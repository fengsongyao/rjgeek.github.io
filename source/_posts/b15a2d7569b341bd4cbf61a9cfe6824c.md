---
title: 【Memcache】32位Linux下的Memcache安装
tags:
  - Memcache
id: 268
categories:
  - 应用服务器
date: 2014-08-13 00:18:13
---

由于memcached安装时，需要使用libevent类库，所以先安装libevent
<!--more-->

libevent下载网址:[http://www.monkey.org/~provos/libevent/](http://www.monkey.org/~provos/libevent/) 

<font color="#333333" face="宋体"><span style="font-size: 14px; line-height: 28px;">官方网站下载地址：</span><span style="line-height: 28px;">http://libevent.org/</span></font>

本次安装用的是 libevent-2.0.21-stable.tar.gz 版本安装步骤如下:

1\. 解压缩

tar xzfv libevent-2.0.21-stable.tar.gz

2\. 进入到 libevent-2.0.21-stable目录

cd libevent-2.0.21-stable

3\. 编译，安装

./configure

make

make install

注：默认安装到/usr/local/lib/ 目录

接下来，安装memcached

memcached下载网址:http://www.memcached.org/

本手册中下载的是 memcached-1.4.20.tar.gz版本

安装步骤如下:

1\. 解压缩

tar xzfv memcached-1.4.20.tar.gz

2\. 进入到 memcached-1.4.20目录

cd memcached-1.2.6

3\. 编译，安装

./configure --prefix=/local/memcached

make

make install

安装完成后，会在 /local/memcached 出现 bin和share目录

进行 bin目录，启动 memcache

方法如下:

./memcached -d -u nobody -m 512 127.0.0.1 -p 11211

此时，会报一个异常

error while loading shared libraries: libevent-2.0.so.5: cannot open shared object file: No such file or directory

原因是找不到libevent-2.0.so.5类库，解决办法如下：

使用LD_DEBUG=help ./memcached -v来确定 加载的类库路径,方法如下:

LD_DEBUG=libs ./memcached -v 2&gt;&amp;1 &gt; /dev/null | less

则系统会显示:

linux:/local/memcached/bin # LD_DEBUG = libs ./memcached -v&nbsp; 2 &gt;&amp; 1&nbsp; &gt; /dev/null | less

20421 :&nbsp;&nbsp;&nbsp;&nbsp; find library = libevent-2.0.so.5 ;&nbsp; searching

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; search cache = /etc/ld.so.cache

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; search path = /lib/tls/i686/sse2:/lib/tls/i686:/lib/tls/sse2:/lib/tls:/lib/i686/sse2:/lib/i686:/lib/sse2:/lib:/usr/lib/tls/i686

/sse2:/usr/lib/tls/i686:/usr/lib/tls/sse2:/usr/lib/tls:/usr/lib/i686/sse2:/usr/lib/i686:/usr/lib/sse2:/usr/lib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (system search path)

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/i686/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/i686/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/i686/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/i686/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/i686/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/i686/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/i686/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/i686/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/sse2/libevent-2.0.so.5

20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/libevent-2.0.so.5

20421 :

./memcached: error while loading shared libraries: libevent-2.0.so.5 : cannot open shared object file: No such file or directory

我们看到，memcached会到很多地方去找，所以根据其它求，我们只需建一个软链接，指定到我们安装的类库上即可

方法如下：

ln -s /usr/local/lib/libevent-2.0.so.5 &nbsp;/lib/libevent-2.0.so.5

现在可以正常启动memcached了

./memcached -d -u nobody -m 512 127.0.0.1 -p 11211

到这里，看到memcached已经启动，说明安装成功。

测试：通过其他机器telnet 此机器的端口 &nbsp; &nbsp; ps:虚拟机上的端口是否已经打开

最后做启动文件，下次可以直接使用

<font color="#333333" face="宋体"><span style="line-height: 28px;">1startmemcache.sh</span></font>

<font color="#333333" face="宋体"><span style="line-height: 28px;">内容为：local/memcached/bin/memcached -d -m 10 -u redhat -l 192.168.199.101 -p 11211 -c 256 -P /tmp/memcached.pid&nbsp;</span></font>

<font color="#333333" face="宋体"><span style="line-height: 28px;">2stopmemecache.sh</span></font>

<font color="#333333" face="宋体"><span style="line-height: 28px;">内容为：</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 16px; line-height: 28px;">kill `cat /tmp/memcached.pid`</span>

memcache启动参数说明:

-d选项是启动一个守护进程，

-m是分配给Memcache使用的内存数量，单位是MB，我这里是10MB，

-u是运行Memcache的用户，我这里是root，

-l是监听的服务器IP地址，如果有多个地址的话，我这里指定了服务器的IP地址192.168.0.200，

-p是设置Memcache监听的端口，我这里设置了12000，最好是1024以上的端口，

-c选项是最大运行的并发连接数，默认是1024，我这里设置了256，按照你服务器的负载量来设定，

-P是设置保存Memcache的pid文件，我这里是保存在 /tmp/memcached.pid

<small><small>&nbsp;</small></small>

<div>[来自为知笔记(Wiz)](http://www.wiz.cn/i/60efacb7 "来自为知笔记(Wiz)")</div>