---
title: 【Memcache】32位redhat6系统安装memcache
tags:
  - Memcache
id: 212
categories:
  - 应用服务器
date: 2014-10-31 22:07:05
---

<font face="宋体"><span style="line-height: 20.740739822387695px;">**一：准备工作**</span></font>

<span style="mso-bidi-font-size:
12.0pt;line-height:150%;font-family:宋体">检查服务器上是否已安装<span lang="EN-US">libevent</span>的<span lang="EN-US">rpm</span>包，具体操作如下：<span lang="EN-US"><o:p></o:p></span></span>

<!--more-->

<span lang="EN-US"># rpm –q
libevent<o:p></o:p></span>

<span style="font-family:宋体;
mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;">若没有，请在</span><span lang="EN-US">linux</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;">软件安装包中找到</span><span lang="EN-US">libevent-***.rpm</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:
&quot;Times New Roman&quot;">，上传至服务器，然后用命令</span><span lang="EN-US">rpm –u libevent-***.rpm</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:
&quot;Times New Roman&quot;">安装</span><span lang="EN-US"><o:p></o:p></span>

<font face="宋体">**二：软件安装**</font>

<o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="chsdate">

</o:smarttagtype>

<span style="font-family:宋体;
mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;">使用</span><span lang="EN-US">root</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;">用户将</span><span lang="EN-US">memcached-<st1:chsdate isrocdate="False" islunardate="False" day="30" month="12" year="1899" w:st="on">1.4.5</st1:chsdate>.tar.gz</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:
&quot;Times New Roman&quot;">上传至服务器上的</span><span lang="EN-US">/usr/local</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:
&quot;Times New Roman&quot;">目录下，用</span><span lang="EN-US">root</span><span style="font-family:宋体;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:
&quot;Times New Roman&quot;">用户登录服务器进行如下安装操作：</span><span lang="EN-US"><o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># cd
/usr/local<o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># tar zxvf memcached-<st1:chsdate isrocdate="False" islunardate="False" day="30" month="12" year="1899" w:st="on">1.4.5</st1:chsdate>.tar.gz<o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># cd
memcached-<st1:chsdate isrocdate="False" islunardate="False" day="30" month="12" year="1899" w:st="on">1.4.5</st1:chsdate><o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># ./configure<o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># make<o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># make
install<o:p></o:p></span>

<span style="mso-bidi-font-size:
12.0pt;line-height:150%;font-family:宋体">查看<span lang="EN-US">memcached</span>是否安装成功<span lang="EN-US"><o:p></o:p></span></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%;font-family:宋体"># ls -al
/usr/local/bin/mem*<o:p></o:p></span>

<span style="mso-bidi-font-size:
12.0pt;line-height:150%;font-family:宋体">成功如下图<span lang="EN-US"><o:p></o:p></span></span>

<span lang="EN-US" style="font-family:宋体;mso-no-proof:yes">![memcache安装成功图](http://helloword.1kapp.com/wp-content/uploads/2015/01/wpid-5175c3f9c8ec74ba2b63fde484e6719b_19ef15c9-03eb-4e80-a9e9-575550b1f116.gif)</span><span lang="EN-US"><o:p></o:p></span>

<span lang="EN-US" style="font-family:宋体;mso-no-proof:yes">**三：编写memcache系统服务**</span>

<span lang="EN-US" style="font-family:宋体;mso-no-proof:yes">

</span>

<span lang="EN-US"># cd
/etc/rc.d/init.d<o:p></o:p></span>

<span lang="EN-US"># vi memcached<o:p></o:p></span>

<span style="line-height: 150%;">按<span lang="EN-US">i</span>键，进入编辑模式，输入如下信息<span lang="EN-US">(</span>不包含中文注释<span lang="EN-US">)</span>，其中<span lang="EN-US">MEMCACHED</span>、<span lang="EN-US">MEMCACHED_PID</span>、<span lang="EN-US">MEMCACHED_IP</span>、<span lang="EN-US">MEMCACHED_USER</span>、<span lang="EN-US">MEMCACHED_PORT</span>、<span lang="EN-US"> MEMCACHED_MEMORY</span></span><span style="line-height: 150%;">请按实际情况配置</span><span style="line-height: 150%;">：<span lang="EN-US" style="color:red"><o:p></o:p></span></span>
<div><pre class="prettyprint linenums prettyprinted">

1.2.  `<span class="pln">#!/bin/sh  </span>`
3.  `<span class="pln">#   </span>`
4.  `<span class="pln"># memcached:    MemCached Daemon   </span>`
5.  `<span class="pln">#   </span>`
6.  `<span class="pln"># chkconfig:    - 90 25    </span>`
7.  `<span class="pln"># description:  MemCached Daemon   </span>`
8.  `<span class="pln">#   </span>`
9.  `<span class="pln"># Source function library.</span>`
10.  `<span class="pln">. /etc/rc.d/init.d/functions</span>`
11.  `<span class="pln">. /etc/sysconfig/network</span>`
12.  `<span class="pln">RETVAL=0 </span>`
13.  `<span class="pln">#memcached安装目录下的memcached脚本路径</span>`
14.  `<span class="pln">#MEMCACHED=/root/memcached/bin/memcached</span>`
15.  `<span class="pln">MEMCACHED=/usr/local/memcached-1.4.21
</span>`
16.  `<span class="pln">#memcached_pid存放路径，可自行定义，但须确保存在该目录</span>`
17.  `<span class="pln">MEMCACHED_PID=/root/logs/memcached.pid</span>`
18.  `<span class="pln">#启动memcached的服务器IP</span>`
19.  `<span class="pln">MEMCACHED_IP=10.1.195.88</span>`
20.  `<span class="pln">#启动memcached的用户</span>`
21.  `<span class="pln">MEMCACHED_USER=root</span>`
22.  `<span class="pln">#启动memcached的端口</span>`
23.  `<span class="pln">MEMCACHED_PORT=11211</span>`
24.  `<span class="pln">#启动内存 单位(M)</span>`
25.  `<span class="pln">MEMCACHED_MEMORY=8192m</span>`
26.27.  `<span class="pln">start()</span>`
28.  `<span class="pln">{</span>`
29.  `<span class="pln">  if [ -e $MEMCACHED_PID];then</span>`
30.  `<span class="pln">     echo "memcached already running...."</span>`
31.  `<span class="pln">     exit 0</span>`
32.  `<span class="pln">  fi</span>`
33.  `<span class="pln">      echo -n $"Starting memcached: "</span>`
34.  `<span class="pln">      daemon $MEMCACHED -u $MEMCACHED_USER -d -m $MEMCACHED_MEMORY -l $MEMCACHED_IP -p $MEMCACHED_PORT</span>`
35.  `<span class="pln">   RETVAL=$?</span>`
36.  `<span class="pln">   echo</span>`
37.  `<span class="pln">   [ $RETVAL = 0 ] &amp;&amp; touch $MEMCACHED_PID</span>`
38.  `<span class="pln">   return $RETVAL</span>`
39.  `<span class="pln">}</span>`
40.  `<span class="pln">stop()</span>`
41.  `<span class="pln">{</span>`
42.  `<span class="pln">      echo -n $"Shutting down memcached: "</span>`
43.  `<span class="pln">      killproc memcached</span>`
44.  `<span class="pln">      RETVAL=$?</span>`
45.  `<span class="pln">      echo</span>`
46.  `<span class="pln">      [ $RETVAL = 0 ] &amp;&amp; rm -f $MEMCACHED_PID</span>`
47.  `<span class="pln">}</span>`
48.  `<span class="pln">#[ -f $MEMCACHED] || exit 0</span>`
49.  `<span class="pln"># See how we were called.</span>`
50.  `<span class="pln">case "$1" in</span>`
51.  `<span class="pln">start)</span>`
52.  `<span class="pln">     start</span>`
53.  `<span class="pln">     ;;</span>`
54.  `<span class="pln">stop)</span>`
55.  `<span class="pln">     stop</span>`
56.  `<span class="pln">     ;;</span>`
57.  `<span class="pln">restart)</span>`
58.  `<span class="pln">     stop</span>`
59.  `<span class="pln">     sleep 3</span>`
60.  `<span class="pln">     start</span>`
61.  `<span class="pln">     ;;</span>`
62.  `<span class="pln">*)</span>`
63.  `<span class="pln">     echo $"Usage: $0 {start|stop|restart}"</span>`
64.  `<span class="pln">     exit 1</span>`
65.  `<span class="pln">esac</span>`
66.  `<span class="pln">exit $RETVAL</span>`</pre></div><div>

<span style="line-height: 150%;">按<span lang="EN-US">ESC</span>键，退出编辑模式，输入命令<span lang="EN-US">:wq</span>保存退出。<span lang="EN-US"><o:p></o:p></span></span>

<span style="line-height: 150%;">**四：启动memcache服务**</span>

<span style="line-height: 150%;">使用命令</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">service memcached start</span><span style="line-height: 150%;">启动</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">memcached</span><span style="line-height: 150%;">服务，出现如下信息即启动成功：</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%"><o:p></o:p></span>

<span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">Service&nbsp; memcached</span><span style="line-height: 150%;">：</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [OK]<o:p></o:p></span>

<span style="line-height: 150%;">在本地机器</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">telnet memcached</span><span style="line-height: 150%;">服务器的</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%">11211</span><span style="line-height: 150%;">端口，能够连接上即表示服务正常启动。</span><span lang="EN-US" style="mso-bidi-font-size:12.0pt;line-height:150%"><o:p></o:p></span>

<span style="line-height: 20.740739822387695px;">**五：常见问题记录**</span>

<span style="line-height: 20.740739822387695px;">1.</span><span style="font-size: 10.5pt; line-height: 1.5;">&nbsp;libevent没有安装</span>

<span style="font-size: 10.5pt; line-height: 1.5;">下载</span><span style="font-size: 10.5pt; line-height: 1.5;">[libevent](http://libevent.org/)安装包，编译安装</span>

<p style="margin: 10px auto; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 19.5px; background-color: rgb(245, 245, 245); margin: 0px; padding: 0px;">&nbsp;</span><span style="margin: 0px; padding: 0px;"> &nbsp; &nbsp; &nbsp;./configure --prefix=/usr</span>

<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;make&nbsp;</span>

&nbsp; &nbsp; &nbsp; &nbsp;make install
</p></div>

<span lang="EN-US" style="font-family:宋体;mso-no-proof:yes">
</span>

<div>[来自为知笔记(Wiz)](http://www.wiz.cn/i/60efacb7 "来自为知笔记(Wiz)")</div>

<div>

### 附件列表

*   [libevent-2.0.21-stable.tar.gz](http://helloword.1kapp.com/wp-content/uploads/2015/01/wpid-5175c3f9c8ec74ba2b63fde484e6719b_libevent-2.0.21-stable.tar.gz)
*   [memcached-1.4.21.tar.gz](http://helloword.1kapp.com/wp-content/uploads/2015/01/wpid-5175c3f9c8ec74ba2b63fde484e6719b_memcached-1.4.21.tar.gz)</div>

&nbsp;