<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[【区块链资讯系列】 国外优秀区块链创业公司梳理]]></title>
    <url>%2Fblockchain_tech_company.html</url>
    <content type="text"><![CDATA[引言本文按照公司的服务类别类别总结了40家国外目前区块链的创业公司，旨在帮助技术人员和创业人员加深对区块链技术和行业的认知。服务类别总体分类2类：金融服务和非金融服务，其中金融服务包括电子商务，保险服务，转账支付，供应链管理，资产管理，证券服务，区块链P2P，区块链众筹，区块链支付，区块链借记卡等；非金融服务包括基础设施，数据存储，数据分析，新闻资讯，身份认证，知识产权，防伪公正，社交通信，物联网，浏览器，DNS，电子投票，学历认证，电子病例等。 金融公司 服务类别 公司名字 电子商务 OpenBazaar 保险服务 Safe share insurance 转账支付 Dragonfly Fintech 供应链管理 Skuchain 资产管理 Everledger 证券服务 Symbiont 区块链P2P BTCJam 区块链众筹 Bolero 区块链支付 Changetip 区块链借记卡 Bladepayments 虚拟货币交易平台 Trezor，Bitgo, Bitpay 非金融公司 服务类别 公司名字 基础设施 Bitcoin, Ethereum，Hyperledger Fabric,Mijin，Lisk 数据存储 Sia，Filecoin，Maidsafe，Storj 数据分析 Scorechain, Chainalysis 新闻资讯 CoinDesk 身份认证 World-Citizenship，Shocard，DIF 知识产权 Stem，Custostech 社交通信 Bitmessage，Steemit 物联网 Iota 浏览器 Blockstack-browser DNS Blockstack-DNS 电子投票 Blockvotes 学历认证 Blockcerts, BTCert 电子病例 Medicalchain 金融领域电子商务OpenBazaarOpenBazaar is an open source project developing a protocol for e-commerce transactions in a fully decentralized marketplace.[1] It uses the cryptocurrency bitcoin and was inspired by a hackathon project called DarkMarket. OpenBazaar 是一个结合了ebay和bitTorrent的去中心化的在线交易市场，因为不需要第三方，因此没有任何限制和不需要交易费用。OpenBazaar 启发与臭名昭著的互联网“黑市”（一个枪支和毒品泛滥的市场）。 项目地址：https://www.openbazaar.org/ 保险服务Safe share insurance SafeShare, an insurance services company has launched a new blockchain based insurance product targetted towards the sharing economy businesses SafeShare is a new-age insurance solutions provider based out of London, England. It is part of Cornerstone Insurance Brokers Limited. SafeShare specializes in insurance solutions for the new-age startups which are based on sharing economy. We all know about the popularity of applications like Airbnb and Uber. They are all based on the sharing economy where individuals offer services in a personal capacity, facilitated by an application or a platform. SafeShare 是一家建立在分享经济和区块链基础上的保险公司，目前SafeShare有英国劳埃德银行承保，他们宣称提供24的小时的理赔服务。 项目地址：http://www.safeshareinsurance.com/ 转账支付解决方案Dragonfly Fintech金融区块链解决方案公司，公司注册在新加坡，目前为软银项目的承担方，第一个被日本银行界认可的区块链解决方案。他们宣称该解决方案将驱动整个汇款链，从批发外汇到接收方的收款。 项目网址：http://www.dragonflyfintech.com/ 供应链管理Skuchain从事产品制造和分销的企业的盈利能力取决于以供应链管理的基础的库存。 ERP系统，库存管理系统，供应链金融计划，贸易融资工具，信用证，开立账户交易，采购订单，发票和库存资产是当今交易中使用的工具。然而，在使用这些工具时存在显着的摩擦，延迟，泄漏和成本。Skuchain 旨在通过透明化的区块链交易解决供应链和贸易融资中所存在的种种问题。 项目网址：http://www.skuchain.com/ 资产管理Everledger We’ve built a global, digital ledger that tracks and protects valuable assets throughout their lifetime journey. We collect an asset’s defining characteristics, history, and ownership to create a permanent record on the blockchain. This digital incarnation, or thumbprint, is used by various stakeholders across a supply chain pipeline to form provenance and verify authenticity. Everledger是一家创建于英国伦敦的公司，Everledger创建了一个全面追踪，保护有价资产的账本，有效的保护了整个资产的安全在整个资产周期管理中。 项目网址：https://www.everledger.io/ 证券服务SymbiontSymbiont是一家位于纽约市的区块链技术公，他们提供用于资本市场的智能合约和分类账本产品，他们的产品提供了一个简单的界面，用于指定发行智能证券时的条款和条件，与市场数据反馈。 项目网址：https://symbiont.io/ 区块链P2PBTCJamBTCjam是总部设在旧金山，加州，它提供了一个基于比特币的社交借贷服务公司，将需要贷款的人和有多余比特币放贷的人匹配在一起，该公司与2014年完成种子融资。 项目网址：https://btcjam.com/ 区块链众筹BoleroBolero众筹平台推出了号称欧洲第一款区块链应用，验证了区块链可以为非上市公司的证券提供更多的流动性，从而打开以区块链为基础的股权众筹二级市场发展道路。 项目网址：https://bolero-crowdfunding.be/nl 区块链支付ChangetipChangeTip是由位于加利福尼亚州旧金山的微型支付平台，专门从事使用数字货币比特币的在线小额支付。 ChangeTip成立于2013年，使数字货币的用户可以在各种社交媒体网站（如Twitter，YouTube，Reddit和Facebook）以及电子邮件和短信发送小额支付。 项目网址：https://www.changetip.com/ 区块链借记卡Bladepaymentsbladepayments 为用户提供了一个可以用比特币充值的借记卡，该借记卡可以在承认比特币的地方进行刷卡。项目网址： https://www.bladepayments.com/ 比特币交易工具（平台）TrezorTrezor 是一个硬件钱包，他使用了离线自主开发的KEY来确保钱包的安全。 项目地址：https://trezor.io/ BitGo BitGo is the leading Bitcoin security platform and a pioneer of multi-sig technology.Based in Palo Alto, BitGo launched the first ever multi-signature Bitcoin wallet in 2013, and continues to create innovative security services on top of emerging industry standards. bitgo 是一个虚拟货币交易平台,专注于比特币的安全交易，有Will O’Brien等人创建，有红点创投投资。 项目地址： http://bitgo.info/ BitPay BitPay is a global bitcoin payment service provider headquartered in Atlanta, Georgia. It was founded in May 2011 by Tony Gallippi and Stephen Pair. BitPay provides payment processing services for merchants, and is one of the largest bitcoin payment processors. In 2014, BitPay started processing 1 million USD daily. BitPay是世界上最大的比特币支付公司。 项目地址：https://bitpay.com/ 非金融服务基础设施Ethereum以太坊（英语：Ethereum）是一个开源的有智能合约功能的公共区块链平台。通过其专用加密货币以太币（Ether，又称“以太币”）提供去中心化的虚拟机（称为“以太虚拟机”Ethereum Virtual Machine）来处理点对点合约。以太坊的概念首次在2013至2014年间由 Vitalik Buterin，受比特币启发后提出，大意为“下一代加密货币与去中心化应用平台”，在2014年通过ICO众筹得以开始发展[1]。 项目地址：https://www.ethereum.org/ Hyperledger FabricHyperledger Fabric是分布式分类帐解决方案的平台，以模块化架构为基础，提供高度的保密性，弹性，灵活性和可扩展性。它旨在支持不同组件的可插拔实现，并适应经济生态系统中存在的复杂性和复杂性。 项目地址： https://cn.hyperledger.org/ MijinMijin是日本的一家区块链开发公司，提供开放的私有链平台。 项目地址：http://mijin.io/ Lisk Lisk is a Blockchain application platform, established in early 2016. Based on its own Blockchain network and token LSK, Lisk will enable developers to create, distribute and manage decentralized Blockchain applications by deploying their own sidechain linked to the Lisk network, including a custom token. Thanks to the flexibility of sidechains, developers can implement and customize their Blockchain applications entirely. Lisk是一个区块链的开发平台，成立于2016年，它允许开发者创建，分发和管理基于该项目的区块链应用。 项目地址：https://lisk.io/ 数据存储从传统的文件系统到关系型数据库，非关系型数据库，人类对存储的研究脚步从未停息，自区块链诞生之日起，就有创业公司开始提出用区块链解决存储问题，下面将主要的公司整理如下： SiaSia的最初想法源于一次活动（HackMIT 2013）。最初的想法是，如果解放世界未使用的存储空间，并将其统一成为全球免费数据市场。Sia利用块链技术的能力，使分布式网络能够以安全无虞的方式达成共识。密码安全的智能合同确保数据的加密和传输，不可能使第三方以任何方式干扰。Sia是云存储平台的新方法。Sia不是所有的数据中心都由一家公司拥有和经营，而是开放包容的，它允许任何人通过租用硬盘来赚钱。使用冗余和加密来保护数据完整性。 项目地址： http://sia.tech FilecoinFilecoin是基于比特币的数据存储网络和电子货币。可以用你未使用的硬盘进行挖矿然后赚取Filecoin币，然后可以通过市场将Filecoin货币进行兑换成法币。 项目地址： http://filecoin.io/ MaidsafeMaidsafe 成立于苏格兰，他们最早提出了安全币项目和资源拥有证明（proof of resource），他们构建了一个去中心化的存储和去中心化的互联网，旨在帮助人们重新夺回对数据的控制权（目前的数据都是集中式数据，有多家行业巨头拥有）。 项目地址： https://maidsafe.net/ StorjStorj 提供了去中心化的存储平台，后台采用NodeJs实现，该项目采用了自由软件基金会发布的GNU Affero通用公共许可证的许可证版本3，目前项目属于免费阶段。 项目地址： https://storj.io/ 数据分析ScorechainScorechain 是一家从事虚拟货币数据分析公司，公司总部位于卢森堡， 该公司提供各项虚拟货币的数据分析。 项目地址： https://www.scorechain.com/ Chainalysis Chainalysis protects the junction between finance and the decentralized internet. 项目地址： https://www.chainalysis.com/ 新闻网站CoinDeskCoinDesk于2013年创立在伦敦，是目前世界公认的区块链资讯信息网络，是区块链技术的重要信息来源。 项目地址：https://www.coindesk.com 身份认证World-Citizenship The goal of this project is to learn and layout a simple process for anyone in the world to create their own Private Passport Service that can be used to validate and prove the existence of other persons using nothing but available tools. World-Citizenship 旨在利用区块链创造个人的护照，该服务可用于验证自己和证明其他人的存在，通过世界护照的方式，让一些难民不仅依赖于国家来证明自己的身份。 项目地址：https://github.com/MrChrisJ/World-Citizenship Shocard ShoBadge is the next generation of enterprise-level identity authentication from ShoCard, the most secure identity management system (IMS) available, which uses mobile devices combined with disruptive, secure blockchain technology as the basis for trusted sharing that is virtually unhackable. Shocard 提供基于区块链的电子身份证，主要的思路是将政府授权个人的信息和手机认证新机发布到区块链，区块链担当中间人进行验证。 项目地址：https://shocard.com/ DIFDIF 提供了一种分散式的身份认证标准，在这个json-ld based 标准中，用户的身份有用户独立控制，不依赖于第三方。协议的内容点击下载 项目地址：http://identity.foundation/ 知识产权Custostech Custostech uses imperceptible watermarking technology and the Bitcoin blockchain to protect digital media files from online piracy. Custostech 使用了水印技术和区块链技术来保护电子文件和媒体，这些文件和媒体涉及音频，视屏，虚拟化文档等。 项目地址：https://custostech.com/ Stem Stem tracks and organizes revenue streams for artists and their teams, giving a clear picture of earnings at all times and ensuring everyone involved in the creative process gets paid. Stem 旨在帮助艺术家，音乐家时刻跟踪他们创作的作品，确保他们的作品得到应有的回报。 项目地址：https://stem.is/ 社交通信Steemit Steemit is a social network and content rewards platform that makes the crowd the beneficiaries of the attention economy. It does this be rewarding users with STEEM. Steemit has redefined social media by building a living, breathing, and growing social economy; a community where users are getting rewarded for sharing their voice. Steemit is a social media platform that works by having the crowd reward the crowd for their content. It does this thanks to the Steem blockchain and cryptocurrency; Steem is ‘minted’ daily and distributed to content producers according to the votes they get. Steemit 将发行的Steemit币，作为对用户的奖励，从而鼓励用户在发表更加价值的文本。 项目地址：https://steemit.com Bitmessage Bitmessage is a P2P communications protocol used to send encrypted messages to another person or to many subscribers. It is decentralized and trustless, meaning that you need-not inherently trust any entities like root certificate authorities. It uses strong authentication which means that the sender of a message cannot be spoofed, and it aims to hide “non-content” data, like the sender and receiver of messages, from passive eavesdroppers like those running warrantless wiretapping programs Bitmessage是一种P2P通信协议，用于向另一个人或许多用户发送加密的消息。 项目地址：https://bitmessage.org 物联网Iota As the Internet-of-Things keep expanding, the need for interoperability and sharing of resources become a necessity. IOTA enables companies to explore new business-2-business models by making every technological resource a potential service to be traded on an open market in real time, with no fees. Iota 是一家位于挪威的公司，旨在用区块链技术解决物联网中的种种问题。 项目地址： https://iota.org/ 浏览器应用Blockstack - BrowserBlockstack于5月23日在Coindesk区块链年会上发布一款分散式浏览器，这款浏览器可以使应用程序利用区块链技术运作。项目地址： https://blockstack.org/ DNS应用Blockstack Blockstack is the first implementation of a decentralized DNS system on top of the Bitcoin blockchain.[2] It combines DNS functionality with public key infrastructure and is primarily meant to be used by new blockchain applications. Blockstack是第一个基于比特币区块链的DNS应用。 项目地址： https://blockstack.org/ 电子投票blockvotesblockvotes 是一个将换签名与区块链相结合的在线投票系统，该项目有伯明翰大学区块链实验室成员推出。 项目地址：http://blockvotes.com 学历认证Blockcertsblockcerts 是有麻省理工学院发布比特币区块链认证系统，项目的核心思想是将学历的认证信息发布到比特币的区块链上。同时blockcerts采用了openBadges. 项目地址：http://www.blockcerts.org/ BTcertBTcert 在blockcerts标准上研发的项目，BTcert运用了多重签名，基于地址的证书回收协议，联合身份认证等解决了blockcerts的相应缺陷，该项目有伯明翰大学区块链实验室成员推出。 项目地址：https://btcert.com/ 电子病例Medicalchain Medicalchain uses blockchain technology to securely store health records and maintain a single version of the truth. Medicalchain 采用区块链技术安全存储健康数据。 项目地址： https://medicalchain.com/en/ 总结本文从金融行业和非金融行业的角度列举了40家国外比较火热的区块链创业项目，旨在帮助技术人员和创业人员加深对区块链技术和行业的认知。 声明d3d3LmVoY29vLmNvbSwg5L2c6ICFOmVoY29v（BASE64编码）访问地址：http://www.ehcoo.com/blockchain_tech_company.html]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【区块链技术系列】 区块链共识机制总结(上)]]></title>
    <url>%2Fblockchain_confirmation_mechanism.html</url>
    <content type="text"><![CDATA[引言 区块链是一种去中心化的分布式账本系统，由于点对点网络下存在较高的网络延迟，各个节点所观察到的交易事务先后顺序不可能完全一致。 因此区块链系统需要设计一种机制对在一定的时间内发生的事务的先后顺序进行共识。这种对一个时间窗口内的事务的先后顺序达成共识的算法被称为“共识机制”。【1】 本文旨在阐述常见的区块链中的确认机制，主要结构如下，共识机制在比特币中的整体地位，常见的共识机制如POW，POS 和 DPOS，以及这几种机制之前的演进，关系与不同。 共识机制区块链系统的核心是有系统中节点竞争记账，这个竞争的过程称为共识机制，区块链的底层有四部分构成，一个分布式的数据库用来存储以往和将来的交易数据，密码学的公私密钥体系用来确认交易双方的身份，P2P网络用来广播和蔓延各类消息（如节点加入消息，节点失效消息，得到挖矿数据的消息）和 用来决定节点记账权利的共识机制。 共识机制在区块链中扮演着核心的地位，共识机制决定了谁有记账的权利，以及记账权利的选择过程和理由。不用的虚拟货币采用共识机制不同，常见的共识机制如POW，POS，DPOS 拜占庭容错等。现梳理如下： Virtual Currency Mechanism Bitcoin POW Ppcoin POS ShadowCash POS BlackCoin POS NuShares/NuBits. POS Ethereum. NXT POW+POS AntShares dBFT POWPOW(Proof of Work)，即工作量证明机制。整个系统中每个节点为整个系统提供计算能力(简称算力)，通过一个竞争机制，让计算工作完成最出色的节点获得系统的奖励，也就是完成新生成货币的分配。【1】 区块链是一个持续增长的顺序块组成的，每个块包含了头文件和一系列的交易信息$TXi$，其中头文件中保护了timestamp $Ti$,上一个块的索引$Hi-1$, 和nounce $ Ni-1$ ,区块链是密码上的安全，对于每一轮只要找到相应的HASG的碰撞就算成功，HASG的碰撞的意思可以了解为hash值的前多少位相同，我们知道何难找到两个hash一模一样的文件，但是我们可以找到前几位相同的，我们将一个完整的挖矿过程整理如下： $$f(Di) &gt; SHA256(SHA256(Hi−1||Ti||TXi||di||Ni)))$$ 其中$Di$是难度系数，可以认为是前多少位的碰撞。挖矿的过程就是在不停的尝试找$Ni$的过程。下面我们给出一个模拟挖矿的例子。 测试环境说明： 操作系统 RAM SWAP Centos 6 x86 512M 256 MB 操作步骤： 运行如下脚本 123456789#!/ bin/bash n=1 while [ $n -lt 1000000 ] do echo -n $n j sha1sum - j cut -c 1-9 &gt;&gt; sha1-9-result n=$ (( n+1 )) # increments $n donesort sha1-9-result &gt; sha1-9-result -sortuniq -d sha1-9-result -sort &gt; sha1-9-result -uniq 对结果进行排序，找到前9位对撞成功的n的值. 实验结果如下： “311214” sha1 value is:ff47893a16ec612176cbb4255c7e0ce58400a828“775478” sha1 value is:ff47893a1f31dd5fd4220a9e8981112a2b3be2d6 虽然只是模拟实验，但是完整的反映了POW的运作原理。 POSPOS， (Proof of Stake) 最初有Sunny King 在2102年在论文PPCoin: Peer-to-Peer Crypto-Currency with Proof-of-Stake 中提出，这种机制通过计算你持有币数占总币数的百分比，包括你占有币数的时间来决定你获得本次记账权利的概率。 在 PoW 机制中，由于想要找到符合条件的 nonce. nonce 往往需要花费大量的电力和时间成本，因此，为了使每个 Block 更快被生成，PoS 机制去掉了穷举 noncenonce 这一过程，继而采用以下更快速的算法：【2】$$SHA256(SHA256(B prev),A,t) ≤ balance(A)m$$ H 某个哈希函数t 为 UTC 时间戳Bprev 指的是上一个区块balance(A) 代表账户A 的账户的余额唯一可以不断调整的参数是 t，等式右边 m 是某个固定的实数，因此，当balance(A)越大，找到合理 t 的概率越大。网络中，普遍对于 t 的范围有所限制，如可以尝试的时间戳不能超过标准时间戳 1 小时，也就说，一个节点可以尝试 7200 次，来找到一个符合条件的t，如果找不到即可放弃。因此，在 PoS 中，一个账户的余额越多，在同等算力下，就越容易发现下一个区块. DPOWDelegated Proof of Stake（委托股权证明） 是 PoS 的进化方案，在常规 PoW 和 PoS 中，一大影响效率之处在于任何一个新加入的 Block，都需要被整个网络所有节点做确认。DPoS 优化方案在于：通过不同的策略，不定时的选中一小群节点，这一小群节点做新区块的创建，验证，签名和相互监督，这样就大幅度的减少了区块创建和确认所需要消耗的时间和算力成本。【2】 机制的演进在本章中我们会重点探讨POW-&gt;POS-DPOS这个演进的过程，哪些原因促使了区块链从POW到POS的转移。 比特币的设计之初，系统默认节点和算力是均匀分布的，因为通过CPU来进行投票，拥有钱包(节点)数和算力值应该是大致匹配的，每一个比特币钱包的拥有者都能够参与整个系统的决策机制，如果有任何人试图对系统作恶，或者某一部分节点收到损失，都可以让其他节点迅速补上，并且只要有51%的节点(算力)投票就可以选择对系统发展更有利的方向。 在实际操作中POW的主要问题是算力过于集中的安全风险，这种风险体现在比特币的控制权上，挖矿的人和持有比特币的人已经完全被隔开，许多矿工可能完全不了解比特币的生态，甚至不关心比特币的未来，却拥有对比特币的绝对控制权，因为他们是新币产生的起始点。一种极端的想法，如果几个大型的矿池联合在一起，那么最新发行的币将囤积，会造成原有币种的进一步通货紧缩。简而言之，比特币的命运掌握在并不一定关心比特币命运的人手上，而持有比特币的人并没有控制权。【3】 这就有点像，一个公司的命运并不是那些持有公司股份的股东来决定的，而是那些有可能根本不拥有股份，而只要有钱的人来决定的。那些持有比特币的人完全无法对比特币的未来做出自己的决定。我们仿佛从中本聪设定的一CPU一票的文明世界，一下子沦为纯粹是靠蛮力，看谁力气更大的原始社会。 DPOS机制似乎又重新把权利归还到那些持有数字货币的人手上。DPOS机制是让每一个持有BTS的人对整个系统资源当代表的人进行投票，而获得最多票数的101个代表进行交易打包计算。这个可以理解为101个矿池，而这101个矿池彼此的权利是完全相等的。那些握着BTS选票的人可以随时通过投票更换这些代表(矿池)，只要他们提供的算力不稳定，计算机宕机、或者试图利用手中的权力作恶，他们将会立刻被愤怒的选民门踢出整个系统，而后备代表可以随时顶上去。【3】 发行机制POW的新增机制是“挖矿”，即矿工每完成一定量的计算，有可能获得一块新block中的新增比特币。这个过程是一个纯粹的通胀过程，即无中生有新增比特币。但获得新增的比特币有一定的要求，必须全球第一个找出特定的HASH值。因此发行机制是算力比例分配的。 POS的新增机制是“利息”，即持有一定的POS币一定时间，当然得开着客户端，将获得一定量的固定“利息”。这部分“利息”是新增的POS币。只要你持有POS币并开机，你就能获得一定比例的“利息”。 因此POS体系将新增POS币投放社会的机制，其投向是以已有POS币等比例增加的。 优缺点对比 类型 优点 缺点 PoW 1.算法简单，容易实现；2.节点间无需交换额外的信息即可达成共识；3.破坏系统需要投入极大的成本； 1.浪费能源；2.区块的确认时间难以缩短；3.新的区块链必须找到一种不同的散列算法，否则就会面临比特币的算力攻击；4.容易产生分叉，需要等待多个确认；5.永远没有最终性，需要检查点机制来弥补最终性； POS/DPOS 1.算法简单，能耗低 1)没有专业化，拥有权益的参与者未必希望参与记账；2.容易产生分叉，需要等待多个确认；4.永远没有最终性，需要检查点机制来弥补最终性；【1】 总结本文介绍了常见的共识机制，并阐述了其中的演进和发展的过程，下部分中我们将从确认时间，能耗，激励措施，经济模型等方面进行详细的分析。 声明本文65%为翻译组合,35%为原创d3d3LmVoY29vLmNvbSwg5L2c6ICFOmVoY29v（BASE64编码） 引用 https://baike.baidu.com/item/%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6/20234683?fr=aladdin https://daimajia.com/2017/09/14/pow-and-pos http://www.wanbizu.com/jingyan/201408231853.html https://www.linkedin.com/pulse/%E6%B7%B1%E5%BA%A6%E6%8E%A2%E8%AE%A8pos%E6%9C%BA%E5%88%B6-%E9%B2%B2-%E7%8E%8B?trk=pulse-det-nav_art]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【比特币技术系列】 椭圆曲线加密算法 - ECDSA]]></title>
    <url>%2FBitcoin_ECDSA.html</url>
    <content type="text"><![CDATA[引言上次文章中提到椭圆曲线加密算法，因为此部分过于学术就没有详细讲解，最近有读者问及,索性写篇文章整理下此算法，首先椭圆曲线加密算法是用于比特币中的公钥私钥的生成。需要指出的是在非对称密钥体系中，椭圆曲线加密算法只是其中的一种，可能还有其他的算法，比如Elgamal，DSA等。今天的主要内容包括：群(GROUP)组的概念，椭圆曲线加密算法与相关的类比与例子 单向陷门函数 A trapdoor function is a function that is easy to compute in one direction, yet difficult to compute in the opposite direction (finding its inverse) without special information, called the “trapdoor”. Trapdoor functions are widely used in cryptography. –wikipedia 一个trapdoor函数最大的功能就是单向计算非常容易，在缺少必要信息的情况下逆向计算非常困难，这就是公私钥密码使用的基础：用私钥推出公钥很容易，有公钥反推出私钥却很困难，除非具备了某些必要的参数。非对称密钥的发展史就是一个在不停的寻找优秀单项函数的过程，目前常用有DH,DSA,ECDH,ECDSA.我们今天探讨的椭圆曲线加密算法(ECDSA)，只是其中的一种。下面开始探讨椭圆曲线加密算法为何是一个优秀的Trapdoor函数。 一个有趣的类比一个椭圆曲线是满足一个特殊方程的点集。一个椭圆曲线方程看起来有点像这个：$y^2 = x^3 + ax + b$ 也有其他椭圆曲线的代表，但学术上一个椭圆曲线是一个满足一个变量为二阶，另一个变量为3阶的二元方程。一个椭圆曲线不仅仅是一个漂亮的图片，它也有一些使它成为密码学的一个好环境的性能。 靠近看上文标绘的椭圆曲线。它有几个有趣的特性。其中一个是水平对称。曲线上的任何点以X轴反射并且仍然是同样的曲线。一个更加有趣的特性是任何不垂直的线穿过曲线最多有三个交点。让我们来把曲线想象成一个奇异的桌球游戏。取曲线上的任意两点并且把他们连起来；这条线与曲线有两个以上的交点。在这个桌球游戏里，你拿球从A射向B.当它撞上曲线，这个球向上反弹（它位于X轴以下）或者向下反弹到曲线的另一边。 我们把球移向两点叫“打点（dot）”。曲线上的任意两点能被同时打点得到一个新点。 A dot B = C 我们也能同时做一串移动来用它自己反复“打点”。 A dot A = B A dot B = C A dot C = D… 事实证明如果你有两个点，一个最初的点用它自己打点n次到达一个最终点，在你只知道最重点时找到n和最初点是很难的。继续我们的奇异桌球比喻，想象一个人在一段任意时间里在一个房间里单独玩我们游戏。对他来说，他跟着上述规则来反复击球是容易的。如果一个人后来走进房间并且看到球最终的位置，即使他们知道这个游戏的所有规则和球的起点，在没有全程观察游戏直到球到达同一点的情况下，他们也不能算出球击打到那的次数。容易做，但很难解开。这就是一个非常棒的trapdoor函数的基础。 椭圆曲线按照上面的例子，如果我们需要桌球进行反弹来确定不同的点，那么桌面一定是具有一定范围的，不然发射出去永远接触不到面永远找不到反射点了，在数学中我们把这个桌面成为定义成一个群，为了便于讲解我们将其定义为一个有限域，NOTE：域其实是群的一种特例，在此不深究。 GroupGroup的标准定义： 我们把它实例化，针对椭圆上的点，我们可以认为他是一个有限域，因为他满足上面的特征 Fp中只有p（p为素数）个元素0,1,2 …… p-2,p-1； Fp 的加法（a+b）法则是 $a+b≡c (mod p)$；即，$(a+c)÷p$的余数 和$c÷p$的余数相同。 Fp 的乘法(a×b)法则是 $a×b≡c (mod p)$； Fp 的除法(a÷b)法则是 $a/b≡c (mod p)$； Fp 的单位元是1，零元是 0。 同时，并不是所有的椭圆曲线都适合加密。$y^2=x^3+ax+b$是一类可以用来加密的椭圆曲线，也是最为简单的一类。下面我们就把$y2=x3+ax+b$ 这条曲线定义在Fp上：选择两个满足下列条件的小于p(p为素数)的非负整数a、b $4a^3+27b^2≠0 (mod p)$ 则满足下列方程的所有点(x,y)，再加上 无穷远点O∞ ，构成一条椭圆曲线。其中 x,y属于0到p-1间的整数，并将这条椭圆曲线记为Ep(a,b)。 $y^2=x^3+ax+b (mod p)$ 举例我们看一下$y^2=x^3+x+1 (mod 23)$的图像，满足这个点是所有数据 上面的结果推到公式涉及高等数学部分，我们再此就直接给出结果 无穷远点 O∞是零元，有O∞+ O∞= O∞，O∞+P=P P(x,y)的负元是 (x,-y)，有P+(-P)= O∞ P(x1,y1),Q(x2,y2)的和R(x3,y3) 有如下关系： $$x3≡k^2-x1-x2(mod p)$$$$y3≡k(x1-x3)-y1(mod p)$$ 理想的情况下，上面的k其实就上上面直线的斜率，$$若P=Q 则 k=(3x^2+a)/2y1$$$$若P≠Q，则k=(y2-y1)/(x2-x1)$$ 例5.1 已知E23(1,1)上两点P(3,10)，Q(9,7)，求1)-P，2)P+Q，3) 2P。 1) –P的值为(3,-10)2) k=(7-10)/(9-3)=-1/2，2的乘法逆元为12 因为212≡1 (mod 23) k≡-112 (mod 23) 故 k=11。 x=112-3-9=109≡17 (mod 23); y=11[3-(-6)]-10=89≡20 (mod 23) 故P+Q的坐标为(17,20)3) k=[3(32)+1]/(2*10)=1/4≡6 (mod 23) x=62-3-3=30≡20 (mod 23) y=6(3-7)-10=-34≡12 (mod 23) 故2P的坐标为(7,12) 在上面这个例子中如果已经知道2P = (7,12)和P(3,10)，Q(9,7)，你很难计算出2这个参数. 总结本文深入介绍了椭圆曲线加密算法。 声明本文50%为翻译组合,50%为原创d3d3LmVoY29vLmNvbSwg5L2c6ICFOmVoY29v（BASE64编码） 引用http://8btc.com/article-138-1.htmlhttp://8btc.com/article-140-1.htmlhttps://arstechnica.com/security/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【比特币技术系列】 比特币的地址，密钥，钱包之间的关系]]></title>
    <url>%2FBitcoin_key_address.html</url>
    <content type="text"><![CDATA[引言目前市面上讲授区块链技术大多比较肤浅，夹杂着很多商业的元素，很难一下子触及技术核心技术，前两天有朋友在群里问，索性决定把 Andreas M. Antonopoulos的经典之作翻译一下，英文名：《Mastering Bitcoin-Unlocking Digital Cryptocurrencies》，中文名《精通比特币》，翻译完第一节的时候才发现网上已经有了翻译版本。 下面的时间里将和大家一起探索比特币技术，以后将尝试推出一系列的文章去探究比特币和区块链的技术本质，今天的主要内容包括：比特币地址，比特币密钥使用，比特币钱包，以及这三者存在怎样的关系。 密钥私钥 A private key in the context of Bitcoin is a secret number that allows bitcoins to be spent. Every Bitcoin wallet contains one or more private keys, which are saved in the wallet file. The private keys are mathematically related to all Bitcoin addresses generated for the wallet. -wiki 私钥就是一个随机选出的数字而已。一个比特币地址中的所有资金的控制取决于相应私钥的所有权和控制权。在比特币交易中，私钥用于生成支付比特币所必需的签名以证明资金的所有权。私钥必须始终保持机密，因为一旦被泄露给第三方，相当于该私钥保护之下的比特币也拱手相让了。私钥还必须进行备份，以防意外丢失，因为私钥一旦丢失就难以复原，其所保护的比特币也将永远丢失。 比特币私钥只是一个数字。你可以用硬币、铅笔和纸来随机生成你的私钥：掷硬币256次，用纸和笔记录正反面并转换为0和1，随机得到的256位二进制数字可作为比特币钱包的私钥。该私钥可进一步生成公钥。 生成密钥的第一步也是最重要的一步，是要找到足够安全的熵源，即随机性来源。生成一个比特币私钥在本质上与“在1到2256之间选一个数字”无异。只要选取的结果是不可预测或不可重复的，那么选取数字的具体方法并不重要。比特币软件使用操作系统底层的随机数生成器来产生256位的熵（随机性）。通常情况下，操作系统随机数生成器由人工的随机源进行初始化，也可能需要通过几秒钟内不停晃动鼠标等方式进行初始化。对于真正的偏执狂，可以使用掷骰子的方法，并用铅笔和纸记录。 比特币私钥空间的大小是$2^{256}$，这是一个非常大的数字。用十进制表示的话，大约是$10^{77}$，而可见宇宙被估计只含有1080个原子。 把私钥以Base58校验和编码格式显示，这种私钥格式被称为钱包导入格式（WIF，Wallet Import Format）。 公钥非对称密钥往往有一对密码组成，一个是私钥，另一个是公钥，公钥就像银行的帐号，而私钥就像控制账户的PIN码或支票的签名。比特币的用户很少会直接看到数字密钥。一般情况下，它们被存储在钱包文件内，由比特币钱包软件进行管理。 其中公钥是有私钥生成，根据选择的算法（RSA,DSA,EIGamal等）不同，生成的方式也不同。比特币采用是的椭圆曲线算法。通过椭圆曲线算法可以从私钥计算得到公钥，这是不可逆转的过程：K = k * G 。其中k是私钥，G是被称为生成点的常数点，而K是所得公钥。其反向运算，被称为“离散对数分解”——已知公钥K来求出私钥k——是非常困难的，就像去试验所有可能的k值，即暴力破解。为了更好的理解私钥和公钥的对应关系 椭圆曲线加密法是一种基于离散对数问题的非对称（或公钥）加密法，可以用对椭圆曲线上的点进行加法或乘法运算来表达。下面我们举出一个例子，如下就是我们高中最常见的椭圆曲线$$y^2 = (x^3 + 7) over (Fp)$$或$$y^2 mod p = (x^3 + 7) mod p$$假设我们设p=17,就是说在x = 17, y= 17 的范围内找出所有符合上面公式的值。当然了这些值一会落在曲线上面。上面的这些点其实就是构成了一个群GROUP，群一定的特征，这里就不深究了，但是提一点，在群中也具有一定运算，也具有加法乘法等，但是和我们平时认知的加减乘除有所区别。 关于此部分是知识，如果读者有浓厚的兴趣可以私信我，因为太过学术，所以点到为止。 下面举一个乘法的例子，下面整数点的乘法，我们的目标是找到生成点G的倍数kG。也就是将G相加k次。在椭圆曲线中，点的相加等同于从该点画切线找到与曲线相交的另一点，然后映射到x轴。如果我们已经知道G和k，可以很轻易的计算出 kG,但是如果知道了KG却很难反推算出k和G，其实这里的k就是私钥，kG就是公钥，私钥可以推算出公钥，但是公钥计算理论上不能推算出私钥。 Note: 很多人会疑惑，按照上面的理论我们计算出来的至公钥是一个点啊，但是我们平时看到的公钥都是一串数字，其实公钥就是X紧跟着Y。举个例子，如下（现实中为了安全往往取值非常大，前缀04表示未压缩格式公钥）x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341Ay = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB则公钥为：K = x + y 地址在比特币交易的支付环节，收件人的公钥是通过其数字指纹表示的，称为比特币地址，就像支票上的支付对象的名字（即“收款方”）。一般情况下，比特币地址由一个公钥生成并对应于这个公钥。地址与公钥之间的关系，如下图所示：javascript的代码实现如下：上图中我提及了Base58Check算法，而在算法实现中我用的却是base58encode，这两者之间有什么差别？ 下文将揭晓答案。1234567pubkey2address = function(h)&#123; var r = ripemd160(Crypto.SHA256(Crypto.util.hexToBytes(h), &#123;asBytes: true&#125;)); r.unshift(&apos;0x00&apos;); //在数组的前端添加任意各项并返回新数组的长度。 var hash = Crypto.SHA256(Crypto.SHA256(r, &#123;asBytes: true&#125;), &#123;asBytes: true&#125;); var checksum = hash.slice(0, 4); return base58encode(r.concat(checksum));&#125; 从Base64编码到Base58为了更简洁方便地表示长串的数字，许多计算机系统会使用一种以数字和字母组成的大于十进制的表示法。例如，传统的十进制计数系统使用0-9十个数字，而十六进制系统使用了额外的 A-F 六个字母。一个同样的数字，它的十六进制表示就会比十进制表示更短。更进一步，Base64使用了26个小写字母、26个大写字母、10个数字以及两个符号（例如“+”和“/”），用于在电子邮件这样的基于文本的媒介中传输二进制数据。Base64通常用于编码邮件中的附件。Base58是一种基于文本的二进制编码格式，用在比特币和其它的加密货币中。这种编码格式不仅实现了数据压缩，保持了易读性，还具有错误诊断功能。Base58是Base64编码格式的子集，同样使用大小写字母和10个数字，但舍弃了一些容易错读和在特定字体中容易混淆的字符。具体地，Base58不含Base64中的0（数字0）、O（大写字母o）、l（小写字母L）、I（大写字母i），以及“+”和“/”两个字符。简而言之，Base58就是由不包括（0，O，l，I）的大小写字母和数字组成。 比特币的Base58字母表 123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz 从Base58到Base58Check编码Base58Check是一种常用在比特币中的Base58编码格式，增加了错误校验码来检查数据在转录中出现的错误。校验码长4个字节，添加到需要编码的数据之后。校验码是从需要编码的数据的哈希值中得到的，所以可以用来检测并避免转录和输入中产生的错误。使用Base58check编码格式时，编码软件会计算原始数据的校验码并和结果数据中自带的校验码进行对比。二者不匹配则表明有错误产生，那么这个Base58Check格式的数据就是无效的。例如，一个错误比特币地址就不会被钱包认为是有效的地址，否则这种错误会造成资金的丢失。 为了使用Base58Check编码格式对数据（数字）进行编码，首先我们要对数据添加一个称作“版本字节”的前缀，这个前缀用来明确需要编码的数据的类型。例如，比特币地址的前缀是0（十六进制是0x00），而对私钥编码时前缀是128（十六进制是0x80）。 常见版本的前缀。 种类 版本前缀 (hex) Base58 格式 Bitcoin Address 0x00 1 Pay-to-Script-Hash Address 0x05 3 Bitcoin Testnet Address 0x6F m or n Private Key WIF 0x80 5,K or L BIP38 Encrypted Private Key 0x0142 6P BIP32 Extended Public Key 0x0488B21E xpub 钱包比特币的所有权是通过数字密钥、比特币地址和数字签名来确立的。数字密钥实际上并不是存储在网络中，而是由用户生成并存储在一个文件或简单的数据库中，称为钱包。存储在用户钱包中的数字密钥完全独立于比特币协议，可由用户的钱包软件生成并管理，而无需区块链或网络连接。 钱包是私钥的容器，通常通过有序文件或者简单的数据库实现。另外一种制作私钥的途径是 确定性密钥生成。在这里你可以用原先的私钥，通过单向哈希函数来生成每一个新的私钥，并将新生成的密钥按顺序连接。只要你可以重新创建这个序列，你只需要第一个私钥（称作种子、主私钥）来生成它们 比特币钱包只包含私钥而不是比特币。每一个用户有一个包含多个私钥的钱包。钱包中包含成对的私钥和公钥。用户用这些私钥来签名交易，从而证明它们拥有交易的输出（也就是其中的比特币）。比特币是以交易输出的形式来储存在区块链中（通常记为vout或txout）。 非确定性的钱包钱包只是随机生成的私钥集合。这种类型的钱包被称作零型非确定钱包。举个例子，比特币核心客户端预先生成100个随机私钥，从最开始就生成足够多的私钥并且每把钥匙只使用一次。这种类型的钱包有一个昵称“Just a Bunch Of Keys（一堆私钥）”简称JBOK。这种钱包现在正在被确定性钱包替换，因为它们难以管理、备份以及导入。随机钥匙的缺点就是如果你生成很多，你必须保存它们所有的副本。这就意味着这个钱包必须被经常性地备份。每一把钥匙都必须备份，否则一旦钱包不可访问时，钱包所控制的资金就付之东流。这种情况直接与避免地址重复使用的原则相冲突——每个比特币地址只能用一次交易。地址通过关联多重交易和对方的地址重复使用会减少隐私。0型非确定性钱包并不是钱包的好选择，尤其是当你不想重复使用地址而创造过多的私钥并且要保存它们。虽然比特币核心客户包含0型钱包，但比特币的核心开发者并不想鼓励大家使用。下图表示包含有松散结构的随机钥匙的集合的非确定性钱包。 确定性的钱包下面列举一种确定性钱包的例子：助记码词汇钱包助记码词汇是英文单词序列代表（编码）用作种子对应所确定性钱包的随机数。单词的序列足以重新创建种子，并且从种子那里重新创造钱包以及所有私钥。在首次创建钱包时，带有助记码的，运行确定性钱包的钱包的应用程序将会向使用者展示一个12至24个词的顺序。单词的顺序就是钱包的备份。它也可以被用来恢复以及重新创造应用程序相同或者兼容的钱包的钥匙。助记码代码可以让使用者复制钱包更容易一些，因为它们相比较随机数字顺序来说，可以很容易地被读出来并且正确抄写。 总结本文介绍了比特币地址，比特币密钥原理，比特币钱包，以及这三者存在怎样的关系。 声明本文70%为翻译组合,30%为原创, 文中大量引用了经典之作《Mastering Bitcoin-Unlocking Digital Cryptocurrencies》d3d3LmVoY29vLmNvbSwg5L2c6ICFOmVoY29v（BASE64编码） 引用http://chimera.labs.oreilly.com/books/1234000001802/ch01.htmlhttp://chimera.labs.oreilly.com/books/1234000001802/ch04.html#public_key_derivation]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【精通比特币，解码电子货币】第1章 介绍（译）]]></title>
    <url>%2FMasteringBitcoin.html</url>
    <content type="text"><![CDATA[引言目前市面上讲授区块链技术大多比较肤浅，很难一下子触及核心技术，前两天有朋友在群里问，索性我决定把 Andreas M. Antonopoulos的经典之作翻译一下，英文名：《Mastering Bitcoin-Unlocking Digital Cryptocurrencies》，中文名《精通比特币》，此部分主要涉及第一章简介。 什么是比特币？比特币是由一系列概念和技术作为基础构建的数字货币生态系统。狭义的“比特币”代表系统中的货币单位，用于储存和传输价值。用户主要通过互联网使用比特币系统，当然其他网络也可以使用。比特币协议以各种开源软件的形式实现，这些软件可以在笔记本电脑、智能手机等多种设备上运行，让用户方便地接入比特币系统。 比特币可以做传统货币能做的所有事，例如买卖商品、给个人或组织汇款、贷款。用户可以在专门的交易所里买卖比特币或兑换其他货币。在一定意义上，比特币才是互联网货币的完美形态。因为它具有快捷、安全、无国界的特性。 不同于传统货币，比特币是完全虚拟的。它不但没有实体，本质上也没有一种虚拟物品代表比特币。比特币隐含在收发币的转账记录中。用户只要有证明其控制权的密钥，用密钥解锁，就可以发送比特币。这些密钥通常存储在计算机的数字钱包里。拥有密钥是使用比特币的唯一条件，这让控制权完全掌握在每个人手中。 比特币是一个分布式的点对点网络系统。因此没有“中央”服务器，也没有中央发行机构。比特币是通过“挖矿”产生的，挖矿就是验证比特币交易的同时参与竞赛来解决一个数学问题。任何参与者（比如运行一个完整协议栈的人）都可以做矿工，用他们的电脑算力来验证和记录交易。平均每10分钟就有人能验证过去这10分钟发生的交易，他将会获得新币作为工作回报。本质上，挖矿把央行的货币发行和结算功能进行分布式，用全球化的算力竞争来取代对中央发行机构的需求。 比特币系统包含调节挖矿难度的协议。挖矿——在比特币网络中成功写入一个区块交易——的难度是动态调整的，保证不管有多少矿工（多少CPU）挖矿，平均每10分钟只有一个矿工成功。 比特币协议还规定，每四年新币的开采量减半，同时限制比特币的最终开采总量为2,100万枚。这样，流通中的比特币数量非常接近一条曲线，并将在2140年比特币将达到2,100万枚。由于比特币的开采速度随时间递减，从长期来看，比特币是一种通货紧缩货币。此外，不能通过“印刷”新比特币来实现“通货膨胀”。 比特币是一种协议、一种网络、一种分布式计算创新的代名词。比特币是这种创新的首次实际应用。作为一个开发者，我看比特币之于货币就像看到当年的互联网，一个通过分布式计算来传播价值和保障数字资产所有权的网络。比起初识比特币，这里将知无不言。 在本章中，我们从一些主要概念和术语入手，告诉你如何获取软件并使用比特币进行简单的交易。接下来的章节，我们会逐步讲解比特币背后的技术细节，分析比特币网络和比特币协议的内部运行机制。 比特币诞生之前的数字货币 切实可行的数字货币的出现是与密码学发展息息相关的。基本的挑战在于，当一个人考虑到用比特来代表可以兑换商品和服务的价值时，接受数字货币也就不足为奇。任何接受数字货币的人都面临的两个基本问题是： 我能相信这钱是真实可信的，而不是伪造的吗？ 我能确定没人说这笔钱是他们的，而不是我的吗？（又名“双重支付”问题） 纸币的发行机构不断的利用日益复杂的纸张和打印技术来遏制造假问题。实物货币很容易解决双重支付问题，因为同一张纸币不可能会同时出现在两个不同的地方。当然，传统货币也经常数字化储存和数字化传输。在这些情况下，假币和双重支付问题是被中央权威机构的处理方式是清除所有的电子交易记录，该中央权威在流通中持有一种全球通货观。对于数字货币来说，不能有效利用秘制油墨印刷技术或条形全息图，密码学为用户所主张的合法性价值提供了信任的基础。具体地来说，加密数字签名能够使一个用户签署一项能够提供其资产所有权证明的数字资产或数字交易。采用适当的结构，数字签名也可以用于解决双重支付的问题。 在20世纪80年代后期，当密码学开始越来越广泛地使用并被理解时，许多研究人员开始尝试使用密码学来建立数字通货。这些早期的数字通货项目发行的数字货币，通常倚靠一种国家通货或像黄金一样的贵金属。 虽然这些早期的数字通货成型了，他们却是中心化的，因此，他们很容易遭受到政府和黑客的攻击。早期的数字通货使用了一个中央结算所来处理所有的定期交易，就像一个传统的银行系统。不幸的是，在大多数情况下，这些新兴的数字货币成为了政府担忧的目标，最终从法律程序上消失了。另一些则是在发行这些数字货币的母公司突然违约时颓然失败了。为了坚定的抵制对手的介入，无论这些对手是合法的政府或是犯罪分子，去中心化的数字货币需要的是避免单节点攻击。比特币正是这样的系统，设计完全去中心化，不被任何中央政权或中央点控制，这样的货币系统是不会遭受攻击，也不会变得腐败。 比特币代表了数十年的密码学和分布式系统的巅峰之作，这是一个独特而强大的组合，汇集了四个关键的创新点。比特币由这些构成： 一个去中心化的点对点网络（比特币协议） 一个公共的交易账簿（区块链） 一个去中心化的数学的和确定性的货币发行（分布式挖矿） 一个去中心化的交易验证系统（交易脚本） 比特币发展史2008年，一位化名为中本聪的人，在一篇名为《比特币：一个点对点的电子现金系统》的论文中首先提出了比特币。中本聪结合以前的多个数字货币发明，如B-money和HashCash，创建了一个完全去中心化的电子现金系统，不依赖于通货保障或是结算交易验证保障的中央权威。关键的创新是利用分布式计算系统（称为“工作量证明”算法）每隔10分钟进行一次的全网“选拔”，能够使去中心化的网络同步交易记录。这个能优雅的解决双重支付问题，即一个单一的货币单位可以使用两次。此前，双重支付问题是数字货币的一个弱点，并通过一个中央结算机构清除所有交易来处理。 根据中本聪发表的一篇涉及比特币网络运行的论文，比特币网络自从被许多其他的程序员修订之后，于2009年启动。分布式计算，为比特币提供了成倍增长的安全性和韧性，现在超过了世界顶级超级电脑的联合处理能力。根据比特币兑美元汇率，比特币的总市场估值为50至100亿美元。目前从全网来看，比特币处理的最大交易额为1.5亿美元，这笔交易及时处理和转账，没有缴纳任何手续费。 中本聪在2011年4月退出公众视野，将比特币代码开发与网络建设的重任留给了欣欣向荣的社区成员。而“中本聪”究竟是谁，时至今日仍然是未解之谜。然而，比特币系统的运行，既不依赖于中本聪，也不依赖于其他任何人——比特币系统依赖于完全透明的数学原理。这项发明本身就是开创性的，它已经蔓延到了分布式计算、经济学、计量经济学领域。 一个分布式计算问题的解决方案 中本聪的此项发明，对“拜占庭将军”问题也是一个可行的解决方案，这是一个在分布式计算中未曾解决的问题。简单来说，这个问题包括了试图通过在一个不可靠、具有潜在威胁的网络中，通过信息交流来达成一个行动协议共识。中本聪的解决方案是使用工作量证明的概念在没有中央信任机构下达成共识，这代表了分布式计算的科学突破，并已经超越了货币广泛的适用性。它可以用来达成去中心化的网络共识来公正选举、彩票、资产登记，以及数字化公证等等。 比特币的应用、用户和他们的故事比特币是一项技术，但它所传递的货币从实质上来说，是一种人与人之间价值交换的基础语言。让我们通过他们的故事，来看看使用比特币的人和一些最常用的通货和协议。我们将会反复用到这些贯穿本书的故事，以此来说明现实生活中数字货币的用途，以及他们是如何通过比特币的各种技术使之成为可能的。 北美低价零售 Alice住在北加州的旧金山湾区。她已经从她的科技迷朋友口中得知了比特币，想要开始使用它。我们会跟进她的故事，来了解比特币，获取一些，并在帕洛阿尔托的Bob家咖啡店用比特币购买一杯咖啡。这个故事会从零售的消费者角度向我们介绍比特币软件，交易平台，以及基本的交易。 北美高价零售 Carol是一位旧金山艺术画廊的主人。她出售昂贵的油画来换取比特币。这个故事将介绍高额商品的零售商们所面临的“51％”攻击的风险。 离岸合同服务 Bob是帕洛阿尔托一家咖啡店的老板，正在建设一个新网站。他曾与一个住在印度班加罗尔的网站开发者Gopesh签订了协议。Gopesh已同意比特币支付。这个故事将研究使用比特币进行海外购、合约服务，以及国际电汇。 慈善捐赠 Eugenia是菲律宾一家儿童慈善机构的董事。最近，她发现了比特币，并希望利用它来和一个全新的国内外捐助群体接洽，以此为她的慈善募捐。她还研究如何使用比特币快速优化资金配置。这个故事将会演示用比特币来进行跨币种跨国界的全球融资，展示慈善组织所使用的公开透明账簿。 进口/出口 Mohammed是迪拜一位电子进口商。他试着用比特币来进行快捷支付，进口美国和中国的电子产品到阿联酋。这个故事将示范用比特币来支付大型企业间实物商品的国际收支。 比特币挖矿 Jing是上海一名计算机工程专业的学生。他建了一个用来挖比特币的矿机，使用他的专业技能来为自己创收。这个故事将审查基于比特币的“工业”：用于确保比特币网络安全和发行新货币的特殊设备。 这些故事都是根据真实行业内的真实人物原型来的，他们正在用比特币创造新市场，创造新产业，用比特币这个新兴事物来解决全球经济问题。 入门加入比特币网络并开始使用通货，所有用户需要做的就是下载应用程序或使用在线应用程序。因为比特币是一个标准，也有许多运行比特币的客户端软件。还有一个标准客户端，也称为中本聪客户端，这是由一个开发团队管理的一个开源项目，源自于中本聪编写的初始客户端。 比特币客户端的三种主要形式是： 完整客户端 一个完整客户端，或称“全节点”，是存储所有比特币交易的整个交易历史（由每一个用户完成的每一笔交易，曾经所有的每一笔）的客户端，管理用户的钱包，并可以在比特币网络上直接开始交易。这类似于一个独立的电子邮件服务器，因为它处理着协议的各个方面，而不依赖于任何其它的服务器或第三方服务。 轻量级客户端 一个轻量级客户端存储用户的钱包，但需要依赖第三方服务器才能进行比特币交易，才能接入比特币网络。轻量级客户端不保存所有交易的完整副本，因此必须信赖第三方的服务器来获取交易确认。这就类似于一个独立的电子邮件客户端，能够通过邮箱服务器来访问一个邮箱，因为它在网络交流中依赖于一个第三方服务器。 在线客户端 在线客户端通过网页浏览器在第三方服务器上访问和储存该用户的钱包。这类似于在线邮件，因为它完全依赖于第三方服务器。 移动客户端 智能手机的移动客户端，例如基于Android系统，既可以作完整客户端运行，也可作为轻量级客户端或在线客户端。一些移动客户端是与在线客户端或桌面客户端同步的，提供跨多个设备但有一个共同的资金源的多平台钱包。 比特币客户端的选择，取决于用户想要管理资金的数目。一个完整的客户端将为用户提供最高级的管理和独立性。这样钱包的备份和安全责任就转移到了用户身上。另一种选择是在线客户端，其设置和使用是最简单的，但在线客户端的取舍还在于需衡量第三方介入的风险，因为安全性和控制权是由用户和网页服务商所共同承担的。如果一个在线钱包服务遭受了损失，就像已发生过的那样，用户们可能会失去所有的资金。反过来看，如果用户的一个完整客户端没有进行适当的备份，他们可能会因为电脑的操作失误而丢失他们的资金。 这本书的目的在于，我们将演示各种可下载的比特币客户端的使用方法，从原版客户端（中本聪客户端）到在线钱包。一些案例将使用到原版客户端，除了作为一个完整的客户端以外，也会公开钱包的API，网络和交易服务。如果您计划进入比特币系统探索编程的话，将会需要原版客户端。 快速入门我们在“1.3 比特币的应用、用户和他们的故事 ”一节中介绍了Alice，她并不是技术性用户，最近才从一个朋友那听说了比特币。她通过浏览比特币官方网站bitcoin.org开始了自己的比特币之旅，在官网上，她发现了很多种可供选择的比特币客户端。她根据官网提供的建议，选择了轻量级的Multibit客户端。 Alice通过官网bitcoin.org上提供的链接，在她的电脑里下载安装了Multibit客户端。目前Multibit电脑客户端有WindowsWindows, Mac OS 和 Linux版本。 比特币钱包必须由一个密码或密令来保护。有许多试图破解弱密码的潜在威胁，所以要注意谨慎设置一个不会被轻易破解的密码。密码应使用大小写字母、数字和符号的组合，避免出现生日、球队名字等个人信息。避免使用任何能在字典里轻易找到的词语，不管这个词语是什么语言的。如果条件允许，可以利用密码生成器生成一个完全随机的12位以上的密码。请记住：比特币是一种随时能被转移到世界其他任何地方的货币。如果不加以妥善保管，会很容易被偷走。 Alice下载并安装了Multibit客户端后，打开程序就会出现一个欢迎界面，如图1-1所示： Multibit客户端会自动为Alice生成一个钱包和一个全新的比特币地址，点击图1-2所示的请求标签即可看到。 界面中最重要的是Alice的比特币地址。类似于电子邮件的地址，Alice可以分享这个地址，这样任何人都可以通过这个地址直接将比特币发送到的新钱包里。界面上看起来一长串的字母和数字就是地址：1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK 地址旁是一个二维码。这个二维码是可以被智能手机摄像头扫描到该钱包地址的条形码，即窗口右边黑白相间的方块。通过点击比特币地址或二维码旁边的复制按钮，Alice可以将它们分别复制到剪贴板。点击二维码可以将其放大，便于智能手机扫描。 Alice也可以打印出这个地址二维码给别人，这样就不用打一长串字母和数字了。 比特币地址以数字1或3开头。类似于电子邮件地址，这些地址可以分享给其他的比特币的用户，这样他们就可以直接通过这些地址发送比特币到你的钱包里。不同于电邮地址的是，你可以任意地创建新的比特币地址，这些地址都能成功地将资金转到你的钱包。钱包是多个地址和解锁资金密钥的简单集合。每笔交易你都可以使用不同的地址，这有利于提高隐私的安全性。用户可创建地址的数量几乎不受限制。现在Alice已经准备好开始使用她的新比特币钱包了。 获取你的第一枚比特币现在你还无法在银行或是外币兑换处买到比特币。截至2014年，在大多数国家，购买比特币还是相当困难的。你可以去一些专门的通货交易所，购买比特币或是出售比特币换取当地货币，交易所是以在线通货市场的方式来运营。包括以下几种： Bitstamp一个欧洲通货市场，通过电汇方式，支持包括欧元、美元在内的多币种交易。 Coinbase美国比特币钱包，也是买家和卖家进行比特币交易的一个平台。 Coinbase允许用户通过ACH系统来连接美国支票账户，这样易于购买和出售比特币。 这一类的数字加密货币交易所，在国家货币和加密货币夹缝中求生存。因此，会受各国法规和国际法规的制约，而且往往会具体到某单个国家或经济区，并只限于该地区的国家货币。你所选择的货币交易所，只限于你使用的本国货币，也只能是在你国范围内合法运营的交易所。类似于在银行开户，用此类服务来设置这些必要的账户需要花费数日或数周的时间，因为他们需要各种形式来了解你的客户，确认交易将符合反洗钱法。一旦你拥有了交易所的一个账户，你就可以像用代理账户购买出售外币一样的，更快捷地购买或出售比特币了。 bitcoin charts是提供价格索引的站点，一个包括数十家货币交易所其他市场数据的站点，在这里你可以找到更完整的数据。 新用户有以下四种方法来获取比特币： 找个有比特币的朋友，直接向他购买一些。很多比特币用户都是这样开始的。 利用localbitcoins.com这样的分类服务网站来寻找你所在地区的卖家，使用现金进行面对面的线下交易。 出售某种产品或服务来换取比特币。如果你是个程序员，可以出售你的编程技能。 使用你所在地区的比特币ATM机。利用CoinDesk里的 在线地图来找到你附近的比特币取款机。 Alice是经朋友介绍认识比特币的，所以在等待加州通货市场上的账号被验证和激活的同时，她轻而易举的就获取了她的第一枚比特币。 发送和接收比特币Alice已经创建好她的比特币钱包，准备接收资金了。她的钱包程序随机生成了一个私钥（关于私钥的详细介绍见“4.1.3 私钥“）和对应的比特币地址。这时，她的比特币地址还未在全网公布，也未在在任何比特币系统中“登记”。她的比特币地址只是一串数字，对应一个她可以掌控的资金私钥。在该地址和账户之间还没有任何交易产生，也没有任何关联。直到这个地址接收到在比特币账簿（区块链）中公布过的一笔交易时，才会成为众多可能“有效”的比特币地址之一。一旦该地址接受了一笔交易，就会变成全网所知的地址之一，Alice就可以在公开账簿中查询余额了。 Alice和Joe约在当地的一个饭店里会面，正是Joe把比特币介绍给了Alice的。这样Alice就可以用美金向Joe换取一些比特币，让Joe发送一些比特币到她的账户里。她带来了打印版的比特币地址和钱包二维码。从安全角度来说，比特币地址没什么特别机密的。她可以在任何地方公布自己的地址，而不用担心帐户安全。 Alice只想兑换10美元的比特币，免得在这项新技术上冒险花太多钱。所以她给了Joe 10美元和她地址的打印件，这样Joe就可以给她发送等值的比特币了。 接下来Joe需要弄清楚汇率，以便于发送给Alice相应数额的比特币。有很多应用和网站都会提供当前的市场汇率，下列是一些最流行的： Bitcoin ChartsBitcoin Chart 是一个市场数据服务网站，显示了全球众多交易所的比特币市场汇率，以当地不同的汇率来进行结算。 Bitcoin AverageBitcoin Average是一个提供每个币种的交易量加权平均价格的简单视图网站。 ZeroBlockZeroBlock是一个免费的安卓和iOS应用程序，可以显示不同交易所的比特币价格。（见图1-3） Bitcoin Wisdom另一个市场数据索引服务站。 Joe使用上述的程序或网站中的其中一个，查到比特币的价格约为每个比特币价值100美元左右。按照这个汇率，Alice给了他10美元，作为交换，他应当给Alice 0.1个比特币，即10,000,000聪。 Joe查到一个市场价后，打开自己的手机钱包应用，选择“发送”比特币 例如，如果是在苹果手机上使用Blockchain手机钱包，他会看见屏幕上要求输入： 对方的收款地址 需要发送的比特币数量 在比特币地址的输入栏，有一个看起来像二维码的小图标。Joe可以用他的智能手机摄像头扫描条形码，而不用再输入Alice的比特币地址(1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK)了，不用再打出这个又长又繁琐的地址。Joe轻击二维码图标，启动智能手机的摄像头，然后扫描Alice带来的二维码打印版。手机钱包程序会填好比特币地址，Joe可以通过比较这个地址和Alice打印的地址中的几个数字，来确认已正确地扫描。 接着Joe输入了交易的比特币金额，0.1比特币。他仔细检查，确保已经输入了正确的金额，因为他马上要发送这些钱了，任何一点点的小失误都会导致发送到错误的地址。最后，他按下了发送键来完成这笔交易。Joe的手机钱包会创建一笔交易，将Joe的钱包里的0.10比特币发送到Alice提供的地址，利用Joe的私钥来签名这笔交易。这就公告了比特币全网，Joe已经授权允许从他的一个地址转账比特币到Alice的新地址。由于交易是通过P2P网络协议传输，它会迅速在整个比特币网络传播。不到一秒钟，网络中大多数连接良好的节点都会收到该交易信息，并首次公布Alice的地址。 如果Alice手边有智能手机或笔记本电脑，她也能看到这笔交易。比特币账簿—一个不断膨胀的文件记录，记载了每一笔曾发生过的比特币交易—是公开的，意味着她可以查看所有曾经使用该地址的记录，可以查看是否有人朝这个账户发送了比特币。她只要在blockchain.info网站的搜索框中，输入她自己的地址，就可以轻而易举的知晓了。网页会显示出该地址所有的交易记录。Joe点击发送后，0.10比特币会很快转到她的钱包里，如果Alice正看这个页面，她就会发现网页更新了这笔新交易信息。 确认 起初，Alice的地址会显示Joe发出这笔的交易为“未确认”，这意味着这笔交易已经被广播到网络，但是尚未列入比特币交易记录账簿，即区块链中。总的来说，交易必须由一个矿工“开采”，交易是包括在区块中的。当新区块创建时，大约十分钟左右，该区域内的交易就会被全网接受为“已确认”，区块中的比特币也都能使用。交易可以立即被其他人看到，但只有当其被包含在新开采的区块中，才是“被信任的”。现在Alice可以自由支配她所有的0.10个比特币了，感觉很是自豪。 在下一章中，我们将看看她第一次使用比特币支付，并会更细致地了解交易和广播的相关技术。 总结本文简单介绍了比特币的历史，发展和如何使用，虽然有些内容已经有些老旧，但是为了尊重原创，还是进行了全文翻译。 声明本文95%为翻译组合,5%为原创，请各位支持原创，尽量看英文版。5LmL5YmN5YaZ55qE5paH56ug77yM5aW95aSa5L2c6ICF6YO955u05o6l5ou/6L+H5Y675Y+Y5oiQ5LuW5Lus55qE5Y6f5Yib5LqG77yM5Y+v5oG255qE55m+5bqm54u854uI5Li65aW477yM5L2/5Yqy6ZmN5L2O5oiR55qE5Z+f5ZCN55qE5p2D6YeN77yM5aSn5a626YO96L+Z5LmI6L6b6Ium77yM5oqE5bCx5oqE5ZGX77yM5aW95q255YaZ5Liq5rOo6YeK77yMd3d3LmVoY29vLmNvbSwg5L2c6ICFZWhjb28=（BASE64编码） 引用http://chimera.labs.oreilly.com/books/1234000001802/ch01.html]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Paper review】Decentralized Anonymous Payments from Bitcoin]]></title>
    <url>%2Fzerocash.html</url>
    <content type="text"><![CDATA[IntroductionThis is a representation in the Security Research Seminar 2017 in our school. In fact, it is a review of the paper “Zerocash: Decentralized Anonymous Payments from Bitcoin“. This paper was published in 2014 IEEE Symposium on Security and Privacy by Eli Ben-Sasson and Alessandro Chiesa, and the source is here . The slides Downloadyou can download the sides form here.]]></content>
      <categories>
        <category>Paper review</category>
      </categories>
      <tags>
        <tag>Bitcoin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Paper review】Using Frankencerts for Automated Adversarial Testing of Certificate Validation in SSL/TLS Implementations]]></title>
    <url>%2FUsing%20Frankencerts%20for%20Automated%20Adversarial%20Testing.html</url>
    <content type="text"><![CDATA[IntroductionThis is a review for the paper of “Using Frankencerts for Automated Adversarial Testing of Certificate Validation in SSL/TLS Implementations“. The source is here SummaryNowadays, varieties of network devices are depended on SSL/TLS when they communicate with each other. Furthermore, certificates validation play a key role in SSL/TLS handshake protocol. So far, there is no good approach to check the certificate validation logic on a large scale. In this paper, the authors designed and implemented an automated testing tool named “frankencerts”, Frankencerts acts as an intermediate certificate and it is generated from the real certificates. Several popular SSL/TLS libraries and web browsers are used for checking the frankencerts in discovering security flaws. The results show that adversarial testing with the frankencerts is a power methodology. Paper strengthsThe paper is well written and presents the concept and principle of SSL/STL. The most significant contribution is that they proposed an automated approach for validating certificate logic in SSL/TLS implementations. They tested over 8,127,600 frankencerts, which nearly cover all the possible combinations and give a well classified and analyzed result. Paper weaknessesWhen it comes to weaknesses, it mainly reflects on the bellow parts: Firstly, the authors come up with a methodology for certificate validation in security flaws finding in SSL/TLS implementations. However, validation is only one part of the SSL/TLS handshake. Bugs may spring up in other progress of the handshake. Even the test results show one specific certificate implementation is secure, which can’t guarantee it work well in reality. Then, in section VIII, they tested 8,127,600 frankencerts on their self-implemented clients, but the browsers are not included. (at least they didn’t mention) which is not specific and accurate. Moreover, it cost about 1 second each execution of browser script, which is too inefficient for the browser testing. Detailed technical commentsP7. I have no idea about the tools of “ZMap”, they just used it directly without explaining anything.P8. I don’t know the difference between the section “Generating frankencerts” and “Generating synthetic mutations”, It looks like they are the same meaning with the different expression.P9. Why they use 3 different frankencert-generating machines? What is the standard for selecting machines?P9. “we used the documentation provided by the libraries and followed the sample code in the documentation as closely as possible”, So what is the code and documentation they mentioned?P10. As they said, it cost approximately 1 second for each execution of a script in the browser and they tested 8,127,600 frankencerts on the client, but they never mentioned they tested on the browser, what is the meaning of listing the verify running time in the browser.P15. I can’t understand the meaning of higher-level software and lower-level software in the section of “conclusions”.]]></content>
      <categories>
        <category>Paper review</category>
      </categories>
      <tags>
        <tag>SSL/TLS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Technical debt】Exploring technical debt of database architecture evolution]]></title>
    <url>%2FExploring%20technical%20debt%20of%20database.html</url>
    <content type="text"><![CDATA[IntroductionThis is one of reports which I did in last term. It mainly focus on the technical debt in database evolution.In this paper, I draw on a case study to analyse the link between technical debts in distributed database architectures and representative architecture evolution decisions. I use alibaba’s for this purpose. Downloadyou can download from here]]></content>
      <categories>
        <category>technical debt</category>
      </categories>
      <tags>
        <tag>technical debt</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Docker】Spring Boot Docker MySQL Demo]]></title>
    <url>%2FspringBootDockerMySQLDemo.html</url>
    <content type="text"><![CDATA[IntroductionSince this is the first time for me to use spring-boot project running in the docker with MySQL database, I use a lot of Yuan Ji’s work for reference， you can also read his web page directly.In the learning of this project, I have met with many difficulties. To help others have a better understanding of spring-mysql running on the docker. I decide to write it down and you can find the demo project at GitHub. These steps are as follows1.Clone the project:12git clone https://github.com/rjgeek/spring-boot-mysql-docker.gitcd spring-boot-docker-mysql 2.Run MySQL in Docker container:1docker run --name demo-mysql -e MYSQL_ROOT_PASSWORD=password -e MYSQL_DATABASE=demo -e MYSQL_USER=demo_user -e MYSQL_PASSWORD=demo_pass -d mysql:5.6 -name demo-mysql to assign a name to the container. -e to pass environment variables to the container, and create a demo database with a user demo-user and password. This user will be granted superuser permissions for the demo database. -p 3306:3306 to expose MySQL port to the local host. -d to tell Docker to daemonize the container and keep it running.mysql:5.6 to download MySQL 5.6 Server image from Docker public repo if not in your computer yet. 3.Check the log to make sure MySQL is running OK1docker logs demo-mysql And you can access the server by localhost:3307/demo,the database instance is “demo”, the user is “demo_user” and the password is “demo_pass”. 4.Maven package and demo application docker build:12cd spring-boot-docker-mysqlmvn clean package docker:build 5. Run demo application MySQL in Docker container and link to demo-mysql:1docker run -p 8080:8080 --name demo-app --link demo-mysql:mysql -d ehcoo/spring-boot-docker-mysql 6. Check the log to make sure Server is running OK1docker logs demo-app 7. Test the whole projectOpen http://127.0.0.1:8080 in browser and you should see the messageOpen http://127.0.0.1:8080/hotels/1 in browser and you should see the message This is the end!]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【区块链】从0开始搭建基于以太坊的区块链开发环境]]></title>
    <url>%2Fether1.html</url>
    <content type="text"><![CDATA[引言Ethereum（以太坊）是一个使开发人员能够建立和发布下一代分布式应用的公共区块链平台。 通过其专用加密货币以太币（Ether）提供去中心化的虚拟机（称为“以太虚拟机”Ethereum Virtual Machine）来处理点对点合约。 本文从0开始搭建了以太坊的开发环境，犹如当年初学其他语言一样，这是我们的第一个hellowork程序，在完成搭建后又进行了账户创建、挖矿、转账等测试。 环境搭建本次的以太坊环境是用go语言开发，虚拟机内部运行的是javascript. 可能有人不太理解，举个例子，java虚拟机本身就是用c开发的(windows平台上)，但是运行在虚拟机之上运行的是java语言。 环境准备一台能联网的Ubuntu64位机器(已经安装git)，如果是其他机器类型，请参考其他安装教程，点我 开始安装两种安装方式，任意选择一种(建议使用第一种)： 第一种使用 Personal Package Archives 直接安装，命令如下： 1234sudo apt-get install software-properties-commonsudo add-apt-repository -y ppa:ethereum/ethereumsudo apt-get updatesudo apt-get install ethereum 第二种安装方式，使用源码安装，自己用go语言进行编译，命令如下： 1.下载源码1git clone https://github.com/ethereum/go-ethereum 2.安装go的运行环境，参考本文3.绑定运行环境到go1sudo apt-get install -y build-essential golang 4.进入到源码目录中，开始编译源码12cd go-ethereummake geth 5.运行1build/bin/geth 初步探索进入虚拟机并输出日志1get --dev console 2&gt;&gt; geth-log 主界面： 日志界面： 全局变量其中有一些是全局变量，你可以认为是javascript的全局变量，全局变量拥有自己的方法和函数。如下eth变量： 如下的的personal变量： 下面对用户操作，对矿机的操作，转账操作，挖矿操作，实际都在运用这些全局变量中的参数，然后穿上适当的方法。 账户操作1.创建新账户1personal.newAccount(&apos;123456&apos;) 创建成功后，会展示创建成功的地址，其中上面的表达式中，中间传入的123456为密码 2.查看一下系统有的用户1eth.accounts 因为我之前有个用户，所以在有两个用户 3.为用户取一个别名，很显然如果操作上面的字符串地址是很不方面的，所以下面对字符串用户进行取别名，因为是js语言，所以可以直接使用，如下：12user1 = eth.accounts[0]user2 = eth.accounts[1] 如果你在查看user1.则如下，已经成功赋值 4.对账户进行解锁，为了安全起见，一般一个用户在创建的时候都是出于锁定的状态，有日志状态可以看到，如下 对账户进行解锁的命令1personal.unlockAccount(user2,&apos;123456&apos;) 开始挖矿挖矿的过程，主要是对miner这个全局变量进行操作 开始之前我们检查一下账户user1和user2的金额，你会发现两者的金额都为0 12eth.getBalcance(user1)eth.getBalcance(user2) 开始挖矿,命令如下：1miner.start() 停止挖矿命令：1miner.stop() 开始挖矿后台输出挖矿日志： 运行一会后你去查看用户的账户金额 发现第一个账户中已经含有金额。也就是说默认是挖到了第一个账户中。 转账测试现在我们模拟从第一个账户像第二个账户转账的命令1eth.sendTransaction(&#123;from:user1,to:user2,value:8&#125;) 需要说明的是转账后，账户2并没有立即收到钱，而在是挖矿之后才收到的，主要原因是当前的交易还没有并入到区块链中，我们从日志中可以获取相关信息 像地址0x0b52…写的的交易0xab24..,在区块8中才写入，我们可以查看区块8进行验证 总结本文快速搭建了一个以太坊的环境，并进一步探索了账户操作，转账，挖矿等操作，其中主要参考了汪晓明老师的教程。 声明本文20%为翻译组合,80%为原创 引用https://github.com/ethereum/go-ethereum/wiki/Installation-Instructions-for-Ubuntuhttp://ethcast.com/v1http://www.8btc.com/ethereumhttps://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E5%9D%8A]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>以太坊,区块链,ethereum</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】30行代码实现一个微信自动回复的机器人]]></title>
    <url>%2FaotoWechat.html</url>
    <content type="text"><![CDATA[引言本文使用了28行代码实现了一个会自动聊天的机器人.其中主要的类库是基于ichart,API接口基于api.qingyunke 环境配置安装python与pip环境因为读者的系统环境不同，在这里关于如何安装python环境与配置python pip环境请读者自行google，如果你当前的系统是windows,可以参考这里，点我 安装相关模块12345678$ pip install itchat$ pip install requests$ pip install time$ pip install re$ pip install sys$ pip install urllib2$ pip install urllib$ pip install json 系统运行创建python文件，代码如下12345678910111213141516171819202122232425262728#!/usr/bin/env python# -- coding: utf-8 --import itchat, time, re, sys, urllib2, jsonfrom urllib import quote,unquote,urlencodefrom itchat.content import *@itchat.msg_register([TEXT])def text_reply(msg): m = quote(msg[&apos;Text&apos;].encode(&apos;utf8&apos;)) url = &apos;http://api.qingyunke.com/api.php?key=free&amp;appid=0&amp;msg=&apos;+m print url raw = urllib2.urlopen(url) try: data = json.loads(raw.read().decode(&apos;utf-8&apos;)) #print data[&apos;response&apos;] print data[&apos;content&apos;] itchat.send((data[&apos;content&apos;]), msg[&apos;FromUserName&apos;]) except: pass @itchat.msg_register([PICTURE, RECORDING, VIDEO, SHARING])def pic_reply(msg): itchat.send((unicode(&apos;图片不错&apos;,&apos;gb2312&apos;)),msg[&apos;FromUserName&apos;]) #itchat.send(&apos;@img@1.jpg&apos;, msg[&apos;FromUserName&apos;])if __name__ == &apos;__main__&apos;: default_encoding = &apos;utf-8&apos; index = 0 if sys.getdefaultencoding() != default_encoding: itchat.auto_login(enableCmdQR=False,hotReload=True) itchat.run() 运行模块1python auto-reply-wechat.py 扫码登录 后台运行界面 前台展示效果 总结本文使用了28行代码实现了一个会自动聊天的机器人.源码地址：点我,最后感谢IVAN的友情支持。 声明本文0%为翻译组合,100%为原创 引用无]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【HTTPS】什么是SSL，HTTPS是如何工作的？]]></title>
    <url>%2FhttpsWork.html</url>
    <content type="text"><![CDATA[引言我们大多数人每天都使用加密通信，你可能不知道，甚至从没关心过它。如你用百度搜索东西，你在阿里巴巴上买了一件喜欢的衬衫，HTTPS能防止你的数据在网络传输过程中不被其他人窃取。 在本博客中，我们将介绍我们加密通信背后的知识，主要内容包括：为什么我们需要升级HTTP到HTTPS，HTTP的问题在哪里？TSL和SSL探讨，HTTPS是什么？HTTPS是如何工作的？从黑客的角度如何攻击HTTPS等。 在阅读本文之前，作者默认了你已经对称加密，非对称加密，摘要算法已经有所了解，如果实在没有基础也没关系，可以先读读这两篇预热下《【密码学】一万字带您走进密码学的世界（上）》,《【密码学】一万字带您走进密码学的世界（下）》 HTTP的问题在哪里？如果你访问一个网站默认了超文本传输协议（HTTP），其内容将明文传输。这意味着每个人在你和服务器之间的位置都可以看到你与网站的每个交互内容。当用HTTP传输私人信息（姓名，电子邮件，家庭住址，信用卡详细信息等），黑客可以轻易的从网络流量中截取你发送信息，因为这些都是明文传输，下图使用fiddle2模拟的截取信息。 这种攻击方式就叫中间人攻击，当然因为这个衍生出来的还有缓存投毒，DDOS定向流向转发等，这些不是本文重点，这个中间人存在你的客户端和服务端的每个部分，例如，如果您连接到Wi-Fi热点，则您和服务器之间通过HTTP传输的所有内容将对热点中的每个参与者都可见。（是不是非常可怕，这也是不要轻易连接免费Wi-Fi的原因！！！） 用专业的术语总结一下HTTP的问题：（1） 窃听风险（eavesdropping）：第三方可以获知通信内容。（2） 篡改风险（tampering）：第三方可以修改通信内容。（3） 冒充风险（pretending）：第三方可以冒充他人身份参与通信。技术进步的一个源动力是解决问题，这个时候一种加密技术应运而生那就是SSL。 SSL探讨SSL，英文全称Secure Sockets Layer，为Netscape所研发，用以保障在Internet上数据传输的安全，利用数据加密(Encryption)的技术，可确保数据在网络上的传输过程中不会被截取及窃听。SSL协议位于TCP/IP协议与各种应用层协议之间，为数据通讯提供安全支持。下面我深入探讨下SSL写到这里我毅然燃起了我对网景公司的情怀，其实网景公司不只发明了SSL，还发明了很多 Web 的基础设施——比如“CSS 样式表”和“JS 脚本” TSL和SSL的区别我们来看看SSL的发明历史，你就明白区别啦 1994年，NetScape公司设计了SSL协议（Secure Sockets Layer）的1.0版，但是未发布。 1995年，NetScape公司发布SSL 2.0版，很快发现有严重漏洞。 1996年，SSL 3.0版问世，得到大规模应用。 1999年，互联网标准化组织ISOC接替NetScape公司，发布了SSL的升级版TLS 1.0版。 2006年和2008年，TLS进行了两次升级，分别为TLS 1.1版和TLS 1.2版。最新的变动是2011年TLS 1.2的修订版。 很明显TLS就是SSL的升级版，那么它都升级哪些东西 1 版本号：TLS记录格式与SSL记录格式相同，但版本号的值不同，TLS的版本1.0使用的版本号为SSLv3.1。 2 报文鉴别码：SSLv3.0和TLS的MAC算法及MAC计算的范围不同。TLS使用了RFC-2104定义的HMAC算法。SSLv3.0使用了相似的算法，两者差别在于SSLv3.0中，填充字节与密钥之间采用的是连接运算，而HMAC算法采用的是异或运算。但是两者的安全程度是相同的。 3 伪随机函数：TLS使用了称为PRF的伪随机函数来将密钥扩展成数据块，是更安全的方式。 4 报警代码：TLS支持几乎所有的SSLv3.0报警代码，而且TLS还补充定义了很多报警代码，如解密失败（decryption_failed）、记录溢出（record_overflow）、未知CA（unknown_ca）、拒绝访问（access_denied）等。 5 密文族和客户证书：SSLv3.0和TLS存在少量差别，即TLS不支持Fortezza密钥交换、加密算法和客户证书。 6 certificate_verify和finished消息：SSLv3.0和TLS在用certificate_verify和finished消息计算MD5和SHA-1散列码时，计算的输入有少许差别，但安全性相当。 7 加密计算：TLS与SSLv3.0在计算主密值（master secret）时采用的方式不同。 8 填充：用户数据加密之前需要增加的填充字节。在SSL中，填充后的数据长度要达到密文块长度的最小整数倍。而在TLS中，填充后的数据长度可以是密文块长度的任意整数倍（但填充的最大长度为255字节），这种方式可以防止基于对报文长度进行分析的攻击。 总而言之一句话：TLS比SSL更加标准化，更加安全 HTTPS探讨HTTPS 相当于是“HTTP over SSL”。举个简单的例子， SSL就像你家自来水管道外面的一个防护膜。 HTTPS是如何工作的注意因为篇幅原因，此处所探讨的只是HTTPS单向鉴别的实现。比方说，你要连接到taobao.com。您在浏览器中键入地址，按回车并在毫秒内转到请求的网站。看起来很简单，对吧？但是实际上后台经过的数次的转发，我们在这里只讨论HTTPS建立单向连接的那部分。具体的步骤如下： 1.你的浏览器请服务器发送建立连接消息，消息中包含加密算法，是使用的协议等。 2.服务器对你的浏览器回应一个消息，消息中包含证书信息，然后你可以对证书的真伪进行验证。 3.验证通过之后，如果一切都按预期（即服务器已经成功验证），浏览器开始发送交换（和同意）应该用于此会话的随机密钥。 4.服务器接收到到随机秘钥，然后开始进行数据交换。最终网页的内容安全地传输并显示在您的浏览器中。 可能你对上面的步骤依然存在疑惑，下面我们一起去解开它。首先证书是啥？其次证书如何校验真伪，在步骤3中，客户端像服务端发送的信息如何加密的？ 电子证书是什么假设你要和张三做生意，然后这个时候你不信任张三怎么办，你敢不敢贸然把货款打给他，答案肯定是否定的，这个找个信得过的中间人，有中间人开一份文件，有中间人李四的名义担保张三的人品信誉没问题，这个时候开的这个文件就叫证书（digital certificate）。在上面的比喻中，你就是浏览器，张三就是服务器，中间人李四就是认证中心CA（Certificate Authority），上面说了CA必须是“信得过的，德高望重的”，并不是每家机构都够资格颁发证书的。国内目前有34家CA搜索，下面列举几个 中国电信认证中心（CTCA） 海关认证中心（SCCA） 国家外贸部EDI中心建立的国富安CA安全认证中心 广东电子商务认证中心（以后称广东CA）为首的“网证通”认证体系 SHECA（上海CA）为首的UCA协卡认证体系。 如果你是服务商，首先你要像认证中心申请，然后认证中心给你颁发（当然了是收费的，而且还有期限），一旦颁发成功，你的浏览器展示就是这样的一些没有经过证书的网站，或者需要自己预装证书的网站 如何查看自己电脑上的证书？1.windows 系统按 Win + R 键打开运行命令窗口，直接输入 certmgr.msc，就可以看到了，如下图所示：2.也可以从浏览器中查看：工具-&gt;Internet选项-&gt;内容-&gt;证书电子证书有哪些部分组成? 主体部分包括： 版本号：指出该证书使用了哪种版本的X.509标准（版本1、版本2或是版本3），版本号会影响证书中的一些特定信息，目前的版本为3 序列号： 标识证书的唯一整数，由证书颁发者分配的本证书的唯一标识符 签名算法标识符： 用于签证书的算法标识，由对象标识符加上相关的参数组成，用于说明本证书所用的数字签名算法。例如，SHA-1和RSA的对象标识符就用来说明该数字签名是利用RSA对SHA-1杂凑加密 认证机构的数字签名：这是使用发布者私钥生成的签名，以确保这个证书在发放之后没有被撰改过 认证机构： 证书颁发者的可识别名（DN），是签发该证书的实体唯一的CA的X.500名字。使用该证书意味着信任签发证书的实体。(注意：在某些情况下，比如根或顶级CA证书，发布者自己签发证书) 有效期限： 证书起始日期和时间以及终止日期和时间；指明证书在这两个时间内有效 主题信息：证书持有人唯一的标识符(或称DN-distinguished name)这个名字在 Internet上应该是唯一的 公钥信息： 包括证书持有人的公钥、算法(指明密钥属于哪种密码系统)的标识符和其他相关的密钥参数 颁发者唯一标识符：标识符—证书颁发者的唯一标识符，仅在版本2和版本3中有要求，属于可选项 扩展部分包括： 发行者密钥标识符：证书所含密钥的唯一标识符，用来区分同一证书拥有者的多对密钥。 密钥使用：一个比特串，指明（限定）证书的公钥可以完成的功能或服务，如：证书签名、数据加密等。如果某一证书将 KeyUsage 扩展标记为“极重要”，而且设置为“keyCertSign”，则在 SSL 通信期间该证书出现时将被拒绝，因为该证书扩展表示相关私钥应只用于签写证书，而不应该用于 SSL。 CRL分布点：指明CRL的分布地点 私钥的使用期：指明证书中与公钥相联系的私钥的使用期限，它也有Not Before和Not After组成。若此项不存在时，公私钥的使用期是一样的。 证书策略：由对象标识符和限定符组成，这些对象标识符说明证书的颁发和使用策略有关。 策略映射：表明两个CA域之间的一个或多个策略对象标识符的等价关系，仅在CA证书里存在 主体别名：指出证书拥有者的别名，如电子邮件地址、IP地址等，别名是和DN绑定在一起的。 颁发者别名：指出证书颁发者的别名，如电子邮件地址、IP地址等，但颁发者的DN必须出现在证书的颁发者字段。 主体目录属性：指出证书拥有者的一系列属性。可以使用这一项来传递访问控制信息。 例如我伯大的证书：证书的信任链最后的补充说明1.浏览器对服务器的认证取决于两点：1，浏览器对中间人CA的信任（信任传递），2，服务器自身采用公私钥加密协议并对外公布公钥。2.为什么建立连接之后开始使用随机对称秘钥加密？因为对称秘钥快！3.为什么HTTPS的普及率不够高？1.因为HTTPS相比HTTP慢！2.因为CA的证书收费！ 总结本文主要阐述了HTTPS的工作原理，介绍了证书的相关概念，在后续的文章中，我会以实际的项目环境配置（如nginx如何配置HTTPS,Tomcat如何配置HTTPS等）来进行分析。 声明本文35%为翻译组合,65%为原创 引用https://www.emerchantpay.com/blog/articles/what-is-https-and-why-should-i-use-encryptionhttp://www.baike.com/wiki/SSLhttp://www.ruanyifeng.com/blog/2014/02/ssl_tls.htmlhttp://blog.csdn.net/adrian169/article/details/9164385]]></content>
      <categories>
        <category>网络知识</category>
      </categories>
      <tags>
        <tag>HTTPS,TSL,SSL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【区块链】区块链中的 Merkle Tree 的java实现.]]></title>
    <url>%2FMerkleTree.html</url>
    <content type="text"><![CDATA[引言这篇文章介绍了MerkleTree，MerkleTree被广泛的应用在比特币技术中，本文旨在通过代码实现一个简单的MerkleTree，并计算出Merkle tree的 TreeRoot Merkle Tree简介Merkle Tree 是一种数据结构，用于验证在计算机之间和之间存储，处理和传输的任何类型的数据。 目前，Merkle树的主要用途是确保从对等网络中接收的数据块未受损和未改变，和检查其他对等网络没有撒谎发送假数据块。 Merkle tree 应用例子 比特币 Git Amazon’s Dynamo Gassandra 环境 windows 7 oracle jdk 1.8.2 Eclipse Java EE IDE for Web Developers. Version: Neon.1a Release (4.6.1) 比特币中的应用比特币中每个块中都包含了所有交易的集合签名，这个签名就是用Merkle tree实现的 Merkle树用于比特币以汇总块中的所有事务，产生整个事务集合的整体数字指纹，提供非常有效的过程来验证事务是否包括在块中。 Merkle树一个很重要的用处是检查块中是否包含指定的交易，Merkle树是通过递归哈希节点对来构造的，直到只有一个哈希 Merkle tree 算法和实现这个哈希树的跟节点称为Merkle根，Merkle树可以仅用log2(N)的时间复杂度检查任何一个数据元素是否包含在树中， 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104package test;import java.security.MessageDigest;import java.util.ArrayList;import java.util.List;public class MerkleTrees &#123; // transaction List List&lt;String&gt; txList; // Merkle Root String root; /** * constructor * @param txList transaction List 交易List */ public MerkleTrees(List&lt;String&gt; txList) &#123; this.txList = txList; root = &quot;&quot;; &#125; /** * execute merkle_tree and set root. */ public void merkle_tree() &#123; List&lt;String&gt; tempTxList = new ArrayList&lt;String&gt;(); for (int i = 0; i &lt; this.txList.size(); i++) &#123; tempTxList.add(this.txList.get(i)); &#125; List&lt;String&gt; newTxList = getNewTxList(tempTxList); while (newTxList.size() != 1) &#123; newTxList = getNewTxList(newTxList); &#125; this.root = newTxList.get(0); &#125; /** * return Node Hash List. * @param tempTxList * @return */ private List&lt;String&gt; getNewTxList(List&lt;String&gt; tempTxList) &#123; List&lt;String&gt; newTxList = new ArrayList&lt;String&gt;(); int index = 0; while (index &lt; tempTxList.size()) &#123; // left String left = tempTxList.get(index); index++; // right String right = &quot;&quot;; if (index != tempTxList.size()) &#123; right = tempTxList.get(index); &#125; // sha2 hex value String sha2HexValue = getSHA2HexValue(left + right); newTxList.add(sha2HexValue); index++; &#125; return newTxList; &#125; /** * Return hex string * @param str * @return */ public String getSHA2HexValue(String str) &#123; byte[] cipher_byte; try&#123; MessageDigest md = MessageDigest.getInstance(&quot;SHA-256&quot;); md.update(str.getBytes()); cipher_byte = md.digest(); StringBuilder sb = new StringBuilder(2 * cipher_byte.length); for(byte b: cipher_byte) &#123; sb.append(String.format(&quot;%02x&quot;, b&amp;0xff) ); &#125; return sb.toString(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return &quot;&quot;; &#125; /** * Get Root * @return */ public String getRoot() &#123; return this.root; &#125; &#125; 数据准备我们将交易的数据，放入到List中123456List&lt;String&gt; tempTxList = new ArrayList&lt;String&gt;();tempTxList.add(&quot;a&quot;);tempTxList.add(&quot;b&quot;);tempTxList.add(&quot;c&quot;);tempTxList.add(&quot;d&quot;);tempTxList.add(&quot;e&quot;); 实现过程 准备交易数据 计算出每个数据的hash值，从左到右逐步组成树的左右节点 执行循环知道最后只剩下一个数据 核心代码123456789101112131415161718192021private List&lt;String&gt; getNewTxList(List&lt;String&gt; tempTxList) &#123; List&lt;String&gt; newTxList = new ArrayList&lt;String&gt;(); int index = 0; while (index &lt; tempTxList.size()) &#123; // left String left = tempTxList.get(index); index++; // right String right = &quot;&quot;; if (index != tempTxList.size()) &#123; right = tempTxList.get(index); &#125; // sha2 hex value String sha2HexValue = getSHA2HexValue(left + right); newTxList.add(sha2HexValue); index++; &#125; 测试代码1234567891011121314151617package test;import java.util.ArrayList;import java.util.List;public class App &#123; public static void main(String [] args) &#123; List&lt;String&gt; tempTxList = new ArrayList&lt;String&gt;(); tempTxList.add(&quot;a&quot;); tempTxList.add(&quot;b&quot;); tempTxList.add(&quot;c&quot;); tempTxList.add(&quot;d&quot;); tempTxList.add(&quot;e&quot;); MerkleTrees merkleTrees = new MerkleTrees(tempTxList); merkleTrees.merkle_tree(); System.out.println(&quot;root : &quot; + merkleTrees.getRoot()); &#125; &#125; 执行结果 总结本文从简单二叉树的形式实现了简单的MerkleTree，并且计算出了TreeRoot，但是实际上的的MerkleTree不拘谨与二叉树还可能是多叉树。MerkleTree应用广泛，尤其在各类校验中，下一部分我们将着重探讨MerkleTree和传统的HashList校验的差别。 声明本文90%为翻译组合,10%为原创 引用http://java-lang-programming.com/en/articles/29]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【算法整理】听说你写的算法很牛？-优质算法衡量标准探讨]]></title>
    <url>%2Fcomplexity.html</url>
    <content type="text"><![CDATA[引文我有个朋友有算法强迫症，每次一看到别人写的算法，就有上去改的冲动，不然就会偏头疼，主要症结在于他认为别人写的算法不好，但是什么的算法可以评判为好，什么样的算法可以评判为不好？最近为了治愈他，我特地写了这篇文章。 算法的衡量从两个方向出发：时间复杂度和空间复杂度。本文主要是不讲具体算法，只将算法的衡量，重点讲解如何衡量算法的复杂度，解决平时见到的XX算法时间复杂是$O(\log^n)$,其中这个结果是怎么推导出来的？$\log^n$是个什么玩意儿？，大写的$O$是什么意思？为什么用这个符号表示等类似问题。 在开始讲解复杂度之前我们先因为一个数学概念Big O notation Big O notationBig O notation是一种描述述函数渐进行为的理论，又被称作Landau’s symbol，其实这部分是高数中的概念。用于表述一个函数增长的多快或者减少的多快。（重点描述加速度），在计算机领域，Big O notation常常用来表达算法时间复杂度和性能的术语，一个算法在执行过程中需要的最大时间或者最大空间。 那么为什么要用O来表示呢？大O符号是由德国数论学家保罗·巴赫曼（Paul Bachmann）在其1892年的著作《解析数论》（Analytische Zahlentheorie）首先引入的。而这个记号则是在另一位德国数论学家艾德蒙·朗道（Edmund Landau）的著作中才推广的，因此它有时又称为朗道符号（Landau symbol）。代表“order of …”（……阶）的大O，最初是一个大写的希腊字母’Θ’（Omicron），现今用的是英文大写字母’O’，但从来不是阿拉伯数字’0’。 学术定义（定义这个东西我觉得还是原汁原味的好，犹豫了很久还是决定保留原版） If we write f(n) = O(g(n)), then there exists a function f(n) such that ∀ n ≥ n0, f(n) ≤ cg (n) with any constant c and a positive integer n0. Or f(n) = O(g(n)) means we can say g(n) is an asymptotic upper bound for f(n). 特性： If f1(n) is O(g1(n)) and f2(n) is O(g2(n)), then f1(n) + f2(n) is O(max(g1(n), g2(n)))Transitive Property: If f(n) = O(g(n)) and g(n) is O(h(n)), then f(n) = O(h(n)). 解决一个规模为 n 的问题所花费的时间（或者所需步骤的数目）可以被求得：$$T(n) = 4n^2 + 2n + 2$$当 n 增大到非常大时，$n^2$; 项将开始占主导地位，而其他各项可以被忽略(可以参见上面的特性)，所以我们可以将$T(n)$的渐进函数记$O(n^2)$,至于上面的公式$T(n)$是怎么推导推导出来的,我在下面的篇幅中会细讲。 所有这些函数都处于 N 趋近于无穷大的情况下，增长得慢的函数列在上面。 c 是一个任意常数。 符号 描述 $O(1)$ 常数，表示无论输入是什么，所需要的执行时间（空间都不变）。 $O(N)$ 线性，表示随着输入的增加，所需的执行时间（空间）也线程增加。 $O(N^2)$ 平方，表示输入的增加，所需要是执行时间（空间）按照平方比例增加。 $O(log^*N)$ 即表示迭代对数，是目前增长最慢的函数 $O(logN)$ 对数 $O(N*logN)$ 是线性函数及对数函数相乘的结果 $O(N^c),Integer(c&gt;1)$ 多项式，有时叫作“代数”（阶） $O(c^N)$ 指数，有时叫作“几何”（阶） $O(N!)$ 阶乘，有时叫做“组合”（阶） 算法的期望与可解性在开始正式的引入的算法的复杂度之前，我们来聊聊算法的期望与可解性，我们还是从例子还是讲起 期望如果我们有一个电话本，这个电话本假设是无序的，电话本中有1000个人的电话，加入我们想找到 “张三”的电话，那么 最好情况(Best Case)：O(1) 期望情况(Expected Case)：O(n)（对应500） 最坏情况(Worst Case)：O(n)（对应1000） 最好的情况就是第一个就是“张三“，非常幸运，最差劲的情况，我们找到第1000个才找到，期望的情况就是在中间找到。衡量一个算法往往都是在探讨期望的情况和最快的情况，因为最好的情况意义不大。 可解性我们依然从一个例子开始讲起：一个商品推销员要去若干个城市推销商品，该推销员从一个城市出发，需要经过所有城市后，回到出发地。应如何选择行进路线，以使总的行程最短（这就是经典的旅行商的问题） 假设有3个城市A、B、C，那就有6中可能（其中3个重复的），即：A-&gt;B-&gt;C;C-&gt;B-&gt;A; A-&gt;C-&gt;B;B-&gt;C-&gt;A;B-&gt;A-&gt;C;C-&gt;A-&gt;B;实际就是一个阶乘的问题$N!$,如果有5个城市，那么会增加到60中可能，如果增加到10000个城市，这个用一般的电脑已经算不出结果了虽然你可以写出算法，但是在你的有生之年可能看不到结果了。 那么为什么要谈这块内容呢？,因为有些算法之所以安全就是建立在可解性的基础上的。公钥加密是个极好例子。至于公钥是什么，可以参考我之前的文章《【密码学】一万字带您走进密码学的世界（下）》,自然界中找到一个很大的数的两个素因子是困难的，如果不困难，公钥系统将彻底不安全，建立在公钥的上的应用HTTPS,SSH,BITCOIN等将一块玩完。 时间复杂度每个算法需要一定量的计算机时间来执行其指令和任务。所需的计算机时间称为时间复杂度。算法的时间复杂度可以定义如下。算法的时间复杂度是算法完成其执行所需的总时间量语句的执行时间=语句的执行次数(即频度(Frequency Count))×语句执行一次所需时间。语句执行一次所需时间有多重因素决定，如：1.算法是运行性单处理器机器上还是在多处理器机器上2.运行的机器是32位还是64位3.运行机器的读写速度4.输出数据量的大小由此可见，语句执行的时间我们很难真实的估计，因为我们在对比算法的好坏，我们假设是运行在一样的环境中的，实际我们要比较的就是，语句的执行次数，我们从上面的分析可以得到一个结论： 求算法是时间复杂度可类比为求指特性环境下算法的算法的执行次数 如何计算现在我们开始回答第二个问题，如何求解算法的时间复杂度？我们依然从例子开始说起， 例子1首先讲的是简单的求和法：12345678int sum(int A[], int n)&#123; int sum = 0, i; for(i = 0; i &lt; n; i++) sum = sum + A[i]; return sum;&#125; 对于上面的代码，时间复杂度的计算过程如下： 在上面的计算中，Cost表示单条操作所需耗费的计算机时间，Repeatation表示每条操作所重复的次数，Total表示每个操作最终耗费的时间。因为上面需要4n+4个计算机执行时间单元，从上面的Big O notation定理我们可以得到T(n) = O(N)，当然这里讲的只是相对简单的求和法的例子。 例子2然后我们看一个稍微复杂点的求和的例子，形如下面代码：1234567for(in i = 1;i&lt;=n;i++)&#123; for(j=1;j&lt;=j;j++)&#123; for(int k = 1;i&lt; = j;k++)&#123; ++x; &#125; &#125; &#125; 有上面的Big O notation定理我们知道，我们在考虑的复杂度的时候，小的影响系数可以抛弃掉，因为我们可直接评估++x的执行次数。$$f(n) = \sum{i=1}^n\sum{j=1}^i\sum{k=j}^m1=\sum{i=1}^n\sum{j=1}^ij=\sum{i=1}^n { \frac{(i+1)}{3} } = \frac {n(n+1)(n+2)}{6}$$因此上面的时间复杂度为$O(N^3)$ 例子3下面我们来看一个有挑战性的例子：12345i=s=0;while(s&lt;n)&#123; i++; s=s+i;&#125; 我们假设循环执行了k次，则有k=1时，i=1,s=0+1k=2时，i=2,s=0+1+2k=3时，i=3,s=0+1+2+3…k=k时，i=k,s=0+1+2+3+ …+k = k(k+1)\2由于循环的条件是s\&lt;n,因此$$\frac {k(k+1)}{2}&lt;=n-1$$可以计算出：$$f(n)=k=\lfloor \frac{-1+\sqrt{8n+1}}{2} \rfloor$$所有最终的算法时间复杂度$T(n)=O(\sqrt{n})$ 例子4形如下面的代码1234int i=1; while (i&lt;=n)&#123; i=i*2;&#125; 求解：$$2^f(n)&lt;=n;$$$$f(n)&lt;=log_2^n $$ 所以程序最多能执行的次数为 $log2^n$，所以时间复杂度为$O(log^n)$,可能有人会好奇这个结果是怎么得到的。现在问题中的对数可以是$ln$(底数为e)，$log{10}$，$log_2$ 或者以其它为底数，这无关紧要，它仍然是$O(log^n)$，正如 $O(2n^2)$ 和 $O(100n^2)$ 都记为 $O(n^2)$。 例子5123456 for(i=1;i&lt;=n;i++)&#123; n+1次 for(j=1;j&lt;=n;j++)&#123; n的平方次 sum++； n的平方次 &#125;&#125; 结果：$f(n) = n+1 + n^2+n^2 = 2n^2+n+1 = O(n^2)$ 空间复杂度当我们设计一个算法来解决一个问题，它需要一些计算机内存来完成其执行。对于任何算法，内存需要以下用途…1.存储程序指令所需的内存2.存储常量值所需的内存3.存储变量值所需的内存3.和其他一些东西算法的空间复杂度可以定义如下：算法完成其执行所需的计算机存储器的总量被称为该算法的空间复杂度通常，当程序正在执行时，它使用计算机内存有三个原因。它们如下…1.指令空间：用于存储已编译版本指令的内存量。2.环境堆栈：在函数调用时存储部分执行函数信息的内存量。3.数据空间：用于存储所有变量和常量的内存量。 如何计算要计算空间复杂性，我们必须知道存储不同数据类型值所需的内存（根据编译器）。例如，C编程语言编译器需要以下…1.2字节存储整数值2.4个字节存储浮点值3.1个字节存储字符值4.8个字节存储双精度值 例子1123int square(int a)&#123; return a*a;&#125; 在上面的代码中，它需要2字节的内存来存储变量a，而另一个2字节的内存用于返回值。这意味着，它完全需要4字节的内存来完成其执行。这4字节的内存是固定的任何输入值 a 。这种空间复杂性被认为是恒定的空间复杂性。如果任何算法对于所有输入值需要固定量的空间，则该空间复杂度被称为恒定空间复杂度 例子21234567int sum(int A[], int n)&#123; int sum = 0, i; for(i = 0; i &lt; n; i++)&#123; sum = sum + A[i]; return sum; &#125;&#125; 在上面的代码中需要 n*2 字节存储数组变量的内存a[],2字节的整数参数n内存,4字节的内存为本地整数变量sum和i,返回值的2字节内存。这意味着，完全需要的2n + 8字节的内存来完成其执行。在这里，内存的数量取决于n的输入值。这种空间复杂度称为线性空间复杂度。如果算法所需的空间量随输入值的增加而增加，则空间复杂度称为线性空间复杂度。 如何定义好算法最后我们聊聊什么样的算法才是好算法。我想这个我就细讲了，因为下面的图已经很清楚了，需要说明的是，在多数情况下时间复杂度和空间复杂度是相悖的，很多时候提速上来了你却牺牲了空间（比如很多缓存策略）。 下面的两张图是常见的数据结构和算法的时间复杂度和空间复杂度。 总结本文主要阐述了算法的衡量标准，引入了Big O notation概念，重点解释了空间复杂度和时间复杂度求解方法和过程。 声明本文35%为翻译组合,65%为原创 引用http://bigocheatsheet.com/https://www.cs.northwestern.edu/academics/courses/311/html/space-complexity.htmlhttps://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/http://baike.baidu.com/link?url=MKCV_wcnPHwg_9fUksGf5qprZbSKaWeKkuuEd-IR_1mGjy6I7oFfttGlIG4Lgq9fHOSsd2wnp5Qa2K-EJe7N9IJrzhA0d_UzIXlTWeaehKrXwOYLNxp8uaBgn-LGISXshttp://blog.jobbole.com/55184/http://baike.baidu.com/link?url=JR_8kNJ8W8BmTrs9lSvSF2rlsFVF5wYYTLhvvpot0SZcnPOYo-DF4L6TXklS05lDjCe46FVi2EaF3iqlO-m7vPu_X4bqerpJSQgQG10Xbok5Kt3xru_CIxZwdAVPzsn0xf_yqLlPv400J_iyQwgBjKhttps://gradeup.co/space-and-time-complexity-i-c0b375f2-b5fc-11e5-867e-9b5bffc0cf23http://btechsmartclass.com/DS/U1_T4.htmlhttp://wenku.baidu.com/link?url=99i1IFK86QaNIGOD1tA4F3VQ5QbqkP0ARnRhLKeFdufoenzHjE10Nh7X1FJHMatFLpUuBzdBwtcYGvQFt7JCzKtuvEJ1g3Prwkc_E6Ufhttp://btechsmartclass.com/DS/U1_T3.html]]></content>
      <categories>
        <category>算法整理</category>
      </categories>
      <tags>
        <tag>算法整理</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【密码学】一万字带您走进密码学的世界（下）]]></title>
    <url>%2Fcryptology1.html</url>
    <content type="text"><![CDATA[引文 密码学是研究编制密码和破译密码的技术科学。研究密码变化的客观规律，应用于编制密码以保守通信秘密的，称为编码学；应用于破译密码以获取通信情报的，称为破译学，总称密码学。 在《一万字带您走进密码学的世界（上）》的文章中我们探讨了对称密码体系，哈希函数等技术，本文继续探讨密码学剩余的部分，本文的主要内容包括，非对称密码体系，签名算法等，因为本部分是区块链技术的基石，所以我会讲的更加详细一点，虽然我已经尽最大努力使思想简化，但是其中的数学理论对于很多人还是很晦涩，建议读者开始之前先读下数论的有关知识。本部分的主要结构如下： 非对称密码前面的文章我们探讨了对称加密，在对称秘钥加密的体系中，加密和解密使用同一个秘钥，显而易见的是这种方式存在一个很严重的弊端，那就是秘钥的分发和管理，一旦秘钥在分发过程中被人窃取，加密形同虚设。秘钥的管理也相当繁琐，如下图，如果我们要同时与n个人通信，那么每个人都将保存n-1个秘钥。 非对称的存在的意义就是为了克服这些问题，在非对称秘钥体系中，通信双方各有一个公钥和私钥，加密者使用私钥进行加密，然后传递解密者，解密者使用对方的公钥直接就可以解开，不存在秘钥秘钥传递的问题，为了更好的解释这个问题，下面用个简单的例子讲解一下。 一个简单的例子Alice和Bob用传统信件进行沟通，假设Alice和Bob不相信有邮政系统，他们想在通信的时候把信件用箱子锁住，并且在箱子外面加上一个锁。 在公钥加密体系中，Alice首先将消息放在盒子中，然后锁上盒子用她的钥匙，然后将盒子发给bob，Bob收到盒子后然后用钥匙打开，很显然，这个钥匙一定是alice钥匙的副本，不然打不开 在上面的例子中我们知道，秘钥交换是一定存在的，在沟通之前一定要进行秘钥的交换，那么有没有其他的方案可以不进行秘钥交换呢，答案是有的，Alice首先将消息放在盒子中，然后锁上盒子用她的钥匙，然后将盒子发给bob，Bob收到盒子后然后用锁锁上，然后在返回给Alice，这个时候盒子上是有两把锁的，然后Alice去掉自己的锁，这样盒子上就剩下Bob的一把锁了，然后在将盒子发给Bob，Bob用自己的钥匙打开自己的锁，就看到其中的消息。 上面的方法是可以实现不用秘钥交换，但是确定就是过于复杂，那么有没有更好的方式呢？在对称密码体系中，问题将变得简单，Bob直接将自己的打开的锁发给Alice，Alice收到锁后，然后用这个锁加密锁住装有消息的盒子，然后发给Bob，Bob可以很轻易的打开自己的锁。 在这个方法中一个重要的环节就是在已知Bob的锁和箱子的时候时候，没有BOb的钥匙是一定是打不开，在显示生活中很容易理解，可以在计算机的世界中如何寻找到这样合适的算法，目前已知的算法有两种，一种是基于离散对数的问题，另一种是椭圆曲线连对数问题，在下面的算法中我们着重讲解离散对数的问题。 Diffie-Hellman密钥交换Diffie-Hellman密钥交换首次出现在Diffie和Hellman的论文中，这篇影响深远的论文奠定了公开密钥密码编码学，因此该算法通常称之为Diffie-Hellman密钥交换。这种密钥交换技术的目的在于使得两个用户安全地交换一个秘密密钥以便用于以后的报文加密。 Diffie-Hellman加密算法的有效性依赖于计算离散对数的难度。简言之，可以如下定义离散对数： 首先定义一个素数p的原根，为其各次幂产生从1 到p-1的所有整数根，也就是说，如果a是素数p的一个原根，那么数值 $a mod p$,$a_1 mod p$,…,ap-1 mod p 是各不相同的整数，并且以某种排列方式组成了从1到p-1的所有整数。对于一个整数b和素数p的一个原根a，可以找到惟一的指数i，使得 b = ai mod p 其中0 ≤ i ≤ (p-1）指数i称为b的以a为基数的模p的离散对数或者指数，该值被记为inda，p(b)。 上面的一段引用看的一脸懵逼对吧，其实我也有又这样的感觉，我始终觉得一个优秀的学术工作者，要写出能读懂的文章，而不是别人看不懂的东西去彰显自己的高大上。好了就不吐槽了，我们开始用简单的例子解释上面的意思 首先说取摩运算，就是我们经常说的取余，比如我们对3对12进行取余就是3,9对12取余就是9,27对12取余就是3 简单点说：$3^x mod 12= y $ 其中 $x \in (1,2,3…n)$ 在这里如果我们已知x，可以很轻易的计算出y的值，及时x的值比较大，利用计算机也可以很轻易的算出，但是如果已经y,即使用高性能的计算机也很难计算出x,这就是离散对数的问题。 离散对数公钥加密算法是目前最为热门的公钥加密算法 ，其安全性要远远高于基于大数分解的RSA算法，首先说明一下上述三位科学家公钥密码体制的运作过程（假定A和B两个人要在一个不安全通道如因特网上形成密钥以备日后加密解密所用）。 首先，A、B两人要共同公开约定一个素数q和有限域Fq中的一个生成元g；A选定一个随机数a∈{1，2，…，q-1}（a可以认为是A之私钥），并将$g^a(mod \quad q)$传送给B；B选定一个随机数b∈{1，2，…，q-1}（b可以认为是B之私钥），并将$g^b(mod \quad q)$传送给A；此时A可以算出$(g^b)^a(mod \quad q)$，B也可以算出$(g^a)^b(mod \quad q)$，由于$(g^b)^a(mod \quad q) = (g^a)^b(mod \quad q) = g^{ab}(mod \quad q)$， 因此，A和B就形成了一个公共的密钥$g^{ab}(mod \quad q)$，日后便可以此钥来进行传统的加密解密计算，从而达到在不安全的通道上进行保密通讯的目的。 显然，敌方可以截获到$g，q，g^a(mod \quad q)，g^b(mod \quad q)$。因此，如果敌方有快速的求解离散对数的算法，就能从已截获的上述信息中迅速求出a或b，从而算出$g^ab(mod \quad q)$。遗憾的是，目前世界上根本就没有快速的求解离散对数的算法，因此当所选的有限域Fq很大时，a或b就很难算出。Diffie-Hellman的算法举例可以参考我之前的文章《【密码学】Diffie-Hellman密钥交换》 ElGamal算法在密码学中，ElGamal加密系统是一个基于迪菲-赫尔曼密钥交换的非对称加密算法。它在1985年由塔希尔·盖莫尔提出。GnuPG和PGP等很多密码学系统中都应用到了ElGamal算法。ElGamal加密算法可以定义在任何循环群$ {\displaystyle G}$ 上。它的安全性取决于 ${\displaystyle G}$ 上的离散对数难题。ElGamal 加密被用于免费的GNU隐私保护软件、PGP 近期的版本和其他密码系统中 此部分的详细讲解，请看下篇文章《【密码学】ElGamal算法详解》 Cramer-Shoup 加密系统Cramer–Shoup 系统是一个非对称秘钥加密算法，而且被证实是第一个针对适应性选择米文攻击所采用的标准加密猜想所用的安全有效的项目。其安全性是基于决定性Diffie–Hellman猜想的计算难解性（广泛接受，但未被证实）的计算难解性的。由 Ronald Cramer （罗纳德·克莱默）和 Victor Shoup （维克多·苏伯）于1998年研发，是 ElGamal 加密系统的延伸。与 ElGamal 相反，它具有很强的延展性，Cramer–Shoup 添加了另外的成分来确保甚至是遭受广泛的攻击时保证其非延展性。这一非延展性是通过使用抗撞击哈希函数和额外的计算而取得的，导致了密文是 ElGamal 的两倍大 ECC 椭圆曲线算法椭圆曲线密码学（英语：Elliptic curve cryptography，缩写为ECC），一种建立公开金钥加密的算法，基于椭圆曲线数学。椭圆曲线在密码学中的使用是在1985年由Neal Koblitz和Victor Miller分别独立提出的。 ECC的主要优势是在某些情况下它比其他的方法使用更小的密钥——比如RSA加密算法——提供相当的或更高等级的安全。ECC的另一个优势是可以定义群之间的双线性映射，基于Weil对或是Tate对；双线性映射已经在密码学中发现了大量的应用，例如基于身份的加密。不过一个缺点是加密和解密操作的实现比其他机制花费的时间长。 RSA加密算法RSA加密算法是一种非对称加密算法。在公开密钥加密和电子商业中RSA被广泛使用。RSA是1977年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。当时他们三人都在麻省理工学院工作。RSA就是他们三人姓氏开头字母拼在一起组成的。 因为此部分是区块链的算法结合比较紧密，我将花更多的篇幅讲解，从上面的讲解我们知道，我们需要构建一个锁和一把钥匙，然后将锁分配给每个人，然后自己保留钥匙，在这里这把锁就相当于相当于公钥，自己的钥匙就相当于私钥，下面我们开始用离散对数问题来构建我们的公钥和私钥。虽然在部分我会尽量写的详细，但是在开始之前，读者最好能对数论知识有个基本的了解，可以参数我之前的文章《【密码学】RSA算法解析-数论基础》 我们前面已经提到离散对数的问题，形如$$m^e mod \quad N = c$$我们在已知c和N和m的情况下很难图导出e.同样的道理，你在已知c和N和e,的情况下也很难推出来m,这就是一个典型的单项函数 m是明文，c是密文，e是加密的钥匙，d是解密的钥匙，按照我们上面的解释，在下面的加密解密过程都是严谨的单向过程$$m^e mod \quad N = c \quad\quad公式1$$我们找到一个d使下面的公式也成立$$c^d mod \quad N = m \quad\quad公式2$$1.接下来我们的目标就是找到合适的e和d,我们开始推导，将公式1带入到公式2中$$（m^e mod \quad N）^d mod \quad N = m \quad\quad公式3$$$$（m^e）^d mod \quad N = m \quad\quad公式4$$$$ m^{ed} mod \quad N = m \quad\quad公式5$$2.我们将一个数n的子集存在互质关系个数定义为φ(n),那么一个合数的公约数是不固定的，但是一个素数的公约数一定只有自己，所以对于素数φ(n) = n-1 这个求解过程叫欧拉函数，可以参考我之前的文章3.欧拉函数主要应用在欧拉定理上，”欧拉定理”指的是：如果两个正整数m和N互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：$$m^{\phi({n})}\equiv 1(mod\quad N) \quad\quad公式6$$转换后就是：$$m^{\phi({n})} mod\quad N \equiv 1 \quad\quad公式7 $$然后两边同时乘以m$$m^{\phi({n})+1} mod\quad N \equiv m \quad\quad公式8$$有上面的公式5我们知道$$ m^{ed} mod \quad N = m \quad\quad公式5$$因此可以得出$$ m^{ed} mod \quad N = m^{\phi({n})+1} mod\quad N $$$$ed = \phi({n})+1$$$$ed - \phi({n}) y = 1 \quad\quad\quad此处增加y表示任意数字$$我们目前已经知道的条件，我们已知N，一般N都是两个素数的乘积，已经知道加密秘钥e,求解解密秘钥d为了便于讲解，我们假设在这里N=77，则$phi({n})=6*10 = 60$, e等于67，则计算过程如下，$$67d - 60 y = 1$$以为y可以为负数，因此这是有一个二项式的接，其实有多个答案，我们只需获取其中一个就可以，根据欧几里得拓展定理可以算出私钥d的值为43，计算机过程参考《【密码学】RSA算法解析-加密解密》最终加密过程$$75^{67}\equiv c(mod\quad 77)$$在计算机中可以很轻易的计算出c=26解密过程$$26^{43}\equiv m(mod\quad 77)$$在计算机中可以很轻易的计算出m=75 演示代码 python源码地址：https://cloud.sagemath.com/projects/dc18d6fb-c4ae-47c4-8ea4-b2a1887ccb6b/files/RSA_CASE.sagews 到这里RSA完整的讲完了，虽然我已经写得很详细了，但是肯定还是有些读者不能完全理解，如果还是不能理解，建议先学习点数论的知识预热。 签名算法我们在讨论签名算法之前，先来回忆一下之前讲的hash函数，我们有一份文件可以计算出他的Hash值，一旦文件被篡改做产生的Hash值也将变化，Hash函数解决了完整性的问题，然而并没有解决认证的问题，如果攻击者不但把文件给篡改了还把hash值给改了，这样接收者就察觉不到文件已经出了问题。 我们需要一种签名机制，这种签名机制能保证所有人都能对文件的完整性进行认证，同时又能验证这份文件确实是发送者发的，攻击者无法伪造这个签名。 设计原则数字签名常常和哈希函数在一起使用，给定一段明文M，我们可以计算出明文的哈希值h(M),然后将哈希值进行某种加密S后，附在明文上，结构如下：$$M|S(h(M))$$在上述结构主要依赖于哈希值不存在对撞，即不同的明文之间不会存在相同的哈希值，实际上每种公钥加密体系都能实现，下面我们主要探究3种： Schnorr签名，Digital Signature Algorithm（数字证书签名），RSA签名 Schnorr签名Schnorr签名是基于ElGamal算法的，它的安全性取决于离散对数的难题。 DSA签名使用SHA哈希加密函数，它的安全性也取决于离散对数的难题。它是1990被提出，并且已经被US FIPS所接受，他的具体原理如下：1.选择一个1024位的素数p,此时有一个群组$Z_p$2.选择另一个160位的素数q，q除以p-1和q都在群组$G_q$中，并且群组$G_q$属于$Z_p$3.其中要到的哈希算法是SHA-1秘钥生成：1.选择p和q,条件就是上面所表达的，换成数学的表达方式就是$p=zq+1$ 并且z属于群组$Z_p$2.选择一个g，使下面的公式成立，$ jz = g(mod \quad p) $ 并且 $1&lt;j&lt;p$3.在范围${1,…..q-1}$ 的选择一个随机数x4.计算出来$y=g^x mod \quad p$5.其中公钥就是$K^1 = (p,q,g,y)$,私钥就是$K^2 = (p,q,g,x)$签名过程：1.在范围${1,…..q-1}$的选择一个随机数r2.计算出来$s=(g^r mod \quad p ) mod \quad q $3.计算出$t=((SHA-1(M)+xs)r^{-1}) mod \quad q$4.将签名结果$(s,t)$附属在消息上。验签过程：1.计算出$u_1 = (SHA-1(M)t^{-1}) mod \quad q $2.计算出$u_2 =(s*t^{-1}) mod \quad q$3.计算签名$s^1 = ((g^{u_1}y^{u_2})mod \quad p) mod \quad q$4.比较$s^1$是否与s相同 RSA签名一种从RSA算法演变而来的签名，它的安全性取决大素数分解难题。下面我们来看看具体的实现过程秘钥生成1.选择两个大素数，p和q2.计算出他们的欧拉函数，$\phi(n) = (p-1)(q-1) $3.我们选择一个整数e&gt;1,并使$gcd(e,\phi(n))=1$ 即e要和欧拉函数（非公约的个数），互为素数。4.我们使$de = 1( mod \phi(n)) $ ,根据欧几里得拓展定理计算出d.5.然后我们就得到了公钥$K1= (e,n)$，然后对外发布公钥6.私钥就是$k2=d$ 签名过程：我们假设需要加密的信息为M，其中M在${1,,,,n-1}$这个范围内，h为哈希加密函数，则签名的过程如下：$$s=h(M)^d mod \quad n$$验签过程：计算出明文的哈希值h(M)比较h(M)是否和$s^e\quad n$相应，如果相同则验签成功。 总结本文主要阐述了密码学中的非对称密码和签名算法，不得不说对于一个开发人员来说，今天的讲解过的理论化，但是理论是实践的基础，不是吗？ 声明本文45%为翻译组合,55%为原创 引用http://www.jiamisoft.com/blog/index.php/3165-diffie-hellmanjiamisuanfa.htmlhttps://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95http://baike.baidu.com/link?url=14BKIalgIoeD2Wbq7X6rxUBoYrTEHlhxlX3x337N7_7qLaDh6XMK1MMStd5zIfROme-meST7ZJPQqWDjb7MgUJHxPiVeEJqeP2PB1i2eSNOZAzy_c-BgpCQLLUjn1GHghttps://www.khanacademy.org/computing/computer-science/cryptography/modern-crypt/v/checkpoint-advanced-lessons http://en.wikipedia.org/wiki/Cramer–Shoup_cryptosystemhttps://zh.wikipedia.org/wiki/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E5%AD%A6]]></content>
      <categories>
        <category>密码学</category>
      </categories>
      <tags>
        <tag>密码学</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】数据库演进过程中的技术债务探讨]]></title>
    <url>%2FtechnicalTebt.html</url>
    <content type="text"><![CDATA[引文软件工程是一门研究方法论且非常宏观的课程，对于与一个初级开发者来说，看到有些概念和定义觉得非常没有意义，感觉学这些是在浪费时间，可能做了多年开发之后才能真正理解其中的痛楚，有些前人总结的方法和教训我们还是要注意的。不要等吃亏了之后再回头。 今天在英国做的一个技术债务的分享，其中拿了阿里巴巴的数据库演进做了案例分析，其中的有些数据可能不够准确，毕竟之前没在阿里工作过，但是不影响对其中的讲解。下面引用维基百科技术负债的定义开始本文的分享。 技术负债（英语：Technical debt），又译技术债，也称为设计负债（design debt）、代码负债（code debt），是编程及软件工程中的一个比喻。指开发人员为了加速软件开发，在应该采用最佳方案时进行了妥协，改用了短期内能加速软件开发的方案，从而在未来给自己带来的额外开发负担。这种技术上的选择，就像一笔债务一样，虽然眼前看起来可以得到好处，但必须在未来偿还。软件工程师必须付出额外的时间和精力持续修复之前的妥协所造成的问题及副作用，或是进行重构，把架构改善为最佳实现方式。 整体结构本文开始介绍了什么是技术债务，简单介绍阿里巴巴和他的数据库变迁，重点放在了技术债务和数据库演进之间的关系，技术债务在数据库演进的实际应用上。 什么是技术债务当你做一件事情的时候，你有两种选择去实现它，一种是草草了事，但是后期问题特别多，非常难维护，另一个总经过精心的策划与安排，但是可以带来更多的长远利益，技术债务是一个非常好的比喻去解释这种现象。 技术债务非常像银行的财务债务，当你欠了银行一英镑，日利率是10%，第二天你就要还银行1.1磅，技术债务也会出现利滚利的现象。 什么是技术债务？这个术语由最先提出维基概念的程序员–沃德·坎宁安在1992年所创造。坎宁安这样描述技术债务：“初次发布代码就像是开始举债。每当代码被收回重写时就会加速原本少量债务的发展。当债务无力偿还时就会发生危险。浪费在不完美的代码上的每一分钟都被作为债务的利息。” 理论上，你可以毫无限制地调整软件，不断地在开发项目上投入时间和资源，不断让它变得更好、更高效。然而在实践当中，没有一个开发团队能拥有无限的时间或资源，在某些时候，你需要做出决定停止重复劳动从而继续前进。这时就是技术债务开始累积的时刻。 软件工程是一门非常实际的工程，只谈理论非常的空洞，而且没有意义，这个PPT是用来过渡的，下面引出阿里巴巴的数据库演进这个例子。 阿里巴巴和他的数据库演变阿里巴巴集团（英语：Alibaba Group），（NYSE：BABA）创立于1999年，是一间提供电子商务在线交易平台的公司，业务包括B2B贸易、网上零售、购物搜索引擎、第三方支付和云计算服务。集团的子公司及关系公司有阿里巴巴B2B、淘宝网、天猫、一淘网、阿里云计算及支付宝。旗下的淘宝网和天猫在2012年销售额达到1.1万亿人民币，超过亚马逊公司和eBay之和。其2015年度商品交易总额已经超过3万亿元人民币，是全球最大零售商。 因为在英国做演讲，所以引用BBC的数据比较权威，这个是引自BBC的在2016年对双11的一次新闻报道。我想强调是是数据增长，必须说明的是这个数据量是根据网上的很多资料推算出来的，实际并不一定准确。但增长量确实非常迅速。 阿里巴巴在过去15年对数据库进行的调整。这个数据时间可能会有一单误差，但是整体趋势是没有问题的。 这段话仍然是过渡的，用来引出来问题，数据库演进和技术债务之间的关系 数据库变革的原因我们常常挂在嘴边的原因（数据量过大，并发过大，创造更多的价值）往往是冰山一角，一些更深次的原因往往被忽略，在实际的运用中这些原因可能占了更大的比重，这些原因包括：日益增长的运维费用，系统运行的风险和越来越差劲的客户应答。 日益增长的运维费用在这里举了一个简单的例子，我们想查询一个用户的用户信息从一个简单的表中，如果数据量只有1000条，那么在查询的时候就非常简单。 如果数据量增长到了1万条，我们还可以用上面的简单语句进行查询，可能依然能查出来结果，但是速度非常慢。这个时候一个比较好的方式就是增加索引。 如果数据增加到1千万条，单纯的使用索引已经很难解决问题，这个时候可能要考虑下水平分库和垂直分库。 数据库的运维费用增加主要体现在两个方面，一方面如上面看到的数据的不断增加导致的技术变得复杂，另一方面之前的产生的技术债务会持续不断的累积。 系统运行风险就像你看到下面的图一样，系统中任何一部分变化都会影响其他部分，你在修复或者偿还之前的债务（问题）的时候，其他的部分有损毁的可能。 依然用一个简单的例子来阐述，下面的例子中一个存储过程应该有四个服务在调用，在实际的开发环境中可能比这种情况更加严重，因为随着时间的推移你甚至不知道哪些服务调用哪些存储过程了。 有一天客户提出了新的特性，需要改动服务2，在改动的同时可能无意修改了这个存储过程，所带来的后果的影响将是无法估量的，因为其他的服务都会受到影响。 差劲的用户响应上面的这两个原因加速了用户逃离你的服务，我们都知道数据库架构本身没有什么价值，他的价值主要体现在为用户创造的价值，用户一旦逃离，势必会降低架构的价值。 技术债务实际运用对上面原因进行总结后，在此处开始探讨另一个问题，为什么有些数据库架构用的时间长，有些架构用的时间短。开始引入另一个概念技术债务分类 Bob大叔和Martin Fowler对于技术负债的进行了划分。他划分的四个象限如下：不计后果，故意的——团队没有时间做设计，仅仅给出了一个匆忙做出的方案，缺乏对质量的预见。谨慎，故意的——尽管有很多已知的缺陷，但团队必须现在交付产品，同时对此造成的后果心中有数。不计后果，无意的——团队压根就不知道基本的设计原则，更不用说引入的坏味道了。谨慎，无意的——那些拥有优秀设计师的团队很容易遇到这种情况。他们交付的方案具有商业价值，但在完成方案后才明白什么才是最好的方案。原文地址：https://martinfowler.com/bliki/TechnicalDebtQuadrant.html 下面举了一个例子，支付宝的例子，简单的介绍了支付宝是啥（毕竟是老外，虽然在国内很火，对于国外人一脸懵逼啊） 支付宝于2004年末发布，实际在这个时候阿里巴巴几乎完成数据往oracle的迁移。实际他们已经意识到了MYSQL数据库的安全问题，oracle在当时提供了几乎完美的安全解决方案，成了当时支付宝能迅速崛起的一个重要支撑。 话锋一转，如果他们当时么有意识到这个问题，可能问题就会很糟糕，在面对巨大是市场挤压的时候，在去调整数据库，数据库架构势必会拖后腿，可能会造成利益的损益。 总结：不是所有的债务都是坏帐。战略性的债务规划可以优化公司是金融界的共识。这也同样适用于软件。在债务的使用（此情形一般为技术债务）方面具有战略眼光的公司可以更快地开发产品，并更快地推出产品，从而赢得市场。 总结最后总结一下今天所讲的东西，开始引入技术债务概念，简单介绍介绍下阿里巴巴的数据库变更，重点讲解了技术债务和数据库架构变更之间的关系，最后举出了技术债务的分类在实际项目的应用。 学界为了工程债务的利益和风险而争论不休。这可能是源于人们想到软件时，就会自然而然地认为其应该有完美的设计、无暇的系统以及无缺陷的运行。但是无休止地追求一个可以运行无暇的完美系统，无疑会使你快速构建产品以及响应客户的能力受限。技术债务是一种能够让你跳出这一僵局去发布产品并打败你竞争对手的资产。 最后：我不得不说虽然写了很多，有些推论还是不够严谨，可能导致数据库的变更的原因比我这里复杂的多（如果老板酒后的一句话），我在这里想强调是其中一定有技术债务占得份额，所以请各位在开发设计的时候意识到这些问题。（其实我也不爱弄这些理论， 但我常常劝自己当你成了架构师这些东西就变了就有意义了）。 声明本文30%为翻译组合,70%为原创 引用[1] Publicnow.com. (2017). Alibaba Group Holding Ltd. (via Public) / Alibaba Group Generated RMB 120.7 Billion (USD 17.8 Billion) of GMV …. [online] Available at: http://www.publicnow.com/view/D5A8827A60D3A2CE13AAF687DEA41FA68F6616DD?2016-11-14-17:01:57+00:00-xxx642 [Accessed 6 Jan. 2017]. [2] Tom, E., Aurum, A. and Vidgen, R. (2013). An exploration of technical debt. Journal of Systems and Software, 86(6), pp.1498- 1516. [3] Alibabagroup.com. (2016). Alibaba Group. [online] Available at: http://www.alibabagroup.com/en/about/history [Accessed 8 Dec. 2016]. [4] Fowler, M. (2016). bliki: TechnicalDebtQuadrant. [online] martinfowler.com. Available at: http://www.martinfowler.com/bliki/TechnicalDebtQuadrant.html [Accessed 7 Dec. 2016]. [6] Gao, Y., Shim, K., Ding, Z., Jin, P., Zujie, R., Xiao, Y., Liu, A. and Qiao, S. (2013). Web-Age information management. 1st ed. Berlin: Springer, p.3. [7] Marketing China. (2017). Review of the Chinese online payments - Marketing China. [online] Available at: http://marketingtochina.com/review-chinese-online-payments/ [Accessed 6 Jan. 2017]. [7] Horkoff, J., Li, T., Li, F., Salnitri, M., Cardoso, E., Giorgini, P., Mylopoulos, J. and Pimentel, J. (2014). Taking goal models downstream: A systematic roadmap. In: 2014 IEEE Eighth International Conference on Research Challenges in Information Science (RCIS). IEEE. [8] Fowler, M. (2016). bliki: CannotMeasureProductivity. [online] martinfowler.com. Available at: http://martinfowler.com/bliki/CannotMeasureProductivity.html [Accessed 8 Dec. 2016]. [10] DeMarco, T. (1982). Controlling software projects. Management, measurement and estimation. 1st ed. New York,N.Y.,Yourdon,1982,: Prentice Hall;, p.3. [11] Chhetri, S. (2017). How we used unit testing to tackle technical debt. [online] Shhetri.github.io. Available at: http://shhetri.github.io/unit-testing-to-tackle-technical-debt [Accessed 6 Jan. 2017]. [13] New Health Advisor. (2017). Why Can’t I Make Decisions?. [online] Available at: http://www.newhealthadvisor.com/why-can&#39;t-i-make-decisions.html [Accessed 6 Jan. 2017]. [14] Persson, A. and Stirna, J. (2015). Advanced Information Systems Engineering Workshops. In: CAiSE 2015 International Workshops. p.215. http://www.weibo.com/ttarticle/p/show?id=2309351000014050451803829463]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
      <tags>
        <tag>系统架构</tag>
        <tag>技术债务</tag>
        <tag>Technical debt</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【密码学】一万字带您走进密码学的世界（上）]]></title>
    <url>%2Fcryptology.html</url>
    <content type="text"><![CDATA[引文 密码学是研究编制密码和破译密码的技术科学。研究密码变化的客观规律，应用于编制密码以保守通信秘密的，称为编码学；应用于破译密码以获取通信情报的，称为破译学，总称密码学。 为了使读者对密码学有一个整体的认识，本文简述了常见的密码学的概念，其中本文包括对称密码，哈希函数。《一万字带您走进密码学的世界（下）》包括非对称密码，数字签名，数字认证等，需要指出的是文中并没有深入探讨加密算法原理，关于此部分内容，后续的文章会详细阐述。本文的主要内容如下图所示： 对称密码在对称密码体系中，相同的密码用来加密和解密报文，因此无论对发送者还是接收者他们都知道秘钥，解密和解密的过程：$M表示明文$$K表示秘钥$$C表示密文$ $E表示加密函数$$D表示解密函数$ 对称密码可以分为两类：分组密码和序列密码 分组密码分组密码（Block Cipher）:以一个数据块（比如64位连续的比特数据）为单位进行加密，将明文消息编码表示后的数字（简称明文数字）序列，划分成长度为n的组（可看成长度为n的矢量），每组分别在密钥的控制下变换成等长的输出数字（简称密文数字）序列。常见的分组密码分为以下几类： Feistel 密码 在密码学研究中，Feistel 密码结构是用于分组密码中的一种对称结构。以它的发明者 Horst Feistel 为名，而Horst Feistel 本人是一位物理学家兼密码学家，在他为 IBM 工作的时候，为Feistel 密码结构的研究奠定了基础。很多密码标准都采用了Feistel 结构，其中包括DES。Feistel 的优点在于：由于它是对称的密码结构，所以对信息的加密和解密的过程就极为相似，甚至完全一样。这就使得在实施的过程中，对编码量和线路传输的要求就减少了几乎一半。 DES数据加密标准（英语：Data Encryption Standard，缩写为 DES）是一种对称密钥加密块密码算法，1976年被美国联邦政府的国家标准局确定为联邦资料处理标准（FIPS），随后在国际上广泛流传开来。它基于使用56位密钥的对称算法 AES高级加密标准（英语：Advanced Encryption Standard，缩写：AES），在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。经过五年的甄选流程，高级加密标准由美国国家标准与技术研究院（NIST）于2001年11月26日发布于FIPS PUB 197，并在2002年5月26日成为有效的标准。2006年，高级加密标准已然成为对称密钥加密中最流行的算法之一。 分组密码几种模式分组（block）密码的工作模式（mode of operation）允许使用同一个分组密码密钥对多于一块的数据进行加密，并保证其安全性。分组密码自身只能加密长度等于密码分组长度的单块数据，若要加密变长数据，则数据必须先被划分为一些单独的密码块。通常而言，最后一块数据也需要使用合适填充方式将数据扩展到匹配密码块大小的长度。一种工作模式描述了加密每一数据块的过程，并常常使用基于一个通常称为初始化向量的附加输入值以进行随机化，以保证安全， 电子密码本（ECB）最简单的加密模式即为电子密码本（Electronic codebook，ECB）模式。需要加密的消息按照块密码的块大小被分为数个块，并对每个块进行独立加密.加密过程如下： 解密过程如下： 密码块链接（CBC）在CBC模式中，每个平文块先与前一个密文块进行异或后，再进行加密。在这种方法中，每个密文块都依赖于它前面的所有平文块。同时，为了保证每条消息的唯一性，在第一个块中需要使用初始化向量。加密过程如下： 解密过程如下： 填充密码块链接（PCBC）填充密码块链接（PCBC，Propagating cipher-block chaining）或称为平文密码块链接（Plaintext cipher-block chaining）[15][16]，是一种可以使密文中的微小更改在解密时导致平文大部分错误的模式，并在加密的时候也具有同样的特性。加密过程如下： 解密过程如下： 密文反馈（CFB）密文反馈（CFB，Cipher feedback）模式类似于CBC，可以将块密码变为自同步的流密码；工作过程亦非常相似，CFB的解密过程几乎就是颠倒的CBC的加密过程：加密过程如下： 解密过程如下： 计数器模式（CTR）TR模式（Counter mode，CM）也被称为ICM模式（Integer Counter Mode，整数计数模式）和SIC模式（Segmented Integer Counter）。与OFB相似，CTR将块密码变为流密码。它通过递增一个加密计数器以产生连续的密钥流，其中，计数器可以是任意保证长时间不产生重复输出的函数，但使用一个普通的计数器是最简单和最常见的做法。加密过程如下： 解密过程如下： 序列密码序列密码（Stream Cipher）：一次只对明文中的单个比特（有时对字节）运算的算法，而且密码要不断变化中。加密的一般模型如下：明文序列：$m=m_1m_2m_3…$秘钥序列：$k=k_1k_2k_3…$密文序列：$c=c_1c_2c_3…$加密变换：$c_i=k_i\otimes m_i (i = 1,2,3…)$解密变换：$m_i=k_i\otimes c_i (i = 1,2,3…)$ 流式密码有点像一次性密码：我们产生一个和和要加密的数据一样长的秘钥，这个秘钥往往是从种子中产生的，虽然他不是随机的，但是是伪随机的。 常见的序列加密算法如下： 线性反馈寄存器线性反馈移位寄存器（linear feedback shift register, LFSR）是指，给定前一状态的输出，将该输出的线性函数再用作输入的移位寄存器。异或运算是最常见的单比特线性函数：对寄存器的某些位进行异或操作后作为输入，再对寄存器中的各比特进行整体移位。 内容扰乱系统内容扰乱系统(Content Scrambling System) 是一种防止直接从盘片上复制视频文件的数据加密和鉴定方法。每个获得许可的人都能得到一把密钥，它从加密光盘上的密钥组成的母集中取出来。 只要在以后的光盘上去除该密钥，许可就失效了。 A5/1算法该方案用于GSM蜂窝电话网络中的数据机密性加密 RC5算法分组密码算法是1994由麻萨诸塞技术研究所的Ronald L. Rivest教授发明的，并由RSA实验室分析。不像许多方案，RC5具有可变块大小（32，64或128位），密钥大小（0到2040位）和轮回数（0到255）。参数的原始建议选择分别为64位，128位密钥和12轮的块大小。12轮的RC5（64位块）易受使用244选择明文差分攻击。18-20轮被认为是足够的安全保护。 哈希加密哈希加密是独立于对称密码和对称密码体系的，因为他不需要解密。接下来我们会提到哈希函数的概念，注意：此处的哈希函数有别与编程中的哈希函数，编程中函数主要用来做地址的映射。具体详见我之前的文章《【密码学】Hash Function(哈希函数)》密码学上指散列函数具有的特征: 输入长度可以是任意长度 输出是固定长度 给出任意的报文可以很轻松的算出哈希函数$H（x）$ 哈希函数是个不可逆的函数，就是给出一个$Y $，其中$Y = H（x）$,你完全不能通过Y去推算出x 哈希函数不存在碰撞，就是不存在任意一个$x’$,使$H（x’） = H（x）$ 哈希函数的用处文件校验MD5 Hash算法的”数字指纹”特性，使它成为目前应用最广泛的一种文件完整性校验和（Checksum）算法 数字签名由于非对称算法的运算速度较慢，所以在数字签名协议中，单向散列函数扮演了一个重要的角色。对 Hash 值，又称”数字摘要”进行数字签名，在统计上可以认为与对文件本身进行数字签名是等效的。而且这样的协议还有其他的优点。 常见的哈希函数算法MD4MD4(RFC 1320）是 MIT 的Ronald L. Rivest在 1990 年设计的，MD 是 Message Digest 的缩写。它适用在32位字长的处理器上用高速软件实现–它是基于 32位操作数的位操作来实现的。 MD5MD5(RFC 1321）是 Rivest 于1991年对MD4的改进版本。它对输入仍以512位分组，其输出是4个32位字的级联，与 MD4 相同。MD5比MD4来得复杂，并且速度较之要慢一点，但更安全，在抗分析和抗差分方面表现更好 SHA1SHA1是由NIST NSA设计为同DSA一起使用的，它对长度小于2^64位的输入，产生长度为160bit的散列值，因此抗穷举（brute-force）性更好。SHA-1 设计时基于和MD4相同原理，并且模仿了该算法。 总结本文主要阐述了密码学中的对称密码和哈希密码在下篇文章《一万字带您走进密码学的世界（下）》中我们将继续介绍 非对称密码，秘钥交换，数字证书等概念。 声明本文40%为翻译组合,60%为原创 引用http://baike.baidu.com/linkurl=8O2XInaeTewn0xMPgNceWPDDCbwEeI8DjJMwpp_T8Gcu6sGCpeJDSpolFXLsYXPfa5OcaIqq7t_r11cprg2j8qhttps://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F#.E7.94.B5.E5.AD.90.E5.AF.86.E7.A0.81.E6.9C.AC.EF.BC.88ECB.EF.BC.89http://baike.baidu.com/link?url=MbBt9W9ZxPbUczMDPjb4Touio78qil_JUp858Oi0GQbB6uVIhpfElCRtdouJlKVO6oDL4lhPzeENovTkJp2GWrq7XeutPYyIpB3l6eWytIuhttp://baike.baidu.com/link?url=hhvK2RFiyxU0CJ12HnVpg9PEozTQ2tTfU7DT2K8VcCgx198hhJRBpiKuCjJk6qm0FA0fyeKPH9w_vLkJrGQ3_j-iLxOi4E6WIlFe-u0WxO_]]></content>
      <categories>
        <category>密码学</category>
      </categories>
      <tags>
        <tag>密码学</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【算法整理】A $*$ search 算法实现八数码问题]]></title>
    <url>%2Fpuzzle8.html</url>
    <content type="text"><![CDATA[引言最近帮一个朋友看八数码的问题，后来查了一下发现实际这是人工智能领域中的启发式搜索部分，网上给的答案看的都是一头雾水的，本文着重从降维映射的角度去实现一个简单的启发式搜索搜索算法。 什么是八数码问题？八数码问题也称为九宫问题。在3×3的棋盘，摆有八个棋子，每个棋子上标有1至8的某一数字，不同棋子上标的数字不相同。棋盘上还有一个空格，与空格相邻的棋子可以移到空格中。要求解决的问题是：给出一个初始状态和一个目标状态，找出一种从初始转变成目标状态的移动棋子步数最少的移动步骤。 所谓问题的一个状态就是棋子在棋盘上的一种摆法。棋子移动后，状态就会发生改变。解八数码问题实际上就是找出从初始状态到达目标状态所经过的一系列中间过渡状态。 八数码问题一般使用搜索法来解。搜索法有广度优先搜索法、深度优先搜索法、A算法等。这里通过用不同方法解八数码问题来比较一下不同搜索法的效果。 算法思路我们的算法思路主要解决方案是将二维的数字进行降维，然后空格上下移动就体现在了数组下标的移动，然后对该一维数组进行“循环”，只到找到最符合条件的。A. 如何表示空格节点状态？在下面的算法中我们定义了将节点作为一个对象，这个对象有如下属性：当前8码数的状态、当前空白的位置、一共走了多少步、离我们的目标还有多少步、移动之前的状态。B. 我们表示空格的上下移动？我们将二维是数据（X，Y轴上的数据，上面的表格可以看成一个坐标）降为一位数组，空格的上下移动体现的是这个数组的下标移动C. 如何有二维数组将为以为数组？直接接在后面就好，例如：这里空格用状态0表示2 8 31 6 47 0 5转化成一维数组就是：283164705D. 状态0的上下移动如何体现在一维数据的变化上？状态0上移动，实际是状态0下标-3，状态0下移动，实际是状态0下标+3，状态0左移动，实际是状态0下标-1，状态0右移动，实际是状态0下标+1，E. 状态0如何不停“循环”？状态0漫步目的移动。F.何时停止？符合某种状态条件的时候停止。 为每个棋牌制定一套可能的走步：左、上、右、下四种移动。这样就需32个操作算子。仅为空格制定这4种走步，因为只有紧靠空格的棋牌才能移动。空格移动的唯一约束是不能移出棋盘。结合上面我们说的降低维度，我们将算法实现结果如下 实现 A* search 算法1.实现节点状态类 1234567891011/** * 构造函数，8码数最初的状态 * @param input An array representing a puzzle. */public State(int[] input) &#123; this.array = input; this.blankIndex = getIndex(input, 0); this.previous = null; this.g = 0; this.h = Puzzle.getHeuristic(this.array);&#125; 定义循环的终止条件，此部分可以根据实现方式最终的输出结果不同定义而不同，下面是输出常规型的八数码的终止条件123456789101112/** * 用来检查是否为解决，实际是一个循环终止条件 * 这是正常的8数码 * @return True if it is in the solved state, false if it is not. */public boolean isSolved() &#123; int[] p = this.array; for (int i = 1; i &lt; p.length - 1; i++) if(p[i-1] &gt; p[i]) return false; return (p[0] == 1);&#125; 2.定义实体Puzzle类12345678/** * Constructor for puzzle class. * @param puzzleInput Valid sliding puzzle in 2D array format. */ public Puzzle(int[] puzzleInput) &#123; this.initialState = new State(puzzleInput); this.state = this.initialState; &#125; Puzzle开始寻找（广度优先遍历），需要说明是下面启动了两个队列，一个已经访问过的队列，不算增加，还有一个是活动队列，进的同时也出。poll出来的数据主要用于判断。12345678910111213141516171819202122232425262728293031/** * This method handles the solving of the puzzle. */public void solve() &#123; // Clear the queue and add the initial state. queue.clear(); queue.add(this.initialState); long startTime = System.currentTimeMillis(); int i = 0; while(!queue.isEmpty()) &#123; i++; // Get the best next state. this.state = queue.poll(); // Check if the state is a solution. if (this.state.isSolved1()) &#123; System.out.println(this.state.solutionMessage(startTime)); return; &#125; // Add this state to the visited HashSet so we don&apos;t revisit it. visited.add(state); // Add valid moves to the queue. this.addToQueue(Move.up(state)); this.addToQueue(Move.down(state)); this.addToQueue(Move.left(state)); this.addToQueue(Move.right(state)); &#125;&#125; 3.定义移动类，主要解决二维数组移动时和一维数组的映射关系类1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 /** * 往上移动一下就是减去三 * Returns a new state with the blank space swapped * with the tile above it. * @param state The state being operated on. * @return null if the state is invalid, the new state if valid. */ public static State up(State state) &#123;//能往上移动的条件是目前不处于第一行 if (state.blankIndex &gt; 2) return new State(state, state.blankIndex - 3); return null; &#125; /** * 往下移动一位就是加三 * Returns a new state with the blank space swapped * with the tile below it. * @param state The state being operated on. * @return null if the state is invalid, the new state if valid. */ public static State down(State state) &#123;//能往上移动的条件是目前不处于最后一行（第三行） if (state.blankIndex &lt; 6)&#123; return new State(state, state.blankIndex + 3); &#125; return null; &#125; /** * * Returns a new state with the blank space swapped * with the tile to the left of it. * @param state The state being operated on. * @return null if the state is invalid, the new state if valid. */ public static State left(State state) &#123;//能往左移动的条件是目前不处于第一列 if (state.blankIndex % 3 &gt; 0)&#123; return new State(state, state.blankIndex - 1); &#125; return null; &#125; /** * 能往右移动的条件是目前不处于最后一列(第三列) * 这里在队列中移动体现在队列+1 * @param state The state being operated on. * @return null if the state is invalid, the new state if valid. */ public static State right(State state) &#123; if (state.blankIndex % 3 &lt; 2)&#123; return new State(state, state.blankIndex + 1); &#125; return null; &#125; 4.写个测试类测试一下吧123456789101112131415161718public class PuzzleTest &#123; public static void main(String[] args) &#123; Puzzle puzzle = null; if (args.length == 0)&#123; puzzle = new Puzzle(Puzzle.getConsoleInput()); &#125; // 检查是否可puzzle是否可解 /*if (!puzzle.isSolvable()) &#123; System.out.printf(&quot;Given puzzle:%s\n\nis NOT solvable!\n&quot;, puzzle.state.toString()); System.exit(0); &#125;*/ // Solve the puzzle. puzzle.solve(); &#125;&#125; 输出结果： Enter a valid 8-puzzle below:2 8 31 6 47 0 5Here are the steps to the goal state: 2 8 31 6 47 5 2 8 31 47 6 5 2 31 8 47 6 5 2 31 8 47 6 5 1 2 3 8 47 6 5 1 2 38 47 6 5 Given puzzle is SOLVED!Solution took 2ms and 5 steps. 总结上面只是简单的阐述了算法的实现思路，具体的算法代码可以从这里下载：点击这里 需要特别说明的是并不是所有的3×3的棋盘都能移动，因为需要在移动之前进行判断。 声明本文30%为翻译组合,70%为原创 引用http://www.cnblogs.com/guanghe/p/5485816.htmlhttps://zhidao.baidu.com/question/195914427.htmlhttps://github.com/caseyscarborough/puzzle]]></content>
      <categories>
        <category>算法整理</category>
      </categories>
      <tags>
        <tag>算法整理</tag>
        <tag>八数码问题</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【算法整理】曼哈顿距离]]></title>
    <url>%2FManhattanDistance.html</url>
    <content type="text"><![CDATA[引言最近帮一个朋友看八数码算法，在读源码的时候无意看到这个新奇的概念，后来发现其应用领域还挺广泛如游戏中的地图，特地研究了一下，本文的目的就是阐述下什么是曼哈顿距离以及其相近的概念，最后用算法实现在数组中如何计算两者之间的曼哈顿距离 曼哈顿距离（出租车距离）是由十九世纪的赫尔曼·闵可夫斯基所创词汇 ，是种使用在几何度量空间的几何学用语，用以标明两个点在标准坐标系上的绝对轴距总和用以标明两个点在标准坐标系上的绝对轴距总和。下图中红线代表曼哈顿距离，绿色代表欧氏距离，也就是直线距离，而蓝色和黄色代表等价的曼哈顿距离。曼哈顿距离——两点在南北方向上的距离加上在东西方向上的距离，即d（i，j）=|xi-xj|+|yi-yj|。 对于一个具有正南正北、正东正西方向规则布局的城镇街道，从一点到达另一点的距离正是在南北方向上旅行的距离加上在东西方向上旅行的距离，因此，曼哈顿距离又称为出租车距离。 计算曼哈顿3$*$3的矩阵，即如下所示【A，B，C】【D，E，F】【G，H，I】如何计算A和I之间的曼哈顿举例呢? 首先将其放入到数组【A，B，C，D，E，F，G，H，I】中，其他的详见注释 12345678910111213141516171819202122232425262728293031323334353637383940414243/*** &lt;p&gt;Title: Test.java&lt;/p&gt;* &lt;p&gt;Description:一个计算曼哈顿距离的小程序 &lt;/p&gt;* &lt;p&gt;Copyright: Copyright (c) 2017&lt;/p&gt;* &lt;p&gt;Company: UOB&lt;/p&gt;* @author RuJia* @date 2016年12月28日* @version 1.0* 【A，B，C】 * 【D，E，F】 * 【G，H，I】*/public class Test &#123; public static void main(String[] args) &#123; String i[] = &#123;&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;&#125;; int s1 = getIndex(i,&quot;A&quot;); int s2 = getIndex(i,&quot;I&quot;); int m = getManhattanDistance(s1, s2); System.out.println(&quot;s1:&quot;+s1+&quot;----s2:&quot;+s2+&quot;-----m:&quot;+m); &#125; /** * 根据当前的值返回在数组中的索引，这里的位置信息从1开始计算 * @param array * @param value * @return */ public static int getIndex(String[] array, String value) &#123; for (int i = 0; i &lt; array.length; i++) if (array[i].equals(value)) return i+1; return -1; &#125; /** * 计算两点之间的曼哈顿,实际是在计算两者之间间隔的节点数 * @param satrt 起点 * @param end 终点 * @return */ public static int getManhattanDistance(int satrt, int end) &#123; return Math.abs((satrt / 3) - ((end-1) / 3)) + Math.abs((satrt % 3) - ((end-1) % 3)); &#125;&#125; 输出结果：s1:1—-s2:9—–m:3刚好A和I之间隔了三个节点，他们是DGH或者DEF或者BEH 总结本文简述了曼哈顿距离，并应用简单的代码实现了求解两点之间的哈夫曼举例。 声明本文20%为翻译组合,80%为原创 引用http://baike.baidu.com/link?url=gD-B1hbERwfSbqoz0r7ak6eu4Gu3eDVutRvuDRJxoNwT86NSWCVMoeiakF3y-jCDkGt5uTrhPthPXGxvL5BcHnuszx5sfYL2XsHunku1qqX4bwmtzr2EWZEu6tiXs3bf_3nEiMtuDaDhLHUYJUc5sK]]></content>
      <categories>
        <category>算法整理</category>
      </categories>
      <tags>
        <tag>曼哈顿距离</tag>
        <tag>算法整理</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】事件模型驱动编程]]></title>
    <url>%2FEventDrivingProgrammingModel.html</url>
    <content type="text"><![CDATA[引言事件驱动模型与普通的编程模式的不同主要体现在数据的流向上，普通的编程模式是A调用B，B调用C,在此过程中一直是单项流向，而且C发挥着被调用的角色，事件驱动编程着力改变这一现状，C中去含有A，B，然后将自身传入到A，B中，然后在适当是时候在回调C的其他方法，在作者看来其实和上篇的文章的观察者模式么有什么差别，下面通过一个例子来说明事件驱动编程在java中包含了3类对象：数据源，监听者，事件为了更好的解释事件驱动模型的例子，文中借鉴了计算机大牛Lộc Nguyễn的代码，地址详见引用。 ExampleNow, we are modeling a simple car object, which can fire a SpeedEvent. The listener is SpeedListener interface. Max speed is temporarily set to 60MPH, min speed 40, and the default 50 when the car starts driving on the highway. 如果没有事件对象这个传递者，其实这就是一个简化版的观察者模式的编程应用 123456789101112131415161718192021222324252627282930313233343536public class SpeedEvent&#123; private static final long serialVersionUID = 1L; private int maxSpeed; private int minSpeed; private int currentSpeed; public SpeedEvent(int maxSpeed,int minSpeed,int currentSpeed) &#123; this.maxSpeed = maxSpeed; this.minSpeed = minSpeed; this.currentSpeed = currentSpeed; &#125; public int getMaxSpeed() &#123; return maxSpeed; &#125; public void setMaxSpeed(int maxSpeed) &#123; this.maxSpeed = maxSpeed; &#125; public int getMinSpeed() &#123; return minSpeed; &#125; public void setMinSpeed(int minSpeed) &#123; this.minSpeed = minSpeed; &#125; public int getCurrentSpeed() &#123; return currentSpeed; &#125; public void setCurrentSpeed(int currentSpeed) &#123; this.currentSpeed = currentSpeed; &#125; &#125; Corresponding SpeedListener declares 2 handlers: 这不就是观察者模式中的那个观察者角色的抽象么。 1234public interface SpeedListener&#123; public void speedExceeded(SpeedEvent e); public void speedGoneBelow(SpeedEvent e);&#125; Come back to the Car, it maintains a list of SpeedListeners: 这个Car作为事件源，是不是和我们之前的被观察者特别相似，区别在于这是一个没有进一步抽象，而是直接作用于监听者，例如下面的例子，当汽车加速时候去通知循环通知所有的listener，然后listener根据做出相应的hander事件，从观察者的模式看其实就是通知各个观察者，然后进行update操作 This processSpeedEvent(SpeedEvent e) method is to be executed when the SpeedEvent is fired. It calls each handler of each SpeedListener object in the speedListenerList, to notify and do something about that event. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class Car &#123; private int maxSpeed; private int minSpeed; private int currentSpeed; ArrayList&lt;SpeedListener&gt; speedListenerList = new ArrayList&lt;SpeedListener&gt;(); // Register an event listener public synchronized void addSpeedListener(SpeedListener listener) &#123; if (!speedListenerList.contains(listener)) &#123; speedListenerList.add(listener); &#125; &#125; public Car(int maxSpeed, int minSpeed, int currentSpeed) &#123; super(); this.maxSpeed = maxSpeed; this.minSpeed = minSpeed; this.currentSpeed = currentSpeed; &#125; public void speedUp(int increment) &#123; this.currentSpeed += increment; if (this.currentSpeed &gt; this.maxSpeed) &#123; // fire SpeedEvent // processSpeedEvent(new SpeedEvent(this, this.maxSpeed, this.minSpeed, this.currentSpeed)); // When SpeedEvent does not extend java.util.EventObject processSpeedEvent(new SpeedEvent(this.maxSpeed, this.minSpeed, this.currentSpeed)); &#125; &#125; public void slowDown(int increment) &#123; this.currentSpeed -= increment; if (this.currentSpeed &lt; this.minSpeed) &#123; // fire SpeedEvent // processSpeedEvent(new SpeedEvent(this, this.maxSpeed, this.minSpeed, this.currentSpeed)); // When SpeedEvent does not extend java.util.EventObject processSpeedEvent(new SpeedEvent(this.maxSpeed, this.minSpeed, this.currentSpeed)); &#125; &#125; private void processSpeedEvent(SpeedEvent speedEvent) &#123; ArrayList&lt;SpeedListener&gt; tempSpeedListenerList; synchronized (this) &#123; if (speedListenerList.size() == 0) &#123; return; &#125; tempSpeedListenerList = (ArrayList&lt;SpeedListener&gt;) speedListenerList.clone(); &#125; for (SpeedListener listener : tempSpeedListenerList) &#123; listener.speedExceeded(speedEvent); listener.speedGoneBelow(speedEvent); &#125; &#125;&#125; That we has created and fired the event, and delegated to the listener to process the event. It’s up to the client code to implement the concrete handler(s).Here we have two handers with differnt implementation. Hander one: 12345678910111213141516public class MySpeedListener implements SpeedListener&#123; @Override public void speedExceeded(SpeedEvent e) &#123; if (e.getCurrentSpeed() &gt; e.getMaxSpeed()) &#123; System.out.println(&quot;Alert! You have exceeded &quot; + (e.getCurrentSpeed() - e.getMaxSpeed() + &quot; MPH!&quot;)); &#125; &#125; @Override public void speedGoneBelow(SpeedEvent e) &#123; if (e.getCurrentSpeed() &lt; e.getMinSpeed()) &#123; System.out.println(&quot;Uhm... you are driving &quot; + e.getCurrentSpeed() + &quot; MPH. Speed up!&quot;); &#125; &#125;&#125; Hander two:123456789101112131415public class MySpeedListener1 implements SpeedListener&#123; @Override public void speedExceeded(SpeedEvent e) &#123; if (e.getCurrentSpeed() &gt; e.getMaxSpeed()) &#123; System.out.println(&quot;警告! 您已经超过 &quot; + (e.getCurrentSpeed() - e.getMaxSpeed() + &quot; 公里/小时&quot;)); &#125; &#125; @Override public void speedGoneBelow(SpeedEvent e) &#123; if (e.getCurrentSpeed() &lt; e.getMinSpeed()) &#123; System.out.println(&quot;您现在的时速是 &quot; + e.getCurrentSpeed() + &quot; 公里没小时. 请提速&quot;); &#125; &#125;&#125; Write a test case:1234567891011121314151617public class Test &#123; public static void main(String[] args) &#123; Car myCar = new Car(60, 40, 50); SpeedListener listener = new MySpeedListener(); SpeedListener listener1 = new MySpeedListener1(); myCar.addSpeedListener(listener); myCar.addSpeedListener(listener1); // Add more listeners if you want myCar.speedUp(50); // fires SpeedEvent myCar.speedUp(50); // fires SpeedEvent myCar.slowDown(70); myCar.slowDown(70); // fires SpeedEvent &#125;&#125; Result output will be:Alert! You have exceeded 40 MPH!警告! 您已经超过 40 公里/小时Alert! You have exceeded 90 MPH!警告! 您已经超过 90 公里/小时Uhm… you are driving 10 MPH. Speed up!您现在的时速是 10 公里没小时. 请提速 总结本文总结了java的事件驱动编程模型，抛去事件本身，其实就是一个观察者模型的应用，最后，源码地址：点击这里 声明本文50%为翻译组合,50%为原创 引用https://www.codeproject.com/articles/677591/defining-custom-source-event-listener-in-java]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>编程语言</tag>
        <tag>事件驱动</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】ThreadPoolExecutor – Java Thread Pool Example]]></title>
    <url>%2FThreadPoolExecutor.html</url>
    <content type="text"><![CDATA[Introduction最近在读源码，俨然已经陷入了java的漩涡，我本意真心是在学习比特流的协议，奈何java基础实在太差劲，也只能摸着石头过河了，好了今天我们来聊聊线程池。 java的线程池是用来管理线程的，他包含了一个等待执行的队列，我们可以用ThreadPoolExecutor去创建线程池 神马！你也没有告诉我你要用英语讲~~~ 这里有能看懂的源码：点击我 Java thread poolJava thread pool manages the collection of Runnable threads and worker threads execute Runnable from the queue. java.util.concurrent.Executors provide implementation of java.util.concurrent.Executor interface to create the thread pool in java. ExecutorService ExampleLet’s write a simple program to explain it’s working.First we need to have a Runnable class, named WorkerThread.java 1234567891011121314151617181920212223242526public class WorkerThread implements Runnable &#123; private String command; public WorkerThread(String s)&#123; this.command=s; &#125; @Override public void run() &#123; System.out.println(Thread.currentThread().getName()+&quot; Start. Command = &quot;+command); processCommand(); System.out.println(Thread.currentThread().getName()+&quot; End.&quot;); &#125; private void processCommand() &#123; try &#123; Thread.sleep(5000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; @Override public String toString()&#123; return this.command; &#125;&#125; Here is the test program class SimpleThreadPool.java, where we are creating fixed thread pool from Executors framework. 12345678910111213141516import java.util.concurrent.ExecutorService;import java.util.concurrent.Executors;public class SimpleThreadPool &#123; public static void main(String[] args) &#123; ExecutorService executor = Executors.newFixedThreadPool(5); for (int i = 0; i &lt; 10; i++) &#123; Runnable worker = new WorkerThread(&quot;&quot; + i); executor.execute(worker); &#125; executor.shutdown(); while (!executor.isTerminated()) &#123; &#125; System.out.println(&quot;Finished all threads&quot;); &#125;&#125; In above progame, we are creating fixed thread pool of 5 worker threads. Then we are submitting 10 jobs to this pool, since the pool size is 5, it will start working on 5 jobs and other jobs will be in wait state, as soon as one of the job is finished, another job from the wait queue will be picked by worker thread and get’s executed. Here is the output of the above program.pool-1-thread-1 Start. Command = 0pool-1-thread-4 Start. Command = 3pool-1-thread-3 Start. Command = 2pool-1-thread-2 Start. Command = 1pool-1-thread-5 Start. Command = 4pool-1-thread-4 End.pool-1-thread-2 End.pool-1-thread-4 Start. Command = 5pool-1-thread-3 End.pool-1-thread-1 End.pool-1-thread-3 Start. Command = 7pool-1-thread-5 End.pool-1-thread-5 Start. Command = 9pool-1-thread-1 Start. Command = 8pool-1-thread-2 Start. Command = 6pool-1-thread-5 End.pool-1-thread-4 End.pool-1-thread-3 End.pool-1-thread-1 End.pool-1-thread-2 End.Finished all threads The output confirms that there are five threads in the pool named from “pool -1 1 thread -1” to “pool -1 1 thread -5” and they are respnsible to execute the submitted tasks to the pool. ThreadPoolExecutor ExampleExecuteors class provide implimentation of Excutor Service using ThreadPooolExcutor but ThreadPoolExecutor provides much more feature than that. We can specify the number of threads that will be alive when create ThreadPoolExecutor instance and we can limit the size of thread pool and create our own RejectedExecutionHandler implementation to handle the jobs that can’t fit in the work queue. Here is the our custom implementation of RejectedExecutionHandle interface.123456public class RejectedExecutionHandlerImpl implements RejectedExecutionHandler &#123; @Override public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) &#123; System.out.println(r.toString()+&quot;is rejected&quot;); &#125;&#125; ThreadPoolExecutor provides several methods using which we can find out the current state of executor,pool size,active thread count and task count. So I have a monitor thread that will print the executor information at certain time interval. 1234567891011121314151617181920212223242526272829303132333435public class MyMonitorThread implements Runnable&#123; private ThreadPoolExecutor executor; private int seconds; private boolean run = true; public MyMonitorThread(ThreadPoolExecutor executor,int seconds) &#123; this.executor = executor; this.seconds = seconds; &#125; public void shutdown()&#123; this.run = false; &#125; @Override public void run() &#123; while(run)&#123; System.out.println( String.format(&quot;[monitor] [%d/%d] Active: %d, Completed: %d, Task: %d, isShutdown: %s, isTerminated: %s&quot;, this.executor.getPoolSize(), this.executor.getCorePoolSize(), this.executor.getActiveCount(), this.executor.getCompletedTaskCount(), this.executor.getTaskCount(), this.executor.isShutdown(), this.executor.isTerminated())); try &#123; Thread.sleep(seconds*1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;&#125; Here is the thread pool implementation example using ThreadPoolExecutor. 123456789101112131415161718192021222324public class WorkerPool &#123; public static void main(String[] args) throws InterruptedException &#123; RejectedExecutionHandlerImpl rejectHander = new RejectedExecutionHandlerImpl(); ThreadFactory threadfactory = Executors.defaultThreadFactory(); ThreadPoolExecutor executerPool = new ThreadPoolExecutor(2, 4, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;Runnable&gt;(2),threadfactory,rejectHander); //start the monitoring thread MyMonitorThread monitor = new MyMonitorThread(executerPool, 3); Thread monitorthread = new Thread(monitor); monitorthread.start(); //submit work to the thread pool for(int i=0;i&lt;10;i++)&#123; executerPool.execute(new WorkerThread(&quot;cmd&quot;+i)); &#125; Thread.sleep(30000); //shut down the pool executerPool.shutdown(); //shut down the monitor thread Thread.sleep(5000); monitor.shutdown(); &#125;&#125; Notice that while initializing the ThreadPoolExecutor, we are keeping initial pool size as 2, maximum pool size to 4 and work queue size as 2. So if there are 4 running tasks and more tasks are submitted, the work queue will hold only 2 of them and rest of them will be handled by RejectedExecutionHandlerImpl. Here is the output of above program that confirms above statement. pool-1-thread-1 Start. Command = cmd0pool-1-thread-3 Start. Command = cmd4pool-1-thread-2 Start. Command = cmd1pool-1-thread-4 Start. Command = cmd5cmd6is rejectedcmd7is rejectedcmd8is rejectedcmd9is rejected[monitor] [0/2] Active: 4, Completed: 0, Task: 6, isShutdown: false, isTerminated: false[monitor] [4/2] Active: 4, Completed: 0, Task: 6, isShutdown: false, isTerminated: falsepool-1-thread-4 End.pool-1-thread-3 End.pool-1-thread-1 End.pool-1-thread-2 End.pool-1-thread-3 Start. Command = cmd3pool-1-thread-4 Start. Command = cmd2[monitor] [4/2] Active: 2, Completed: 4, Task: 6, isShutdown: false, isTerminated: false[monitor] [4/2] Active: 2, Completed: 4, Task: 6, isShutdown: false, isTerminated: falsepool-1-thread-3 End.pool-1-thread-4 End.[monitor] [4/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [2/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [2/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [0/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [0/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [0/2] Active: 0, Completed: 6, Task: 6, isShutdown: false, isTerminated: false[monitor] [0/2] Active: 0, Completed: 6, Task: 6, isShutdown: true, isTerminated: true[monitor] [0/2] Active: 0, Completed: 6, Task: 6, isShutdown: true, isTerminated: true Notice the change in active, completed and total completed task count of the executor. We can invoke shutdown() method to finish execution of all the submitted tasks and terminate the thread pool. DeclarationThe author has to say this article is not original, the reference is bellow. Referencehttp://www.journaldev.com/1069/threadpoolexecutor-java-thread-pool-example-executorservice]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>编程语言</tag>
        <tag>java</tag>
        <tag>ThreadPoolExecutor</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【文学艺术】船 ——白桦]]></title>
    <url>%2Fboat.html</url>
    <content type="text"><![CDATA[引言最近听了王德顺的演讲，感觉最后的主体诗歌非常棒，这首诗是33年前伟大诗人白桦所做，名字叫《船》，他把自己的一生比作船，历经坎坷，我们从这首诗中去感受我们应该如何对待自己的人生，如何对待自己的命运。 正文我有过多次这样的奇遇，从天堂到地狱只在瞬息之间；每一朵可爱、温柔的浪花，都成了突然崛起、随即倾倒的高山。 每一滴海水都变脸变色，刚刚还是那样美丽、蔚蓝；旋涡纠缠着旋涡，我被抛向高空又投进深渊…… 当时我甚至想到过轻生，眼前一片苦海无边；放弃了希望就象放弃了舵柄，在暴力之下只能沉默和哀叹。 今天我才有资格嘲笑昨天的自己，为昨天落叶似的惶恐感到羞惭；虚度了多少年华，船身多次被礁石撞穿…… 千万次在大洋里撒网，才捕获到一点点生活的经验，才恍然大悟，啊！道理原是如此浅显： 你要航行吗？必然会有千妖百怪出来阻拦；暴虐的欺凌是它们的游戏，制造灭亡是它们唯一的才干。 命中注定我要常常和它们相逢，因为我的名字叫做船；面对强大于自身千万倍的对手，能援救自己的只有清醒和勇敢。 恐惧只能使自己盲目，盲目只能夸大魔鬼的狰狞嘴脸；也许我的样子比它们更可怕，当我以生命相拼，一往无前！ 只要我还有一根完整的龙骨，绝不驶进避风的港湾；把生命放在征途上，让勇敢来决定道路的宽窄、长短。 我完完全全的自由了，船头成为埋葬它们的铁铲；我在波浪中有节奏地跳跃，就象荡着一个巨大的秋千。 即使它们终于把我撕碎，变成一些残破的木片；我不会沉沦，决不！我还会在浪尖上飞旋。 后来者还会在残片上认出我，未来的诗人会喟然长叹：“这里有一个幸福的灵魂，它曾经是一艘前进着的航船……” The Ship -Bai Hua I have time after time experienced such an adventure:From heaven to hell needs only a twinkling of eyes;Each lovable and tender spray,Becomes in an instant a high peak on the collapsing. Each drop of seawater turns hostile and changes hue;In spite of its blueness and loveliness a moment ago.Vortices are entangling upon vortices;I am heaved heavenward and flung into an abyss ¼ When the idea of commiting suicide hits me,Before my eyes is a vast expanse of bitter sea;To abandon hope is like abandoning the tiller,And one has to save one’s breath and bewail under violence. Only today I am entitled to mock the me myself of yore,And I am ashamed of the falling-leaf-like terror of yesterday;How many years are fooled away,And the hull of the ship is broken by the reef time and again. Not until the net is cast for myriads of times in the ocean,Do we capture a scantling of life experience,And it dawns on us: Oh! The reason behind is so simple and easy: Do you intend to take a voyage?Thousands of monsters are lying in wait to discourage;Tyrannous bullying is their game,And their sole ability is to bring destruction. I am destined to come across them from time to time,Because my name is ship;Facing the antagonist who is thousands of times more powerful than myself,Only sobriety and bravery can save me. Trepidation only renders a person blind,And blindness only magnifies the ferocious features of the demons;Perhaps my appearance is more frightful than them,When I go all out at the cost of my life, pressing forward! So long as I have kept one intact keel,I will never sail into a safe harbour;I place my life on the journey,And the width and length of the road will be determined by courage. When I am completely free,The prow becomes a shovel with which to bury them;In the waves I am dancing rhythmically,Like swaying a huge swing. Even if they tear me up,Into some broken pieces,I will never sink into depravity, never!I can also wheel on the spray. The late comer can recognize me on the remains,And the future poet will sigh a deep sigh:“There is a happy soul here,Which has ever been a ship on the sailing; 总结船体现了一个伟大诗人的胸怀！ 声明本文100%为翻译组合,0%为原创，版权归诗人白桦所有 引用http://blog.sina.com.cn/s/blog_8f5bacc70100v7oq.html]]></content>
      <categories>
        <category>文学艺术</category>
      </categories>
      <tags>
        <tag>文学艺术</tag>
        <tag>船</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计模式-观察者模式]]></title>
    <url>%2FObserver.html</url>
    <content type="text"><![CDATA[引言java的设计模式之观察者模式，因为最近读BitTorrent的源码，因为其中用到了java的观察者模式，因此特整理复习一下，观察者模式简单点讲就是允许一个对象去观察其他的对象的活动，观察者与被观察者之间是一种订阅的关系。 观察者模式观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态上发生变化时，会通知所有观察者对象，让它们能够自动更新自己。 抽象主题角色:把所有对观察者对象的引用保存在一个集合中，每个抽象主题角色都可以有任意数量的观察者。抽象主题提供一个接口，可以增加和删除观察者角色。一般用一个抽象类和接口来实现。 抽象观察者角色：为所有具体的观察者定义一个接口，在得到主题的通知时更新自己。 具体主题角色：在具体主题内部状态改变时，给所有登记过的观察者发出通知。具体主题角色通常用一个子类实现。 具体观察者角色：该角色实现抽象观察者角色所要求的更新接口，以便使本身的状态与主题的状态相协调。通常用一个子类实现。如果需要，具体观察者角色可以保存一个指向具体主题角色的引用。 吐槽：真正的布道者就应该把知识尽量简化,每次看上面的东西都一脸懵逼，简单的知识用学术的语言一解释，然后大家都不懂了，都不明白这群人实在装逼还是在分享，最后知识是用来解决问题的！！！，下面从问题开始说起 观察者模式就是一种订阅模式，对象A有两种行为模式，如何会学习和会运动，对象B，C，D 就是想知道A从事这些活动的时候告知他们一下，仅此而已。在上面A扮演了被观察者，B,C，D扮演了观察者的角色。首先解决A的问题，对象A有自己的属性，有自己的方法，如下所示：1234567891011public class ObjectA &#123; private int i; // 私有属性 public void doStudy()&#123; //会学习 System.out.println(&quot;A is studying&quot;); &#125; public void doSport()&#123; //会运动 System.out.println(&quot;A is doing sport&quot;); &#125;&#125; 对象A想告诉B，C，D，那么至少A中有一个方法是干这个事情的，直接将告知B,C,D这个事情抽象成一个方法，那么就是这样的 123456789101112131415161718192021222324public class ObjectA &#123; ObjectB Objectb; //需要通知的对象 ObjectC Objectc; //需要通知的对象 ObjectD Objectd; //需要通知的对象 private int i; // 私有属性 public void doStudy()&#123; //会学习 System.out.println(&quot;A is studying&quot;); notifyObserver(); //告诉其他人我学习，弄得自己很爱学习似的 &#125; public void doSport()&#123; //会运动 System.out.println(&quot;A is doing sport&quot;); notifyObserver();//告诉其他人我运动了，掩饰自己不是胖子 &#125; protected void notifyObserver()&#123; Objectb.update(); //告知B Objectc.update(); //告知C Objectd.update(); //告知D &#125;&#125; 看似上面的东西已经实现了我们当初的功能，但是过于简单不够通用化，我们设想一种场景，假设我们需要通知对象E，那么我们势必需要姚调整上面的代码，我们能不能保存一个通知列表，然后直接维护这个通知列表，看似是可行的，还有一个问题，通知列表中假设我们用List对象，那么List中应该保存何种对象呢，我们可以找出素有的对象的公共特性，貌似所有对象都继承了Object12345678910111213141516171819202122232425262728293031323334public class ObjectA &#123; private List&lt;Object&gt; watcherObjectist = new ArrayList&lt;Object&gt;(); //需要通知的对象列表 //维护这个列表的方法，新增观察者（通知对象） public void addWatcher(Object watcher)&#123; watcherObjectist.add(watcher); &#125; //维护这个列表的方法，删除观察者（通知对象） public void removeWatcher(Object watcher)&#123; watcherObjectist.remove(watcher); &#125; private int i; // 私有属性 public void doStudy()&#123; //会学习 System.out.println(&quot;A is studying&quot;); notifyObserver(); //告诉其他人我学习，弄得自己很爱学习似的 &#125; public void doSport()&#123; //会运动 System.out.println(&quot;A is doing sport&quot;); notifyObserver();//告诉其他人我运动了，掩饰自己不是胖子 &#125; protected void notifyObserver()&#123; for(Object l: watcherObjectist)&#123; //经过判断决定通知哪一个 //((ObjectB)l).update(); //((ObjectC)l).update(); //((ObjectD)l).update(); &#125; &#125;&#125; 到目前为止，已经具备了一个观察者应该有的功能，但是还是有不完美之处，比如在最后通知的时候还要分别去判断各个对象然后一一通知，如果我们将所有的观察者抽象出一个接口，可能有人会问为什么不是抽象成父类，因为父类破坏了原有对象的结构，所谓的父类一定是一类，然后我们接受者并不一定是一类，所有在这里抽象成接口最为合适，接口中定义了观察者受到消息应该处理的方法，具体的方法在每个观察者中去实现，这样会更加灵活，因为每个观察者接收到消息后处理的方式可能不同，因为将以上代码变如何变更。1.增加观察者B，C，D的抽象类123public interface ImplWatcher &#123; public void update();&#125; 2.每个观察者实现这个接口，当然实现凡是可以不同123456789101112131415161718public class ObjectB implements ImplWatcher &#123; @Override public void update() &#123; System.out.println(&quot;ObjectB被通知&quot;); &#125;&#125;public class ObjectC implements ImplWatcher &#123; @Override public void update()&#123; System.out.println(&quot;ObjectC被通知&quot;); &#125;&#125;public class ObjectD implements ImplWatcher &#123; @Override public void update()&#123; System.out.println(&quot;ObjectD被通知&quot;); &#125;&#125; 2.在原来的方法中直接执行接口中的方法，最后一部分抽象如下：12345protected void notifyObserver()&#123; for(ImplWatcher l: watcherObjectist)&#123; l.update(); &#125; &#125; 到这一步已经接近完美了，但是依然还有另外一个没有提及的问题，那就是如果有多个被观察者A1，A2，A3，上面的代码能否重用，答案是肯定的，我只需将上面的A进行抽象，将A中的操作观察者列表的部分抽象成接口，至于为什么是接口而不是父类，我上面已经提及，因此更改之后的代码，可以调整为如下：12345678public interface ImplWatched &#123; //维护这个列表的方法，新增观察者（通知对象） public void addWatcher(ImplWatcher watcher); //维护这个列表的方法，删除观察者（通知对象） public void removeWatcher(ImplWatcher watcher); //通知事件 public void notifyObserver();&#125; 1234567891011121314151617181920212223242526272829303132333435public class ObjectA implements ImplWatched &#123; private List&lt;ImplWatcher&gt; watcherObjectist = new ArrayList&lt;ImplWatcher&gt;(); //需要通知的对象列表 //维护这个列表的方法，新增观察者（通知对象） @Override public void addWatcher(ImplWatcher watcher)&#123; watcherObjectist.add(watcher); &#125; //维护这个列表的方法，删除观察者（通知对象） @Override public void removeWatcher(ImplWatcher watcher)&#123; watcherObjectist.remove(watcher); &#125; private int i; // 私有属性 public void doStudy()&#123; //会学习 System.out.println(&quot;A is studying&quot;); notifyObserver(); //告诉其他人我学习，弄得自己很爱学习似的 &#125; public void doSport()&#123; //会运动 System.out.println(&quot;A is doing sport&quot;); notifyObserver();//告诉其他人我运动了，掩饰自己不是胖子 &#125; @Override public void notifyObserver()&#123; for(ImplWatcher l: watcherObjectist)&#123; l.update(); &#125; &#125;&#125; 到这里就演绎完了整个观察者模式的全过程。最后写个测试类，测试一下123456789public class Test &#123; public static void main(String[] args) &#123; ObjectA oa = new ObjectA(); oa.addWatcher(new ObjectB()); //添加观察者 oa.addWatcher(new ObjectC()); //添加观察者 oa.addWatcher(new ObjectD()); //添加观察者 oa.doSport(); &#125;&#125; 结果输出：A is doing sportObjectB被通知ObjectC被通知ObjectD被通知 JDK自带的观察者类Observer和Observablejava的jdk中提供了Observer和Observable可供直接调用，具体用法如下：被观察者1234567public class ObjectF extends Observable&#123; public void doSomething()&#123; System.out.println(&quot;I am doing something&quot;); setChanged(); notifyObservers(); &#125;&#125; 观察者123456public class ObjectE implements Observer&#123; @Override public void update(Observable o, Object arg) &#123; System.out.println(&quot;观察者ObjectE 接收到了来自ObjectF的广播消息&quot;); &#125;&#125; 测试类1234567public class Test &#123; public static void main(String[] args) &#123; ObjectF of = new ObjectF(); of.addObserver(new ObjectE()); of.doSomething(); &#125;&#125; 输出结果I am doing something观察者ObjectE 接收到了来自ObjectF的广播消息 总结本文总结了原生态的观察者模式和java自带的观察者模式，最后总结一句话，就是拿着父类的指针到处传，这里的父类指的就是分发通知列表。 声明本文30%为翻译组合,70%为原创 引用http://www.javamex.com/tutorials/threads/context_switch.shtmlhttp://bbs.csdn.net/topics/190140872http://www.java2s.com/Code/Java/Design-Pattern/AsimpledemoofObservableandObserver.htm]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>编程语言</tag>
        <tag>设计模式</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】java的线程的实现方式]]></title>
    <url>%2FThread.html</url>
    <content type="text"><![CDATA[引言刚刚从Grove Park公园回来，心情还不错，准备整理一下java线程的实现方式（虽然我已经没有以前那么信仰java了），主要还是为了读区块链的java源码做知识准备。Java多线程实现方式主要有三种：继承Thread类、实现Runnable接口、使用ExecutorService、Callable、Future实现有返回结果的多线程。其中前两种方式线程执行完后都没有返回值，只有最后一种是带返回值的。 继承Thread类启动线程的唯一方法就是通过Thread类的start()实例方法。start()方法是一个native方法，它将启动一个新线程，并执行run()方法。这种方式实现多线程很简单，通过自己的类直接extend Thread，并复写run()方法，就可以启动新线程并执行自己定义的run()方法。例如：1234567891011public class MyThread extends Thread &#123; public void run() &#123; System.out.println(&quot;MyThread.run()&quot;); &#125; &#125; public static void main(String[] args)&#123; MyThread myThread1 = new MyThread(); MyThread myThread2 = new MyThread(); myThread1.start(); myThread2.start(); &#125; Thread本质上也是实现了Runnable接口的一个实例，每次看到下面的写法就一脸懵逼，为什么已经是线程了里面还有传一个Runnable，其实Thread本身是不干活的，说白了他也实现了Runnable1234567new Thread(new Runnable() &#123; @Override public void run() &#123; System.out.println(&quot;test&quot;); &#125; &#125;); 分析下面的Thread的源码12345678public Thread(Runnable target) &#123; init(null, target, &quot;Thread-&quot; + nextThreadNum(), 0);&#125;public void run() &#123; if (target != null) &#123; target.run(); &#125; &#125; a. 如果子类覆盖了run()方法，则调用子类的run()b. 如果a不成立： b1. 指定了target，则调用target的run() b2. 没有指定target，该方法不做任何事并返回 实现Runnable接口方式实现一个Runnable接口好处是自身类的属性不受污染，因为java的单继承的原因，一旦继承了Thread，你将丧失集成其他类的能力,从面向对象的角度讲，实现Runnable接口更具有优越性12345678910public class MyThread extends OtherClass implements Runnable &#123; public void run() &#123; System.out.println(&quot;MyThread.run()&quot;); &#125; &#125; public static void main(String[] args)&#123; MyThread myThread = new MyThread(); Thread thread = new Thread(myThread); thread.start(); &#125; 使用Executor框架下面代码中Executors类，提供了一系列工厂方法用于创先线程池，返回的线程池都实现了ExecutorService接口。public static ExecutorService newFixedThreadPool(int nThreads)创建固定数目线程的线程池。public static ExecutorService newCachedThreadPool()创建一个可缓存的线程池，调用execute 将重用以前构造的线程（如果线程可用）。如果现有线程没有可用的，则创建一个新线程并添加到池中。终止并从缓存中移除那些已有 60 秒钟未被使用的线程。public static ExecutorService newSingleThreadExecutor()创建一个单线程化的Executor。public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize)创建一个支持定时及周期性的任务执行的线程池，多数情况下可用来替代Timer类。ExecutoreService提供了submit()方法，传递一个Callable，或Runnable，返回Future。如果Executor后台线程池还没有完成Callable的计算，这调用返回Future对象的get()方法，会阻塞直到计算完成。此部分代码版权归wb_qiuquan.ying所有12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849public class Test &#123;public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;----程序开始运行----&quot;); Date date1 = new Date(); int taskSize = 5; // 创建一个线程池 ExecutorService pool = Executors.newFixedThreadPool(taskSize); // 创建多个有返回值的任务 List&lt;Future&gt; list = new ArrayList&lt;Future&gt;(); for (int i = 0; i &lt; taskSize; i++) &#123; Callable c = new MyCallable(i + &quot; &quot;); // 执行任务并获取Future对象 Future f = pool.submit(c); // System.out.println(&quot;&gt;&gt;&gt;&quot; + f.get().toString()); list.add(f); &#125; // 关闭线程池 pool.shutdown(); // 获取所有并发任务的运行结果 for (Future f : list) &#123; // 从Future对象上获取任务的返回值，并输出到控制台 System.out.println(&quot;&gt;&gt;&gt;&quot; + f.get().toString()); &#125; Date date2 = new Date(); System.out.println(&quot;----程序结束运行----，程序运行时间【&quot; + (date2.getTime() - date1.getTime()) + &quot;毫秒】&quot;);&#125;&#125;class MyCallable implements Callable&lt;Object&gt; &#123;private String taskNum;MyCallable(String taskNum) &#123; this.taskNum = taskNum;&#125;public Object call() throws Exception &#123; System.out.println(&quot;&gt;&gt;&gt;&quot; + taskNum + &quot;任务启动&quot;); Date dateTmp1 = new Date(); Thread.sleep(1000); Date dateTmp2 = new Date(); long time = dateTmp2.getTime() - dateTmp1.getTime(); System.out.println(&quot;&gt;&gt;&gt;&quot; + taskNum + &quot;任务终止&quot;); return taskNum + &quot;任务返回运行结果,当前任务时间【&quot; + time + &quot;毫秒】&quot;;&#125;&#125; 总结本文总结了线程的实现方式，源码位置：点击这里 声明本文80%为翻译组合,20%为原创 引用http://blog.csdn.net/aboy123/article/details/38307539/]]></content>
      <categories>
        <category>编程语言，java</category>
      </categories>
      <tags>
        <tag>编程语言</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】java的线程是如何工作的（How threads work？)]]></title>
    <url>%2FThreadWork.html</url>
    <content type="text"><![CDATA[引言上一篇的文章中我们简单介绍了线程是如何实现的，在本文中我们重点探讨线程是如何工作的。 继承Thread类 总结本文总结了线程的实现方式 声明本文80%为翻译组合,20%为原创 引用http://www.javamex.com/tutorials/threads/context_switch.shtml]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>编程语言，java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Runtime.getRuntime().addShutdownHook（Thread hook）学习]]></title>
    <url>%2FRuntime.html</url>
    <content type="text"><![CDATA[引言最近在研究比特流的源码，看到Runtime.getRuntime().addShutdownHook（Thread hook）时，发现全然不知所云，速查之，特总结如下。 何时调用The Java virtual machine shuts down in response to two kinds of events: The program exits normally, when the last non-daemon thread exits or when the exit (equivalently, System.exit) method is invoked, orThe virtual machine is terminated in response to a user interrupt, such as typing ^C, or a system-wide event, such as user logoff or system shutdown. Thus, a shutdown hook is a initialized and unstarted thread that gets executed when a JVM shutdown occurs. 示例代码123456789101112131415161718192021222324public class MainClass &#123; public static void main(String args[])&#123; Runtime.getRuntime().addShutdownHook(new Thread(new ShutDownHook())); System.out.println(&quot;Shutdown hook registered&quot;); System.out.println(&quot;Before calling exit&quot;); System.exit(0); System.out.println(&quot;After exit&quot;); &#125; &#125; class ShutDownHook implements Runnable&#123; public void run() &#123; System.out.println(&quot;Inside Shutdown hook&quot;); System.out.println(&quot;Shutdown hook thread sleeping for 2 seconds&quot;); try &#123; Thread.sleep(2000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(&quot;Shutdown hook thread waking up&quot;); System.out.println(&quot;Shutdown hook thread terminating&quot;); &#125;&#125; 代码输出： Shutdown hook registeredBefore calling exitInside Shutdown hookShutdown hook thread sleeping for 2 secondsShutdown hook thread waking upShutdown hook thread terminating 1234567891011121314151617181920public class MainClass &#123; public static void main(String[] args) throws Exception &#123; Object f = new Object() &#123; public void finalize() &#123; System.out.println(&quot;Running finalize()&quot;); &#125; &#125;; Runtime.getRuntime().addShutdownHook(new Thread() &#123; public void run() &#123; System.out.println(&quot;Running Shutdown Hook&quot;); &#125; &#125;); f = null; System.gc(); System.out.println(&quot;Calling System.exit()&quot;); System.exit(0); &#125;&#125; 代码输出：Calling System.exit()Running finalize()Running Shutdown Hook 总结：总是在虚拟机关闭之前调用 使用场景 your program had created many temporary files in filesystem you want to delete it; you need to send a distress signal to another process/machine before terminating; execute any clean-up actions, logging or after-error actions on unexpected behaviours. 声明本文70%为翻译组合,30%为原创 引用http://stackoverflow.com/questions/8722826/when-do-i-need-to-call-this-method-runtime-getruntime-addshutdownhook]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>编程语言</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【数据库知识】MySQL英文文档翻译-16.0 复制配置]]></title>
    <url>%2FMysql_Replication.html</url>
    <content type="text"><![CDATA[引言最近加入了一个MySQL的开源组织，旨在将MySQL的英文官网文档翻译成中文，下面的内容为我负责的部分，因水平有限，在翻译过程中难免有纰漏，还请读者多多指教。 原文17.1 Replication Configuration 17.1.1 How to Set Up Replication17.1.2 Replication Formats17.1.3 Replication with Global Transaction Identifiers17.1.4 Replication and Binary Logging Options and Variables17.1.5 Common Replication Administration Tasks Replication between servers in MySQL is based on the binary logging mechanism. The MySQL instance operating as the master (the source of the database changes) writes updates and changes as “events” to the binary log. The information in the binary log is stored in different logging formats according to the database changes being recorded. Slaves are configured to read the binary log from the master and to execute the events in the binary log on the slave’s local database. ImportantYou cannot configure the master to log only certain events. The master is “dumb” in this scenario. Once binary logging has been enabled, all statements are recorded in the binary log. Each slave receives a copy of the entire contents of the binary log. It is the responsibility of the slave to decide which statements in the binary log should be executed; you cannot configure the master to log only certain events. If you do not specify otherwise, all events in the master binary log are executed on the slave. If required, you can configure the slave to process only events that apply to particular databases or tables. Each slave keeps a record of the binary log coordinates: The file name and position within the file that it has read and processed from the master. This means that multiple slaves can be connected to the master and executing different parts of the same binary log. Because the slaves control this process, individual slaves can be connected and disconnected from the server without affecting the master’s operation. Also, because each slave records the current position within the binary log, it is possible for slaves to be disconnected, reconnect and then resume processing. The master and each slave must be configured with a unique ID (using the server-id option). In addition, each slave must be configured with information about the master host name, log file name, and position within that file. These details can be controlled from within a MySQL session using the CHANGE MASTER TO statement on the slave. The details are stored within the slave’s master info repository, which can be either a file or a table (see Section 17.2.2, “Replication Relay and Status Logs”). This section describes the setup and configuration required for a replication environment, including step-by-step instructions for creating a new replication environment. The major components of this section are: For a guide to setting up two or more servers for replication, Section 17.1.1, “How to Set Up Replication”, deals with the configuration of the systems and provides methods for copying data between the master and slaves. Events in the binary log are recorded using a number of formats. These are referred to as statement-based replication (SBR) or row-based replication (RBR). A third type, mixed-format replication (MIXED), uses SBR or RBR replication automatically to take advantage of the benefits of both SBR and RBR formats when appropriate. The different formats are discussed in Section 17.1.2, “Replication Formats”. Detailed information on the different configuration options and variables that apply to replication is provided in Section 17.1.4, “Replication and Binary Logging Options and Variables”. Once started, the replication process should require little administration or monitoring. However, for advice on common tasks that you may want to execute, see Section 17.1.5, “Common Replication Administration Tasks”. 译文16.1.1如何建立复制16.1.2复制格式16.1.3使用全局事务标识符进行复制16.1.4复制和二进制日志记录选项和变量16.1.5常见复制管理任务 MySQL服务器之间的复制是基于二进制日志机制，MySQL主实例节点（数据库的变化源）将更新和变化作为“事件”写入二进制日志。不同的事件类型格式化成不同的二进制日志，从库读取主库二进制日志并在本地数据库上执行二进制日志中的事件。 重要您不能将主数据库配置为仅记录特定事件。 在这种情况下，主库是“哑的”。 一旦启用二进制日志记录，所有语句都记录在二进制日志中。 每个从库接收二进制日志的全部内容的副本。 决定在二进制日志中执行哪些语句是从库的责任; 您不能将主机配置为仅记录特定事件。 如果没有指定，则在从库上执行主库二进制日志中的所有事件。 如果需要，可以将从库配置为仅处理特定数据库或表的事件。 每个从库保存二进制日志的坐标：从主库读取和处理的文件中的文件名和位置。 这意味着多个从库可以连接到主站并执行相同二进制日志的不同部分。 由于从库控制此过程，因此可以在不影响主站操作的情况下将各个从站连接和断开与服务器的连接。 此外，由于每个从库记录二进制日志中的当前位置信息，因此可以断开重连然后恢复处理。 主库和每个从库必须配置唯一的ID（使用server-id选项）。此外，每个从库必须配置有关主库主机名，日志文件名和该文件中位置的信息。 这些细节可以在MySQL会话中使用从设备上的CHANGE MASTER TO语句来控制。 详细信息存储在从属主信息库中，可以是文件或表（请参见第16.2.2节“复制中继和状态日志”）。 本节介绍复制环境所需的体系和配置，包括创建新复制环境的分步说明。 本节的主要组成部分是： 有关设置两个或多个复制服务器的指南，请参见第16.1.1节“如何设置复制”，介绍系统的配置，并提供在主站和从站之间复制数据的方法。 二进制日志中的事件使用多种格式记录。 这些称为基于语句的复制（SBR）或基于行的复制（RBR）。 第三种类型的混合格式复制（MIXED）在适当时自动使用SBR或RBR复制来利用SBR和RBR格式的优点。 第16.1.2节“复制格式”中讨论了不同的格式。 有关适用于复制的不同配置选项和变量的详细信息，请参见第16.1.4节“复制和二进制日志记录选项和变量”。 一旦开始，复制过程需要少量管理或监视。 但是，有关可能要执行的常见任务的建议，请参见第16.1.5节“常见复制管理任务”。声明本文100%为翻译组合,0%为原创引用http://dev.mysql.com/doc/refman/5.6/en/replication-configuration.html]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【密码学】Hash Function(哈希函数)]]></title>
    <url>%2FhashFunction.html</url>
    <content type="text"><![CDATA[引言为了给区块链研究做铺垫，我们今天研究的是验证报文完整性的方法：密码学的函数函数,当然有些文章也将哈希函数称为散列函数 密码学哈希函数密码学上的哈希函数是一种测试消息完整性的方法，哈希函数可以输入任意长的信息，然后输出一个固定长度的字符串，这个字符串就叫做hash值，散列函数原则上用于以下方式： 假设爱丽丝想要给鲍勃一些方法使鲍勃能确认完整的接收了她发来的信息，她可以将信息的摘要伴随着的信息（可能已经加密）一起发给鲍勃，一旦鲍勃接收到了信息，鲍勃就可以用相同的方法再次算出这段信息的摘要，然后将新的摘要和爱丽丝发来的进行对比。如果相同则说明消息是完整的，如果不同，那么鲍勃就知道这些数据可能在传输途中遭到黑客篡改。况且爱丽丝不希望黑客能推算出发送的消息哪些是摘要，一旦黑客能区分出哪些部分是摘要，就能伪造报文和对应的摘要，当然这不适合我们今天探讨的话题，言归正传，密码学上指散列函数应该具有哪些特征。 输入长度可以是任意长度 输出是固定长度 给出任意的报文可以很轻松的算出哈希函数$H（x）$ 哈希函数是个不可逆的函数，就是给出一个$Y $，其中$Y = H（x）$,你完全不能通过Y去推算出x 哈希函数不存在碰撞，就是不存在任意一个$x’$,使$H（x’） = H（x）$ 密码学哈希函数和编程中的哈希函数我在写这篇文章的时候一直在哈希函数前面强调是密码学上的哈希函数，只是因为它与编程中的哈希函数不同，编程上的哈希函数（表）是一种数据结构，哈希表是将数据对象映射到一个便于存储和检索的特定内存空间。虽然和密码学上的哈希函数有点类似，都是一段长的数据映射到固定长度的短的值，但是哈希表是可逆的，相同的数据可以允许多个不用的哈希编码实现方式去做地址映射，而密码学上的哈希函数则是透明的不可逆的。 SHA-256关于哈希函数的算法有很多种，比如MD4，MD5，SHA1（这些已经不安全了）等，因为我们在这里探讨的是为了区块链做准备的，所以我们直接进入主题。 SHA (Secure Hash Algorithm，译作安全散列算法) 是美国国家安全局 (NSA) 设计，美国国家标准与技术研究院 (NIST) 发布的一系列密码散列函数。正式名称为 SHA 的家族第一个成员发布于 1993年。然而现在的人们给它取了一个非正式的名称 SHA-0 以避免与它的后继者混淆。两年之后， SHA-1，第一个 SHA 的后继者发布了。 另外还有四种变体，曾经发布以提升输出的范围和变更一些细微设计: SHA-224, SHA-256, SHA-384 和 SHA-512。 SHA-2的第t个加密循环。图中的深蓝色方块是事先定义好的非线性函数。ABCDEFGH一开始分别是八个初始值，Kt是第t个密钥，Wt是本区块产生第t个word。原消息被切成固定长度的区块，对每一个区块，产生n个word（n视算法而定），通过重复运作循环n次对ABCDEFGH这八个工作区块循环加密。最后一次循环所产生的八段字符串合起来即是此区块对应到的散列字符串。若原消息包含数个区块，则最后还要将这些区块产生的散列字符串加以混合才能产生最后的散列字符串。网络教程上有各种语言的关于SHA-256的实现库，这里就不重复了 各种哈希函数的对比 总结本文是为区块链研究做背景的内容，主要浅谈了密码学上的哈希函数，以及此哈希函数与编程上的哈希函数的区别，最后探讨了SHA-256 声明本文50%为组合,50%为原创 引用https://zh.wikipedia.org/wiki/SHA-2]]></content>
      <categories>
        <category>密码学</category>
      </categories>
      <tags>
        <tag>密码学</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【安全编码】一个系统应该考虑的安全功能要素]]></title>
    <url>%2FsecureTest01.html</url>
    <content type="text"><![CDATA[引言当我们考虑一个系统安全时候，往往第一印象是系统是否有漏洞，系统数据是否高可用，但实际上最容易疏漏和引入的安全问题却是系统的功能安全问题，那么评价一个系统的功能是否安全应该从哪几方面考虑？系统应提供多少特性才算做是基本安全的系统 身份和鉴别身份和鉴别在系统中扮演者守门员的角色，一旦系统的大门被攻破，系统内的数据将如摆设一般，任人鱼肉宰割。 用户标识 系统应提供独立的登录控制模块，对所有登录用户进行唯一身份标识用户鉴别 系统应不允许匿名用户登录 √ √ 系统应确保用户在授予敏感权限之前被鉴别 ★ ★ 系统应具备防篡改和防重放机制的能力 √ x 系统应能够支持双向鉴别机制 √ x 系统应提供多重鉴别机制以支持用户鉴别 ★ x 系统应由系统管理员分发用户的初始口令，并强制用户在初始登录时修改初始口令 ★ ★ 系统应除了系统管理员之外，不允许其它用户修改非本人的口令 用户口令规范 鉴别信系统应具备复杂度的功能 ★ ★ 系统应具备检查口令的有效期的能力 √ √ 系统的用户口令应有历史重复次数的限制鉴别失败 系统应能够对失败的标识和鉴别尝试进行锁定 ★ ★ 系统应能够对鉴别尝试失败的次数和锁定时间进行设置用户-客户端绑定 系统应能够设置客户端登录系统的用户属性会话鉴别 系统应具有鉴别初始会话连接请求的能力 ★ ★ 系统应能够检测和处理会话的异常状态 ★ √用户角色 系统的管理权限单独赋予各级系统管理帐号，这类帐号（角色）仅负责进行系统级的管理，不具备任何业务操作的权限★ ★ 系统应设置审核管理员，对关键的系统管理和特殊业务操作进行审批生效 √ √ 系统应保证审核管理员与系统管理员不是同一账户 √ √ 系统应通过设置审计管理员，对系统的所有安全功能进行管理和监视 ★ ★ 系统应将业务操作权限赋予非系统管理员，且业务操作用户不能具备任何系统级的管理权限 ★ ★访问控制本部分的核心是，不同的角色应该具备他所应有的最小权限，并且不同角色之间不能越权访问、处理数据。 访问控制管理 系统应提供用户授权的管理功能访问控制策略 系统应由授权主体配置访问控制策略，限制默认用户的访问权限 ★ ★ 系统应授予不同用户为完成各自承担任务所需的最小权限，且相互制约 ★ ★ 系统应能够设置权限互斥原则 √ √ 访问控制功能 系统应实现完整的访问控制功能，依据安全策略控制用户对文件、数据库表等客体的访问 ★ ★标记 系统应具有对重要信息资源设置敏感标记的功能 √ x 系统应依据安全策略控制用户对敏感标记信息的操作 √ x安全审计审计的功能一方面是发现异常，另一方面可以对系统有企图的人起到震慑作用。 审计数据产生 系统应提供覆盖到每个用户的安全审计功能，对应用系统重要安全事件能进行审计 ★ ★ 被检软件的审计事件类型至少应包括系统事件、业务事件、成功事件、失败事件及对审计功能的操作。 ★ ★ 系统审计记录中应包括了以下基本信息：日期、事件类型和内容、主体身份、事件的描述和结果等 ★ ★审计查阅 系统应具有对审计数据的搜索、查询、分析、统计、分类、排序的功能。★ √审计响应 系统应定义分级的系统异常事件类型，并根据异常的严重程度采用不同的通知方式 √ x审计事件存储 系统应保证无法删除、修改或覆盖审计记录 ★ ★ 系统应对审计数据具有手动或自动备份的功能 √ x审计事件选择 系统应具有对审计信息的访问控制机制 ★ x 系统应允许审计管理员选择需要进行审计的事件项目，并提供对审计数据的管理功能 √ x数据完整性数据的完整性主要体现在存储完完整性和传输完整性上。存储完整性 系统应采用校验技术保证存储过程中数据的完整性 ★ ★ 系统应能在检测到完整性错误时采取必要的恢复行动 ★ x传输完整性 系统应采用密码技术保证传输过程中数据的完整性 ★ ★ 系统应检测到系统管理数据、鉴别信息和重要业务数据在传输过程中完整性受到破坏，并在检测到完整性错误时采取必要的恢复措施 √ √数据保密性数据保密性是指数据无论在传输过程中还是存储过程中，及时被截获或者获取依然不知道数据的真实意思 会话初始化验证 系统应在通信双方建立连接之前，利用密码技术进行会话初始化验证 √ x数据存储保密性 系统应采用加密或其他保护措施实现系统管理数据、鉴别信息和重要业务数据存储的保密性。 ★ ★数据传输保密性 系统应对通信过程中的整个报文或会话过程进行加密 ★ x 系统应采用加密或其他有效措施实现系统管理数据、鉴别信息和重要业务数据传输保密性。 ★ ★ 系统应保证向客户端提供的数据信息中不包含会泄露应用系统安全数据的内容，及与用户请求无关的数据★ ★抗抵赖 原发抗抵赖 系统应具有原发抗抵赖的功能 √ x 接收抗抵赖 系统应具有接收抗抵赖的功能 √ x软件容错软件的容错有点类似数据库高可用数据有效性 验证系统应提供数据有效性检测功能，保证通过人机接口输入或通过通信接口输入的数据符合系统设定的安全属性要求★ ★ 故障与恢复 系统应提供自动保护功能，当故障发生时自动保护当前所有状态，保证系统能够进行恢复 ★ ★ 资源控制 会话超时 系统应能根据设定时间（用户非活动期的间隔）自动终止用户会话。 ★ ★ 并发会话限制系统应能够限制属于同一用户（或同一组用户）的并发会话的最大数量 ★ ★ 系统应能够限制单个用户的多重并发会话的限制，防止单用户会话的重用 ★ ★ 资源分配系统应对一个访问帐户或一个请求进程占用的资源分配最大限额和最小限额 √ x 系统应能够对系统服务水平降低到预先规定的最小值进行检测和报警 √ x 服务优先级系统应能提供服务优先级的功能，并根据优先级分配系统资源 √ x备份与恢复 系统应提供本地数据备份与恢复功能。 ★ ★声明本文30%为组合,70%为原创引用中国某院信息通信研究所资料]]></content>
      <categories>
        <category>安全编码</category>
      </categories>
      <tags>
        <tag>安全编码</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【金融知识】Reserve Ratio (准备金率)]]></title>
    <url>%2FReserve%20Ratio.html</url>
    <content type="text"><![CDATA[IntroductionReserve ratio is the amount of cash a bank must keep in its bank vaults or deposit into a central, governing bank. The percentage is based on the bank’s total deposits. What is Reserve RatioThe reserve ratio is the portion of depositors’ balances that banks must have on hand as cash. This is a requirement determined by the country’s central bank, which in the United States is the Federal Reserve. The reserve ratio affects the money supply in a country at any given time. Governments often use reserve requirements as a control over the money supply. The basic money supply of most countries is made up of cash plus the total of all bank demand deposits. The reserve ratio creates a multiplier effect on the cash. When a person deposits 1,000 in the bank, the bank is not required to keep all of that 1,000 on hand in case the depositor wants it back later – the bank is only required to keep a portion on hand. The percentage of cash the bank is required to keep (and thus not lend out) is the reserve ratio. Assume ABC Bank has total deposits of 2 billion and the reserve ratio is 12%. This means that ABC is required to keep 240 million in cash reserves. In most developed countries, the majority of the cash reserve is kept at the central, governing bank, and a fraction is in the bank’s own vaults. The cash is transferred between the two based on daily cash needs. In the United States, the Federal Reserve controls the reserve ratio requirements. Currently, banks with deposits of less than 14.5 million have zero reserve requirements. For banks with deposits between 14.5 million and 103.6 million, the reserve requirement is 3%. It’s 10% for banks with deposits exceeding 103.6 million. What is the ‘Reserve Ratio’ used forPurpose and Functions (1994) describes how a change in the reserve requirement ratio affects bank credit and the money stock.Reserve requirements are the percentage of deposits that depository institutions must hold in reserve and not lend out. For example, with a 10 percent reserve requirement on net transaction accounts, a bank that experiences a net increase of 200 million in these deposits would be required to increase its required reserves by 20 million. The bank would be able to lend the remaining 180 million of deposits, resulting in an increase in bank credit. As those funds are lent, they create additional deposits in the banking system. The increase in deposits affects the money stock, because it is measured in several ways that primarily include various categories of deposits and currency in the hands of the public. Increasing the (reserve requirement) ratios reduces the volume of deposits that can be supported by a given level of reserves and, in the absence of other actions, reduces the money stock and raises the cost of credit. Decreasing the ratios leaves depositories initially with excess reserves, which can induce an expansion of bank credit and deposit levels and a decline in interest rates.The volume of net transaction deposits held by all depository institutions is large, 566.5 billion, as of June 2001 (see table and H.6 Release). Thus, even a small change in the reserve requirement ratio may have a relatively large effect on reserve requirements and the money stock. 为了解释的更清楚一点，开始彪汉语了，以下内容摘自知乎彭牧的回答，详见引用。 1，法定准备金率存在的意义，是为了防范风险。对于银行而言，贷款放出去的越多，他们赚的利息就越多，所以银行为了多赚钱，会尽量多的放出贷款，这个很好理解。而由于银行的特殊性质，当经济危机出现，银行破产时，整个社会都要为银行带来的损失买单，所以监管机构需要严格监控银行的贷款行为，存款准备金是最基本的保障，它可以保证银行在绝大多数情况下不会提不出钱，不过经济危机时，储户恐慌性提款，还是能把银行提空。 2，法定准备金率对于宏观经济的影响。举个例子，在极简情况下，lz是一家银行，有储户存了100块钱在lz手里，准备金率10%，那么lz就需要把10块钱放在知乎管理员手中（中央银行），另外90块钱lz作为贷款放出，流入市场（这是最简情况，实际中还要考虑银行的额外准备金率e），这90块钱经过各种途径（企业、个人），最后又会回到银行体系中（这是最简情况，实际中还要考察企业及个人留在手中的资金，即现金比率c），比如90块钱存进了1楼银行，那么1楼银行要把90块钱的10%，即9块钱放入直呼管理员手中，另外81块又当做贷款放出，如此反复，最后市场上流通了100+90+81+。。。。根据无穷级数的公式，最后结果是1000.即100块钱的存款，实际产生了1000块钱的流通货币，货币乘数是10，即1/10%，存款准备金率的倒数。这样，当存款准备金率下调0.1%时，比如从10%下降到了9.9%，那么货币乘数从10涨到了11.11。如果银行体系中有4万亿的存款，那是什么概念？领导一句话，存款准备金率降低0.1%吧！结果，市场上平白无故多出了4.44万亿元！（实际情况不会这么夸张，需要考虑e和c以及定存活期的区别）。所以，存款准备金率是很有力度的调控指标，央行也轻易不敢动它。 Conclusion说白了，准备金就是平台留存的钱。100%准备金率就是用户存100块，平台必须保留100块；10%就是存100块，平台可以只保留10块，另外的90块可以做别的事情，通常银行通过放贷等进行盈利，所以银行需要拼命吸储。贮备金存在的意义：1.防范风险；2调控宏观经济 Declaraction本文100%为组合,0%为原创，详见引用 Referencehttp://www.investopedia.com/video/play/reserve-ratio/#ixzz4TPwLn2Xvhttp://www.economicshelp.org/blog/67/money/money-multiplier-and-reserve-ratio-in-us/https://www.zhihu.com/question/19944185/answer/15064686]]></content>
      <categories>
        <category>金融知识</category>
      </categories>
      <tags>
        <tag>金融知识</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【搜索优化】Hexo-next百度和谷歌搜索优化]]></title>
    <url>%2Fseo.html</url>
    <content type="text"><![CDATA[引言搭建好了github的网站发现百度和谷歌搜索都不收录，甚为沮丧，研究后发展其实有很多实用的技巧可以优化网站搜索，特写文章总结之. 首页title优化更改index.swig文件(your-hexo-site\themes\next\layout);1&#123;% block title %&#125; &#123;&#123; config.title &#125;&#125; &#123;% endblock %&#125; 修改为1&#123;% block title %&#125; &#123;&#123; theme.keywords &#125;&#125; - &#123;&#123; config.title &#125;&#125;&#123;&#123; theme.description &#125;&#125; &#123;% endblock %&#125; 修改文章链接HEXO默认的文章链接形式为domain/year/month/day/postname，默认就是一个四级url，并且可能造成url过长，对搜索引擎是十分不友好的，我们可以改成 domain/postname 的形式。编辑站点_config.yml文件，修改其中的permalink字段改为permalink: :title.html即可。 设置站点地图1.安装sitemap站点地图自动生成插件 12npm install hexo-generator-sitemap --savenpm install hexo-generator-baidu-sitemap --save 2.在主题配置文件中添加一下配置(your-hexo-site_config.yml) 1234sitemap: path: sitemap.xmlbaidusitemap: path: baidusitemap.xml 3.然后在主题配置文件中修改url为你的域名，例如我的1url: http://www.ehcoo.com 配置好后，hexo g 就能在your-hexo-site\public 中生成sitemap.xml 和 baidusitemap.xml了; 4.在your-hexo-site\source中新建文件robots.txt,内容可以参照我的1234567891011121314151617# hexo robots.txtUser-agent: *Allow: /Allow: /archives/Allow: /categories/Allow: /tags/Allow: /about-me/Disallow: /vendors/Disallow: /js/Disallow: /css/Disallow: /fonts/Disallow: /vendors/Disallow: /fancybox/Sitemap: http://www.ehcoo.com/sitemap.xmlSitemap: http://www.ehcoo.com/baidusitemap.xml 当上面所有的都配置后就能看到编译好的sitemap.xml和baidusitemap.xml 百度链接优化百度站长平台sitemap提交是邀请制的，并没有对所有站长开放，只有网站到一定等级百度才会在你后台开放提交sitemap的入口。1.站点验证百度搜索引擎提交入口 百度搜索有三种验证方式，我选择Html标签验证，在themes\next\layout_partials\head.swing中添加验证代码：1&lt;meta name=&quot;baidu-site-verification&quot; content=&quot;6VWurVhWUo&quot; /&gt; 配置页面如下图所示 2.更新Robots 谷歌链接优化1.注册Google Search Console，添加你的域名后，如下图所示 2.进行站点验证，验证的方式和百度的方式相同 3.测试robots.txt 4.提交站点地图 5.点击左侧的Google 抓取方式 6.提交谷歌索引在这里我们填上我们需要抓取的url,不填这表示抓取首页，抓取方式可以选择桌面，智能手机等等，自行根据需要选择。填好url之后，点击抓取。然后可能会出现几种情况，如:完成、部分完成、重定向等，自由这三种情况是可以提交的。提交完成后，提交至索引，根据提示操作就可以了，我的提交： 7.上面我们提交了（【个人生活】大不列颠及北爱尔兰联合王国首都伦敦之3日游记）这篇文章，下面我们测试一下，优化效果 设置关键字1.设置hexo博客的关键字:在博客根目录下找到 config.yml 文件，在所示地方添加keywords: 关键字1,关键字2,关键字3…，采用英文逗号隔开，注意keywords与关键词之间的空格 2.设置文章的关键字: 在文章里面加入keywords，如下所示：12345678---title: ###date: ###categories: ###tags: ###keywords: ###description: ###--- 添加 “nofollow” 标签给非友情链接的出站链接添加 “nofollow” 标签，nofollow标签是由谷歌领头创新的一个“反垃圾链接”的标签，并被百度、yahoo等各大搜索引擎广泛支持，引用nofollow标签的目的是：用于指示搜索引擎不要追踪（即抓取）网页上的带有nofollow属性的任何出站链接，以减少垃圾链接的分散网站权重。 rel这个属性它有许多的属性值，比如next、previous,、chapter、 section等等，比较常见的是rel=”external nofollow”与rel=”nofollow”两种参数的应用！ rel=”nofollow”属性是谷歌为了应对垃圾链接而引入的一个属性值，被各大搜索引擎引用！rel=”external nofollow”只是更相对于rel=”nofollow”参数更加规范一些而已！ rel=”external nofollow”与rel=”nofollow”其功能就中文译文”不要读取” 及”外部链接不要读取”的意思！ 1、 找到footer.swig，路径在your-hexo-site\themes\next\layout_partials\footer.swig，将下面代码1&#123;&#123; __(&apos;footer.powered&apos;, &apos;&lt;a class=&quot;theme-link&quot; href=&quot;http://hexo.io&quot;&gt;Hexo&lt;/a&gt;&apos;) &#125;&#125; 修改成1&#123;&#123; __(&apos;footer.powered&apos;, &apos;&lt;a class=&quot;theme-link&quot; href=&quot;http://hexo.io&quot; rel=&quot;external nofollow&quot;&gt;Hexo&lt;/a&gt;&apos;) &#125;&#125; 将下面代码1&lt;a class=&quot;theme-link&quot; href=&quot;https://github.com/iissnan/hexo-theme-next&quot;&gt; 修改成1&lt;a class=&quot;theme-link&quot; href=&quot;https://github.com/iissnan/hexo-theme-next&quot; rel=&quot;external nofollow&quot;&gt; 2、 修改sidebar.swig文件，路径在your-hexo-site\themes\next\layout_macro\sidebar.swig，将下面代码1&lt;a href=&quot;&#123;&#123; link &#125;&#125;&quot; target=&quot;_blank&quot;&gt;&#123;&#123; name &#125;&#125;&lt;/a&gt; 修改成1&lt;a href=&quot;&#123;&#123; link &#125;&#125;&quot; target=&quot;_blank&quot; rel=&quot;external nofollow&quot;&gt;&#123;&#123; name &#125;&#125;&lt;/a&gt; 将下面代码1&lt;a href=&quot;http://creativecommons.org/licenses/&#123;&#123; theme.creative_commons &#125;&#125;/4.0&quot; class=&quot;cc-opacity&quot; target=&quot;_blank&quot;&gt; 修改成1&lt;a href=&quot;http://creativecommons.org/licenses/&#123;&#123; theme.creative_commons &#125;&#125;/4.0&quot; class=&quot;cc-opacity&quot; target=&quot;_blank&quot; rel=&quot;external nofollow&quot;&gt; 总结本文从首页title优化，修改文章链接，设置站点地图，百度链接优化，谷歌链接优化，添加 “nofollow” 标签6个方面进行了github博客的SEO优化，其中大量借鉴了他人的方法，具体地址详见引用。 声明本文70%为组合,30%为原创 引用http://hunao.info/http://www.arao.me/2015/hexo-next-theme-optimize-seo/http://blog.csdn.net/zaoan_wx/article/details/50859675http://hunao.info/2016/06/01/Hexo-Seo%E4%BC%98%E5%8C%96%E8%AE%A9%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%9C%A8google%E6%90%9C%E7%B4%A2%E6%8E%92%E5%90%8D%E7%AC%AC%E4%B8%80/]]></content>
      <categories>
        <category>搜索优化</category>
      </categories>
      <tags>
        <tag>搜索优化</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【个人生活】大不列颠及北爱尔兰联合王国首都伦敦之3日游记]]></title>
    <url>%2Ftravel.html</url>
    <content type="text"><![CDATA[应好友zesing和ivan的邀约，决定写一篇最近在伦敦的游记，本想用英文装一下，纠结了很久之后，决定还是用中文写，下面用文字和图片记录下在伦敦美妙的3天。（此刻的心情：写游记真是一件十分痛苦的事情，因为不知道写成什么文体，不由自主想写成论文的格式，摘要，引言，叙述。。。。） 第一天下车后，对于一个资深的大学历史研究员而言，最开心的事情莫过于在地铁出口看到了伯大的广告 当然也有一些能代表“英伦气息”的广告，如这个，足够的基友吧 到了酒店，发现酒店远超出我们的预期（因为自带厨房，而且各种设备十分齐全，唯一遗憾的是WI-FI坏了） 在酒店小歇之后，本决定去晚上去海德公园看看夜景，途中发现了宝藏（自然科学历史博物馆），本以为是在讲英国的历史，事实上更加偏重天文历史和生物进化的研究，不同于其他的博物馆的地方是更注重体验，很多照片都是可以触摸的，可以试听的，不像我天朝所有展品都写这“禁止触碰！” 自然科学历史博物馆博物馆外景 博物馆门牌 进入主展厅区 展品主要分为两部分，一是天文科学，比如自然界中石头的风化，地表的生成，地震的原理等 另一部分树生物科学，诸如最小的生物，各种生物的进化史等。 相比伯明翰，伦敦的街头确实繁华不少，灯红酒绿的，四处悬挂着“大英帝国”的国旗，就连警车都比伯村开的快，有种德国明天就要入侵的紧张感 伦敦的街头伦敦的标志性的公交车，红彤彤的，可爱吧（不要在意旁边的国旗，那是个例外） 傍晚时分的溜冰场，实际当时才4点，伦敦基本4点天就黑了 牛津街的部分，说实话能活着从牛街街回来真是感到莫大的欣慰（最近IS扬言要攻击该地区） 伦敦的商业区，云集了众多厉害的公司（汇丰，花旗，普华永道） 英国是个对钟表十分着迷的国家，你几乎能在任何一个城市或者地区看到各种钟楼 大本钟忧郁的背影，但是也比不过被鸟屎击中的zesing 玩弄于鼓掌之间的大本钟， 实际我在拍摄上一个照片的时候，下落的鸟屎理我的头不足5厘米，但是最终这个新鲜的东西，还是被zesing抢先了一步，勇敢的弄衣服夹住了下落的鸟屎，我们的为他的悲壮主义精神点赞！ 为了答谢鸟儿的热情，我们决定合影留念 来自世界各地“捐赠”的东西，然后建了一个博物馆展示，然后自豪的告诉世人，我们才是最牛逼的 大英博物馆门口是这样的 让我想起了小学时候，墙上的各种宣传画,然后旁边在写上“德智体全面发展” 虽然我看不懂，但是这对于一个书虫真心具有莫大的吸引力 为什么不是全裸的？这肯定是伪艺术！ 鉴于对历史的敬畏，一些木乃伊什么的决定不再上图了。下面我们将去女王的家看一看 白金汉宫这就是女王的宫殿 女王的卫队 战斗演习 女王的后花园，皇家园林公园 格林尼治天文台开始并不在考虑范围内，主要是太远了，庆幸的我们的 16-25 Railcard 成功的绑定了伦敦地铁一卡通（Oyster card），一般这个网上很少有相关的教程，其实只要拿着你的16-25 Railcard和 Oyster card然后找地铁的工作人员授权就好，经过我们测试，一般可以打25折，重点是每天3.7磅封顶。 皇家格林尼治天文台格林尼治标准时间（旧译格林尼治平均时间或格林威治标准时间；英语：Greenwich Mean Time，GMT）是指位于英国伦敦郊区的皇家格林尼治天文台的标准时间，因为本初子午线被定义在通过那里的经线。 自1924年2月5日开始，格林尼治天文台每隔一小时会向全世界发放调时信息 没来英国之前，他们都说英国的饭菜难吃，然后事实证明确实很难吃，基本就有两种做法，一种是水煮，另一种是烤箱 英国饮食文化典型的英式早餐 典型的英国中餐，事实上他们并不怎么吃中餐（炸鱼薯条） 龙虾薯条，当然这是非典型的英国饭菜，人均消费25磅左右，作为一种体验，还是强烈推荐的 伦敦地铁文化 Please mind the gap between the train and the platform 这句话伴随着伦敦100多年的历史，显然已经沉淀成可一种文化，礼品店有卖各种“mind the gap”的短袖 现代的伦敦地铁某些支线，如维多利亚线依然 保留了旧的列车，个人感觉这种列车更有时代科技感 近些年伦敦地铁增加了一些活泼的元素，但是也驱散不了地铁中人与人之间的冷漠 值得一提的是，即使这样，我们依然获得了2次搭讪与被搭讪，一个退休的桥梁工程师，另一个为毕业于伦敦政经的银行职员（印度三哥） 在zesing的强烈建议下，我们去体验一下，伦敦评分顶级的酒吧，名字忘记了，先不说酒怎样，单从酒保看这个酒吧确实顶级的 煮酒论英雄像瓷娃娃一样的酒保 德国的红酒，真心不够懂酒啊 基本喝酒的同时，聊得话题就是批评与自我批评，再此对zesing的误解的表示道歉，最终总结下我们得出的结论 1.每个人的成长环境经历不同，所以考虑问题的角度尽量从全局出发，考虑到别人的感受 2.做大事者，一定要有宽广的胸襟，纵使周瑜这样的奇才，狭隘的胸襟一样严重阻碍了他的发展 3.承认别人的长处，承认自己的短处，即使知道了这些事实也不要自卑自弃，羞耻是前进的动力 4.做任何事情，三思而后行，武断的着急行为是情商低的表现 5.人的生命有限，你的一生只能做成一件事情，所以一定要聚焦 最后，作者照片镇楼 声明本文1%为组合,99%为原创 引用http://baike.baidu.com/link?url=1hJ2pkvmMXP8z4ZUj4SNA9yJtZWeoPtuJvMYvAe3g8IWrUPMX6L7b1ppFjaYZDsO5e1kYaawsWycMzoY2KzbefzG3bv3oSe4wlbQ149bhx3XuZypvtgsARl5_HYA_Imd]]></content>
      <categories>
        <category>个人生活</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【计算机网络】网络层-IPv4是什么？IPv4怎么划分的？]]></title>
    <url>%2FIP.html</url>
    <content type="text"><![CDATA[引言你需要上网，你在浏览器中输入一个网址，实际是你和服务器之间的沟通，两者之前需要沟通，就要知道两个的位置，IP就是用来标记你的位置的，告诉外部网络，你是谁？我以什么样的方式与外部通信，IP的地址是怎么样划分的，IP不够用的时候怎么处理，带着这些问题，开始本文的阅读。你可以通过百度直接输入IP查询你是谁？ 你也通过 https://wq.apnic.net/whois-search 通过查询对方是谁？ IP是什么？互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），缩写为IP地址（英语：IP Address），是分配给网络上使用网际协议（英语：Internet Protocol, IP）的设备的数字标签。常见的IP地址分为IPv4与IPv6两大类。 由32位二进制数组成，为便于使用，常以XXX.XXX.XXX.XXX形式表现，每组XXX代表小于或等于255的10进制数。例如维基媒体的一个IP地址是208.80.152.2。地址可分为A,B,C,D,E五大类，其中E类属于特殊保留地址。 IP地址分类拿那上面的百度IP，103.235.46.39作为例子，因为人类依赖十进制，所以这里的IP地址用十进制的方式表示，要让机器识别，还是得转为二进制(十进制IP地址) 103.235.46.39(二进制IP地址) 1110011.11101011.101110.100111一共有8乘4=32位，这种IP方式的表示方法，叫做IPV4，这样的话，一共有多少个IP地址呢？最小地址 00000000 00000000 00000000 00000000 也就是 0.0.0.0最大地址 11111111 11111111 11111111 11111111 也就是 255.255.255.255IPV4的方式，最多可以表示 255 乘 255 乘255 乘 255 = 4228250625 个ip地址 = 40亿,40亿的IPV4地址，预计将会在2020年年前后分配完毕 （具体数字记不清）,目前世界有70亿人口，本来这些IP就不够分的，偏偏还有人搞三六九等，搞出A类，B类，C类地址其中分类的标准是这样的 A类IP地址A类地址前8位表示网络地址，后24位表示表示主机地址，那么可以容纳的主机数是2的24次方，就是16,777,214，翻译成中文，就是一千六百七十万个，差不多就是深圳+香港的人口总数。 A类地址范围：1.0.0.1到126.255.255.254，为什么明明是8位，为什么只能只到126，其中最前面1位为固定位0，为什么要这样设计？二进制数里全是“0”和全是“1”的要保留。“0”做为网络号，“1”做为广播号。所以A类地址的网段为1—126.，这样能表示的范围是就是7位了，但是 127.0.0.0到127.255.255.255是保留地址，用做循环测试用的。A类地址中的私有地址和保留地址： 10.0.0.0到10.255.255.255是私有地址（所谓的私有地址就是在互联网上不使用，而被用在局域网络中的地址）。 顺便解释下私有私有地址上面提到IP地址在全世界范围内唯一，看到这句话你可能有这样的疑问，像192.168.0.1这样的地址在许多地方都能看到，并不唯一，这是为 何？Internet管理委员会规定如下地址段为私有地址，私有地址可以自己组网时用，但不能在Internet网上用，Internet网没有这些地址 的路由，有这些地址的计算机要上网必须转换成为合法的IP地址,也称为公网地址，这就像有很到的世界公园，每个公园内都可命名相同的大街，如香榭丽舍大街，但对外我们只能看到公园的地址和真正的香榭丽舍大街。下面是A、B、C类网络中的私有地址段。你自己组网时就可以用这些地址了。 10.0.0.0～10.255.255.255 172.16.0.0～172.131.255.255 192.168.0.0～192.168.255.255 那么谁在使用A类地址，100%都在美国的大公司，在本来地址不足的情况下，非要搞出一个Ａ类地址，一方面是当时没有预想到网络的发展会如此迅速，另一方面也体现了美国的特权主义，“爷就是网络的规定制定者，有意见您就别用”3.0.0.0/8：通用9.0.0.0/8：IBM11.0.0.0/8：国防部12.0.0.0/8：AT&amp;T贝尔实验室13.0.0.0/8：施乐15.0.0.0/8：HP16.0.0.0/8：DEC17.0.0.0/8：苹果18.0.0.0/8：MIT19.0.0.0/8：福特汽车55.0.0.0/8：波音56.0.0.0/8：邮政局至于上面的/8是什么意思，我以后的文章会解释 B类IP地址B类地址，前16位表示网络地址，后16位表示主机地址，需要指出的是B类网络地址的前两位也是固定的为1,0，其中预留的地址的上面已经写过，大部分的B类地址在欧洲，如伯明翰大学的就是B类地址，而且还有两个，而多数的中国大学都没有这么幸运，基本都是C类地址，还有可能是附庸的C类地址。 那么一共有多少个B类地址可以容纳多少个主机呢16位是主机标识，所以主机数应该是2的16次幂 65536，扣除两个保留地址后，主机最大数应该是65534个。 C类IP地址C类地址其中24位网络地址，8位位主机地址，24位的网络的地址中前三位110也已经被固定，实际C类地址的操作位数为21位，因为是二进制数，所以网段数应该为：2的21次幂个网段，等于2097152，扣除两个全“0”，全“1”的保留地址，所以B类网络可以有2097150个网段。而转换成十进制后，IP地址的第一个小数点前的数字应该是多少呢？因为第一段是110XXXXX，所以应该是 2的5次幂，等于32个。所以网段应该是从192开始，到192+32-1=223. 即十进制IP的第一段数字是在192—223之间。 C类主机数计算：因为后面8位是主机标识，所以主机数应该是 2的8次幂 256，扣除两个保留地址后，主机最大数应该是254个 如果全世界全都按照C类地址去分，虽然总得网络容量不会变，但是机会会更均等，不会出现像以上那样无耻的A类地址垄断，那么这个分配的权利在谁手里？世界上四个掌管IP地址分配的四个组织：APNIC (Asia Pacific Network Information Centre) - 亚太地区ARIN (American Registry for Internet Numbers) - 北美、南部非洲LACNIC (Regional Latin-American and Caribbean IP Address Registry) – 拉美和加勒比海地区RIPE NCC (Réseaux IP Européens) - 欧洲、中东、中亚、北部非洲 D类IP地址D类IP地址第一个字节以“1110”开始 。它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。多点广播地址用来一次寻址一组计算机，它标识共享同一协议的一组计算机。 E类IP地址以“1111”开始，为将来使用保留。全零（“0．0．0．0”）地址对应于当前主机。全“1”的IP地址（“255．255．255．255”）是当前子网的广播地址。 总结上面讲了什么是IP从IP的分配的角度深深的痛斥了美国的特权主义与霸权主义！中国多数都是C类地址，一个C类IP地址，只能分配254个主机，该如何解决中国几十亿的设备上网问题，下一次博客我将继续深入~ 声明本文30%为组合,70%为原创 引用https://www.zhihu.com/question/29723388/answer/66737890http://www.xitong8.com/xtjc/20120217/2576.html、http://blog.sina.com.cn/s/blog_6de000c20101jj8b.htmlhttps://zh.wikipedia.org/wiki/IP%E5%9C%B0%E5%9D%80]]></content>
      <categories>
        <category>网络知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[一种点对点的电子现金系统（A Peer-to-Peer Electronic Cash System）-中本聪]]></title>
    <url>%2FA%20Peer-to-Peer%20Electronic%20Cash%20System.html</url>
    <content type="text"><![CDATA[Abstract（摘要）A purely peer-to-peer version of electronic cash would allow onlinepayments to be sent directly from one party to another without going through a financial institution. Digital signatures provide part of the solution, but the main benefits are lost if a trusted third party is still required to prevent double-spending. We propose a solution to the double-spending problem using a peer-to-peer network. The network timestamps transactions by hashing them into an ongoing chain of hash-based proof-of-work, forming a record that can not be changed without redoing the proof-of-work. The longest chain not only serves as proof of the sequence of events witnessed, but proof that it came from the largest pool of CPU power. As long as a majority of CPU power is controlled by nodes that are not cooperating to attack the network, they’ll generate the longest chain and outpace attackers. The network itself requires minimal structure. Messages are broadcast on a best effort basis, and nodes can leave and rejoin the network at will, accepting the longest proof-of-work chain as proof of what happened while they were gone. 本文提出了一种完全通过点对点技术实现的电子现金系统，它使得在线支付能够直接由一方发起并支付给另外一方，中间不需要通过任何的金融机构。虽然数字签名（Digital signatures）部分解决了这个问题，但是如果仍然需要第三方的支持才能防止双重支付（double-spending）的话，那么这种系统也就失去了存在的价值。我们在此提出一种解决方案，使现金系统在点对点的环境下运行，并防止双重支付问题。该网络通过随机散列（hashing）对全部交易加上时间戳（timestamps），将它们合并入一个不断延伸的基于随机散列的工作量证明（proof-of-work）的链条作为交易记录，除非重新完成全部的工作量证明，形成的交易记录将不可更改。最长的链条不仅将作为被观察到的事件序列（sequence）的证明，而且被看做是来自CPU计算能力最大的池（pool）。只要大多数的CPU计算能力都没有打算合作起来对全网进行攻击，那么诚实的节点将会生成最长的、超过攻击者的链条。这个系统本身需要的基础设施非常少。信息尽最大努力在全网传播即可，节点(nodes)可以随时离开和重新加入网络，并将最长的工作量证明链条作为在该节点离线期间发生的交易的证明。 Introduction（简介）Commerce on the Internet has come to rely almost exclusively on financial institutions serving astrusted third parties to process electronic payments. While the system works well enough for most transactions, it still suffers from the inherent weaknesses of the trust based model. Completely non-reversible transactions are not really possible, since financial institutions can not avoid mediating disputes. The cost of mediation increases transaction costs, limiting the minimum practical transaction size and cutting off the possibility for small casual transactions,and there is a broader cost in the loss of ability to make non-reversible payments for non-reversible services. With the possibility of reversal, the need for trust spreads. Merchants must be wary of their customers, hassling them for more information than they would otherwise need.A certain percentage of fraud is accepted as unavoidable. These costs and payment uncertainties can be avoided in person by using physical currency, but no mechanism exists to make paymentsover a communications channel without a trusted party.What is needed is an electronic payment. 互联网上的贸易，几乎都需要借助金融机构作为可资信赖的第三方来处理电子支付信息。虽然在绝大多数情况下这类系统都运作良好，但是这类系统仍然内生性地受制于“基于信用的模式”(trust based model)的弱点。人们无法实现完全不可逆的交易，因为金融机构总是不可避免地会出面协调争端。而金融中介的存在，也会增加交易的成本，并且限制了实际可行的最小交易规模，也限制了日常的小额支付交易。并且潜在的损失还在于，很多商品和服务本身是无法退货的，如果缺乏不可逆的支付手段，互联网的贸易就大大受限。因为有潜在的退款的可能，就需要交易双方拥有信任。此外，因为商家也必须对自己的客户小心提防，所以会向客户索取完全不必要的个人信息。而实际的商业行为中，一定比例的欺诈性客户也被认为是不可避免的，相关损失视作销售费用处理。而在使用物理现金的情况下，因为此时没有第三方信用中介的存在，这些销售费用和支付问题上的不确定性却是可以避免的。 system based on cryptographic proof instead of trust,allowing any two willing parties to transact directly with each other without the need for a trusted third party. Transactions that are computationally impractical to reverse would protect sellers from fraud, and routine escrow mechanisms could easily be implemented to protect buyers. In this paper, we propose a solution to the double-spending problem using a peer-to-peer distributed timestamp server to generate computational proof of the chronological order of transactions. Thesystem is secure as long as honest nodes collectively control more CPU power than anycooperating group of attacker nodes 所以，我们非常需要这样一种电子支付系统，它基于密码学原理而不基于信用，使得任何达成一致的双方，能够直接进行支付，从而不需要第三方中介的参与。杜绝回滚(reverse)支付交易的可能，这就可以保护特定的卖家免于欺诈；而对于想要保护买家的人来说，在此环境下设立通常的第三方担保机制也可谓轻松加愉快。在这篇论文中，我们(we)将提出一种通过点对点分布式的时间戳服务器来生成依照时间前后排列并加以记录的电子交易证明，从而解决双重支付问题。只要诚实的节点所控制的计算能力的总和，大于有合作关系的(cooperating)攻击者的计算能力的总和，该系统就是安全的。 Transactions(交易)We define an electronic coin as a chain of digital signatures. Each owner transfers the coin to the next by digitally signing a hash of the previous transaction and the public key of the next owner and adding these to the end of the coin. A payee can verify the signatures to verify the chain ofownership. 我们定义，一枚电子货币（an electronic coin）是这样的一串数字签名：每一位所有者通过对前一次交易和下一位拥有者的公钥(Public key) 签署一个随机散列的数字签名，并将这个签名附加在这枚电子货币的末尾，电子货币就发送给了下一位所有者。而收款人通过对签名进行检验，就能够验证该链条的所有者。 The problem of course is the payee can’t verify that one of the owners did not double-spend the coin. A common solution is to introduce a trusted central authority, or mint, that checks everytransaction for double spending. After each transaction, the coin must be returned to the mint to issue a new coin, and only coins issued directly from the mint are trusted not to be double-spent.The problem with this solution is that the fate of the entire money system depends on thecompany running the mint, with every transaction having to go through them, just like a bank. 该过程的问题在于，收款人将难以检验，之前的某位所有者，是否对这枚电子货币进行了双重支付。通常的解决方案，就是引入信得过的第三方权威，或者类似于造币厂(mint)的机构，来对每一笔交易进行检验，以防止双重支付。在每一笔交易结束后，这枚电子货币就要被造币厂回收，而造币厂将发行一枚新的电子货币；而只有造币厂直接发行的电子货币，才算作有效，这样就能够防止双重支付。可是该解决方案的问题在于，整个货币系统的命运完全依赖于运作造币厂的公司，因为每一笔交易都要经过该造币厂的确认，而该造币厂就好比是一家银行。 We need a way for the payee to know that the previous owners did not sign any earlier transactions. For our purposes, the earliest transaction is the one that counts, so we don’t care about later attempts to double-spend. The only way to confirm the absence of a transaction is to be aware of all transactions. In the mint based model, the mint was aware of all transactions and decided which arrived first. To accomplish this without a trusted party, transactions must be publicly announced [1], and we need a system for participants to agree on a single history of the order in which they were received. The payee needs proof that at the time of each transaction, the majority of nodes agreed it was the first received. 我们需要收款人有某种方法，能够确保之前的所有者没有对更早发生的交易实施签名。从逻辑上看，为了达到目的，实际上我们需要关注的只是于本交易之前发生的交易，而不需要关注这笔交易发生之后是否会有双重支付的尝试。为了确保某一次交易是不存在的，那么唯一的方法就是获悉之前发生过的所有交易。在造币厂模型里面，造币厂获悉所有的交易，并且决定了交易完成的先后顺序。如果想要在电子系统中排除第三方中介机构，那么交易信息就应当被公开宣布（publicly announced）1，我们需要整个系统内的所有参与者，都有唯一公认的历史交易序列。收款人需要确保在交易期间绝大多数的节点都认同该交易是首次出现。 Timestamp Server (时间戳服务器)The solution we propose begins with a timestamp server. A timestamp server works by taking a hash of a block of items to be timestamped and widely publishing the hash, such as in a newspaper or Usenet post [2-5]. The timestamp proves that the data must have existed at the time, obviously, in order to get into the hash. Each timestamp includes the previous timestamp inits hash, forming a chain, with each additional timestamp reinforcing the ones before it. 本解决方案首先提出一个“时间戳服务器”。时间戳服务器通过对以区块(block)形式存在的一组数据实施随机散列而加上时间戳，并将该随机散列进行广播，就像在新闻或世界性新闻组网络（Usenet）的发帖一样[2-5]。显然，该时间戳能够证实特定数据必然于某特定时刻是的确存在的，因为只有在该时刻存在了才能获取相应的随机散列值。每个时间戳应当将前一个时间戳纳入其随机散列值中，每一个随后的时间戳都对之前的一个时间戳进行增强(reinforcing)，这样就形成了一个链条（Chain）。 Proof-of-Work（工作量证明）To implement a distributed timestamp server on a peer-to-peer basis, we will need to use a proof-of-work system similar to Adam Back’s Hashcash [6], rather than newspaper or Usenet posts. The proof-of-work involves scanning for a value that when hashed, such as with SHA-256, the hash begins with a number of zero bits. The average work required is exponential in the number of zero bits required and can be verified by executing a single hash. 为了在点对点的基础上构建一组分散化的时间戳服务器，仅仅像报纸或世界性新闻网络组一样工作是不够的，我们还需要一个类似于亚当·柏克（Adam Back）提出的哈希现金（Hashcash）[6]。在进行随机散列运算时，工作量证明机制引入了对某一个特定值的扫描工作，比方说SHA-256下，随机散列值以一个或多个0 开始。那么随着0 的数目的上升, 找到这个解所需要的工作量将呈指数增长，但是检验结果仅需要一次随机散列运算。 For our timestamp network, we implement the proof-of-work by incrementing a nonce in theblock until a value is found that gives the block’s hash the required zero bits. Once the CPU effort has been expended to make it satisfy the proof-of-work, the block can not be changed without redoing the work. As later blocks are chained after it, the work to change the block would include redoing all the blocks after it. 我们在区块中补增一个随机数(Nonce)，这个随机数要使得该给定区块的随机散列值出现了所需的那么多个0。我们通过反复尝试来找到这个随机数，找到为止。这样我们就构建了一个工作量证明机制。只要该CPU 耗费的工作量能够满足该工作量证明机制，那么除非重新完成相当的工作量，该区块的信息就不可更改。由于之后的区块是链接在该区块之后的，所以想要更改该区块中的信息，就还需要重新完成之后所有区块的全部工作量 The proof-of-work also solves the problem of determining representation in majority decisionmaking. If the majority were based on one-IP-address-one-vote, it could be subverted by anyoneable to allocate many IPs. Proof-of-work is essentially one-CPU-one-vote. The majoritydecision is represented by the longest chain, which has the greatest proof-of-work effort invested in it. If a majority of CPU power is controlled by honest nodes, the honest chain will grow the fastest and outpace any competing chains. To modify a past block, an attacker would have to redo the proof-of-work of the block and all blocks after it and then catch up with and surpass thework of the honest nodes. We will show later that the probability of a slower attacker catching updiminishes exponentially as subsequent blocks are added. 同时，该工作量证明机制还解决了在集体投票表决时，谁是大多数的问题。如果决定大多数的方式是基于IP地址的，一IP地址一票，那么如果有人拥有分配大量IP地址的权力，则该机制就被破坏了。而工作量证明机制的本质则是一CPU一票。“大多数”的决定表达为最长的链，因为最长的链包含了最大的工作量。如果大多数的CPU为诚实的节点控制，那么诚实的链条将以最快的速度延长，并超越其他的竞争链条。如果想要对业已出现的区块进行修改，攻击者必须重新完成该区块的工作量外加该区块之后所有区块的工作量，并最终赶上和超越诚实节点的工作量。我们将在后文证明，设想一个较慢的攻击者试图赶上随后的区块，那么其成功概率将呈指数化递减。 To compensate for increasing hardware speed and varying interest in running nodes over time,the proof-of-work difficulty is determined by a moving average targeting an average number of blocks per hour. If they’re generated too fast, the difficulty increases 另一个问题是，硬件的运算速度在高速增长，且节点参与网络的程度会有所起伏。为了解决这个问题，工作量证明的难度(the proof-of-work difficulty)将采用移动平均目标的方法来确定，即令难度指向令每小时生成区块的速度为某一预设的平均数。如果区块生成的速度过快，那么难度就会提高。 Network（网络）The steps to run the network are as follows:1)New transactions are broadcast to all nodes.2)Each node collects new transactions into a block.3)Each node works on finding a difficult proof-of-work for its block.4)When a node finds a proof-of-work, it broadcasts the block to all nodes.5)Nodes accept the block only if all transactions in it are valid and not already spent.6)Nodes express their acceptance of the block by working on creating the next block in thechain, using the hash of the accepted block as the previous hash 运行该网络的步骤如下： 1) 新的交易向全网进行广播； 2) 每一个节点都将收到的交易信息纳入一个区块中； 3) 每个节点都尝试在自己的区块中找到一个具有足够难度的工作量证明； 4) 当一个节点找到了一个工作量证明，它就向全网进行广播； 5) 当且仅当包含在该区块中的所有交易都是有效的且之前未存在过的，其他节点才认同该区块的有效性； 6) 其他节点表示他们接受该区块，而表示接受的方法，则是在跟随该区块的末尾，制造新的区块以延长该链条，而将被接受区块的随机散列值视为先于新区快的随机散列值。 Nodes always consider the longest chain to be the correct one and will keep working onextending it. If two nodes broadcast different versions of the next block simultaneously, some nodes may receive one or the other first. In that case, they work on the first one they received,but save the other branch in case it becomes longer. The tie will be broken when the next proof-of-work is found and one branch becomes longer; the nodes that were working on the other branch will then switch to the longer one 节点始终都将最长的链条视为正确的链条，并持续工作和延长它。如果有两个节点同时广播不同版本的新区块，那么其他节点在接收到该区块的时间上将存在先后差别。当此情形，他们将在率先收到的区块基础上进行工作，但也会保留另外一个链条，以防后者变成最长的链条。该僵局（tie）的打破要等到下一个工作量证明被发现，而其中的一条链条被证实为是较长的一条，那么在另一条分支链条上工作的节点将转换阵营，开始在较长的链条上工作。 New transaction broadcasts do not necessarily need to reach all nodes. As long as they reach many nodes, they will get into a block before long. Block broadcasts are also tolerant of droppedmessages. If a node does not receive a block, it will request it when it receives the next block and realizes it missed one. 所谓“新的交易要广播”，实际上不需要抵达全部的节点。只要交易信息能够抵达足够多的节点，那么他们将很快被整合进一个区块中。而区块的广播对被丢弃的信息是具有容错能力的。如果一个节点没有收到某特定区块，那么该节点将会发现自己缺失了某个区块，也就可以提出自己下载该区块的请求。 Incentive（Conclusion）By convention, the first transaction in a block is a special transaction that starts a new coin owned by the creator of the block. This adds an incentive for nodes to support the network, and providesa way to initially distribute coins into circulation, since there is no central authority to issue them.The steady addition of a constant of amount of new coins is analogous to gold miners expending resources to add gold to circulation. In our case, it is CPU time and electricity that is expended. 我们约定如此：每个区块的第一笔交易进行特殊化处理，该交易产生一枚由该区块创造者拥有的新的电子货币。这样就增加了节点支持该网络的激励，并在没有中央集权机构发行货币的情况下，提供了一种将电子货币分配到流通领域的一种方法。这种将一定数量新货币持续增添到货币系统中的方法，非常类似于耗费资源去挖掘金矿并将黄金注入到流通领域。此时，CPU的时间和电力消耗就是消耗的资源。 The incentive can also be funded with transaction fees. If the output value of a transaction is less than its input value, the difference is a transaction fee that is added to the incentive value of the block containing the transaction. Once a predetermined number of coins have entered circulation, the incentive can transition entirely to transaction fees and be completely inflation free 另外一个激励的来源则是交易费（transaction fees）。如果某笔交易的输出值小于输入值，那么差额就是交易费，该交易费将被增加到该区块的激励中。只要既定数量的电子货币已经进入流通，那么激励机制就可以逐渐转换为完全依靠交易费，那么本货币系统就能够免于通货膨胀。 he incentive may help encourage nodes to stay honest. If a greedy attacker is able toassemble more CPU power than all the honest nodes, he would have to choose between using itto defraud people by stealing back his payments, or using it to generate new coins. He ought tofind it more profitable to play by the rules, such rules that favour him with more new coins than everyone else combined, than to undermine the system and the validity of his own wealth. 激励系统也有助于鼓励节点保持诚实。如果有一个贪婪的攻击者能够调集比所有诚实节点加起来还要多的CPU计算力，那么他就面临一个选择：要么将其用于诚实工作产生新的电子货币，或者将其用于进行二次支付攻击。那么他就会发现，按照规则行事、诚实工作是更有利可图的。因为该等规则使得他能够拥有更多的电子货币，而不是破坏这个系统使得其自身财富的有效性受损。 Reclaiming Disk Space（回收磁盘空间）Once the latest transaction in a coin is buried under enough blocks, the spent transactions before it can be discarded to save disk space. To facilitate this without breaking the block’s hash,transactions are hashed in a Merkle Tree [7][2][5], with only the root included in the block’s hash.Old blocks can then be compacted by stubbing off branches of the tree. The interior hashes donot need to be stored. 如果最近的交易已经被纳入了足够多的区块之中，那么就可以丢弃该交易之前的数据，以回收硬盘空间。为了同时确保不损害区块的随机散列值，交易信息被随机散列时，被构建成一种Merkle树（Merkle tree）[7]的形态，使得只有根(root)被纳入了区块的随机散列值。通过将该树（tree）的分支拔除（stubbing）的方法，老区块就能被压缩。而内部的随机散列值是不必保存的。 A block header with no transactions would be about 80 bytes. If we suppose blocks aregenerated every 10 minutes, 80 bytes 6 24 * 365 = 4.2MB per year. With computer systems typically selling with 2GB of RAM as of 2008, and Moore’s Law predicting current growth of1.2GB per year, storage should not be a problem even if the block headers must be kept inmemory. 不含交易信息的区块头（Block header）大小仅有80字节。如果我们设定区块生成的速率为每10分钟一个，那么每一年产生的数据位4.2MB。（80 bytes 6 24 * 365 = 4.2MB）。2008年，PC系统通常的内存容量为2GB，按照摩尔定律的预言，即使将全部的区块头存储于内存之中都不是问题。 Simplified Payment Verification(简化的支付确认)It is possible to verify payments without running a full network node. A user only needs to keep a copy of the block headers of the longest proof-of-work chain, which he can get by querying network nodes until he’s convinced he has the longest chain, and obtain the Merkle branch linking the transaction to the block it’s timestamped in. He can’t check the transaction for himself, but by linking it to a place in the chain, he can see that a network node has accepted it,and blocks added after it further confirm the network has accepted it. 在不运行完整网络节点的情况下，也能够对支付进行检验。一个用户需要保留最长的工作量证明链条的区块头的拷贝，它可以不断向网络发起询问，直到它确信自己拥有最长的链条，并能够通过merkle的分支通向它被加上时间戳并纳入区块的那次交易。节点想要自行检验该交易的有效性原本是不可能的，但通过追溯到链条的某个位置，它就能看到某个节点曾经接受过它，并且于其后追加的区块也进一步证明全网曾经接受了它。 As such, the verification is reliable as long as honest nodes control the network, but is more vulnerable if the network is over powered by an attacker. While network nodes can verify transactions for themselves, the simplified method can be fooled by an attacker’s fabricated transactions for as long as the attacker can continue to over power the network. One strategy to protect against this would be to accept alerts from network nodes when they detect an invalid block, prompting the user’s software to download the full block and alerted transactions to confirm the inconsistency. Businesses that receive frequent payments will probably still want to run their own nodes for more independent security and quicker verification. 当此情形，只要诚实的节点控制了网络，检验机制就是可靠的。但是，当全网被一个计算力占优的攻击者攻击时，将变得较为脆弱。因为网络节点能够自行确认交易的有效性，只要攻击者能够持续地保持计算力优势，简化的机制会被攻击者焊接的（fabricated）交易欺骗。那么一个可行的策略就是，只要他们发现了一个无效的区块，就立刻发出警报，收到警报的用户将立刻开始下载被警告有问题的区块或交易的完整信息，以便对信息的不一致进行判定。对于日常会发生大量收付的商业机构，可能仍会希望运行他们自己的完整节点，以保持较大的独立完全性和检验的快速性。 Combining and Splitting Value(价值的组合与分割)Although it would be possible to handle coins individually, it would be unwieldy to make aseparate transaction for every cent in a transfer. To allow value to be split and combined,transactions contain multiple inputs and outputs. Normally there will be either a single inputfrom a larger previous transaction or multiple inputs combining smaller amounts, and at most two outputs: one for the payment, and one returning the change, if any, back to the sender.It should be noted that fan-out, where a transaction depends on several transactions, and those transactions depend on many more, is not a problem here. There is never the need to extract acomplete standalone copy of a transaction’s history. 虽然可以单个单个地对电子货币进行处理，但是对于每一枚电子货币单独发起一次交易将是一种笨拙的办法。为了使得价值易于组合与分割，交易被设计为可以纳入多个输入和输出。一般而言是某次价值较大的前次交易构成的单一输入，或者由某几个价值较小的前次交易共同构成的并行输入，但是输出最多只有两个：一个用于支付，另一个用于找零（如有）。 需要指出的是，虽然一笔交易依赖于之前的多笔交易、这些交易又各自依赖于多笔交易，但是这并不存在任何问题。因为这个工作机制并不需要展开检验之前发生的所有交易历史。 Privacy(隐私)The traditional banking model achieves a level of privacy by limiting access to information to the parties involved and the trusted third party. The necessity to announce all transactions publicly precludes this method, but privacy can still be maintained by breaking the flow of information in another place: by keeping public keys anonymous. The public can see that someone is sending an amount to someone else, but without information linking the transaction to anyone. This issimilar to the level of information released by stock exchanges, where the time and size ofindividual trades, the “tape”, is made public, but without telling who the parties were. 传统的造币厂模型为交易的参与者提供了一定程度的隐私保护，因为试图向可信任的第三方索取交易信息是严格受限的。但是如果将交易信息向全网进行广播，就意味着这样的方法失效了。但是隐私依然可以得到保护：将公钥保持为匿名。公众得知的信息仅仅是有某个人将一定数量的货币发所给了另外一个人，但是难以将该交易同某个特定的人联系在一起，也就是说，公众难以确信，这些人究竟是谁。这同股票交易所发布的信息是类似的，每一手股票买卖发生的时间、交易量是记录在案且可供查询的，但是交易双方的身份信息却不予透露。 As an additional firewall, a new key pair should be used for each transaction to keep them from being linked to a common owner. Some linking is still unavoidable with multi-inputtransactions, which necessarily reveal that their inputs were owned by the same owner. The riskis that if the owner of a key is revealed, linking could reveal other transactions that belonged tothe same owner 作为额外的预防措施，使用者可以让每次交易都生成一个新的地址，以确保这些交易不被追溯到一个共同的所有者。不过由于存在并行输入，一定程度上的追溯还是不可避免的，因为并行输入暗示这些货币都属于同一个所有者。此时的风险在于，如果某个人的某一个公钥被确认属于他，那么就可以追溯出此人的其它很多交易。 Calculations（计算）We consider the scenario of an attacker trying to generate an alternate chain faster than the honestchain. Even if this is accomplished, it does not throw the system open to arbitrary changes, such as creating value out of thin air or taking money that never belonged to the attacker. Nodes are not going to accept an invalid transaction as payment, and honest nodes will never accept a blockcontaining them. An attacker can only try to change one of his own transactions to take backmoney he recently spent. 设想如下场景：一个攻击者试图比诚实节点产生链条更快地制造替代性区块链。即便它达到了这一目的，但是整个系统也并非就此完全受制于攻击者的独断意志了，比方说凭空创造价值，或者掠夺本不属于攻击者的货币。这是因为节点将不会接受无效的交易，而诚实的节点永远不会接受一个包含了无效信息的区块。一个攻击者能做的，最多是更改他自己的交易信息，并试图拿回他刚刚付给别人的钱。 The race between the honest chain and an attacker chain can be characterized as a Binomial Random Walk. The success event is the honest chain being extended by one block, increasing its lead by +1, and the failure event is the attacker’s chain being extended by one block, reducing thegap by -1. 诚实链条和攻击者链条之间的竞赛，可以用二叉树随机漫步（Binomial Random Walk)来描述。成功事件定义为诚实链条延长了一个区块，使其领先性+1，而失败事件则是攻击者的链条被延长了一个区块，使得差距-1。 The probability of an attacker catching up from a given deficit is analogous to a Gambler’sRuin problem. Suppose a gambler with unlimited credit starts at a deficit and plays potentially aninfinite number of trials to try to reach breakeven. We can calculate the probability he everreaches breakeven, or that an attacker ever catches up with the honest chain, as follows [8]:p = probability an honest node finds the next blockq = probability the attacker finds the next block$q_z$ = probability the attacker will ever catch up from z blocks behind 攻击者成功填补某一既定差距的可能性，可以近似地看做赌徒破产问题（Gambler’s Ruin problem）。假定一个赌徒拥有无限的透支信用，然后开始进行潜在次数为无穷的赌博，试图填补上自己的亏空。那么我们可以计算他填补上亏空的概率，也就是该攻击者赶上诚实链条，如下所示[8]：p=诚实节点制造出下一个节点的概率q=攻击者制造出下一个节点的概率qz=攻击者最终消弭了z个区块的落后差距 Given our assumption that p &gt; q, the probability drops exponentially as the number of blocks theattacker has to catch up with increases. With the odds against him, if he doesn’t make a lucky lunge forward early on, his chances become vanishingly small as he falls further behind.We now consider how long the recipient of a new transaction needs to wait before being sufficiently certain the sender can’t change the transaction. We assume the sender is an attacker who wants to make the recipient believe he paid him for a while, then switch it to pay back to himself after some time has passed. The receiver will be alerted when that happens, but the sender hopes it will be too late. 假定p&gt;q，那么攻击成功的概率就因为区块数的增长而呈现指数化下降。由于概率是攻击者的敌人，如果他不能幸运且快速地获得成功，那么他获得成功的机会随着时间的流逝就变得愈发渺茫。那么我们考虑一个收款人需要等待多长时间，才能足够确信付款人已经难以更改交易了。我们假设付款人是一个支付攻击者，希望让收款人在一段时间内相信他已经付过款了，然后立即将支付的款项重新支付给自己。虽然收款人届时会发现这一点，但为时已晚。 The receiver generates a new key pair and gives the public key to the sender shortly beforesigning. This prevents the sender from preparing a chain of blocks ahead of time by working onit continuously until he is lucky enough to get far enough ahead, then executing the transaction atthat moment. Once the transaction is sent, the dishonest sender starts working in secret on aparallel chain containing an alternate version of his transaction. 收款人生成了新的一对密钥组合，然后只预留一个较短的时间将公钥发送给付款人。这将可以防止以下情况：付款人预先准备好一个区块链然后持续地对此区块进行运算，直到运气让他的区块链超越了诚实链条，方才立即执行支付。当此情形，只要交易一旦发出，攻击者就开始秘密地准备一条包含了该交易替代版本的平行链条。 The recipient waits until the transaction has been added to a block and z blocks have beenlinked after it. He doesn’t know the exact amount of progress the attacker has made, butassuming the honest blocks took the average expected time per block, the attacker’s potentialprogress will be a Poisson distribution with expected value:然后收款人将等待交易出现在首个区块中，然后在等到z个区块链接其后。此时，他仍然不能确切知道攻击者已经进展了多少个区块，但是假设诚实区块将耗费平均预期时间以产生一个区块，那么攻击者的潜在进展就是一个泊松分布，分布的期望值为： To get the probability the attacker could still catch up now, we multiply the Poisson density foreach amount of progress he could have made by the probability he could catch up from that point:当此情形，为了计算攻击者追赶上的概率，我们将攻击者取得进展区块数量的泊松分布的概率密度，乘以在该数量下攻击者依然能够追赶上的概率。 Rearranging to avoid summing the infinite tail of the distribution…化为如下形式，避免对无限数列求和： Converting to C code…写为如下C语言代码：123456789101112131415#include &lt;math.h&gt; double AttackerSuccessProbability(double q, int z)&#123; double p = 1.0 - q; double lambda = z * (q / p); double sum = 1.0; int i, k; for (k = 0; k &lt;= z; k++) &#123; double poisson = exp(-lambda); for (i = 1; i &lt;= k; i++) poisson *= lambda / i; sum -= poisson * (1 - pow(q / p, z - k)); &#125; return sum; &#125; Running some results, we can see the probability drop off exponentially with z.对其进行运算，我们可以得到如下的概率结果，发现概率对z值呈指数下降。q=0.1z=0 P=1.0000000z=1 P=0.2045873z=2 P=0.0509779z=3 P=0.0131722z=4 P=0.0034552z=5 P=0.0009137z=6 P=0.0002428z=7 P=0.0000647z=8 P=0.0000173z=9 P=0.0000046z=10 P=0.0000012q=0.3z=0 P=1.0000000z=5 P=0.1773523z=10 P=0.0416605z=15 P=0.0101008z=20 P=0.0024804z=25 P=0.0006132z=30 P=0.0001522z=35 P=0.0000379z=40 P=0.0000095z=45 P=0.0000024z=50 P=0.000000Solving for P less than 0.1%…P &lt; 0.001q=0.10 z=5q=0.15 z=8q=0.20 z=11q=0.25 z=15q=0.30 z=24q=0.35 z=41q=0.40 z=89q=0.45 z=340 Conclusion(总结)We have proposed a system for electronic transactions without relying on trust. We started with the usual framework of coins made from digital signatures, which provides strong control ofownership, but is incomplete without a way to prevent double-spending. To solve this, we proposed a peer-to-peer network using proof-of-work to record a public history of transactions that quickly becomes computationally impractical for an attacker to change if honest nodescontrol a majority of CPU power. The network is robust in its unstructured simplicity. Nodes work all at once with little coordination. They do not need to be identified, since messages are not routed to any particular place and only need to be delivered on a best effort basis. Nodes can leave and rejoin the network at will, accepting the proof-of-work chain as proof of what happened while they were gone. They vote with their CPU power, expressing their acceptance of valid blocks by working on extending them and rejecting invalid blocks by refusing to work onthem. Any needed rules and incentives can be enforced with this consensus mechanism. 我们在此提出了一种不需要信用中介的电子支付系统。我们首先讨论了通常的电子货币的电子签名原理，虽然这种系统为所有权提供了强有力的控制，但是不足以防止双重支付。为了解决这个问题，我们提出了一种采用工作量证明机制的点对点网络来记录交易的公开信息，只要诚实的节点能够控制绝大多数的CPU计算能力，就能使得攻击者事实上难以改变交易记录。该网络的强健之处在于它结构上的简洁性。节点之间的工作大部分是彼此独立的，只需要很少的协同。每个节点都不需要明确自己的身份，由于交易信息的流动路径并无任何要求，所以只需要尽其最大努力传播即可。节点可以随时离开网络，而想重新加入网络也非常容易，因为只需要补充接收离开期间的工作量证明链条即可。节点通过自己的CPU计算力进行投票，表决他们对有效区块的确认，他们不断延长有效的区块链来表达自己的确认，并拒绝在无效的区块之后延长区块以表示拒绝。本框架包含了一个P2P电子货币系统所需要的全部规则和激励措施 References（引用）[1]W. Dai, “b-money,” http://www.weidai.com/bmoney.txt, 1998. 一种能够借助电子假名在群体内部相互支付并迫使个体遵守规则且不需要外界协助的电子现金机制 [2]H. Massias, X.S. Avila, and J.-J. Quisquater, “Design of a secure timestamping service with minimaltrust requirements,” In 20th Symposium on Information Theory in the Benelux, May 1999. 在最小化信任的基础上设计一种时间戳服务器 [3]S. Haber, W.S. Stornetta, “How to time-stamp a digital document,” In Journal of Cryptology, vol 3, no2, pages 99-111, 1991. 怎样为电子文件添加时间戳 [4]D. Bayer, S. Haber, W.S. Stornetta, “Improving the efficiency and reliability of digital time-stamping,”In Sequences II: Methods in Communication, Security and Computer Science, pages 329-334, 1993. 提升电子时间戳的效率和可靠性 [5]S. Haber, W.S. Stornetta, “Secure names for bit-strings,” In Proceedings of the 4th ACM Conferenceon Computer and Communications Security, pages 28-35, April 1997. 比特字串的安全命名 [6]A. Back, “Hashcash - a denial of service counter-measure,”http://www.hashcash.org/papers/hashcash.pdf, 2002 哈希现金——拒绝服务式攻击的克制方法 [7]R.C. Merkle, “Protocols for public key cryptosystems,” In Proc. 1980 Symposium on Security andPrivacy, IEEE Computer Society, pages 122-133, April 1980. 公钥密码体制协议 [8]W. Feller, “An introduction to probability theory and its applications,” 1957.9 概率论及其应用 声明本文100%为组合翻译，详见引用,0%为原创https:www.bitcoin.org/bitcoin.pdf]]></content>
      <categories>
        <category>区块链</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【分布式数据库】区域链技术（Blockchain Technology）]]></title>
    <url>%2Fpresentation.html</url>
    <content type="text"><![CDATA[最近在学校做的一次3分钟的英文技术分享，本着厚颜无耻的态度还是把它分享出来了，讲的非常浅显，但区域链确是未来分布式数据发展的方向。 开场引出区域链技术–&gt; 数据膨胀案例导入–&gt; 解决方案解决方案–&gt; 总结总结–！ 声明本文0%为组合翻译,100%为原创 引用无]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【密码学】Diffie-Hellman密钥交换]]></title>
    <url>%2FDiffie-Hellman.html</url>
    <content type="text"><![CDATA[Diffie-Hellman密钥交换Diffie-Hellman密钥交换是RSA之前的算法，其中的原理就是单项函数，如下图所示在已知下图的模式下，任意跟换X可以获得不同的输出，但是从输出你无法获取X，RSA的算法基石假设ALICE和BOB进行通信，而EVE是个监听者，首先ALICE根据上左边的选择一个任意的X54经过计算得出结果15发给BOBBOB同样选择任意一个X24按照上图的公式进行计算得出16，此时54,24分别为ALICE和BOB的私有，15和16则为公开的数据，监听者EVE可以获取15和16 其中1为将来需要交换的秘钥，两边接收的相同$$3^{54\ast24}mod\quad17 =3^{24\ast54}mod\quad17 = 1$$证明$$16^{54}mod\quad17 = (3^{24}mod17)^{54}mod\quad17 = 3^{24\ast54}mod\quad17$$同理$$15^{24}mod\quad17 = (3^{54}mod17)^{24}mod\quad17 = 3^{54\ast24}mod\quad17$$ 声明本文70%为组合，详见引用,30%为原创 引用https://www.khanacademy.org/computing/computer-science/cryptography/modern-crypt/v/diffie-hellman-key-exchange-part-2]]></content>
      <categories>
        <category>密码学</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】五种通用WEB应用服务架构（5 Common Server Setups For Your Web Application）]]></title>
    <url>%2F5%20Common%20Server%20Setups%20For%20Your%20Web%20Application.html</url>
    <content type="text"><![CDATA[简介（Introduction）When deciding which server architecture to use for your environment, there are many factors to consider, such as performance, scalability, availability, reliability, cost, and ease of management.Here is a list of commonly used server setups, with a short description of each, including pros and cons. Keep in mind that all of the concepts covered here can be used in various combinations with one another, and that every environment has different requirements, so there is no single, correct configuration. 在决定为您的环境使用哪种服务器体系结构时，需要考虑很多因素，如性能，可扩展性，可用性，可靠性，成本和易于管理。这里是常用的服务器设置列表，每个都有简短的描述，包括利弊。 请记住，此处涵盖的所有概念可以彼此不同的组合使用，并且每个环境都有不同的要求，因此没有单一，正确的配置。 所有东西都放在一个服务器上（Everything On One Server）The entire environment resides on a single server. For a typical web application, that would include the web server, application server, and database server. A common variation of this setup is a LAMP stack, which stands for Linux, Apache, MySQL, and PHP, on a single server. Use Case: Good for setting up an application quickly, as it is the simplest setup possible, but it offers little in the way of scalability and component isolation. Pros:Simple Cons:1.Application and database contend for the same server resources (CPU, Memory, I/O, etc.) which, aside from possible poor performance, can make it difficult to determine the source (application or database) of poor performance2.Not readily horizontally scalable整个环境驻留在单个服务器上。 典型的Web应用程序将包括Web服务器，应用程序服务器和数据库服务器。 这种设置的一个常见变体是LAMP堆栈，它的代表Linux，Apache，MySQL和PHP，部署在单个服务器上。使用案例：适合快速设置应用程序，因为它是可能的最简单的设置，但它不提供可扩展性和组件隔离的方式。优点：简单缺点：1.应用程序和数据库争用相同的服务器资源（CPU，内存，I / O等），除了可能的性能低下外，你也很难确定到底是谁的性能问题2.不容易水平扩展 数据服务器分离（Separate Database Server）The database management system (DBMS) can be separated from the rest of the environment to eliminate the resource contention between the application and the database, and to increase security by removing the database from the DMZ, or public internet. Use Case: Good for setting up an application quickly, but keeps application and database from fighting over the same system resources. Pros:1.Application and database tiers do not contend for the same server resources (CPU, Memory, I/O, etc.)You may vertically scale each tier separately, by adding more resources to whichever server needs increased capacity2.Depending on your setup, it may increase security by removing your database from the DMZ Cons:1.Slightly more complex setup than single server2.Performance issues can arise if the network connection between the two servers is high-latency (i.e. the servers are geographically distant from each other), or the bandwidth is too low for the amount of data being transferred 数据库管理系统（DBMS）可以与环境的其余部分分离，以消除应用程序和数据库之间的资源争用，并且通过从DMZ或公共因特网移除数据库来增加安全性。使用案例：适合快速设置应用程序，避免了应用程序和数据库在同一系统资源上的战斗。优点：1.应用程序和数据库层不竞争相同的服务器资源（CPU，内存，I / O等）,您可以通过向任何服务器需要增加的容量添加更多资源来单独垂直扩展每个层2.根据您的设置，它可以通过从DMZ中删除数据库来提高安全性缺点：1.比单服务器设置更复杂2.如果两个服务器之间的网络连接是高延迟（即，服务器在地理上彼此远离），或者带宽对于传送的数据量太低，则可能出现性能问题 负载均衡（Load Balancer-Reverse Proxy）Load balancers can be added to a server environment to improve performance and reliability by distributing the workload across multiple servers. If one of the servers that is load balanced fails, the other servers will handle the incoming traffic until the failed server becomes healthy again. It can also be used to serve multiple applications through the same domain and port, by using a layer 7 (application layer) reverse proxy.Examples of software capable of reverse proxy load balancing: HAProxy, Nginx, and Varnish. Use Case: Useful in an environment that requires scaling by adding more servers, also known as horizontal scaling. Pros:1.Enables horizontal scaling, i.e. environment capacity can be scaled by adding more servers to it2.Can protect against DDOS attacks by limiting client connections to a sensible amount and frequency Cons:1.The load balancer can become a performance bottleneck if it does not have enough resources, or if it is configured poorly2.Can introduce complexities that require additional consideration, such as where to perform SSL termination and how to handle applications that require sticky sessions3.The load balancer is a single point of failure; if it goes down, your whole service can go down. A high availability (HA) setup is an infrastructure without a single point of failure. To learn how to implement an HA setup, you can read this section of How To Use Floating IPs. 负载平衡器可以添加到服务器环境中，以通过在多个服务器之间分配工作负载来提高性能和可靠性。如果其中一个负载平衡的服务器失败，其他服务器将处理传入流量，直到失败的服务器再次变得健康。它还可以用于通过使用第7层（应用层）反向代理通过相同的域和端口服务多个应用。能够进行逆向代理负载平衡的软件示例：HAProxy，Nginx和Varnish。用例：在需要通过添加更多服务器进行扩展的环境中有用，也称为水平缩放。优点：1.启用水平扩展，即可通过向其中添加更多服务器来扩展环境容量2.通过将客户端连接限制在明显的数量和频率，可防止DDOS攻击缺点：1.如果负载均衡器没有足够的资源或者配置不当，它可能会成为性能瓶颈2.可能引入需要额外考虑的复杂性，例如在何处执行SSL终止以及如何处理需要粘性会话的应用程序3.负载均衡器是单点故障;如果它下降，你的整个服务可以下降。高可用性（HA）设置是没有单点故障的基础设施。要了解如何实施HA设置，您可以阅读如何使用浮动IP的此部分。 HTTP Accelerator (Caching Reverse Proxy)An HTTP accelerator, or caching HTTP reverse proxy, can be used to reduce the time it takes to serve content to a user through a variety of techniques. The main technique employed with an HTTP accelerator is caching responses from a web or application server in memory, so future requests for the same content can be served quickly, with less unnecessary interaction with the web or application servers. Examples of software capable of HTTP acceleration: Varnish, Squid, Nginx. Use Case: Useful in an environment with content-heavy dynamic web applications, or with many commonly accessed files.Pros:1.Increase site performance by reducing CPU load on web server, through caching and compression, thereby increasing user capacity2.Can be used as a reverse proxy load balancer3.Some caching software can protect against DDOS attacksCons:1.Requires tuning to get best performance out of it2.If the cache-hit rate is low, it could reduce performance HTTP加速器或缓存HTTP反向代理可用于减少通过各种技术向用户提供内容所需的时间。 HTTP加速器采用的主要技术是缓存来自内存中的Web或应用程序服务器的响应，因此可以快速提供对相同内容的未来请求，同时减少与Web或应用程序服务器之间的不必要的交互。 能够进行HTTP加速的软件示例：Varnish，Squid，Nginx。用例：适用于内容繁多的动态Web应用程序或许多常用文件的环境。优点：1.通过减少Web服务器上的CPU负载，通过缓存和压缩来提高站点性能，从而提高用户容量可用作逆向代理负载均衡器2.一些缓存软件可以防止DDOS攻击缺点：1.需要调整以获得最佳性能2.如果缓存命中率低，则可能降低性能 主备互用，读写分离（Master-Slave Database Replication）One way to improve performance of a database system that performs many reads compared to writes, such as a CMS, is to use master-slave database replication. Master-slave replication requires a master and one or more slave nodes. In this setup, all updates are sent to the master node and reads can be distributed across all nodes. Use Case: Good for increasing the read performance for the database tier of an application. Here is an example of a master-slave replication setup, with a single slave node: Pros:1.Improves database read performance by spreading reads across slaves2.Can improve write performance by using master exclusively for updates (it spends no time serving read requests)Cons:1.The application accessing the database must have a mechanism to determine which database nodes it should send update and read requests to2.Updates to slaves are asynchronous, so there is a chance that their contents could be out of date3.If the master fails, no updates can be performed on the database until the issue is corrected4.Does not have built-in failover in case of failure of master node 与写操作（例如CMS）相比，提高执行许多读取操作的数据库系统性能的一种方法是使用主从数据库复制。主从复制需要主节点和一个或多个从节点。在此设置中，所有更新都发送到主节点，读取可以分布在所有节点上。 用例：适用于提高应用程序的数据库层的读取性能。 以下是具有单个从节点的主从复制设置的示例：优点：1.通过在从机之间传播读，提高数据库读性能2.可以通过使用专用于更新的主机来提高写入性能（它不需要时间提供读取请求）缺点：1.访问数据库的应用程序必须有一个机制来确定它应该向其发送更新和读取请求的数据库节点2.更新到从属设备是异步的，因此有可能它们的内容可能已过期3.如果主服务器失败，则无法对数据库执行更新，直到问题得到纠正4.在主节点故障的情况下没有内置故障转移 综合用法（Combining the Concepts）It is possible to load balance the caching servers, in addition to the application servers, and use database replication in a single environment. The purpose of combining these techniques is to reap the benefits of each without introducing too many issues or complexity. Here is an example diagram of what a server environment could look like: Let’s assume that the load balancer is configured to recognize static requests (like images, css, javascript, etc.) and send those requests directly to the caching servers, and send other requests to the application servers. Here is a description of what would happen when a user sends a requests dynamic content: The user requests dynamic content from http://example.com/ (load balancer)The load balancer sends request to app-backendapp-backend reads from the database and returns requested content to load balancerThe load balancer returns requested data to the userIf the user requests static content: The load balancer checks cache-backend to see if the requested content is cached (cache-hit) or not (cache-miss)If cache-hit: return the requested content to the load balancer and jump to Step 7. If cache-miss: the cache server forwards the request to app-backend, through the load balancerThe load balancer forwards the request through to app-backendapp-backend reads from the database then returns requested content to the load balancerThe load balancer forwards the response to cache-backendcache-backend caches the content then returns it to the load balancerThe load balancer returns requested data to the userThis environment still has two single points of failure (load balancer and master database server), but it provides the all of the other reliability and performance benefits that were described in each section above. 除了应用程序服务器之外，还可以对缓存服务器进行负载平衡，并在单个环境中使用数据库复制。组合这些技术的目的是获得每个技术的益处而不引入太多的问题或复杂性。以下是服务器环境可能类似的示例图：让我们假设负载均衡器被配置为识别静态请求（如图像，css，javascript等），并将这些请求直接发送到缓存服务器，并向应用服务器发送其他请求。 以下是用户发送请求动态内容时会发生什么的说明： 用户从http://example.com/（负载平衡器）请求动态内容，负载均衡器向app-backend发送请求app-backend从数据库读取并将请求的内容返回到负载平衡器负载平衡器将请求的数据返回给用户如果用户请求静态内容： 负载平衡器检查缓存后端以查看请求的内容是否被缓存（缓存命中）或不缓存（缓存未命中）如果cache-hit：将请求的内容返回到负载均衡器并跳转到步骤7.如果cache-miss：缓存服务器通过负载均衡器将请求转发到app-backend负载平衡器将请求转发到应用后端应用程序后端读取从数据库然后返回请求的内容到负载平衡器负载平衡器将响应转发到缓存后端缓存后端缓存内容，然后将其返回到负载均衡器负载平衡器将请求的数据返回给用户此环境仍然有两个单点故障（负载平衡器和主数据库服务器），但它提供了上面每个部分中描述的所有其他可靠性和性能优势。 结论（Conclusion）Now that you are familiar with some basic server setups, you should have a good idea of what kind of setup you would use for your own application(s). If you are working on improving your own environment, remember that an iterative process is best to avoid introducing too many complexities too quickly. Let us know of any setups you recommend or would like to learn more about in the comments below! By Mitchell Anicas 现在你已经熟悉了一些基本的服务器设置，你应该明白你将在你自己的应用程序中使用什么样的设置。 如果你正在努力改善你自己的环境，记住一个迭代的过程是最好避免太快地引入太多的复杂性。 让我们知道您推荐的任何设置，或者想在下面的评论中了解更多信息！ 作者：Mitchell Anicas 声明本文100%为组合翻译，详见引用,0%为原创 引用https://www.digitalocean.com/community/tutorials/5-common-server-setups-for-your-web-application]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】聊聊TCP协议 Version 0.1]]></title>
    <url>%2Ftcp.html</url>
    <content type="text"><![CDATA[TCP的报文结构（TCP segment structure）basic structureInteractive applications,however, often transmit data chunks that are smaller than the MSS; for example, with remote login applications like Telnet, the data field in the TCP segment is often only one byte. Because the TCP header is typically 20 bytes (12 bytes more than the UDP header), segments sent by Telnet may be only 21 bytes in length. Figure bellow shows the structure of the TCP segment.As with UDP, the header includes source and destination port numbers , which are used for multiplexing/demultiplexing data from/to upper-layer applications. Also, as with UDP, the header includes a checksum field . A TCP segment header also contains the following fields: The 32-bit sequence number field and the 32-bit acknowledgment number field are used by the TCP sender and receiver in implementing a reliable data transfer service, as discussed below. The 16-bit receive window field is used for flow control. We will see shortly that it is used to indicate the number of bytes that a receiver is willing to accept. The 4-bit header length field specifies the length of the TCP header in 32-bit words. The TCP header can be of variable length due to the TCP options field. The optional and variable-length options field is used when a sender and receiver negotiate the maximum segment size (MSS) or as a window scaling factor for use in high-speed networks. A time-stamping option is also defined. See RFC 854 and RFC 1323 for additional details. The flag field contains 6 bits. The ACK bit is used to indicate that the value carried in the acknowledgment field is valid; that is, the segment contains an acknowledgment for a segment that has been successfully received. The RST, SYN, and FIN bits are used for connection setup and teardown, as we will discuss at the end of this section. Setting the PSH bit indicates that the receiver should pass the data to the upper layer immediately. Finally, the URG bit is used to indicate that there is data in this segment that the sending-side upper-layer entity has marked as “urgent.” The location of the last byte of this urgent data is indicated by the 16-bit urgent data pointer field. TCP must inform the receiving-side upper-layer entity when urgent data exists and pass it a pointer to the end of the urgent data. (In practice, the PSH, URG, and the urgent data pointer are not used. However, we mention these fields for completeness.)Demo: Sequence Numbers and Acknowledgment NumbersTwo of the most important fields in the TCP segment header are the sequence number field and the acknowledgment number field. These fields are a critical part of TCP’s reliable data transfer service. But before discussing how these fields are used to provide reliable data transfer, let us first explain what exactly TCP puts in these fields.TCP views data as an unstructured, but ordered, stream of bytes. TCP’s use of sequence numbers reflects this view in that sequence numbers are over the stream of transmitted bytes and not over the series of transmitted segments. The sequence number for a segment is therefore the byte-stream number of the first byte in the segment. Let’s look at an example. Suppose that a process in Host A wants to send a stream of data to a process in Host B over a TCP connection. The TCP in Host A will implicitly number each byte in the data stream. Suppose that the data stream consists of a file consisting of 500,000 bytes, that the MSS is 1,000 bytes, and that the first byte of the data stream is numbered 0.As shown in Figure bellow,TCP constructs 500 segments out of the data stream. The first segment gets assigned sequence number 0, the second segment gets assigned sequence number 1,000, the third segment gets assigned sequence number 2,000, and so on. Each sequence number is inserted in the sequence number field in the header of the appropriate TCP segment.Now let’s consider acknowledgment numbers. These are a little trickier than sequence numbers. Recall that TCP is full-duplex, so that Host A may be receiving data from Host B while it sends data to Host B (as part of the same TCP connection). Each of the segments that arrive from Host B has a sequence number for the dataflowing from B to A. The acknowledgment number that Host A puts in its segment is the sequence number of the next byte Host A is expecting from Host B. It is good to look at a few examples to understand what is going on here. Suppose that Host A has received all bytes numbered 0 through 535 from B and suppose that it is aboutto send a segment to Host B. Host A is waiting for byte 536 and all the subsequent bytes in Host B’s data stream. So Host A puts 536 in the acknowledgment number field of the segment it sends to B.As another example, suppose that Host A has received one segment from Host B containing bytes 0 through 535 and another segment containing bytes 900 through 1,000. For some reason Host A has not yet received bytes 536 through 899. In this example, Host A is still waiting for byte 536 (and beyond) in order to re-create B’sdata stream. Thus, A’s next segment to B will contain 536 in the acknowledgment number field. Because TCP only acknowledges bytes up to the first missing byte in the stream, TCP is said to provide cumulative acknowledgments.This last example also brings up an important but subtle issue. Host A received the third segment (bytes 900 through 1,000) before receiving the second segment(bytes 536 through 899). Thus, the third segment arrived out of order. The subtle issue is: What does a host do when it receives out-of-order segments in a TCP connection?Interestingly, the TCP RFCs do not impose any rules here and leave the decision up to the people programming a TCP implementation. There are basically two choices: either (1) the receiver immediately discards out-of-order segments (which, as we discussed earlier, can simplify receiver design), or (2) the receiver keeps the out-of-order bytes and waits for the missing bytes to fill in the gaps. Clearly, the latter choice is more efficient in terms of network bandwidth, and is the approach taken in practice.In Figure up, we assumed that the initial sequence number was zero. In truth,both sides of a TCP connection randomly choose an initial sequence number. This is done to minimize the possibility that a segment that is still present in the network from an earlier, already-terminated connection between two hosts is mistaken for avalid segment in a later connection between these same two hosts (which also happen to be using the same port numbers as the old connection) [Sunshine 1978]. Telnet: A Case Study for Sequence and Acknowledgment NumbersTelnet, defined in RFC 854, is a popular application-layer protocol used for remote login. It runs over TCP and is designed to work between any pair of hosts. Unlike the bulk data transfer applications discussed in Chapter 2, Telnet is an interactive application. We discuss a Telnet example here, as it nicely illustrates TCP sequence and acknowledgment numbers. We note that many users now prefer to use the SSH protocol rather than Telnet, since data sent in a Telnet connection (including passwords!) is not encrypted, making Telnet vulnerable to eavesdropping attacksSuppose Host A initiates a Telnet session with Host B. Because Host A initiates the session, it is labeled the client, and Host B is labeled the server. Each character typed by the user (at the client) will be sent to the remote host; the remote host will send back a copy of each character, which will be displayed on the Telnet user’s screen. This “echo back” is used to ensure that characters seen by the Telnet user have already been received and processed at the remote site. Each character thus traverses the network twice between the time the user hits the key and the time the character is displayed on the user’s monitorNow suppose the user types a single letter, ‘C,’and then grabs a coffee. Let’s examine the TCP segments that are sent between the client and server. As shown in Figure 3.31, we suppose the starting sequence numbers are 42 and 79 for the client and server, respectively.Recall that the sequence number of a segment is the sequence number of the first byte in the data field. Thus, the first segment sent from the client will have sequence number 42; the first segment sent from the server will have sequence number Recall that the acknowledgment number is the sequence number of the next byte of data that the host is waiting for. After the TCP connection is established but before any data is sent, the client is waiting for byte 79 and the server is waiting for byte 42As shown in Figure 3.31, three segments are sent. The first segment is sent from the client to the server, containing the 1-byte ASCII representation of the letter ‘C’ in its data field. This first segment also has 42 in its sequence number field, as we just described. Also, because the client has not yet received any data from the server, this first segment will have 79 in its acknowledgment number fieldThe second segment is sent from the server to the client. It serves a dual purpose.First it provides an acknowledgment of the data the server has received. By putting 43 in the acknowledgment field, the server is telling the client that it has successfully received everything up through byte 42 and is now waiting for bytes 43 onward. The second purpose of this segment is to echo back the letter ‘C.’ Thus, the second segment has the ASCII representation of ‘C’ in its data field. This second segment has the sequence number 79, the initial sequence number of the server-toclient data flow of this TCP connection, as this is the very first byte of data that the server is sending. Note that the acknowledgment for client-to-server data is carried in a segment carrying server-to-client data; this acknowledgment is said to be piggybacked on the server-to-client data segment Round-Trip Time Estimation and TimeoutTCP, like our rdt protocol in Section 3.4, uses a timeout/retransmit mechanism to recover from lost segments. Although this is conceptually simple, many subtle issues arise when we implement a timeout/retransmit mechanism in an actual protocol such as TCP. Perhaps the most obvious question is the length of the timeoutintervals. Clearly, the timeout should be larger than the connection’s round-trip time (RTT), that is, the time from when a segment is sent until it is acknowledged. Otherwise, unnecessary retransmissions would be sent. But how much larger? How should the RTT be estimated in the first place? Should a timer be associated with each and every unacknowledged segment? So many questions! Our discussion in this section is based on the TCP work in [Jacobson 1988] and the current IETF recommendations for managing TCP timers [RFC 6298].Estimating the Round-Trip TimeLet’s begin our study of TCP timer management by considering how TCP estimates the round-trip time between sender and receiver. This is accomplished as follows. The sample RTT, denoted SampleRTT, for a segment is the amount of time between when the segment is sent (that is, passed to IP) and when an acknowledgment for the segment is received. Instead of measuring a SampleRTT for every transmitted segment, most TCP implementations take only one SampleRTT measurement at a time. That is, at any point in time, the SampleRTT is being estimatedfor only one of the transmitted but currently unacknowledged segments, leading to a new value of SampleRTT approximately once every RTT. Also, TCP never computes a SampleRTT for a segment that has been retransmitted; it only measures SampleRTT for segments that have been transmitted once [Karn 1987]. (A problem at the end of the chapter asks you to consider why.)Obviously, the SampleRTT values will fluctuate from segment to segment due to congestion in the routers and to the varying load on the end systems. Because of this fluctuation, any given SampleRTT value may be atypical. In order to estimate a typical RTT, it is therefore natural to take some sort of average of the SampleRTTvalues. TCP maintains an average, called EstimatedRTT, of the SampleRTT values. Upon obtaining a new SampleRTT, TCP updates EstimatedRTT according to the following formula:$$EstimatedRTT = (1 – a) • EstimatedRTT + a• SampleRTT$$The formula above is written in the form of a programming-language statement—the new value of EstimatedRTT is a weighted combination of the previous value of EstimatedRTT and the new value for SampleRTT. The recommended value of is = 0.125 (that is, 1/8) [RFC 6298], in which case the formula above becomes:$$EstimatedRTT = 0.875 • EstimatedRTT + 0.125 • SampleRTT$$Setting and Managing the Retransmission Timeout IntervalGiven values of EstimatedRTT and DevRTT, what value should be used for TCP’s timeout interval? Clearly, the interval should be greater than or equal to EstimatedRTT, or unnecessary retransmissions would be sent. But the timeout interval should not be too much larger than EstimatedRTT; otherwise, when a segment is lost, TCP would not quickly retransmit the segment, leading to large data transfer delays. It is therefore desirable to set the timeout equal to the EstimatedRTT plus some margin. The margin should be large when there is a lot of fluctuation in the SampleRTT values; it should be small when there is little fluctuation. The value ofDevRTT should thus come into play here. All of these considerations are taken into account in TCP’s method for determining the retransmission timeout interval:$$TimeoutInterval = EstimatedRTT + 4 • DevRTT$$An initial TimeoutInterval value of 1 second is recommended [RFC 6298].Also, when a timeout occurs, the value of TimeoutInterval is doubled to avoid a premature timeout occurring for a subsequent segment that will soon be acknowledged.However, as soon as a segment is received and EstimatedRTT is updated,the TimeoutInterval is again computed using the formula above.Reliable Data TransferRecall that the Internet’s network-layer service (IP service) is unreliable. IP does not guarantee datagram delivery, does not guarantee in-order delivery of datagrams, and does not guarantee the integrity of the data in the datagrams. With IP service, datagrams can overflow router buffers and never reach their destination,datagrams can arrive out of order, and bits in the datagram can get corrupted(flipped from 0 to 1 and vice versa). Because transport-layer segments are carried across the network by IP datagrams, transport-layer segments can suffer from these problems as well TCP creates a reliable data transfer service on top of IP’s unreliable besteffort service. TCP’s reliable data transfer service ensures that the data stream that a process reads out of its TCP receive buffer is uncorrupted, without gaps, without duplication, and in sequence; that is, the byte stream is exactly the same byte stream that was sent by the end system on the other side of the connection. How TCP provides a reliable data transfer involves many of the principles that we studied in Section 3.4 In our earlier development of reliable data transfer techniques, it was conceptually easiest to assume that an individual timer is associated with each transmitted but not yet acknowledged segment. While this is great in theory, timer management can require considerable overhead. Thus, the recommended TCP timer management procedures [RFC 6298] use only a single retransmission timer, even if there are multiple transmitted but not yet acknowledged segments. The TCP protocol described in this section follows this single-timer recommendationWe will discuss how TCP provides reliable data transfer in two incremental steps. We first present a highly simplified description of a TCP sender that uses only timeouts to recover from lost segments; we then present a more complete description that uses duplicate acknowledgments in addition to timeouts. In the ensuing discussion, we suppose that data is being sent in only one direction, from Host A to Host B, and that Host A is sending a large fileFigure 3.33 presents a highly simplified description of a TCP sender. We see that there are three major events related to data transmission and retransmission in the TCP sender: data received from application above; timer timeout; and ACK receipt. Upon the occurrence of the first major event, TCP receives data from the application, encapsulates the data in a segment, and passes the segment to IP. Note that each segment includes a sequence number that is the byte-stream number of the first data byte in the segment, as described in Section 3.5.2. Also note that if the timer is already not running for some other segment, TCP starts the timer when the segment is passed to IP. (It is helpful to think of the timer as being associated with the oldest unacknowledged segment.) The expiration interval for this timer is the TimeoutInterval, which is calculated from EstimatedRTT and DevRTT, as described in Section 3.5.3.The second major event is the timeout. TCP responds to the timeout event by retransmitting the segment that caused the timeout. TCP then restarts the timerThe third major event that must be handled by the TCP sender is the arrival of an acknowledgment segment (ACK) from the receiver (more specifically, a segment containing a valid ACK field value). On the occurrence of this event, TCP compares the ACK value y with its variable SendBase. The TCP state variable SendBase is the sequence number of the oldest unacknowledged byte. (Thus SendBase–1 is the sequence number of the last byte that is known to have been received correctly and in order at the receiver.) As indicated earlier, TCP uses cumulative acknowledgments, so that y acknowledges the receipt of all bytes before byte number y. If y &gt; SendBase, then the ACK is acknowledging one or more previously unacknowledged segments.Thus the sender updates its SendBase variable; it also restarts the timer if there currently are any not-yet-acknowledged segments.A Few Interesting ScenariosWe have just described a highly simplified version of how TCP provides reliable data transfer. But even this highly simplified version has many subtleties. To get a good feeling for how this protocol works, let’s now walk through a few simple scenarios.Figure 3.34 depicts the first scenario, in which Host A sends one segment to Host B. Suppose that this segment has sequence number 92 and contains 8 bytes of data. After sending this segment, Host A waits for a segment from B with acknowledgment number 100. Although the segment from A is received at B, the acknowledgment from B to A gets lost. In this case, the timeout event occurs, and Host A retransmits the same segment. Of course, when Host B receives the retransmission, it observes from the sequence number that the segment containsdata that has already been received. Thus, TCP in Host B will discard the bytes in the retransmitted segmentIn a second scenario, shown in Figure 3.35, Host A sends two segments back to back. The first segment has sequence number 92 and 8 bytes of data, and the second segment has sequence number 100 and 20 bytes of data. Suppose that both segments arrive intact at B, and B sends two separate acknowledgments for each of these segments. The first of these acknowledgments has acknowledgment number 100; the second has acknowledgment number 120. Suppose now that neither of the acknowledgments arrives at Host A before the timeout. When the timeout event occurs, Host A resends the first segment with sequence number 92 and restarts the timer. As longas the ACK for the second segment arrives before the new timeout, the second segment will not be retransmitted In a third and final scenario, suppose Host A sends the two segments, exactly as in the second example. The acknowledgment of the first segment is lost in the network, but just before the timeout event, Host A receives an acknowledgment with acknowledgment number 120. Host A therefore knows that Host B has received everything up through byte 119; so Host A does not resend either of the two segments. This scenario is illustrated in Figure Doubling the Timeout IntervalWe now discuss a few modifications that most TCP implementations employ. The first concerns the length of the timeout interval after a timer expiration. In this modification, whenever the timeout event occurs, TCP retransmits the not-yetacknowledged segment with the smallest sequence number, as described above. Buteach time TCP retransmits, it sets the next timeout interval to twice the previous value, rather than deriving it from the last EstimatedRTT and DevRTT (as described in Section 3.5.3). For example, suppose TimeoutInterval associated with the oldest not yet acknowledged segment is .75 sec when the timer first expires.TCP will then retransmit this segment and set the new expiration time to 1.5 sec. If the timer expires again 1.5 sec later, TCP will again retransmit this segment, now setting the expiration time to 3.0 sec. Thus the intervals grow exponentially after each retransmission. However, whenever the timer is started after either of the two other events (that is, data received from application above, and ACK received), the TimeoutInterval is derived from the most recent values of EstimatedRTT and DevRTT.This modification provides a limited form of congestion control. (More comprehensive forms of TCP congestion control will be studied in Section 3.7.) The timer expiration is most likely caused by congestion in the network, that is, too many packets arriving at one (or more) router queues in the path between the sourceand destination, causing packets to be dropped and/or long queuing delays. In times of congestion, if the sources continue to retransmit packets persistently, the congestion may get worse. Instead, TCP acts more politely, with each sender retransmitting after longer and longer intervals. We will see that a similar idea is used by Ethernet when we study CSMA/CD in Chapter 5 Fast RetransmitOne of the problems with timeout-triggered retransmissions is that the timeout period can be relatively long. When a segment is lost, this long timeout period forces the sender to delay resending the lost packet, thereby increasing the end-to end delay. Fortunately, the sender can often detect packet loss well before the timeoutevent occurs by noting so-called duplicate ACKs. A duplicate ACK is an ACK that reacknowledges a segment for which the sender has already received an earlier acknowledgment. To understand the sender’s response to a duplicate ACK, we must look at why the receiver sends a duplicate ACK in the first place. Table 3.2 summarizes the TCP receiver’s ACK generation policy [RFC 5681]. When a TCP receiver receives a segment with a sequence number that is larger than the next, expected,in-order sequence number, it detects a gap in the data stream—that is, a missing segment.This gap could be the result of lost or reordered segments within the network.Since TCP does not use negative acknowledgments, the receiver cannot send an explicit negative acknowledgment back to the sender. Instead, it simply reacknowledges (that is, generates a duplicate ACK for) the last in-order byte of data it has received. (Note that Table 3.2 allows for the case that the receiver does not discardout-of-order segments.) Because a sender often sends a large number of segments back to back, if one segmentis lost, there will likely be many back-to-back duplicate ACKs. If the TCP sender receives three duplicate ACKs for the same data, it takes this as an indication that the segment following the segment that has been ACKed three times has been lost. (In the homework problems, we consider the question of why the sender waits for three duplicate ACKs, rather than just a single duplicate ACK.) In the case that three duplicate ACKs are received, the TCP sender performs a fast retransmit [RFC 5681], retransmitting the missing segment before that segment’s timer expires. This is shown in Figure 3.37, where the second segment is lost, then retransmitted before its timer expires. For TCP with fast retransmit, the following code snippet replaces the ACK received event in Figure 3.33:We noted earlier that many subtle issues arise when a timeout/retransmit mechanism is implemented in an actual protocol such as TCP. The procedures above,which have evolved as a result of more than 20 years of experience with TCP timers, should convince you that this is indeed the case! Go-Back-N or Selective Repeat?Let us close our study of TCP’s error-recovery mechanism by considering the following question: Is TCP a GBN or an SR protocol? Recall that TCP acknowledgments are cumulative and correctly received but out-of-order segments are not individuallyACKed by the receiver. Consequently, as shown in Figure 3.33 (see also Figure 3.19),the TCP sender need only maintain the smallest sequence number of a transmitted but unacknowledged byte (SendBase) and the sequence number of the next byte to be sent (NextSeqNum). In this sense, TCP looks a lot like a GBN-style protocol. Butthere are some striking differences between TCP and Go-Back-N. Many TCP implementations will buffer correctly received but out-of-order segments [Stevens 1994]. Consider also what happens when the sender sends a sequence of segments 1, 2, . . . , N, and all of the segments arrive in order without error at the receiver. Further suppose that the acknowledgment for packet n &lt; N gets lost, but the remaining N – 1 acknowledgmentsarrive at the sender before their respective timeouts. In this example, GBN would retransmit not only packet n, but also all of the subsequent packets n + 1, n + 2,. . . , N. TCP, on the other hand, would retransmit at most one segment, namely, segment n. Moreover, TCP would not even retransmit segment n if the acknowledgment for segment n + 1 arrived before the timeout for segment n.A proposed modification to TCP, the so-called selective acknowledgment [RFC 2018], allows a TCP receiver to acknowledge out-of-order segments selectively rather than just cumulatively acknowledging the last correctly received, inorder segment. When combined with selective retransmission—skipping the retransmission of segments that have already been selectively acknowledged by the receiver—TCP looks a lot like our generic SR protocol. Thus, TCP’s error-recovery mechanism is probably best categorized as a hybrid of GBN and SR protocols. Flow ControlRecall that the hosts on each side of a TCP connection set aside a receive buffer for the connection. When the TCP connection receives bytes that are correct and in sequence, it places the data in the receive buffer. The associated application process will read data from this buffer, but not necessarily at the instant the data arrives.Indeed, the receiving application may be busy with some other task and may not even attempt to read the data until long after it has arrived. If the application is relatively slow at reading the data, the sender can very easily overflow the connection’s receive buffer by sending too much data too quicklyTCP provides a flow-control service to its applications to eliminate the possibility of the sender overflowing the receiver’s buffer. Flow control is thus a speed-matching service—matching the rate at which the sender is sending against the rate at which the receiving application is reading. As noted earlier, a TCP sender can also be throttled due to congestion within the IP network; this form of sender control is referred to as congestion control, a topic we will explore in detail in Sections 3.6 and 3.7. Even though the actions taken by flow and congestion control are similar (the throttling of the sender), they are obviously taken for very different reasons. Unfortunately, many authors use the terms interchangeably, and the savvy reader would be wise to distinguish between them. Let’s now discuss how TCP provides its flow-control service. In order to see the forest for the trees, we suppose throughout this section that the TCP implementation is such that the TCP receiver discards out-of-order segmentsTCP provides flow control by having the sender maintain a variable called the receive window. Informally, the receive window is used to give the sender an idea of how much free buffer space is available at the receiver. Because TCP is full-duplex, the sender at each side of the connection maintains a distinct receive window. Let’s investigate the receive window in the context of a file transfer. Suppose that Host A is sendinga large file to Host B over a TCP connection. Host B allocates a receive buffer to this connection; denote its size by RcvBuffer. From time to time, the application process in Host B reads from the buffer. Define the following variables: LastByteRead: the number of the last byte in the data stream read from thebuffer by the application process in B LastByteRcvd: the number of the last byte in the data stream that has arrivedfrom the network and has been placed in the receive buffer at BBecause TCP is not permitted to overflow the allocated buffer, we must have$$LastByteRcvd – LastByteRead &lt;= RcvBuffer$$The receive window, denoted rwnd is set to the amount of spare room in the buffer:$$rwnd = RcvBuffer – [LastByteRcvd – LastByteRead]$$Because the spare room changes with time, rwnd is dynamic. The variable rwnd isillustrated in Figure 3 Host A in turn keeps track of two variables, LastByteSent and LastByteAcked, which have obvious meanings. Note that the difference between these two variables, LastByteSent – LastByteAcked, is the amount of unacknowledgeddata that A has sent into the connection. By keeping the amount of unacknowledged data less than the value of rwnd, Host A is assured that it is not overflowing the receive buffer at Host B. Thus, Host A makes sure throughout the connection’s life that$$LastByteSent – LastByteAcked &lt;= rwnd$$There is one minor technical problem with this scheme. To see this, suppose Host B’s receive buffer becomes full so that rwnd = 0. After advertising rwnd = 0 to Host A, also suppose that B has nothing to send to A. Now consider what happens. As the application process at B empties the buffer, TCP does not send new segmentswith new rwnd values to Host A; indeed, TCP sends a segment to Host A only if it has data to send or if it has an acknowledgment to send. Therefore, Host A is never informed that some space has opened up in Host B’s receive buffer—Host A is blocked and can transmit no more data! To solve this problem, the TCP specificationrequires Host A to continue to send segments with one data byte when B’s receive window is zero. These segments will be acknowledged by the receiver. Eventually the buffer will begin to empty and the acknowledgments will contain a nonzero rwnd valueThe online site at http://www.awl.com/kurose-ross for this book provides an interactive Java applet that illustrates the operation of the TCP receive window. Having described TCP’s flow-control service, we briefly mention here that UDP does not provide flow control. To understand the issue, consider sending a series of UDP segments from a process on Host A to a process on Host B. For a typical UDP implementation, UDP will append the segments in a finite-sized buffer that “precedes” the corresponding socket (that is, the door to the process). The process reads one entire segment at a time from the buffer. If the process does not read the segments fast enough from the buffer, the buffer will overflow and segments will get dropped. TCP Connection ManagementIn this subsection we take a closer look at how a TCP connection is established and torn down. Although this topic may not seem particularly thrilling, it is important because TCP connection establishment can significantly add to perceived delays (for example, when surfing the Web). Furthermore, many of the most common network attacks—including the incredibly popular SYN flood attack—exploit vulnerabilities in TCP connection management. Open a TCP connectionLet’s first take a look at how a TCP connection is established. Suppose a process running in one host (client) wants to initiate a connection with another process in another host (server). The client application process first informs the client TCP that it wants to establish a connection to a process in the server. The TCP in the client then proceeds to establish a TCP connection with the TCP in the server in the following manner: Step 1. The client-side TCP first sends a special TCP segment to the server-side TCP. This special segment contains no application-layer data. But one of the flag bits in the segment’s header (see Figure 3.29), the SYN bit, is set to 1. For this reason, this special segment is referred to as a SYN segment. In addition, the client randomly chooses an initial sequence number (client_isn) and puts this number in the sequence number field of the initial TCP SYN segment. This segment is encapsulated within an IP datagram and sent to the server. There has been considerable interest in properly randomizing the choice of the client_isn in order to avoid certain security attacks [CERT 2001–09]. Step 2. Once the IP datagram containing the TCP SYN segment arrives at the server host (assuming it does arrive!), the server extracts the TCP SYN segment from the datagram, allocates the TCP buffers and variables to the connection, and sends a connection-granted segment to the client TCP. (We’ll see in Chapter 8 thatthe allocation of these buffers and variables before completing the third step of the three-way handshake makes TCP vulnerable to a denial-of-service attack known as SYN flooding.) This connection-granted segment also contains no applicationlayer data. However, it does contain three important pieces of information in thesegment header. First, the SYN bit is set to 1. Second, the acknowledgment field of the TCP segment header is set to client_isn+1. Finally, the server chooses its own initial sequence number (server_isn) and puts this value in the sequence number field of the TCP segment header. This connection-granted segment is saying, in effect, “I received your SYN packet to start a connection with your initial sequence number, client_isn. I agree to establish this connection. My own initial sequence number is server_isn.” The connectiongranted segment is referred to as a SYNACK segment. Step 3. Upon receiving the SYNACK segment, the client also allocates buffers and variables to the connection. The client host then sends the server yet another segment; this last segment acknowledges the server’s connection-granted segment (the client does so by putting the value server_isn+1 in the acknowledgmentfield of the TCP segment header). The SYN bit is set to zero, since the connection is established. This third stage of the three-way handshake may carry client-to-server data in the segment payload.Once these three steps have been completed, the client and server hosts can send segments containing data to each other. In each of these future segments, the SYN bit will be set to zero. Note that in order to establish the connection, three packets are sent between the two hosts, as illustrated in Figure 3.39. For this reason, this connectionestablishment procedure is often referred to as a three-way handshake. Several aspects of the TCP three-way handshake are explored in the homework problems(Why are initial sequence numbers needed? Why is a three-way handshake, as opposed to a two-way handshake, needed?). It’s interesting to note that a rock climberand a belayer (who is stationed below the rock climber and whose job it is to handle the climber’s safety rope) use a three-way-handshake communication protocol that is identical to TCP’s to ensure that both sides are ready before the climber begins ascent. Close a TCP connectionAll good things must come to an end, and the same is true with a TCP connection.Either of the two processes participating in a TCP connection can end the connection.When a connection ends, the “resources” (that is, the buffers and variables) in the hosts are deallocated. As an example, suppose the client decides to close theconnection, as shown in Figure 3.40. The client application process issues a close command. This causes the client TCP to send a special TCP segment to the server process. This special segment has a flag bit in the segment’s header, the FIN bit (see Figure 3.29), set to 1. When the server receives this segment, it sends the client an acknowledgment segment in return. The server then sends its own shutdown segment, which has the FIN bit set to 1. Finally, the client acknowledges the server’s shutdown segment. At this point, all the resources in the two hosts are now deallocatedDuring the life of a TCP connection, the TCP protocol running in each host makes transitions through various TCP states. Figure 3.41 illustrates a typical sequence of TCP states that are visited by the client TCP. The client TCP begins in the CLOSED state. The application on the client side initiates a new TCP connection(by creating a Socket object in our Java examples as in the Python examples from Chapter 2). This causes TCP in the client to send a SYN segment to TCP in the server. After having sent the SYN segment, the client TCP enters the SYN_SENT state. While in the SYN_SENT state, the client TCP waits for a segment from the server TCP that includes an acknowledgment for the client’s previous segment and has the SYN bit set to 1. Having received such a segment, the client TCP enters the ESTABLISHED state. While in the ESTABLISHED state, the TCP client can sendand receive TCP segments containing payload (that is, application-generated) data Principles of Congestion ControlIn the previous sections, we examined both the general principles and specific TCP mechanisms used to provide for a reliable data transfer service in the face of packet loss. We mentioned earlier that, in practice, such loss typically results from the overflowing of router buffers as the network becomes congested. Packetretransmission thus treats a symptom of network congestion (the loss of a specific transport-layer segment) but does not treat the cause of network congestion—too many sources attempting to send data at too high a rate. To treat the cause of network congestion, mechanisms are needed to throttle senders in the face of networkcongestion.In this section, we consider the problem of congestion control in a general context, seeking to understand why congestion is a bad thing, how network congestion is manifested in the performance received by upper-layer applications, and various approaches that can be taken to avoid, or react to, network congestion. This moregeneral study of congestion control is appropriate since, as with reliable data transfer, it is high on our “top-ten” list of fundamentally important problems in networking. We conclude this section with a discussion of congestion control in the available bit-rate (ABR) service in asynchronous transfer mode (ATM) networks. The following section contains a detailed study of TCP’s congestioncontrol algorithm. The Causes and the Costs of CongestionLet’s begin our general study of congestion control by examining three increasingly complex scenarios in which congestion occurs. In each case, we’ll look at why congestion occurs in the first place and at the cost of congestion (in terms of resources not fully utilized and poor performance received by the end systems). We’ll not (yet) focus on how to react to, or avoid, congestion but rather focus on the simpler issue of understanding what happens as hosts increase their transmission rate and the network becomes congested. Scenario 1: Two Senders, a Router with Infinite BuffersWe begin by considering perhaps the simplest congestion scenario possible: Two hosts (A and B) each have a connection that shares a single hop between source and destination, as shown in Figure 3.43Let’s assume that the application in Host A is sending data into the connection (for example, passing data to the transport-level protocol via a socket) at an average rate of A_in bytes/sec. These data are original in the sense that each unit of data is sent into the socket only once. The underlying transport-level protocol is a simple one. Data is encapsulated and sent; no error recovery (for example, retransmission), flow control, or congestion control is performed. Ignoring the additional overhead due to adding transport- and lower-layer header information, the rate at which Host A offers traffic to the router in this first scenario is thus A_in bytes/sec. Host B operates in a similar manner, and we assume for simplicity that it too is sending at a rate of A_in bytes/sec. Packets from Hosts A and B pass through a router and over a shared outgoing link of capacity R. The router has buffers that allow it to store incoming packets when the packet-arrival rate exceeds the outgoing link’s capacity. In this first scenario, we assume that the router has an infinite amount of buffer space.Figure 3.44 plots the performance of Host A’s connection under this first scenario. The left graph plots the per-connection throughput (number of bytes per second at the receiver) as a function of the connection-sending rate. For a sending rate between 0 and R/2, the throughput at the receiver equals the sender’s sending rate—everything sent by the sender is received at the receiver with a finite delay. When the sending rate is above R/2, however, the throughput is only R/2. This upper limit on throughput is a consequence of the sharing of link capacity between two connections. The link simply cannot deliver packets to a receiver at a steady-staterate that exceeds R/2. No matter how high Hosts A and B set their sending rates, they will each never see a throughput higher than R/2.Achieving a per-connection throughput of R/2 might actually appear to be a good thing, because the link is fully utilized in delivering packets to their destinations. The right-hand graph in Figure 3.44, however, shows the consequence of operating near link capacity. As the sending rate approaches R/2 (from the left), the average delay becomes larger and larger. When the sending rate exceeds R/2, the average number of queued packets in the router is unbounded, and the average delay between source and destination becomes infinite (assuming that the connections operate at these sending rates for an infinite period of time and there is an infinite amount of buffering available). Thus, while operating at an aggregate throughput of near R may be ideal from a throughput standpoint, it is far from ideal from a delay standpoint. Even in this (extremely) idealized scenario, we’ve already found one cost of a congested network—large queuing delays are experienced as the packetarrival rate nears the link capacity Scenario 2: Two Senders and a Router with Finite BuffersLet us now slightly modify scenario 1 in the following two ways (see Figure 3.45). First, the amount of router buffering is assumed to be finite. A consequence of this real-world assumption is that packets will be dropped when arriving to an already full buffer. Second, we assume that each connection is reliable. If a packet containing a transport-level segment is dropped at the router, the sender will eventually retransmit it. Because packets can be retransmitted, we must now be more careful with our use of the term sending rate. Specifically, let us again denote the rate at which the application sends original data into the socket by$ \lambda{in} $bytes/sec. The rate at which the transport layer sends segments (containing original data and retransmitted data) into the network will be denoted $\lambda1{in} $in bytes/sec. $\lambda1_{in} $ is sometimes referred to as the offered load to the network.The performance realized under scenario 2 will now depend strongly on how retransmission is performed. First, consider the unrealistic case that Host A is able to somehow (magically!) determine whether or not a buffer is free in the router and thus sends a packet only when a buffer is free. In this case, no loss would occur,$\lambda1{in}$ would be equal to $\lambda{in}$, and the throughput of the connection would be equal to$\lambda_{in}$. This case is shown in Figure 3.46(a). From a throughput standpoint, performance is ideal—everything that is sent is received. Note that the average host sending rate cannot exceed R/2 under this scenario, since packet loss is assumed never to occur.Consider next the slightly more realistic case that the sender retransmits only when a packet is known for certain to be lost. (Again, this assumption is a bit of a stretch. However, it is possible that the sending host might set its timeout large enough to be virtually assured that a packet that has not been acknowledged has been lost.) In this case, the performance might look something like that shown in Figure 3.46(b). To appreciate what is happening here, consider the case that the offered load, $\lambda1_{in}$ (the rate of original data transmission plus retransmissions), equals R/2. According to Figure 3.46(b), at this value of the offered load, the rate at which data are delivered to the receiver application is R/3. Thus, out of the 0.5R units of data transmitted, 0.333R bytes/sec (on average) are original data and 0.166R bytes/ sec (on average) are retransmitted data. We see here another cost of a congested network the sender must perform retransmissions in order to compensate for dropped (lost) packets due to buffer overflowFinally, let us consider the case that the sender may time out prematurely and retransmit a packet that has been delayed in the queue but not yet lost. In this case, both the original data packet and the retransmission may reach the receiver. Of course, the receiver needs but one copy of this packet and will discard the retransmission. In this case, the work done by the router in forwarding the retransmitted copy of the original packet was wasted, as the receiver will have already received the original copy of this packet. The router would have better used the link transmission capacity to send a different packet instead. Here then is yet another cost of a congested network—unneeded retransmissions by the sender in the face of large delays may cause a router to use its link bandwidth to forward unneeded copies of a packet. Figure 3.46 (c) shows the throughput versus offered load when each packet is assumed to be forwarded (on average) twice by the router. Since each packet is forwarded twice, the throughput will have an asymptotic value of R/4 as the offered load approaches R/2. Scenario 3: Four Senders, Routers with Finite Buffers, and Multihop PathsIn our final congestion scenario, four hosts transmit packets, each over overlapping two hop paths, as shown in Figure 3.47. We again assume that each host uses a timeout/retransmission mechanism to implement a reliable data transfer service, that all hosts have the same value of $\lambda_{in}$, and that all router links have capacity R bytes/sec.Let’s consider the connection from Host A to Host C, passing through routers R1 and R2. The A–C connection shares router R1 with the D–B connection and shares router R2 with the B–D connection. For extremely small values of $\lambda{in}$, buffer overflows are rare (as in congestion scenarios 1 and 2), and the throughput approximately equals the offered load. For slightly larger values of $\lambda{in}$, the corresponding throughput is also larger, since more original data is being transmitted into the network and delivered to the destination, and overflows are still rare. Thus, for small values of $\lambda{in}$, an increase in $\lambda1{in}$ results in an increase in $\lambda{out}$Having considered the case of extremely low traffic, let’s next examine the case that $\lambda{in}$ (and hence $\lambda{in}$) is extremely large. Consider router R2. The A–C traffic arriving to router R2 (which arrives at R2 after being forwarded from R1) can have an arrival rate at R2 that is at most R, the capacity of the link from R1 to R2, regardless of the value of $\lambda{in}$. If $\lambda1_{in}$ is extremely large for all connections (including the B–D connection), then the arrival rate of B–D traffic at R2 can be much larger than that of the A–C traffic. Because the A–C and B–D traffic must compete at router R2 for the limited amount of buffer space, the amount of A–C traffic that successfully gets through R2 (that is, is not lost due to buffer overflow) becomes smaller and smaller as the offered load from B–D gets larger and larger. In the limit, as the offered load approaches infinity, an empty buffer at R2 is immediately filled by a B–D packet, and the throughput of the A–C connection at R2 goes to zero. This, in turn, implies that the A–C end-to-end throughput goes to zero in the limit of heavy traffic. These considerations give rise to the offered load versus throughput tradeoff shown in Figure 3.48.The reason for the eventual decrease in throughput with increasing offered load is evident when one considers the amount of wasted work done by the network.In the high-traffic scenario outlined above, whenever a packet is dropped at a second-hop router, the work done by the first-hop router in forwarding a packet to the second-hop router ends up being “wasted.” The network would have been equally well off (more accurately, equally bad off) if the first router had simply discarded that packet and remained idle. More to the point, the transmissioncapacity used at the first router to forward the packet to the second router could have been much more profitably used to transmit a different packet. (For example, when selecting a packet for transmission, it might be better for a router to give priority to packets that have already traversed some number of upstreamrouters.) TCP Congestion ControlIn Section 3.7, we’ll examine TCP’s specific approach to congestion control in great detail. Here, we identify the two broad approaches to congestion control that are taken in practice and discuss specific network architectures and congestion-control protocols embodying these approachesAt the broadest level, we can distinguish among congestion-control approaches by whether the network layer provides any explicit assistance to the transport layer for congestion-control purposes:End-to-end congestion control. In an end-to-end approach to congestion control, the network layer provides no explicit support to the transport layer for congestion control purposes. Even the presence of congestion in the network must be inferred by the end systems based only on observed network behavior (for example, packetloss and delay). We will see in Section 3.7 that TCP must necessarily take this end to-end approach toward congestion control, since the IP layer provides no feedback to the end systems regarding network congestion. TCP segment loss (as indicated by a timeout or a triple duplicate acknowledgment) is taken as an indication of network congestion and TCP decreases its window size accordingly. We will also see a more recent proposal for TCP congestion control that uses increasing round-trip delay values as indicators of increased network congestion CI and NI bits. As noted above, sender-to-receiver RM cells are interspersed with data cells. The rate of RM cell interspersion is a tunable parameter, with the default value being one RM cell every 32 data cells. These RM cells have a congestion indication (CI) bit and a no increase (NI) bit that can be set by a congested network switch. Specifically, a switch can set the NI bit in a passing RM cell to 1 under mild congestion and can set the CI bit to 1 under severe congestion conditions. When a destination host receives an RM cell, it will send the RM cell back to the sender with its CI and NI bits intact (except that CI may be set to 1 by the destination as a result of the EFCI mechanism described above).ER setting. Each RM cell also contains a 2-byte explicit rate (ER) field. A congested switch may lower the value contained in the ER field in a passing RM cell. In this manner, the ER field will be set to the minimum supportable rate of all switches on the source-to-destination path. TCP Congestion ControlIn this section we return to our study of TCP. As we learned in Section 3.5, TCP provides a reliable transport service between two processes running on different hosts. Another key component of TCP is its congestion-control mechanism. As indicated in the previous section, TCP must use end-to-end congestion control rather than network-assisted congestion control, since the IP layer provides no explicit feedback to the end systems regarding network congestionThe approach taken by TCP is to have each sender limit the rate at which it sends traffic into its connection as a function of perceived network congestion. If a TCP sender perceives that there is little congestion on the path between itself and the destination, then the TCP sender increases its send rate; if the sender perceivesthat there is congestion along the path, then the sender reduces its send rate. But this approach raises three questions. First, how does a TCP sender limit the rate at which it sends traffic into its connection? Second, how does a TCP sender perceive that there is congestion on the path between itself and the destination? And third, what algorithm should the sender use to change its send rate as a function of perceived end-to-end congestion? Let’s first examine how a TCP sender limits the rate at which it sends traffic into its connection. In Section 3.5 we saw that each side of a TCP connection consists of a receive buffer, a send buffer, and several variables (LastByteRead, rwnd, and so on). The TCP congestion-control mechanism operating at the sender keepstrack of an additional variable, the congestion window. The congestion window, denoted cwnd, imposes a constraint on the rate at which a TCP sender can send traffic into the network. Specifically, the amount of unacknowledged data at a sender may not exceed the minimum of cwnd and rwnd, that is:$$LastByteSent – LastByteAcked &lt;= min{cwnd, rwnd}$$In order to focus on congestion control (as opposed to flow control), let us henceforth assume that the TCP receive buffer is so large that the receive-window constraint can be ignored; thus, the amount of unacknowledged data at the sender is solely limited by cwnd. We will also assume that the sender always has data to send, i.e., that all segments in the congestion window are sent.The constraint above limits the amount of unacknowledged data at the sender and therefore indirectly limits the sender’s send rate. To see this, consider a connection for which loss and packet transmission delays are negligible. Then, roughly, at the beginning of every RTT, the constraint permits the sender to send cwnd bytes of data into the connection; at the end of the RTT the sender receives acknowledgments for the data. Thus the sender’s send rate is roughly cwnd/RTT bytes/sec. By adjusting the value of cwnd, the sender can therefore adjust the rate at which it sends data into its connectionLet’s next consider how a TCP sender perceives that there is congestion on the path between itself and the destination. Let us define a “loss event” at a TCP sender as the occurrence of either a timeout or the receipt of three duplicate ACKs from the receiver. (Recall our discussion in Section 3.5.4 of the timeout event in Figure 3.33 and the subsequent modification to include fast retransmit on receipt of three duplicate ACKs.) When there is excessive congestion, then one (or more) router buffers along the path overflows, causing a datagram (containing a TCP segment) to be dropped. The dropped datagram, in turn, results in a loss event at the sender—either a timeout or the receipt of three duplicate ACKs—which is taken by the sender to be an indication of congestion on the sender-to-receiver path.Having considered how congestion is detected, let’s next consider the more optimistic case when the network is congestion-free, that is, when a loss event doesn’t occur. In this case, acknowledgments for previously unacknowledged segments will be received at the TCP sender. As we’ll see, TCP will take the arrival of these acknowledgments as an indication that all is well—that segments being transmitted into the network are being successfully delivered to the destination—and will use acknowledgments to increase its congestion windowsize (and hence its transmission rate). Note that if acknowledgments arrive at a relatively slow rate (e.g., if the end-end path has high delay or contains a low-bandwidth link), then the congestion window will be increased at a relatively slow rate. On the other hand, if acknowledgments arrive at a high rate, then the congestion window will be increased more quickly. Because TCP uses acknowledgments to trigger (or clock) its increase in congestion window size, TCP is said to be self-clockingGiven the mechanism of adjusting the value of cwnd to control the sending rate, the critical question remains: How should a TCP sender determine the rate at which it should send? If TCP senders collectively send too fast, they can congest the network,leading to the type of congestion collapse that we saw in Figure 3.48. Indeed,the version of TCP that we’ll study shortly was developed in response to observed Internet congestion collapse [Jacobson 1988] under earlier versions of TCP. However, if TCP senders are too cautious and send too slowly, they could under utilize the bandwidth in the network; that is, the TCP senders could send at a higher ratewithout congesting the network. How then do the TCP senders determine their sending rates such that they don’t congest the network but at the same time make use of all the available bandwidth? Are TCP senders explicitly coordinated, or is there a distributed approach in which the TCP senders can set their sending rates based onlyon local information? TCP answers these questions using the following guiding principles: A lost segment implies congestion, and hence, the TCP sender’s rate should be decreased when a segment is lost. Recall from our discussion in Section 3.5.4, that a timeout event or the receipt of four acknowledgments for a given segment (one original ACK and then three duplicate ACKs) is interpreted as an implicit “loss event” indication of the segment following the quadruply ACKed segment, triggering a retransmission of the lost segment. From a congestioncontrol standpoint, the question is how the TCP sender should decrease its congestionwindow size, and hence its sending rate, in response to this inferred loss event. An acknowledged segment indicates that the network is delivering the sender’s segments to the receiver, and hence, the sender’s rate can be increased when an ACK arrives for a previously unacknowledged segment. The arrival of acknowledgments is taken as an implicit indication that all is well—segments are being successfully delivered from sender to receiver, and the network is thus not congested. The congestion window size can thus be increased. Bandwidth probing. Given ACKs indicating a congestion-free source-to-destination path and loss events indicating a congested path, TCP’s strategy for adjusting its transmission rate is to increase its rate in response to arriving ACKs until a loss event occurs, at which point, the transmission rate is decreased. The TCP sender thus increases its transmission rate to probe for the rate that at which congestion onset begins, backs off from that rate, and then to begins probing again to see if he congestion onset rate has changed. The TCP sender’s behavior is perhaps analogous to the child who requests (and gets) more and more goodies until finally he/she is finally told “No!”, backs off a bit, but then begins making requests again shortly afterwards. Note that there is no explicit signaling of congestion state by the network—ACKs and loss events serve as implicit signals—and that each TCP sender acts on local information asynchronously from other TCPsenders.Given this overview of TCP congestion control, we’re now in a position to consider the details of the celebrated TCP congestion-control algorithm, which was first described in [Jacobson 1988] and is standardized in [RFC 5681]. The algorithm has three major components: (1) slow start, (2) congestion avoidance, and (3) fast recovery. Slow start and congestion avoidance are mandatory components of TCP, differing in how they increase the size of cwnd in response to received ACKs. We’ll see shortly that slow start increases the size of cwnd more rapidly (despite its name!) than congestion avoidance. Fast recovery is recommended, but not required, forTCP senders.Slow StartWhen a TCP connection begins, the value of cwnd is typically initialized to a small value of 1 MSS [RFC 3390], resulting in an initial sending rate of roughly MSS/RTT. For example, if MSS = 500 bytes and RTT = 200 msec, the resulting initial sending rate is only about 20 kbps. Since the available bandwidth to the TCP sender may be much larger than MSS/RTT, the TCP sender would like to find the amount of available bandwidth quickly. Thus, in the slow-start state, the value of cwnd begins at 1 MSS and increases by 1 MSS every time a transmittedsegment is first acknowledged. In the example of Figure 3.51, TCP sends the first segment into the network and waits for an acknowledgment. When this acknowledgment arrives, the TCP sender increases the congestion window by one MSS and sends out two maximum-sized segments. These segments are then acknowledged, with the sender increasing the congestion window by 1 MSS for each of the acknowledged segments, giving a congestion window of 4 MSS, and so on. This process results in a doubling of the sending rate every RTT. Thus, the TCP send rate starts slow but grows exponentially during the slow start phase.But when should this exponential growth end? Slow start provides several answers to this question. First, if there is a loss event (i.e., congestion) indicated by a timeout, the TCP sender sets the value of cwnd to 1 and begins the slow start process anew. It also sets the value of a second state variable, ssthresh (shorthand for “slow start threshold”) to cwnd/2—half of the value of the congestion window value when congestion was detected. The second way in which slow start may end is directly tied to the value of ssthresh. Since ssthresh is half the value of cwnd when congestion was last detected, it might be a bit reckless to keep doubling cwnd when it reaches or surpasses the value of ssthresh. Thus, when the value of cwnd equals ssthresh, slow start ends and TCP transitions into congestion avoidance mode. As we’ll see, TCP increases 引用《计算机网络-自顶向下方法(原书第五版)》]]></content>
      <categories>
        <category>网络知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Interaction design】11个令人抓乱的错误交互设计（11 Interactions Design Mistakes That Drive Us Nuts）]]></title>
    <url>%2FInteraction%20Design%20Mistakes%20That%20Drive%20Us%20Nuts.html</url>
    <content type="text"><![CDATA[好的交互设计可以区分开有质量的网站和其他普通网站。然而，如果有明显的设计错误，它只会给予你本来想打动的用户以刺激和挫败感。下面是Speckyboy上总结的让人最不喜欢的交互设计错误列表，来看看你中枪了没！Interaction design can separate the quality sites from the rest of the crowd – if done well. If, however, there are glaring errors in the designs, it will only serve to irritate and frustrate the very people you’re trying to impress.Here’s a list of my least favorite IxD mistakes that have left users disappointed, confused, and can even at times leave them a little angry. 缺乏对比（Lack of Contrast）译文：当浏览网站时，我们喜欢看页面设计展示出干净、清爽的对比。对比达到了一个重要的目的——它使内容可读，并毫不费力地在页面上指导用户。这是一个最基本的设计概念，只是很奇怪，有些网站似乎就是不明白。没有足够的对比度的话，不管是颜色或整体展示，一个网站看起来，在最好的情况下，也会让你觉得有点儿丈二和尚摸不着头脑，在最坏的情况下，将会使页面完全不可读。When browsing sites, we like to view designs that pop off the page with clean, crisp contrast. Contrast serves an important purpose – it helps make the content readable, and effortlessly guides users around the page. This is one of the most basic design concepts, and it’s surprising that some sites just don’t seem to get it!Without enough contrast, either in the color palette or overall presentation, a site can look, at best, a little confusing; and at worst, unreadable.Interaction Design Mistake Example: 疯狂的导航（Insane Navigation）无论你用的是什么跳出框架的导航创意，先考虑好你的用户。这并不是令人无聊的，而是深思熟虑并且务实的。好好利用导航设计的最佳实践和原则：清晰、简单性、一致性和相关性。No matter how out-of-the-box your navigation ideas are, think of your users first. It’s not being boring. It’s being thoughtful and pragmatic. Take advantage of navigation design best practices and principles: clarity, simplicity, consistency and correlation.Interaction Design Mistake Example: 非响应式的或者不良的触摸目标（Non-Responsive &amp; Poor Touch Targets）响应式网站在现在是至关重要的，我们没有借口去创建一个在你的智能手机上很难用的网站，除非你做了大量的用户测试，并证明了一个移动友好的网站并不是必需的Responsive websites are vital these days, and there’s no excuse for creating a site that’s hard to use on your smartphone unless you’ve done tons of user tests and proven that a mobile-friendly site is not a necessity.Interaction Design Mistake Example: 令人心烦意乱的音乐（Mind-Numbing Music）在晚上放些音乐很高兴而且也令放松。在正确的时间点上，音乐可以是很棒的体验。然而，在99.9％的情况下，正确的时间并不是当你浏览网站的时候。很少有事情比你在浏览一个网站的同时有一个刺耳的管弦交响乐团在你耳边演奏更恼人的事情。如果你是广告你的下一张专辑，这可能还算是可以原谅的。但即使这样，也只是可能还算是。It’s nice to put on some music in the evening and relax. Music can be great, at the right times. However, in 99.9% of cases, the right time isn’t when you’re browsing online.Few things are more annoying than browsing a site and having an orchestral symphony blaring in your ear at the same time. It’s possibly just about excusable if you’re advertising your next album. But even then, only just.Interaction Design Mistake Example: 毫无意义的弹出窗口（Pointless Pop-Ups）是的，弹出窗口真的可以让人感到恼火。特别是注册窗口！每个人都需要更多的注册！但是，总有更好的方法来做你的营销。弹出式窗口可以像冲孩子大喊大叫以试图吸引其注意力一样恼人。如果你必须使用弹窗，请让它们简单，有创意，并且易于关闭。Yes, they can really be irritating. Sign-ups! Everyone needs more sign-ups! However, there’s always a more elegant way to do your marketing. Pop-ups can be about as annoying as shouting children trying to get your attention. If you must use them, keep them simple, creative, and easy to shut down.Interaction Design Mistake Example: 可怜的架构（Poor Structure）我理解尝试创新是多么诱人。毕竟，你希望你的设计脱颖而出。然而，当创造变成了一场火热的混乱，就是时候带入一些必要的组织性。伟大的设计师们都是伟大的沟通者。视觉层次结构和平衡是创造良好的第一印象的重要层面，同时它们可以影响用户的行为，更重要的是，可以有效地传递出网页以外的信息。I understand how tempting it is to try to be creative. After all, you want your design to stand out. However, when creativity just becomes one hot mess, it’s time to bring in some much needed organization instead.Great designers are great communicators. Visual hierarchy and balance are some of the important aspects of creating a good first impression, shaping user behavior, and more importantly, effectively delivering the message beyond a web page.Interaction Design Mistake Example: 棘手的排版（Tricky Typography）当我访问网站，我喜欢能够快速而方便地访问信息。我们都不喜欢混乱的不易阅读的带阴影效果的大号字体。或者是在一个移动的背景尝试阅读，或者与要用放大镜才能查看的小字体苦苦斗争。这里有一些可以帮助你复习基础知识的规则：—— 建立一个清晰的层次结构—— 注意文本对齐方式—— 限制字体的字号数量、类型和颜色—— 必要时充分地利用空白When I visit websites, I like to be able to access information quickly and easily. We’re not keen on confusing large lettering with difficult-to-read shadow effects. Trying to read words over a moving background, or struggling with teeny-tiny fonts that require a magnifying glass to view them.Here are a few rules to help you brush up on the basics:Build a clear hierarchy.Pay attention to text alignment.Limit the number of font sizes, types, and colors.Make good use of whitespace where and when necessary. 笨拙的表单（Clumsy Forms）有的时候你会需要向你的用户要一些信息，这本身很好。然而，这并不是说你可以为他们提供一个很长，很浪费时间的表单。重复地要求相同的信息也不是一个好主意。只向用户要最少量的必要信息，并且不要忽视表单的跨浏览器样式。好的表单交互体验来自于清晰性、简洁性和一致性。这里有一些小贴士：—— 强调需要的字段—— 必要时显示进度—— 提供提示—— 注意字段的长度—— 使用先进的工具来定制表单元素There may be times when you need to ask your users for information, and that’s fine. However, it’s not okay to present them with a form that’s overly long and far too time-consuming to complete. Nor is it a good idea to ask for the same information twice. Ask for exactly what you require, at a minimum, and don’t neglect cross-browser form styling.Great web form interaction experience comes from clarity, conciseness, and consistency.Here are a few tips:Highlight required fields.Display progress if necessary.Provide hints.Pay attention to field length.Use advanced tools for customizing form elements. 没有用户反馈和数据的抄袭（Copying Others, Without User Feedback &amp; Data）从别人那里获得灵感并不一定是件坏事，但如果你这样做，你需要确保你手头有正确的反馈和数据，以确保你在为你的目标受众提供真正的设计价值。It’s not necessarily a bad thing to take inspiration from someone else, but you need to ensure you’ve got the right feedback and data at your fingertips before you do so to make sure you’re designing something of genuine value for your target audience.Interaction Design Mistake Example: 显著的不一致性（Glaring Inconsistencies）在一定程度上风格可以混搭的。然而，如果整体效果成了一个巨大的，丑陋的视觉“冲突”，那么还是建议回到绘图板并重新开始。好的交互设计是具有一致性的。它使用户更好地理解事物是如何工作的，让用户在使用一个网页时，感觉到他们在控制局面，以及提高他们的工作效率。雅各布·尼尔森说：“用户的期望更多地被证实是正确的，他们就会越觉得他们在控制系统，并会更加喜欢它。”It’s ok to mix-and-match styles to a certain extent. However, if the overall effect is just one big, ugly visual “clash” then it’s advisable to get back to the drawing board and start over.Great IxD is consistent. It gives users a better understanding of how things work, making them feel in control of the situation and increasing their efficiency in working with a web page. As Jakob Nielson said, “The more users’ expectations prove right, the more they will feel in control of the system and the more they will like it.”Interaction Design Mistake Example: 太多的动效（Too Many Effects）偶尔使用的交互式动画可以提升你的网站内容。然而，让你的页面负担一个又一个疯狂的动效，会让你的用户感觉到有点像是进入了在线疯人院里，甚至更糟糕的东西。下面这个网站是谈到疯狂设计时我一定会加冕为冠军的，我可以定下个挑战，你在看到它时有没有办法不感到精神错乱！The occasional well-positioned interactive animation can really lift the content of your site. However, burden your pages with crazy effect after crazy effect, and you’ll leave your audience feeling a little like they’ve entered the online equivalent of a lunatic asylum, or even worse.This one is my crowned winner when it comes to madcap design… I challenge you not to feel a little unhinged after seeing it!Interaction Design Mistake Example: 追逐趋势（Trend Chasing)保持一点时髦是很让人高兴的。然而，花时间去追逐最新的流行语和交互设计风格，你最终会得到一个网站，它阅读起来就像是陈词滥调。如果可以的话，你要敢于不同。It’s good to stay a little on-trend. However, spend your days chasing the latest buzzwords and interaction design styles, and you’ll end up with a site that reads a little bit like a cliché. Dare to be different, if you can. 交互设计——四种正确设计的方式(Interaction Design – Four Ways to Get it Right)所以，以上便是我收藏的我最讨厌的交互设计错误。下面是一个便利的小列表，以提醒你如何用正确的方式设计！ 1）目标驱动。不要为了添加效果而添加效果。不要选择某个调色板，导航栏，或者图标仅仅因为你认为它看起来不错。试试着眼在最终目标上。你想让你的网站达到什么目标？一旦你已经确定了那个目标，那么你很有可能就有了一个关于你应该使用什么样的交互设计的好主意。 2）记住要有人情味。如果你属于艺术型（我们不都是么），那你面对的诱惑是去创造美丽的东西，一些优秀的，一些有人从未做过的事。然而，如果没有人创建过和使用过，可能有一个很好的原因就是，它们确实没用。记住，网站的访客都是人类。你创造出旨在能直接吸引他们的东西。 3）保持一致性。是的，网站本身应该是很令人惊叹的。然而，网站也应该需要正常可用。你会有需要遵守某些设计惯例，以使网站易于浏览和理解。不要为了与众不同而违背常理。相反，接受你将需要实现一定的规则的事实，能帮助你的用户轻松地访问你的网站。 4）测试测试再测试。如果你发现任何疑问，就进行测试！有很多用户研究工具可以帮助你发现在产品中用户受困或者分心的地方。a/b测试，分析眼 动跟踪数据，或者是直接让你的客户，同事和朋友尝试你的新设计。没有什么比真正的反馈更有价值，并且几乎没有一个更好的方法能如此改进你的交互设想。So, that was my collection of my most hated errors in interaction design. Here’s a handy little list, reminding you how to get it right!Be goal-driven. Don’t add an effect for the sake of it. Don’t choose a color palette, navigation item, or icon simply because you think it looks good. Look at the end-goal instead. What do you want your site to achieve? Once you’ve identified that, then hopefully, you should have a good idea about what interaction design you should be using..Remember the human touch. If you’re the artistic type (aren’t we all!) the temptation is to create something beautiful, something outstanding, something that has never been done before. However, if nobody has created and used it yet, there might be a very good reason for that…namely, it just doesn’t work. Remember, the visitors to websites are humans. Create something that is designed to appeal directly to them..Keep it consistent. Yes, websites should be spectacular. However, they also need to be usable. There will be certain conventions that you’ll need to follow, in order to make the site easy to navigate and simple to understand. Don’t go against the grain for the sake of being different. Instead, accept that there are certain rules you will need to implement to help your users access your site with ease..Test, test, test. If in doubt, test! There are plenty of user research tools to help you define where users get stuck or distracted. Do a/b tests, analyze eye-tracking data or simply ask your customers, colleagues, and friends to try out your new designs. There’s nothing more valuable than genuine feedback and there’s hardly a better way to improve your interaction ideas..Want to Brush up on Your Skills? If you’re keen to polish up on your interaction design skills, here are some great guides, full to the brim with useful information to help you:Complete Beginner’s Guide to Interaction Design.Interaction Design Basics from Usability.gov.Interaction Design Tactics For Visual Designers.If you think I’ve missed anything, or you’ve got a pet peeve related to interaction design that you want to share, just leave a comment below!No related posts. 声明本文95%为组合翻译，详见引用,5%为原创 引用https://www.nngroup.com/articles/ten-usability-heuristics/]]></content>
      <categories>
        <category>人机交互</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Interaction design】10 Usability Heuristics for User Interface Design（transmit）]]></title>
    <url>%2Fheuristic_evaluation.html</url>
    <content type="text"><![CDATA[“用户的期望更多地被证实是正确的,他们就会越觉得他们在控制系统,并会更加喜欢它。” 雅各布·尼尔森 Summary: Jakob Nielsen’s 10 general principles for interaction design. They are called “heuristics” because they are broad rules of thumb and not specific usability guidelines. Visibility of system statusThe system should always keep users informed about what is going on, through appropriate feedback within reasonable time. Match between system and the real worldThe system should speak the users’ language, with words, phrases and concepts familiar to the user, rather than system-oriented terms. Follow real-world conventions, making information appear in a natural and logical order. User control and freedomUsers often choose system functions by mistake and will need a clearly marked “emergency exit” to leave the unwanted state without having to go through an extended dialogue. Support undo and redo. Consistency and standardsUsers should not have to wonder whether different words, situations, or actions mean the same thing. Follow platform conventions. Error preventionEven better than good error messages is a careful design which prevents a problem from occurring in the first place. Either eliminate error-prone conditions or check for them and present users with a confirmation option before they commit to the action.(Read full article on preventing user errors.) Recognition rather than recallMinimize the user’s memory load by making objects, actions, and options visible. The user should not have to remember information from one part of the dialogue to another. Instructions for use of the system should be visible or easily retrievable whenever appropriate.(Read full article on recognition vs. recall in UX.) Flexibility and efficiency of useAccelerators – unseen by the novice user – may often speed up the interaction for the expert user such that the system can cater to both inexperienced and experienced users. Allow users to tailor frequent actions. Aesthetic and minimalist designDialogues should not contain information which is irrelevant or rarely needed. Every extra unit of information in a dialogue competes with the relevant units of information and diminishes their relative visibility. Help users recognize, diagnose, and recover from errorsError messages should be expressed in plain language (no codes), precisely indicate the problem, and constructively suggest a solution. Help and documentationEven though it is better if the system can be used without documentation, it may be necessary to provide help and documentation. Any such information should be easy to search, focused on the user’s task, list concrete steps to be carried out, and not be too large. 引用https://www.nngroup.com/articles/ten-usability-heuristics/]]></content>
      <categories>
        <category>人机交互</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【密码学】RSA算法解析-加密解密]]></title>
    <url>%2Frsa_extend.html</url>
    <content type="text"><![CDATA[密钥生成随机选择两个不相等的质数p和q。例子中选择了7和11。（实际应用中，这两个质数越大，就越难破解。） 计算p和q的乘积n。 n = 7×11 = 77 n的长度就是密钥长度。77写成二进制是1001101，一共有7位，所以这个密钥就是7位。实际应用中，RSA密钥一般是1024位，重要场合则为2048位。 计算n的欧拉函数φ(n)。因为7和11为互质关系，根据欧拉定理可直接计算出φ(n) φ(n) = (p-1) (q-1)60 = 6 10 随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质。在本例子选择e等于67 计算e对于φ(n)的模反元素d。 ed ≡ 1 (mod φ(n))ed - 1 = kφ(n)ex + φ(n)y = 1已知 e=67, φ(n)=6067x + 60y = 1根据欧几里得拓展算法，求x,y67x + 120y = 1120 = 67 + 5367 = 53 + 1453 = 14×3+1114 = 11+311 = 3×3 +23 = 2+ 1 1 = 3-22 = 11 - 3×33 = 14 -1111 = 53 - 14×314 = 67 - 5353 = 120 -67 1 = 3 -21 = 3 -(11-3×3)1 = 4×3 - 111 = 4×(14-11)-111 = 4×14 - 5×111 = 4×14 - 5×(53-143)1 = 19×14 - 5×531 = 19×(67-53) - 5×(120-67)1 = 24×67 - 19×53 - 5×1201 = 24×67 -19(120-67)-5×1201 = 24×67 -24×120 + 19671 = 43×67 -48×60 加密和解密加密加密要用公钥 (n,e)，m必须是整数（字符串可以取ascii值或unicode值），且m必须小于n。$$m^e\equiv c(mod\quad n)$$这里的公钥是(77,67),假设需要加密的M=75$$75^{67}\equiv c(mod\quad 77)$$计算c的过程如下$$75^{1} mod\quad 77 = -2 $$$$75^{2} mod\quad 77 = 4 $$$$75^{4} mod\quad 77 = 16 $$根据欧几里得原理$$75^{60} mod\quad 77 = 1 $$ $$75^{67} mod\quad 77 =75^{60}75^{4}75^{2}75^{1} mod\quad 77 = 1164（-2）mod\quad 77 = （-13）*（-12） = 26$$ 解密解密要用私钥 (n,d)，这里的私钥是（77,43）需要解密的密文是26$$26^{43}\equiv m(mod\quad 77)$$计算m的过程如下$$26^{1} mod\quad 77 = 26$$$$26^{2} mod\quad 77 = 60$$$$26^{4} mod\quad 77 = 58$$$$26^{8} mod\quad 77 = 53$$$$26^{16} mod\quad 77 = 37$$$$26^{32} mod\quad 77 = 60$$ $$26^{43} mod\quad 77 = 26^{32}26^{8}26^{2}*26^{1} mod\quad 77 = 75$$ 引用无]]></content>
      <categories>
        <category>密码学</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【密码学】RSA算法解析-数论基础]]></title>
    <url>%2Frsa.html</url>
    <content type="text"><![CDATA[质（素）数（Prime Number）定义：大于 1 且只能被 1 和自身整除的正整数称为素数或质数. 大于 1 且不是素数的正整数称为合数.例如, 2,3,5,7,11是素数, 4,6,8,9是合数.一个好玩的现象，如果将所有素数进行螺旋排列，所有素数呈现斐波那契螺旋线排列，在计算机下的模拟如下：当有足够多的数据进行模拟时，展现的图形如下：自然界中也有很多如贝类的螺旋轮廓线、向日葵轮廓、银河、人的耳朵等这种天然的“黄金螺旋”。至于素数为什么也有这样的特征我的答案是我也不知道 任何合数(Composite Number)都是有若干素数（Prime Number）组成的素数是构成元素的基本要素,素数本身是不可再分的，素数是构建，每一个数有且只有一种素数的分解方法，没有两个数会分享同一个素数因子分解, (算术基本定理)设a&gt;1, 则$$a=p_1^{k1}p_2^{k2}p_3^{k3}….p_r^{kr}$$,其中p1,p2,…,pk是不相同的素数, r1,r2,…,rk是正整数, 并且在不计顺序的情况下, 该表示是惟一的. 该表达式称作整数 a 的素因子分解.例如 30=2×3×5, 117=32×13, 1024=210 数论倒数(Multiplicative Inverse)在数论中，还有数论倒数的概念，如果两个数a和b，它们的乘积关于模m余1，那么我们称它们互为关于模m的数论倒数.比如 3是2关于5的数论倒数.数论倒数在中国剩余定理中非常重要.而辗转相除法提供了计算数论倒数的方法,数论的倒数实际就是指定整数范围内的互质关系 互质(素)关系如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。关于互质关系，不难得到以下结论： 1. 任意两个质数构成互质关系，比如13和61。 2. 一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10。 3. 如果两个数之中，较大的那个数是质数，则两者构成互质关系，比如97和57。 4. 1和任意一个自然数是都是互质关系，比如1和99。 5. p是大于1的整数，则p和p-1构成互质关系，比如57和56。 6. p是大于1的奇数，则p和p-2构成互质关系，比如17和15。 官方给的定义： 同余定义 设m是正整数, a和b是整数. 如果m|a-b, 则称a模m同余于b, 或a与b模m同余, 记作a≡b(mod m). 如果a与b模m不同余, 则记作a!≡b(mod m). 例如, 15≡3(mod 4), 16≡0(mod 4), 14≡-2(mod 4), 15!≡16(mod 4). 下述两条都是a与b模m同余的充分必要条件:(1) a mod m = b mod m.(2) a=b+km, 其中k是整数. 中国剩余定理最大公约数a,b属于Z，能同时被a和b整除的最大的那个数，成为最大公约数，或者公因子 欧几里得算法(Euclidean Algorithm)欧几里德算法又称辗转相除法，用于计算两个整数a,b的最大公约数。其计算原理依赖于下面的定理：定理：gcd(a,b) = gcd(b,a mod b) 证明：a可以表示成a = kb + r ，则r = a mod b假设d是a,b的一个公约数，则有d|a, d|b，而r = a - kb，因此d|r因此d是(b,a mod b)的公约数 假设d 是(b,a mod b)的公约数，则d | b , d |r ，但是a = kb +r因此d也是(a,b)的公约数因此(a,b)和(b,a mod b)的公约数是一样的，其最大公约数也必然相等，得证。 设两数为a、b(a&gt;b)，求a和b最大公约数(a，b)的步骤如下：用a除以b，得a÷b=q……r1(0≤r1)。若r1=0，则(a，b)=b；若r1≠0，则再用b除以r1，得b÷r1=q……r2 (0≤r2）.若r2=0，则(a，b)=r1，若r2≠0，则继续用r1除以r2，……如此下去，直到能整除为止。其最后一个为被除数的余数的除数即为(a, b)。例如：a=25,b=15，a/b=1……10,b/10=1……5,10/5=2…….0,最后一个为被除数余数的除数就是5,5就是所求最大公约数。 扩展欧几里得算法（Extended Euclidean algorithm）已知整数a、b，扩展欧几里得算法可以在求得a、b的最大公约数的同时，能找到整数x、y（其中一个很可能是负数），使它们满足贝祖等式$$a\ast x+b\ast y = gcd(a,b)$$算法例子：用类似辗转相除法，求二元一次不定方程$$47\ast x+30\ast y = 1$$的整数解。 $$47=30+17\ast1$$$$30=17+13\ast1$$$$17=13+4\ast1$$$$13=4\ast3+1\ast1$$用余数的形式进行表达$$17=47+30\ast（-1）$$$$13=30+17\ast（-1）$$$$4=17+13\ast（-1）$$$$1=13+4\ast（-3）$$然后把他倒回去$$1=13-4\ast（3）$$$$1=13 +[17+13\ast（-1）]\ast（-3）$$$$1=13\ast4+17\ast(-3)$$$$1=[30+17\ast（-1）]\ast4+17\ast(-3)$$$$1=30\ast4+17\ast(-7)$$$$1=30\ast4+[47+30\ast（-1）]\ast(-7)$$$$1=30\ast11+47\ast(-7)$$得解x=-7, y=11。 贝祖定理一次不定方程是形式如$$a_1x_1+a_2x_2+a_3x_3+a_nx_n=c$$的方程，一次不定方程有整数解的充要条件为：$$gcd(a_1,a_2,….,a_n)|c$$换言之 a1,a2,a3的最大公约数须是c的因数 倍祖等式是上面的一种特殊情况$$a\ast x+b\ast y = c$$贝祖等式有解时必然有无穷多个整数解，每组解 x、y都称为裴蜀数 所谓贝祖定理是说：两个整数 a、b 是互质的，等价于方程 ax+by=1有整数解。方程 ax+by=1有整数解，两个整数 a、b 是互质的$$\frac{a}{c}\ast x-\frac{b}{c}\ast y = 1$$ 模幂运算(Modular exponentiation) 定义模运算即求余运算。“模”是“Mod”的音译，模运算多应用于程序编写中。 Mod的含义为求余。模运算在数论和程序设计中都有着广泛的应用，从奇偶数的判别到素数的判别，从模幂运算到最大公约数的求法，从孙子问题到凯撒密码问题，无不充斥着模运算的身影。虽然很多数论教材上对模运算都有一定的介绍，但多数都是以纯理论为主，对于模运算在程序设计中的应用涉及不多。模幂运算则是指先进行幂运算，在进行模运算。In symbols, given base b(底数), exponent e（指数）, and modulus m（模量）, the modular exponentiationc is:$$c \equiv b^e (mod\quad m).$$Given integers b and e, and a positive integer m, a unique solution c exists with the property 0 ≤ c &lt; m.Modular exponentiation can be performed with a negative(负指数) exponent e by finding the modular multiplicative inverse d of b modulo m using the extended Euclidean algorithm. That is:$$c \equiv b^e \equiv d^{-e} (mod\quad m).$$where e &lt; 0 and b ⋅ d ≡ 1 mod m.Modular exponentiation similar to the one described above are considered easy to compute, even when the numbers involved are enormous. On the other hand, computing the discrete logarithm – that is, the task of finding the exponent e when given b, c, and m – is believed to be difficult. This one-way function behavior makes modular exponentiation a candidate for use in cryptographic algorithms. 如何计算 1.直接计算 2.蒙哥马利模乘蒙哥马利模乘的优点在于减少了取模的次数（在大数的条件下）以及简化了除法的复杂度（在2的k次幂的进制下除法仅需要进行左移操作）。模幂运算是RSA 的核心算法，gh最直接地决定了RSA 算法的性能。 针对快速模幂运算这一课题，西方现代数学家提出了大量的解决方案，通常都是先将幂模运算转化为乘模运算首先由模运算的性质，可以得到下面的公式：(ab) % c = (a%c) b % c 【公式一】将【公式一】继续展开，可得下面的公式：(ab) % c = (a%c) b % c = (b%c) (a%c) % c = (a%c) (b%c) % c 【公式二】 例题：计算$$4^{13} mod\quad 11$$$$=(4^{6}mod\quad11)\ast(4^{7}mod\quad11) mod \quad11$$$$=[(4^{3}mod\quad11)\ast(4^{3}mod\quad11)mod\quad11]\ast [(4^{3}mod\quad11)\ast(4^{4}mod\quad11)mod\quad11]mod \quad11$$$$=((-2)\ast(-2)mod\quad11)\ast((-2)\ast(3)mod\quad11) mod 11$$$$=(4mod\quad11)\ast(5mod\quad11) mod 11$$$$=20mod\quad11$$$$=9$$ 欧拉函数请思考以下问题： 任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？） 计算这个值的方法就叫做欧拉函数，官方定义:invertible elements 表示数论倒数，数论倒数实际是对互质（素）的表示以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4。φ(n) 的计算方法并不复杂，但是为了得到最后那个公式，需要一步步讨论。 第一种情况如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。 第二种情况如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。 第三种情况如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则$$\phi{(p^k)}=p^k-p^{k-1}$$比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。这是因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有p^(k-1)个，即1×p、2×p、3×p、…、p^(k-1)×p，把它们去除，剩下的就是与n互质的数。上面的式子还可以写成下面的形式：$$\phi{(p^k)}=p^k-p^{k-1}=p^k(1-\frac{1}{p})$$可以看出，上面的第二种情况是 k=1 时的特例。 第四种情况如果n可以分解成两个互质的整数之积， n = p1 × p2则 φ(n) = φ(p1p2) = φ(p1)φ(p2)即积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。这一条的证明要用到”中国剩余定理”，这里就不展开了，只简单说一下思路：如果a与p1互质(a&lt;p1)，b与p2互质(b&lt;p2)，c与p1p2互质(c&lt;p1p2)，则c与数对 (a,b) 是一一对应关系。由于a的值有φ(p1)种可能，b的值有φ(p2)种可能，则数对 (a,b) 有φ(p1)φ(p2)种可能，而c的值有φ(p1p2)种可能，所以φ(p1p2)就等于φ(p1)φ(p2)。 第五种情况因为任意一个大于1的正整数，都可以写成一系列质数的积。$$n=p_1^{k1}p_2^{k2}p_3^{k3}….p_r^{kr}$$根据第4条的结论，得到$$\phi{n}=\phi({p_1^{k1}})\phi(p_2^{k2})\phi(p_3^{k3})….\phi(p_r^{kr})$$再根据第3条的结论，得到$$\phi{n}=p_1^{k1}p_2^{k2}p_3^{k3}….p_r^{kr}(1-\frac{1}{p_1})(1-\frac{1}{p_2})(1-\frac{1}{p_3})(1-\frac{1}{p_r})$$也就等于$$\phi{n}=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})(1-\frac{1}{p_3})(1-\frac{1}{p_r})$$这就是欧拉函数的通用计算公式。比如，1323的欧拉函数，计算过程如下：$$\phi{1323}=\phi({3^3\ast7^2})=1323(1-\frac{1}{3})(1-\frac{1}{7})=756$$ 欧拉定理欧拉函数的用处，在于欧拉定理。”欧拉定理”指的是：如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：$$a^{\phi({n})}\equiv 1(mod\quad n)$$也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728/7=104）。欧拉定理的证明比较复杂，这里就省略了。我们只要记住它的结论就行了。欧拉定理可以大大简化某些运算。比如，7和10互质，根据欧拉定理，$$7^{\phi({10})}\equiv 1(mod\quad 10)$$已知 φ(10) 等于4，所以马上得到7的4倍数次方的个位数肯定是1。$$7^{\phi({4k})}\equiv 1(mod\quad 10)$$因此，7的任意次方的个位数（例如7的222次方），心算就可以算出来。欧拉定理有一个特殊情况。假设正整数a与质数p互质，因为质数p的φ(p)等于p-1，则欧拉定理可以写成$$7^{\phi({p-1})}\equiv 1(mod\quad p)$$这就是著名的费马小定理。它是欧拉定理的特例。欧拉定理是RSA算法的核心。理解了这个定理，就可以理解RSA。 模反元素还剩下最后一个概念：如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1。$$ab\equiv 1(mod\quad n)$$这时，b就叫做a的”模反元素”。比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，即如果b是a的模反元素，则 b+kn 都是a的模反元素。欧拉定理可以用来证明模反元素必然存在。$$a^{\phi({n})}=a*a^{\phi({n})-1}\equiv 1(mod\quad n)$$可以看到，a的 φ(n)-1 次方，就是a的模反元素。 引用http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.htmlhttp://www.cnblogs.com/ziwuge/archive/2011/09/18/2180480.htmlhttps://en.wikipedia.org/wiki/Modular_exponentiationhttp://baike.baidu.com/link?url=o9Fn53FTV7r99qWNCYJGa3oR8yhjWV25RDvOMs0N4CCACOTFtsVzpwEAoVp50ecoYG5REZ2ksjQMfWiWw7y9Y18Y3CW1juoE7wC77h929B9tUysp4WjEt26BzMh1CA1539ZOoeUAZsucN0kz_ZVg9V-Fpt-_Z4nsiX0q9jOHm_jcDNw7Y2lL8BdRoFtmtJaohttp://blog.csdn.net/delphiwcdj/article/details/5973026https://zh.wikipedia.org/wiki/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95http://w3.math.sinica.edu.tw/math_media/d294/29408.pdf]]></content>
      <categories>
        <category>密码学</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】C语言指针整理1]]></title>
    <url>%2Fc_point.html</url>
    <content type="text"><![CDATA[一切都是地址C语言用变量来存储数据，用函数来定义一段可以重复使用的代码，它们最终都要放到内存中才能供 CPU 使用。 数据和代码都以二进制的形式存储在内存中，计算机无法从格式上区分某块内存到底存储的是数据还是代码。当程序被加载到内存后，操作系统会给不同的内存块指定不同的权限，拥有读取和执行权限的内存块就是代码，而拥有读取和写入权限（也可能只有读取权限）的内存块就是数据。 CPU 只能通过地址来取得内存中的代码和数据，程序在执行过程中会告知 CPU 要执行的代码以及要读写的数据的地址。如果程序不小心出错，或者开发者有意为之，在 CPU 要写入数据时给它一个代码区域的地址，就会发生内存访问错误。这种内存访问错误会被硬件和操作系统拦截，强制程序崩溃，程序员没有挽救的机会。编译和链接过程的一项重要任务就是找到变量和函数名所对应的地址 指针变量如下例子：a为正常变量，p为指针变量，p指向了100的地址 int a = 100; int *p = &amp;a; 获取指针的中的值，使用如下方式*p #include &lt;stdio.h&gt; int main(){ int a = 10; int *p = &amp;a; printf(&quot;%d, %d\n&quot;, a, *p); return 0; } 两种方式都可以输出a的值指针除了可以获取内存上的数据，也可以修改内存上的数据 #include &lt;stdio.h&gt; int main(){ int a = 15, b = 99, c = 222; int *p = &amp;a; //定义指针变量 *p = b; //通过指针变量修改内存上的数据 c = *p; //通过指针变量获取内存上的数据 printf(&quot;%d, %d, %d, %d\n&quot;, a, b, c, *p); return 0; } 结果输出：99,99，，99,99 * 和 &amp;的用法&amp;a可以理解为(&amp;a)，&amp;a表示取变量 a 的地址（等价于 pa），(&amp;a)表示取这个地址上的数据（等价于 pa），绕来绕去，又回到了原点，*&amp;a仍然等价于 a。 &amp;pa可以理解为&amp;(pa)，pa表示取得 pa 指向的数据（等价于 a），&amp;(pa)表示数据的地址（等价于 &amp;a），所以&amp;*pa等价于 pa。 指针变量的运算根据数据类型对指针进行增加，如下面运行代码 #include &lt;stdio.h&gt; int main(){ char a = 15; char *pa = &amp;a; int b = 55; int *pb = &amp;b; double c = 11; double *pc = &amp;c; printf(&quot;%#X,%#X,%#X\n&quot; , pa, pb,pc); printf(&quot;%d,%d,%d\n&quot;, *pa, *pb,c); pa++; pb++; pc++; printf(&quot;%#X,%#X,%#X\n&quot; , pa, pb,pc); return 0; } 返回结果，0X240FF27,0X240FF1C,0X240FF1015,55,00X240FF28,0X240FF20,0X240FF180X240FF27到0X240FF28 char类型后移位0X240FF1C到0X240FF20 int类型后移动4位0X240FF10到0X240FF18 double类型后移8位 以 a 和 pa 为例，a 的类型为 int，占用 4 个字节，pa 是指向 a 的指针，如下图所示：]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】聊聊网络传输层 Version 0.1]]></title>
    <url>%2Ftcp1.html</url>
    <content type="text"><![CDATA[声明本文70%为组合翻译，详见最后引用，30%为原创内容定版为version1.0,目前为 Version 0.1 表示正在撰写或者翻译 传输层（Transport layer） vs 网络层(network layer)network layer: logical communication between hosts网络层：主机之间的逻辑通信 transport layer: logical communication between processes–relies on, enhances, network layer services传输层:是主机之间的进程通信，是用来加强网络层的transport protocols run in end systems&nbsp;&nbsp;&nbsp;&nbsp;–send side: breaks app messages into segments, passes to network layer&nbsp;&nbsp;&nbsp;&nbsp;–rcv side: reassembles segments into messages, passes to app layer传输层工作在系统末端，发送消息时传输的报文拆分成小的片段然后发给网络层，接收消息时将报文组装应用层 传输层的协议（Internet transport-layer protocols）reliable,in-order delivery(TCP)&nbsp;&nbsp;&nbsp;&nbsp;–congestion control&nbsp;&nbsp;&nbsp;&nbsp;–flow control&nbsp;&nbsp;&nbsp;&nbsp;–connetion setup可信的有序的TCP协议，提供拥塞控制，流量控制等功能unreliable,unordered delivery(UDP)不可信的无序的UDP协议 复用和解复用（ Multiplexing and Demultiplexing）Multiplexing is the process in which multiple Data Streams, coming from different Sources, are combined and Transmitted over a Single Data Channel or Data Stream.并发传输是将多个数据流，从不同来源，合并和传播在一个单一的数据通道或数据流的过程。In Electronic Communications, the two basic forms of Multiplexing are Time Division Multiplexing (TDM) and Frequency Division Multiplexing (FDM).在电子通信中，复用的两种基本形式是时分复用（TDM）和频分复用（FDM）。In Time Division Multiplexing, Transmission Time on a Single Channel is divided into non-overlapped Time Slots. Data Streams from different Sources are divided into Units with same size and interleaved successively into the Time Slots.在时分复用，在一个通道传输时间被分为非重叠时隙。不同来源的数据流被分成大小相同的单位，先后交错成时隙。In Frequency Division Multiplexing, Data Streams are carried simultaneously on the same Transmission medium by allocating to each of them a different Frequency Band within the Bandwidth of the Single Channel.在频分复用，数据流同时相同的传输介质上的单信道的带宽内分配给他们每个人不同的频段进行。Multiplexing is done by an equipment called Multiplexer (MUX). It is placed at the Transmitting End of the communication link. At the Receiving End, the Composite Signal is separated by an equipment called Demultiplexer (DEMUX). Demultiplexer performs the reverse process of Multiplexing and routes the separated signals to their corresponding Receivers or Destinations.多路复用是通过称为多路复用器（MUX）的设备完成的。它被放置在通信链路的发送端。在接收端，复合信号是由称为解复用器（DEMUX）的设备分离。多路分解器执行复用和路由的分离的信号的逆过程到其对应的接收器或目的地。Figure 1 shows how TDM interleaves small Units of each Data Stream into the corresponding Time Slots. It Transmits the Data Streams from three Signal Sources (Red, Green and Blue) simultaneously by combining them into a Single Data Stream.图1显示了TDM如何交织每个数据流的小单位到相应的时隙。它通过将它们合并为单个数据流传输数据流从三个信号源（红，绿，蓝）同时进行。 解复用是如何工作的 How demultiplexing works发送和接收delivering received segments to correct socket发送：从多个套接字收集数据，用传输层首部封装数据(以后用于分解 ) Multiplexing at send host接收：将接收的段交付给正确的套接字，(利用传输层首部信息进行分解)host receive IP datagrams,each datagrams hava source IP address,destination address,Each datagrams carreies transport-layer segment,each segment have source destination port number,host use IP address and port to appropriate socket实际上，复用与分解是针对多个SOCKET与一个网络层通道的关系 面向连接的分解（connection-oriented demux）TCP socket identified by 4-tuple:&nbsp;&nbsp;&nbsp;&nbsp;–source IP address&nbsp;&nbsp;&nbsp;&nbsp;–source port address&nbsp;&nbsp;&nbsp;&nbsp;–dest IP address&nbsp;&nbsp;&nbsp;&nbsp;–dest port addressdemux: receiver uses all four values to direct segment to approprite socket接收主机使用这四个值将段定位到对应的套接字(也就对应了特定应用程序) server host may support many simultaneous TCP socket,web servers have different sockets for each connecting client,non-persistent HTTP will have different socket for each resquest服务器可以同时支持很多个TCP套接字同时工作，对于非持续连接的HTTP的请求，每次都要建立一个请求套接字 无连接分解(Connectionless demultiplexing)Create socket with port numbers:DatagarmSocket mysocket = new DatagarmSocket(11111);UDP socket identified by two tuple:&nbsp;&nbsp;&nbsp;&nbsp;–dest IP address&nbsp;&nbsp;&nbsp;&nbsp;–dest port addresswhen host receives UDP segment,checks destination in segement.directs UDP segment to socket with that port number,IP datagrams with different source IP addresses and/or source port numbers can be directed to same socket一个应用程序可以有多个套接字,一个套接字只能属于一个应用程序无连接的分解只考虑目的IP和目的地址，如果目的IP和地址相同，他们可以被分配到相同的套接字 UDP: User Datagram Protocol [RFC 768]“best effort” service, UDP segments may be “尽力而为”服务，UDP段可能：&nbsp;&nbsp;&nbsp;&nbsp;– lost 丢包&nbsp;&nbsp;&nbsp;&nbsp;– delivered out-of-order to app 交付给应用程序的报文可能失序connectionless: 无连接:&nbsp;&nbsp;&nbsp;&nbsp;– no handshaking between UDP sender, receiver 在UDP发送方和接收方之间无握手&nbsp;&nbsp;&nbsp;&nbsp;– – each UDP segment handled independently of others每个UDP段的处理独立于其他段，无状态传递UDP应用场景，对数据丢失不敏感的流式数据（视屏，音频），DNS，SNMP UDP头格式化 （UDP segment header）其中length为UDP数据和头的长度 UDP校验和 （UDP checksum）Goal:detect “errors” in transmitted segmentsender:目标：监听传输过程中的错误 The checksum field is the 16 bit one’s complement of the one’s complement sum of all 16-bit words in the header and text.If a segment contains an odd number of header and text octets to be checksummed, the last octet is padded on the right with zeros to form a 16-bit word for checksum purposes. The pad is not transmitted as part of the segment. While computing the checksum, the checksum field itself is replaced with zeros. Header Checksum区域有16位。它是这样获得的，从header取得除checksum之外的0/1序列，比如：9194 8073 0000 4000 4011 C0A8 0001 C0A8 00C7 (十六进制hex, 这是一个为演示运算过程而设计的header)按照十六位(也就是4位hex)分割整个序列。将分割后的各个4位hex累积相加。如果有超过16位的进位出现，则将进位加到后16位结果的最后一位： Binary Hex 1001000110010100 9194 +1000000001110011 8073 1 0001001000000111 11207 1 0001001000001000 1208上面的计算叫做one’s complement sum。求得所有十六位数的和，one’s complement sum(4500, 0073, 0000, 4000, 4011, C0A8, 0001, C0A8, 00C7) = 1433然后，将1433的每一位取反(0-&gt;1, 1-&gt;0)， 就得到checksum：EBCC这样，我们的header就是:9194 8073 0000 4000 4011 EBCC C0A8 0001 C0A8 00C7IP包的接收方在接收到IP包之后，可以求上面各个16位数的one’s complement sum，应该得到FFFF。如果不是FFFF，那么header是不正确的，整个IP包会被丢弃。Here is Checksum calculation for a very small UDP user datagram with only 7 bytes of data. Because the number of bytes of data is odd, padding is added for checksum calculation.The pseudo header as well as the padding will be dropped when the user datagram is delivered to IP layer. 构造可靠的数据传输协议完全可靠信道上的可靠数据传输(rdt1.0)最简单的情况，假设底层的信道是完全可靠的，所有分组从发送方流向接收方，有了完全可靠的信道，接收方不需要提供任何反馈消息给发送方，因为不会发生任何差错 完全可靠信道上的可靠数据传输(rdt2.0)在现实中，在实际传输中有些比特可能会受损或者丢失，接了解决这个问题采用，服务应答机制接收肯定确认（positive acknowledgment），否定确认(negative acknowledgment)，自动重传请求(Automatic Repeat Request ARQ)ARQ协议提供了三种协议来处理比特差错，1差错检测，2接收方反馈，3重传rdt2.0 看着似乎可是运行了，但是有个致命的缺陷，没有考虑到ACK或者NAK的分组受损的情况，rdt2.1为了解决ACK或者NAK丢失的问题，有三种方案可以考虑，第一种：重发ACK或者NAK，但是同样面临含糊丢失的问题第二种：增加足够的检测和比特，可以直接恢复比特差错第三种：收到含糊不清的ACK，重发整个分组，但是会产生冗余分组（duplicate packet）的问题，解决此类问题的方法是在数据分组中添加一个新字段，即将发送的数据分组的序号放入字段中，接收方可以检测序号（sequence number）判断是否为冗余分组rdt2.2如果分组报文接收不成功接收方不发送NAC，转而发送上一次正确接收的ACK 具有比特差错的丢包信道上的可靠数据传输(rdt3.0)除了比特受损之外，底层信道还会丢包，假定让发送方负责检测和恢复丢包，发送方确定一个合适的时间值倒数定时器（countdown timer）1.每次发送一个分组，启动定时器2.响应定时器中断（采取合适的动作）3.终止定时器 流水线可靠数据传输协议(Pipelined protocols)模型：为了评估停等对性能的影响，可以考虑一种两台主机理想化的情况，一台位于美国位于美国东海岸，一台位于美国西海岸，两个系统光速往返传播时延（RTT）大约为30ms,假如彼此通过一条传输速率为R=1Gbps(10^9bps),包括首部字段和数据分组的长L=1000字节（8000比特），实际发送一个分组到1Gbps链路所需的时间是$$\phi{n}=\frac{L}{R}=\frac{8000\quad bit/packet}{10^9\quad bit/s}=9us$$如果发送方在t=0的时刻发送分组，在t=L/R=8us后，最后一个比特数据进入发送方信道，经过15ms的垮美国旅行后到达接收方，该分组的最后1比特在时刻t=RTT/2+L/R=15.008时到达接收方，接收方在收到最后一个分组的最后1个比特后立刻发动ACK，ACK在时刻t=RTT+L/R=30.008ms到达发送方，（假设ACK分组很小，我们忽略其发送时间），此时发送方可以发送下一个报文，因此在30.008ms内，发送方值发送了0.008ms定义发送方信道的利用率：$$\phi{n}=\frac{L/R}{RTT+L/R}=\frac{0.008\quad ms}{30.008\quad ms}=0.000267us$$发送方只有万分之2.67的时间是繁忙的，发送方在30.008ms内只发送了1000字节，有效的吞吐量为267kbps为了解决这个问题引用新的方法：不使用停等协议，允许发送方发送多个分组，而且不用确认，下图的例子，在等待确认之前发送3个分组，利用率提高3倍，此种方式称为流水线，但是流水线对可靠数据传输协议带来的如下影响：1.每个传输分组必须有分组序号2.协议发发送方和接收方必须可以缓存多个分组，发送方最低限度是缓冲那些没有确认的分组3.所需的序号范围和对缓冲的要求取决于数据传输协议处理丢失、损坏以及过度延时分组的方式解决流水线分的方式有两种：回退N部，选择重传， 回退N部（Go-back-N）Go-back-N简称GBNGo-back-N，sender can have up to N unacked packets in pipeline• receiver only sends cumulative ack doesn’t ack packet if there’s a gap• sender has timer for oldest unacked packet when timer expires, retransmit all unacked packets 滑动窗口协议（sliding-window protocol）我么将最早的未确认的分组的序号定义为基序号(base)，下一个序号（nextsqnum）定义为最小的未使用的序号，可以将序号范围分为以下四部分，详见下图已经被发送，但是还么有收到确认的分组的许可范围可以被看成是一个在序号范围内长度为N的窗口，随着协议的运行，该窗口在序号空间内向前滑动，N被称为窗口长度，GBN协议被称为滑动窗口协议（slinding-window protocol） GNB响应一下三种类型的事件1.上层的调用，上层调用rdt_send()时，发送方首先检查发送窗口是否已满，即是否有N个已经发送但是未被确认的分组，如果窗口未满，则创建一个分组将其发送，如果窗口已满，告诉上层一会重试，目前繁忙2.收到ACK，采用累积确认的方式，如收到的序号为m,则m之前的序号已经完成发送3.超时事件，收到下一组发送的ACK，但是上一组没有收到，则从上一组开始恢复 选择重传（Selective repeat）GBN的问题，出现任何一个差错，其后的所有分组都将收到影响，为了解决这个问题引入了选择重传的功能发送：1.如果下一个可用的序号在窗口内，则发送包2.每个分组都拥有自己逻辑定时器，超时只发送当前这个分组3.收到ACK，如果该分组在窗口内，在SR发送方将那个未被确认的分组标示为已经接收 ，如果该分组的序号等于send_base,则窗口基序号向前移动到最小序号的未确认分组处，如果窗口移动了并且有序号落在窗口内的未发送分组，则发送这些分组接收： #include &lt;stdio.h&gt; int main(){ char a = 15; char *pa = &amp;a; int b = 55; int *pb = &amp;b; double c = 11; double *pc = &amp;c; printf(&quot;%#X,%#X,%#X\n&quot; , pa, pb,pc); printf(&quot;%d,%d,%d\n&quot;, *pa, *pb,c); pa++; pb++; pc++; printf(&quot;%#X,%#X,%#X\n&quot; , pa, pb,pc); return 0; } 引用http://macao.communications.museum/eng/exhibition/secondfloor/moreinfo/2_8_6_Multiplexing.htmlhttp://blog.chinaunix.net/uid-26758209-id-3146230.html《计算机网络-自顶向下方法(原书第4版)》]]></content>
      <categories>
        <category>网络知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Reading Notes Of 《RFC 2616, HTTP/1.1》 Part1]]></title>
    <url>%2FReading%20Notes%20Of%20RFC%202616%20P1.html</url>
    <content type="text"><![CDATA[1 Introduction1.1 PurposeThe Hypertext Transfer Protocol (HTTP) is an application-level protocol for distributed, collaborative, hypermediainformation systems. HTTP has been in use by the World-Wide Web global information initiative since 1990. The first version of HTTP, referred to as HTTP/0.9, was a simple protocol for raw data transfer across the Internet. HTTP/1.0, as defined by RFC 1945 [6], improved the protocol by allowing messages to be in the format of MIMElike messages, containing metainformation about the data transferred and modifiers on the request/response semantics. However, HTTP/1.0 does not sufficiently take into consideration the effects of hierarchical proxies,caching, the need for persistent connections, or virtual hosts. In addition, the proliferation of incompletelyimplemented applications calling themselves “HTTP/1.0” has necessitated a protocol version change in order for two communicating applications to determine each other’s true capabilities. This specification defines the protocol referred to as “HTTP/1.1”. This protocol includes more stringentrequirements than HTTP/1.0 in order to ensure reliable implementation of its features. Practical information systems require more functionality than simple retrieval, including search, front-end update,and annotation. HTTP allows an open-ended set of methods and headers that indicate the purpose of a request [47].It builds on the discipline of reference provided by the Uniform Resource Identifier (URI) [3], as a location (URL)[4] or name (URN) [20], for indicating the resource to which a method is to be applied. Messages are passed in a format similar to that used by Internet mail [9] as defined by the Multipurpose Internet Mail Extensions (MIME) [7]. HTTP is also used as a generic protocol for communication between user agents and proxies/gateways to other Internet systems, including those supported by the SMTP [16], NNTP [13], FTP [18], Gopher [2], and WAIS [10]protocols. In this way, HTTP allows basic hypermedia access to resources available from diverse applications. 阐述了HTTP的发展历史，从版本0.9 到版本1.1 中间添加的新功能和新需求 HTTP1.1重点增加了可靠性传输的功能 1.2 RequirementsThe key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULDNOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described inRFC 2119 [34]. An implementation is not compliant if it fails to satisfy one or more of the MUST or REQUIRED level requirements for the protocols it implements. An implementation that satisfies all the MUST or REQUIRED level and all the SHOULD level requirements for its protocols is said to be “unconditionally compliant”; one that satisfies all theMUST level requirements but not all the SHOULD level requirements for its protocols is said to be “conditionally compliant.” 1.3 Terminology(专业术语)This specification uses a number of terms to refer to the roles played by participants in, and objects of, the HTTP communication. connection（连接）A transport layer virtual circuit established between two programs for the purpose of communication.message（报文）The basic unit of HTTP communication, consisting of a structured sequence of octets matching the syntaxdefined in section 4 and transmitted via the connection.request(请求) An HTTP request message, as defined in section 5.response（响应）An HTTP response message, as defined in section 6.resource（资源）A network data object or service that can be identified by a URI, as defined in section 3.2. Resources may beavailable in multiple representations (e.g. multiple languages, data formats, size, and resolutions) or vary inother ways.entity(实体)The information transferred as the payload of a request or response. An entity consists of metainformation in the form of entity-header fields and content in the form of an entity-body, as described in section 7.representationAn entity included with a response that is subject to content negotiation, as described in section 12. There may exist multiple representations associated with a particular response status.content negotiation （内容约定）The mechanism（机制） for selecting the appropriate representation（表现） when servicing a request, as described in section 12.The representation of entities in any response can be negotiated（协定） (including error responses).variant（变量）A resource may have one, or more than one, representation(s) associated with it at any given instant（瞬间）. Each of these representations is termed a ‘variant.’ Use of the term ‘variant’ does not necessarily imply that the resource is subject to content negotiation.client（客户端）A program that establishes connections for the purpose of sending requests.user agent（用户代理）The client which initiates a request. These are often browsers, editors, spiders (web-traversing robots), or other end user tools. 用户代理包括了浏览器，爬虫，自动机器人 server（服务端）An application program that accepts connections in order to service requests by sending back responses. Anygiven program may be capable of being both a client and a server; our use of these terms refers only to the role being performed by the program for a particular connection, rather than to the program’s capabilities in general. Likewise, any server may act as an origin server, proxy, gateway, or tunnel, switching behavior based on the nature of each request.origin server（源服务器）The server on which a given resource resides or is to be created.proxy(代理)An intermediary program which acts as both a server and a client for the purpose of making requests on behalfof other clients. Requests are serviced internally or by passing them on, with possible translation, to otherservers. A proxy MUST implement both the client and server requirements of this specification. A “transparentproxy” is a proxy that does not modify the request or response beyond what is required for proxy authenticationand identification. A “non-transparent proxy” is a proxy that modifies the request or response in order to provide some added service to the user agent, such as group annotation services, media type transformation, protocol reduction, or anonymity filtering. Except where either transparent or non-transparent behavior is explicitly stated, the HTTP proxy requirements apply to both types of proxies. 有时候为了提供更多的其他服务，可能会对HTTP的request or response进行适当调整 gateway（网关）A server which acts as an intermediary（中间阶段） for some other server. Unlike a proxy, a gateway receives requests as if it were the origin server for the requested resource; the requesting client may not be aware that it is communicating with a gateway. 客户端意识不到它在和网关沟通 tunnel（信道）An intermediary program which is acting as a blind relay between two connections. Once active, a tunnel is notconsidered a party to the HTTP communication, though the tunnel may have been initiated（发起） by an HTTP request. The tunnel ceases to exist when both ends of the relayed connections are closed. HTTP发起信道通讯，一般信道用于HTTPS cache（缓存）A program’s local store of response messages and the subsystem that controls its message storage, retrieval, and deletion. A cache stores cacheable responses in order to reduce the response time and network bandwidthconsumption on future, equivalent requests. Any client or server may include a cache, though a cache cannot beused by a server that is acting as a tunnel. 缓存用户减少带宽消耗，减少相应时间，客户端和服务端均可以有缓存 cacheable（是否能缓存）A response is cacheable if a cache is allowed to store a copy of the response message for use in answeringsubsequent requests. The rules for determining the cacheability of HTTP responses are defined in section 13.Even if a resource is cacheable, there may be additional constraints on whether a cache can use the cached copyfor a particular request.first-hand（首次握手）A response is first-hand if it comes directly and without unnecessary delay from the origin server, perhaps viaone or more proxies. A response is also first-hand if its validity（有效性） has just been checked directly with the origin server.explicit expiration time（显式过期时间）The time at which the origin server intends that an entity should no longer be returned by a cache without further validation. 可以设置的过期时间 heuristic expiration time（启发式时间）An expiration time assigned by a cache when no explicit expiration time is available. 在没有设置的情况下，服务器自动给分配的过期时间 age（存活时间）The age of a response is the time since it was sent by, or successfully validated with, the origin server.freshness lifetime The length of time between the generation of a response and its expiration time. fresh(刷新)A response is fresh if its age has not yet exceeded its freshness lifetime.staleA response is stale if its age has passed its freshness lifetime.semantically transparent（语义透明）A cache behaves in a “semantically transparent” manner, with respect to a particular response, when its useaffects neither the requesting client nor the origin server, except to improve performance. When a cache issemantically transparent, the client receives exactly the same response (except for hop-by-hop headers) that itwould have received had its request been handled directly by the origin server.validator（验证）A protocol element (e.g., an entity tag or a Last-Modified time) that is used to find out whether a cache entry is an equivalent copy of an entity. 检验本次请求是否和上次一致，如果一致返回302 upstream/downstream（上传流、下载流）Upstream and downstream describe the flow of a message: all messages flow from upstream to downstream.inbound/outboundInbound and outbound refer to the request and response paths for messages: “inbound” means “traveling towardthe origin server”, and “outbound” means “traveling toward the user agent” 1.4 Overall OperationThe HTTP protocol is a request/response protocol. A client sends a request to the server in the form of a request method, URI, and protocol version, followed by a MIME-like（多用途互联网邮件扩展类型） message containing request modifiers, client information, and possible body content over a connection with a server. The server responds with a status line, including the message’s protocol version and a success or error code, followed by a MIME-like message containing server information, entity metainformation, and possible entity-body content. The relationship between HTTP and MIME is described in appendix 19.4. 常见的MIME类型(通用型)：超文本标记语言文本 .html text/htmlxml文档 .xml text/xmlXHTML文档 .xhtml application/xhtml+xml普通文本 .txt text/plainRTF文本 .rtf application/rtfPDF文档 .pdf application/pdfMicrosoft Word文件 .word application/mswordPNG图像 .png image/pngGIF图形 .gif image/gifJPEG图形 .jpeg,.jpg image/jpegau声音文件 .au audio/basicMIDI音乐文件 mid,.midi audio/midi,audio/x-midiRealAudio音乐文件 .ra, .ram audio/x-pn-realaudioMPEG文件 .mpg,.mpeg video/mpegAVI文件 .avi video/x-msvideoGZIP文件 .gz application/x-gzipTAR文件 .tar application/x-tar任意的二进制数据 application/octet-stream Most HTTP communication is initiated by a user agent and consists of a request to be applied to a resource on some origin server. In the simplest case, this may be accomplished via a single connection (v) between the user agent (UA) and the origin server (O). request chain ————————&gt; UA ——————-v——————- O &lt;———————– response chain 用户代理发起请求， 服务端返回响应 A more complicated situation occurs when one or more intermediaries（中间） are present in the request/response chain.There are three common forms of intermediary: proxy, gateway, and tunnel. A proxy is a forwarding agent, receiving requests for a URI in its absolute form, rewriting all or part of the message, and forwarding the reformatted request toward the server identified by the URI. A gateway is a receiving agent, acting as a layer above some other server(s) and, if necessary, translating the requests to the underlying server’s protocol. A tunnel acts as a relay point between two connections without changing the messages; tunnels are used when the communication needs to pass through anintermediary (such as a firewall) even when the intermediary cannot understand the contents of the messages. request chain ————————————–&gt; UA —–v—– A —–v—– B —–v—– C —–v—– O &lt;————————————- response chainThe figure above shows three intermediaries (A, B, and C) between the user agent and origin server. A request or response message that travels the whole chain will pass through four separate connections. This distinction is important because some HTTP communication options may apply only to the connection with the nearest, non tunnel neighbor, only to the end-points of the chain, or to all connections along the chain. Although the diagram is linear（线性的）, each participant may be engaged in multiple, simultaneous communications. For example, B may be receiving requests from many clients other than A, and/or forwarding requests to servers other than C, at the same time that it is handling A’s request. Any party to the communication which is not acting as a tunnel may employ an internal cache for handling requests.The effect of a cache is that the request/response chain is shortened if one of the participants along the chain has a cached response applicable to that request. The following illustrates the resulting chain if B has a cached copy of an earlier response from O (via C) for a request which has not been cached by UA or A. request chain ———-&gt; UA —–v—– A —–v—– B - - - - - - C - - - - - - O &lt;——— response chain Not all responses are usefully cacheable, and some requests may contain modifiers which place special requirements on cache behavior. HTTP requirements for cache behavior and cacheable responses are defined in section 13.In fact, there are a wide variety of architectures and configurations of caches and proxies currently beingexperimented with or deployed across the World Wide Web. These systems include national hierarchies of proxycaches to save transoceanic bandwidth, systems that broadcast or multicast cache entries, organizations thatdistribute subsets of cached data via CD-ROM, and so on. HTTP systems are used in corporate intranets over highbandwidth links, and for access via PDAs with low-power radio links and intermittent connectivity. The goal of HTTP/1.1 is to support the wide diversity of configurations already deployed while introducing protocol constructs that meet the needs of those who build web applications that require high reliability and, failing that, at least reliable indications of failure. HTTP communication usually takes place over TCP/IP connections. The default port is TCP 80 [19], but other ports can be used. This does not preclude HTTP from being implemented on top of any other protocol on the Internet, or on other networks. HTTP only presumes a reliable transport; any protocol that provides such guarantees can be used; the mapping of the HTTP/1.1 request and response structures onto the transport data units of the protocol in question is outside the scope of this specification. In HTTP/1.0, most implementations used a new connection for each request/response exchange. In HTTP/1.1, aconnection may be used for one or more request/response exchanges, although connections may be closed for avariety of reasons (see section 8.1).]]></content>
      <categories>
        <category>网络知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[​【WEB安全】WEB安全基础知识系列- JSON Hijacking]]></title>
    <url>%2Fjson-hijacking.html</url>
    <content type="text"><![CDATA[JavaScript Hijacking和CSRF很相像，唯一不同的是，CSRF是模拟你的身份去发送请求，JavaScript Hijacking是模拟你的身份，窃取你在服务器上的私隐信息。 1.攻击原理:Json Hijacking攻击的思想见下图： （1）.你正常访问信任站点（http://www.Bank.com），然后登陆信任站点。 （2）.信任站点通过你的验证，并返回Cookie。 （3）.这时，在你还没有登出信任站点之前，你再打开了一个浏览器的tab页，并访问了一个恶意站点（www.BadGuy.com）。 （4）.恶意站点向请求用户访问http://www.Bank.com的一个资源。 （5）.浏览器带着之前的Cookie信息，向信任站点发送一个AJAX的GET请求或者JSONP跨域请求 （6）.信任站点验证的Cookie信息通过，根据请求返回一个JSON数组或者回调数据如mycallback({‘id’:’123’})。 （7）.你的浏览器收到来自http://www.Bank.com的响应后，转发响应中的JSON信息给恶意站点。至此，恶意站点拿到你关于http://www.Bank.com的信息。 2.JSONP的介绍:为了更好的引述下面的话题，下面我借用stackoverflow上的话题来介绍一下JSONP JSONP is really a simple trick to overcome the XMLHttpRequest same domain policy. (As you know one cannot send AJAX (XMLHttpRequest) request to a different domain.)，So - instead of using XMLHttpRequest we have to use script HTML tags, the ones you usually use to load js files, in order for js to get data from another domain. Sounds weird?，Thing is - turns out script tags can be used in a fashion similar to XMLHttpRequest! Check this out: script = document.createElement(‘script’);script.type = ‘text/javascript’;script.src = ‘http://www.someWebApiServer.com/some-data‘; You will end up with a script segment that looks like this after it loads the data: &lt;script&gt;{[‘some string 1’, ‘some data’, ‘whatever data’]}&lt;/script&gt; However this is a bit inconvenient, because we have to fetch this array from script tag. So JSONPcreators decided that this will work better(and it is): script = document.createElement(‘script’);script.type = ‘text/javascript’;script.src = ‘http://www.someWebApiServer.com/some-data?callback=my_callback‘; Notice the my_callback function over there? So - when JSONP server receives your request and finds callback parameter - instead of returning plain js array it’ll return this: my_callback({[‘some string 1’, ‘some data’, ‘whatever data’]}); See where the profit is: now we get automatic callback (my_callback) that’ll be triggered once we get the data.That’s all there is to know about JSONP: it’s a callback and script tags.，NOTE: these are simple examples of JSONP usage, these are not production ready scripts. Basic JavaScript example (simple Twitter feed using JSONP) &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div id = ‘twitterFeed’&gt;&lt;/div&gt;&lt;script&gt;function myCallback(dataWeGotViaJsonp){var text = ‘’;var len = dataWeGotViaJsonp.length;for(var i=0;i&lt;len;i++){twitterEntry = dataWeGotViaJsonp[i];text += ‘&lt;p&gt;&lt;img src = “‘ + twitterEntry.user.profile_image_url_https +’”/&gt;’ + twitterEntry[‘text’] + ‘&lt;/p&gt;’}document.getElementById(‘twitterFeed’).innerHTML = text;}&lt;/script&gt;&lt;script type=”text/javascript” src=”http://twitter.com/status/user_timeline/padraicb.json?count=10&amp;callback=myCallback&quot;&gt;&lt;/script&amp;gt;&lt;/body&gt;&lt;/html&gt;Basic jQuery example (simple Twitter feed using JSONP) &lt;html&gt;&lt;head&gt;&lt;script type=”text/javascript” src=”https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js&quot;&gt;&lt;/script&amp;gt;&lt;script&gt;$(document).ready(function(){$.ajax({url: ‘http://twitter.com/status/user_timeline/padraicb.json?count=10‘,dataType: ‘jsonp’,success: function(dataWeGotViaJsonp){var text = ‘’;var len = dataWeGotViaJsonp.length;for(var i=0;i&lt;len;i++){twitterEntry = dataWeGotViaJsonp[i];text += ‘&lt;p&gt;&lt;img src = “‘ + twitterEntry.user.profile_image_url_https +’”/&gt;’ + twitterEntry[‘text’] + ‘&lt;/p&gt;’}$(‘#twitterFeed’).html(text);}});})&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id = ‘twitterFeed’&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; JSONP stands for JSON with Padding. (very poorly named technique as it really has nothing to do with what most people would think of as “padding”.) 总结：AJAX的底层原理是XMLHttpRequest，但是由于浏览器的同源策略，无论是get还是post请求，均不允许进行跨域操作，但是html对js和css则没有限制，这要是网站优化动静态元素分离的一个基础，JSONP就是基于此事实，去后台请求时返回可以执行的JS,例如&lt;script type=”text/javascript” src=”https://ajax.min.js&quot;&gt;&lt;/script&amp;gt; 返回mycallback({‘id’:’123’}，如果此刻在页面中有函数，Function mycallback(obj){alert(obj.id)} 则能正常的返回 2.攻击举例实际应用中返回的数据格式有两种，一种是数据，一种是对象 对象的攻击方式 &lt;html&gt;…&lt;body&gt;&lt;script type=”text/javascript”&gt;Object.prototype.defineSetter(‘Id’, function(obj){alert(obj);});&lt;/script&gt;&lt;script src=”http://example.com/Home/AdminBalances&quot;&gt;&lt;/script&amp;gt;&lt;/body&gt;&lt;/html&gt;其中用到了Javascript的原型，如果对Javascript的原型不够熟悉，可以参考之前的文章《【编程语言】深刻理解javascript原型（proto）》数组的攻击方式 &lt;script type=”text/javascript”&gt;var secrets;&nbsp;Array = function() {secrets = this;};&lt;/script&gt;&lt;script src=”http://haacked.com/demos/secret-info.json“type=”text/javascript”&gt;&lt;/script&gt;&nbsp;&lt;script type=”text/javascript”&gt;var yourData = ‘’;var i = -1;while(secrets[++i]) {yourData += secrets[i] + ‘ ‘;}alert(‘I stole your data: ‘ + yourData);&lt;/script&gt;下面举一个实际的例子，通过构造URL让用户访问，可以获得QQ Mail的邮件列表。该漏洞由于需要在web QQ里共享QQ Mail里的邮件信息，所以QQ Mail开放了一个json接口以提供第三方的域名来获得QQ Mail的信息，但是由于该接口缺乏足够的认证，所以导致任何第三方域里都可以用script的方式来获取该邮件列表。WooYun: QQMail邮件泄露漏洞 详见地址http://www.wooyun.org/bugs/wooyun-2010-046 &lt;script&gt;var Qmail={};&lt;/script&gt;&lt;script src=”http://mail.qq.com/cgi-bin/login?fun=passport&amp;target=MLIST&amp;t=login.js&amp;pagesize=10&amp;resp_charset=gb2312&amp;1=3&quot;&gt;&lt;/script&amp;gt;&lt;script&gt;alert(Qmail.newMailsList.nextUrl);alert(document.scripts[1].src=Qmail.newMailsList.nextUrl);alert(Qmail.newMailsList.summary);&lt;/script&gt; 4.漏洞防御:因为此类漏洞为CSRF的变种，因此CSRF的防御均可以使用，详见《【WEB安全】WEB安全基础知识系列-跨站请求伪造(CSRF)》，其中重点介绍JSONP中的callback防御，在早期 JSON 出现时候，大家都没有合格的编码习惯。再输出 JSON 时，没有严格定义好 Content-Type（ Content-Type: application/json ）然后加上 callback 这个输出点没有进行过滤直接导致了一个典型的 XSS 漏洞， 举例：http://127.0.0.1/getUsers.php?callback=&lt;script&gt;alert(/xss/)&lt;/script&lt;/script)&gt;，对于 Content-Type 来说早期还有一部分人比较喜欢使用 application / javascript而这个头在 IE 等浏览器下一样可以解析 HTML 导致 XSS 漏洞。对于这种类型的漏洞，防御主要是从两个点去部署的： a、严格定义 Content-Type: application / json 这样的防御机制导致了浏览器不解析恶意插入的 XSS 代码（直接访问提示文件下载）。但是凡事都有个案，在 IE 的进化过程中就出现过通过一些技巧绕过 Content-Type 防御解析 html ，比如在 IE6、7 等版本时请求的 URL 文件后面加一个 /x.html 就可以解析 html （ http://127.0.0.1/getUsers.php/x.html?callback=&lt;script&gt;alert(/xss/)&lt;/script&amp;gt; ） 具体参考：http://hi.baidu.com/hi_heige/item/f1ecde01c4af3ed61ef04646 b、过滤 callback 以及 JSON 数据输出 这样的防御机制是比较传统的攻防思维，对输出点进行 xss 过滤。又是一个看上去很完美的解决方案，但是往往都是”事与愿违”。当年( 2011 年)一个 utf7-BOM 就复活了 n 个 XSS 漏洞。这种攻击方式主要还是存在与 IE 里(注在 IE 较新版本里已经”修复”) 也就是当我们在 callback 点输出 +/v8 这样的 utf7-BOM 的时候， IE 浏览器会把当前执行的编码认为是 utf7 ,所以我们通过 utf7 提交的 XSS 代码会被自动解码并执行。如： http://127.0.0.1/getUsers.php?callback=%2B%2Fv8%20%2BADwAaAB0AG0APgA8AGIAbwBkAHkAPgA8AHMAYwByAGkAcAB0AD4AYQBsAGUAcgB0ACgAMQApADsAPAAvAHMAYwByAGkAcAB0AD4APAAvAGIAbwBkAHkAPgA8AC8AaAB0AG0APg-%20其中：%2B%2Fv8%20%2BADwAaAB0AG0APgA8AGIAbwBkAHkAPgA8AHMAYwByAGkAcAB0AD4AYQBsAGUAcgB0ACgAMQApADsAPAAvAHMAYwByAGkAcAB0AD4APAAvAGIAbwBkAHkAPgA8AC8AaAB0AG0APg-%20URLdecode 为：+/v8+ADwAaAB0AG0APgA8AGIAbwBkAHkAPgA8AHMAYwByAGkAcAB0AD4AYQBsAGUAcgB0ACgAMQApADsAPAAvAHMAYwByAGkAcAB0AD4APAAvAGIAbwBkAHkAPgA8AC8AaAB0AG0APg- 其中 +/v8 为 utf7-BOM ，后面的为我们注入的 utf-7 编码后的 XSS 代码的：&lt;htm&gt;&lt;body&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/body&gt;&lt;/htm&gt; 4.总结与思考: Json Hijacking 主要是利用了服务器对请求的信任和JS的强大的灵活性， 在使用JSONP时注意返回格式的严格定义，减少攻击的切入面 5.引用: http://haacked.com/archive/2009/06/25/json-hijacking.aspx/ http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx/ http://stackoverflow.com/questions/2067472/what-is-jsonp-all-about http://www.wooyun.org/bugs/wooyun-2010-046 http://www.csdn.net/article/2015-07-14/2825207]]></content>
      <categories>
        <category>WEB安全</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[​【WEB安全】WEB安全基础知识系列-点击劫持（CLICKJACKING）]]></title>
    <url>%2Fe2-80-8bweb-e5-ae-89-e5-85-a8-e5-9f-ba-e7-a1-80-e7-9f-a5-e8-af-86-e7-b3-bb-e5-88-97-e7-82-b9-e5-87-bb-e5-8a-ab-e6-8c-81-ef-bc-88clickjacking-ef-bc-89.html</url>
    <content type="text"><![CDATA[“ Clickjacking （点击劫持）是由互联网安全专家罗伯特·汉森和耶利米·格劳斯曼在 2008 年提出的。 是一种视觉欺骗手段，在 web 端就是 iframe 嵌套一个透明不可见的页面，让用户在不知情的情况下，点击攻击者想要欺骗用户点击的位置。” 1.攻击原理:点击劫持（ClickJacking）是一种视觉上的欺骗手段。大概有两种方式，一是攻击者使用一个透明的iframe，覆盖在一个网页上，然后诱使用户在该页面上进行操作，此时用户将在不知情的情况下点击透明的iframe页面；二是攻击者使用一张图片覆盖在网页，遮挡网页原有位置的含义； 2.攻击举例假如我们在百度有个贴吧，想偷偷让别人关注它。于是我们准备一个页面： &lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;meta http-equiv=”Content-Type” content=”text/html; charset=gb2312” /&gt;&lt;head&gt;&lt;title&gt;点击劫持&lt;/title&gt;&lt;style&gt; html,body,iframe{ display: block; height: 100%; width: 100%; margin: 0; padding: 0; border:none; } iframe{ opacity:0; filter:alpha(opacity=0); position:absolute; z-index:2; } button{ position:absolute; top: 315px; left: 462px; z-index: 1; width: 72px; height: 26px; }&lt;/style&gt;&lt;/head&gt; &lt;body&gt; 那些不能说的秘密 &lt;button&gt;查看详情&lt;/button&gt; &lt;iframe src=”http://tieba.baidu.com/f?kw=%C3%C0%C5%AE&quot;&gt;&lt;/iframe&amp;gt; &lt;/body&gt;&lt;/html PS：页面看起来就这样，当然真正攻击的页面会精致些，不像这么简陋。 2. 网址传播出去后，用户手贱点击了查看详情后，其实就会点到关注按钮。 PS：可以把iframe透明设为0.3看下实际点到的东西。 3. 这样贴吧就多了一个粉丝了。 4.漏洞防御:Client Side Mitigations（客户端防护） NoScript plugin 这是一种简单的一种防御方法，就是在浏览器层面阻止js的运行。FireFox的Noscript插件就可以做到这一点。这个插件有一个选项可以使用户免于遭受clickjacking的攻击。实现原理是，这个插件阻止JS创建iframe。不过这个插件只能运行于firefox和基于其内核的浏览器。GuardedID GuardedID是一个用于保护用户免受包括clickijack在内的诸多攻击的商业软件。GuardedID不直接干扰浏览器的解析，只是把所用iframe强制设为可见。GuardedID只能在IE firefox浏览器下工作。 Server Side Mitigations（服务端防护）JS防御方案 &lt;script&gt;if (self == top) { var theBody = document.getElementsByTagName(‘body’)[0]; theBody.style.display = “block”;} else { top.location = self.location;}&lt;/script&gt; X-Frame-Options X-Frame-Options 共有三个值：DENY 任何页面都不能被嵌入到 iframe 或者 frame 中。SAMEORIGIN 页面只能被本站页面嵌入到 iframe 或者 frame 中。 ALLOW-FROM uri 页面自能被指定的 Uri 嵌入到 iframe 或 frame 中。 &nbsp; Apache 配置 X-Frame-Options &nbsp; 在站点配置文件 httpd.conf 中添加如下配置，限制只有站点内的页面才可以嵌入 iframe 。 Header always append X-Frame-Options SAMEORIGIN 配置之后重启 apache 使其生效。该配置方式对 IBM HTTP Server 同样适用。 如果同一 apache 服务器上有多个站点，只想针对一个站点进行配置，可以修改 .htaccess 文件，添加如下内容： Header append X-FRAME-OPTIONS “SAMEORIGIN” &nbsp; Nginx 配置 X-Frame-Options &nbsp; 到 nginx/conf 文件夹下，修改 nginx.conf ，添加如下内容： add_header X-Frame-Options “SAMEORIGIN”; 重启 Nginx 服务。 &nbsp; Node Express服务器防止点击劫持劫持 &nbsp; npm install helmet –save var express = require(‘express’); var helmet = require(‘helmet’); var app = express(); app.use(helmet.frameguard(‘sameorigin’)); PS：可以把iframe透明设为0.3看下实际点到的东西。4.总结与思考: 点击劫持核心思想是利用利用隐藏的IFRAME诱骗用户去点击，隐藏的IFRAME的链接可共享主域名的COOKIE等信息 安全起见，最好在开发时屏蔽IFRAME的调用，迫不得已的情况下，优先考虑使用X-FRAME-OPTION的相应策略5.引用: http://www.07net01.com/2016/03/1339679.html https://qjzd.net/topic/55a13be30fcea8a4423a2cef http://www.freebuf.com/articles/web/22999.html]]></content>
      <categories>
        <category>WEB安全</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【WEB安全】WEB安全基础知识系列-DATA URI]]></title>
    <url>%2F01ee46195698d061ab87e4ff17816a48.html</url>
    <content type="text"><![CDATA[1.DATA URI 释义: 举例：data:text/html;charset=utf-8;base64,PGh0bWw+PGJvZHk+aGkhISEhPC9ib2R5PjwvaHRtbD4=Data URI scheme是在RFC2397中定义的，目的是将一些小的数据，直接嵌入到网页中，从而不用再从外部文件载入。data表示取得数据的协定名称，text/html 是数据类型名称，charset=utf-8;是编码格式，base64 是数据的编码方法，逗号后面就是这个image/png文件base64编码后的数据。 data:,文本数据data:text/plain,文本数据data:text/html,HTML代码data:text/html;base64,base64编码的HTML代码data:text/css,CSS代码data:text/css;base64,base64编码的CSS代码data:text/javascript,Javascript代码data:text/javascript;base64,base64编码的Javascript代码data:image/gif;base64,base64编码的gif图片数据data:image/png;base64,base64编码的png图片数据data:image/jpeg;base64,base64编码的jpeg图片数据data:image/x-icon;base64,base64编码的icon图片数据2.应用举例 1.直接挂载&lt;object data=data:text/html;base64,PHNjcmlwdD5hbGVydCgieHNzIik8L3NjcmlwdD4=&gt;&lt;/object&gt;页面 会弹’xss’,如下图所示 2.压缩图片，减少网络请求，提高运行效率，图片的 base64 编码就是可以将一副图片数据编码成一串字符串，使 用该字符串代替图像地址。那么图片的 base64 编码长什么样子呢？举个栗子。www.google.com 的首页搜索框右侧 的搜索小图标使用的就是base64编码。我们可以看到： 1234//在css里的写法#fkbx-spch, #fkbx-hspch { background: url(data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5B…EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs=) no-repeat center;}12//在html代码img标签里的写法&lt;i&lt;span style=&quot;font-size: 14pt;&quot; data-wiz-span=&quot;data-wiz-span&quot;&gt;mg src=&lt;/span&gt;``&lt;span style=&quot;font-size: 14pt;&quot; data-wiz-span=&quot;data-wiz-span&quot;&gt;&quot;data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5B…EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs=&quot;&lt;/span&gt;``&lt;span style=&quot;font-size: 14pt;&quot; data-wiz-span=&quot;data-wiz-span&quot;&gt;&amp;gt;&lt;/span&gt; 上面分别是图片的 base64 编码在 css 里面的写法和在 html&lt;img&gt; 标签里的写法。base64 编码长得就是这个样子， 当然 base64 编码不仅仅运用在图片编码， 4.总结与思考: 正确的利用此类协议可以更好的屏蔽XSS漏洞 同时运用BASE64对图像转换，可以有效的减少网络流量，节省带宽，此类应用在雪碧图中，表现的更为明显5.引用: http://www.cnblogs.com/coco1s/p/4375774.html http://26836659.blogcn.com/articles/data-url.html http://www.pjhome.net/web/html5/encodeDataUrl.htm]]></content>
      <categories>
        <category>WEB安全</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【WEB安全】WEB安全基础知识系列-跨站请求伪造(CSRF)]]></title>
    <url>%2Fweb-e5-ae-89-e5-85-a8-e5-9f-ba-e7-a1-80-e7-9f-a5-e8-af-86-e7-b3-bb-e5-88-97-e8-b7-a8-e7-ab-99-e8-af-b7-e6-b1-82-e4-bc-aa-e9-80-a0csrf.html</url>
    <content type="text"><![CDATA[CSRF（Cross-site request forgery跨站请求伪造，也被称成为”one click attack”或者session riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。 1.攻击原理: CSRF攻击原理比较简单，如图1所示。其中Web A为存在CSRF漏洞的网站，Web B为攻击者构建的恶意网站，User C为Web A网站的合法用户。 1.用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A； 2.在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A； 3.用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B； 4.网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A； 5.浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是 由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。 2.攻击举例&nbsp; 银行网站A，它以GET请求来完成银行转账的操作，如：http://www.mybank.com/Transfer.php?toBankId=11&amp;money=1000危险网站B，它里面有一段HTML代码如下：&lt;img src=http://www.mybank.com/Transfer.php?toBankId=11&amp;money=1000&amp;gt;首先，你登录了银行网站A，然后访问危险网站B，噢，这时你会发现你的银行账户少了1000块……为什么会这样呢？原因是银行网站A违反了HTTP规范，使用GET请求更新资源。在访问危险网站B的之前，你已经登录了银行网站A，而B中的&lt;img&gt;以GET的方式请求第三方资源（这里的第三方就是指银行网站了，原本这是一个合法的请求，但这里被不法分子利用了），所以你的浏览器会带上你的银行网站A的Cookie发出Get请求，去获取资源”http://www.mybank.com/Transfer.php?toBankId=11&amp;money=1000”，结果银行网站服务器收到请求后，认为这是一个更新资源操作（转账操作），所以就立刻进行转账操作……同样的道理，即使是用post依然会被轻易利用，在此不再冗余举例 4.漏洞防御:增加二次验证，在表单提交之前在此输入验证码或者其他标识，如12306的校验过程 验证HTTP REFERER,HTTP源地址用来标识请求的源地址，即此次页面从哪发起，校验的代码如下 // 从 HTTP 头中取得 Referer 值 `&lt;/pre&gt; &lt;pre&gt;` String referer=request.getHeader(&quot;Referer&quot;); `&lt;/pre&gt; &lt;pre&gt;` // 判断 Referer 是否以 bank.example 开头 `&lt;/pre&gt; &lt;pre&gt;` if((referer!=null) &amp;amp;&amp;amp;(referer.trim().startsWith(&quot;bank.example&quot;))){ `&lt;/pre&gt; &lt;pre&gt;` chain.doFilter(request, response); `&lt;/pre&gt; &lt;pre&gt;` }else{ `&lt;/pre&gt; &lt;pre&gt;` request.getRequestDispatcher(&quot;error.jsp&quot;).forward(request,response); `&lt;/pre&gt; &lt;pre&gt;` }`&lt;/pre&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;span style=&quot;color: #333333;&quot;&gt;在实际生成环境中，因为代理服务器和防火墙的原因，源地址常常会被屏蔽掉，所以此种方法慎用,增加随机数校验TOKEN，其核心思想是客户端的请求时的随机数与存在后台的数据进行对比,前台的随机数常用隐藏的input中、自定义header中、cookie中，服务器端的随机数一般存在SESSION中，由此衍生出来的防御方法如下：前台的基础是浏览器的同源策略，即第三方的页面无法获取本页面的相应信息 &lt;/span&gt; &lt;span style=&quot;color: #333333;&quot;&gt;**基于隐藏input的代码 **&lt;/span&gt; &lt;div&gt; &lt;table style=&quot;border-collapse: collapse; background: #fbd4b4;&quot; border=&quot;0&quot;&gt;&lt;colgroup&gt; &lt;col style=&quot;width: 590px;&quot; /&gt;&lt;/colgroup&gt; &lt;tbody valign=&quot;top&quot;&gt; &lt;tr&gt; &lt;td style=&quot;padding-left: 7px; padding-right: 7px; border: solid 0.5pt;&quot;&gt; &lt;pre&gt;`&amp;lt;form method=&quot;POST&quot; action=&quot;transfer.php&quot;&amp;gt; &amp;lt;input type=&quot;text&quot; name=&quot;toBankId&quot;&amp;gt; &amp;lt;input type=&quot;text&quot; name=&quot;money&quot;&amp;gt; &amp;lt;input type=&quot;hidden&quot; name=&quot;hash&quot; value=&quot;****&quot;&amp;gt; &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot;&amp;gt; `&lt;/pre&gt; &lt;pre&gt;` &amp;lt;/form&amp;gt;`&lt;/pre&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;span style=&quot;color: #333333;&quot;&gt;**基于HASHCOOKIE的代码 **&lt;/span&gt; &lt;div&gt; &lt;table style=&quot;border-collapse: collapse; background: #fbd4b4;&quot; border=&quot;0&quot;&gt;&lt;colgroup&gt; &lt;col style=&quot;width: 590px;&quot; /&gt;&lt;/colgroup&gt; &lt;tbody valign=&quot;top&quot;&gt; &lt;tr&gt; &lt;td style=&quot;padding-left: 7px; padding-right: 7px; border: solid 0.5pt;&quot;&gt; &lt;pre&gt;`$token = md5(uniqid(rand(), TRUE)); `&lt;/pre&gt; &lt;pre&gt;`$_SESSION[&apos;token&apos;] = $token; `&lt;/pre&gt; &lt;pre&gt;`$_SESSION[&apos;token_time&apos;] = time()`&lt;/pre&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;span style=&quot;color: #333333;&quot;&gt;**基于自定义header的条件 **&lt;/span&gt; &lt;div&gt; &lt;table style=&quot;border-collapse: collapse; background: #fbd4b4;&quot; border=&quot;0&quot;&gt;&lt;colgroup&gt; &lt;col style=&quot;width: 590px;&quot; /&gt;&lt;/colgroup&gt; &lt;tbody valign=&quot;top&quot;&gt; &lt;tr&gt; &lt;td style=&quot;padding-left: 7px; padding-right: 7px; border: solid 0.5pt;&quot;&gt; &lt;pre&gt;`dojo.xhr = function(method,args,hasBody) { `&lt;/pre&gt; &lt;pre&gt;` // 确保 header 对象存在 `&lt;/pre&gt; &lt;pre&gt;` args.headers = args.header || {}; `&lt;/pre&gt; &lt;pre&gt;` tokenValue = &apos;&amp;lt;=request.getSession(false).getAttribute(&quot;csrftoken&quot;)%&amp;gt;&apos;; `&lt;/pre&gt; &lt;pre&gt;` var token = dojo.getObject(&quot;tokenValue&quot;); `&lt;/pre&gt; &lt;pre&gt;` // 把 csrftoken 属性放到头中 `&lt;/pre&gt; &lt;pre&gt;` args.headers[&quot;csrftoken&quot;] = (token) ? token : &quot; &quot;; `&lt;/pre&gt; &lt;pre&gt;` return plainXhr(method,args,hasBody); `&lt;/pre&gt; &lt;pre&gt;`} &nbsp; 4.总结与思考: 其中起到关键因素因素是浏览器的同源策略，如果没有看懂的小伙盘，可以研究下这块 目前最好的解决方案依然停留在客户端与服务端的对比校验，随机数有服务端发起，客户端在数据流中只负责带上，服务端自行校验 5.引用: http://www.freebuf.com/articles/web/11840.html http://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html 《白帽子讲WEB安全》 &nbsp;]]></content>
      <categories>
        <category>WEB安全</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】深刻理解javascript原型（_proto_）]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91-e6-b7-b1-e5-88-bb-e7-90-86-e8-a7-a3javascript-e5-8e-9f-e5-9e-8b-ef-bc-88-proto-ef-bc-89.html</url>
    <content type="text"><![CDATA[原文作者：汤姆大叔 原文地址：http://www.cnblogs.com/TomXu/archive/2012/01/12/2308594.html 我们首先来看一下对象[Object]的概念，这也是ECMASript中最基本的概念。 对象Object ECMAScript是一门高度抽象的面向对象(object-oriented)语言，用以处理Objects对象. 当然，也有基本类型，但是必要时，也需要转换成object对象来用。 An object is a collection of properties and has a single prototype object. The prototype may be either an object or the null value. Object是一个属性的集合，并且都拥有一个单独的原型对象[prototype object]. 这个原型对象[prototype object]可以是一个object或者null值。 让我们来举一个基本Object的例子，首先我们要清楚，一个Object的prototype是一个内部的[[prototype]]属性的引用。 不过一般来说，我们会使用&lt;内部属性名&gt; 下划线来代替双括号，例如proto(这是某些脚本引擎比如SpiderMonkey的对于原型概念的具体实现，尽管并非标准)。 var foo = {x: 10,y: 20}; 上述代码foo对象有两个显式的属性[explicit own properties]和一个自带隐式的 proto 属性[implicit proto property]，指向foo的原型。 图 1. 一个含有原型的基本对象 为什么需要原型呢，让我们考虑原型链的概念来回答这个问题。 原型链（Prototype chain） 原型对象也是普通的对象，并且也有可能有自己的原型，如果一个原型对象的原型不为null的话，我们就称之为原型链（prototype chain）。 A prototype chain is a finite chain of objects which is used to implemented inheritance and shared properties.原型链是一个由对象组成的有限对象链由于实现继承和共享属性。 想象一个这种情况，2个对象，大部分内容都一样，只有一小部分不一样，很明显，在一个好的设计模式中，我们会需要重用那部分相同的，而不是在每个对象中重复定义那些相同的方法或者属性。在基于类[class-based]的系统中，这些重用部分被称为类的继承 – 相同的部分放入class A，然后class B和class C从A继承，并且可以声明拥有各自的独特的东西。 ECMAScript没有类的概念。但是，重用[reuse]这个理念没什么不同（某些方面，甚至比class-更加灵活），可以由prototype chain原型链来实现。这种继承被称为delegation based inheritance-基于继承的委托，或者更通俗一些，叫做原型继承。 类似于类“A”，“B”，“C”，在ECMAScript中尼创建对象类“a”，“b”，“c”，相应地，对象“a” 拥有对象“b”和“c”的共同部分。同时对象“b”和“c”只包含它们自己的附加属性或方法。 var a = {x: 10,calculate: function (z) { returnthis.x + this.y + z}}; var b = {y: 20,proto: a}; var c = {y: 30,proto: a}; // 调用继承过来的方法b.calculate(30); // 60c.calculate(40); // 80 这样看上去是不是很简单啦。b和c可以使用a中定义的calculate方法，这就是有原型链来[prototype chain]实现的。 原理很简单:如果在对象b中找不到calculate方法(也就是对象b中没有这个calculate属性), 那么就会沿着原型链开始找。如果这个calculate方法在b的prototype中没有找到，那么就会沿着原型链找到a的prototype，一直遍历完整个原型链。记住，一旦找到，就返回第一个找到的属性或者方法。因此，第一个找到的属性成为继承属性。如果遍历完整个原型链，仍然没有找到，那么就会返回undefined。 注意一点，this这个值在一个继承机制中，仍然是指向它原本属于的对象，而不是从原型链上找到它时，它所属于的对象。例如，以上的例子，this.y是从b和c中获取的，而不是a。当然，你也发现了this.x是从a取的，因为是通过原型链机制找到的。 如果一个对象的prototype没有显示的声明过或定义过，那么prototype的默认值就是object.prototype, 而object.prototype也会有一个prototype, 这个就是原型链的终点了，被设置为null。 下面的图示就是表示了上述a,b,c的继承关系 图 2. 原型链 原型链通常将会在这样的情况下使用：对象拥有相同或相似的状态结构(same or similar state structure) （即相同的属性集合）与不同的状态值(different state values)。在这种情况下，我们可以使用构造函数(Constructor) 在特定模式(specified pattern) 下创建对象。 构造函数(Constructor) 除了创建对象，构造函数(constructor) 还做了另一件有用的事情—自动为创建的新对象设置了原型对象(prototype object) 。原型对象存放于 ConstructorFunction.prototype 属性中。 例如，我们重写之前例子，使用构造函数创建对象“b”和“c”，那么对象“a”则扮演了“Foo.prototype”这个角色： // 构造函数function Foo(y) { // 构造函数将会以特定模式创建对象：被创建的对象都会有”y”属性this.y = y;} // “Foo.prototype”存放了新建对象的原型引用// 所以我们可以将之用于定义继承和共享属性或方法// 所以，和上例一样，我们有了如下代码： // 继承属性”x”Foo.prototype.x = 10; // 继承方法”calculate”Foo.prototype.calculate = function (z) { returnthis.x + this.y + z;}; // 使用foo模式创建 “b” and “c”var b = new Foo(20);var c = new Foo(30); // 调用继承的方法b.calculate(30); // 60c.calculate(40); // 80 // 让我们看看是否使用了预期的属性 console.log( b.proto === Foo.prototype, // true c.proto === Foo.prototype, // true // “Foo.prototype”自动创建了一个特殊的属性”constructor”// 指向a的构造函数本身// 实例”b”和”c”可以通过授权找到它并用以检测自己的构造函数 b.constructor === Foo, // true c.constructor === Foo, // true Foo.prototype.constructor === Foo // true b.calculate === b.proto.calculate, // true b.proto.calculate === Foo.prototype.calculate // true ); 上述代码可表示为如下的关系： 图 3. 构造函数与对象之间的关系 上述图示可以看出，每一个object都有一个prototype. 构造函数Foo也拥有自己的proto, 也就是Function.prototype, 而Function.prototype的proto指向了Object.prototype. 重申一遍，Foo.prototype只是一个显式的属性，也就是b和c的proto属性。]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[The Principle of Quick Response Code]]></title>
    <url>%2F8a3f0f6b234e02e107992b55cae6c012.html</url>
    <content type="text"><![CDATA[二维码又称QR Code，QR全称Quick Response，是一个近几年来移动设备上超流行的一种编码方式，它比传统的Bar Code条形码能存更多的信息，也能表示更多的数据类型：比如：字符，数字，日文，中文等等。这两天学习了一下二维码图片生成的相关细节，觉得这个玩意就是一个密码算法，在此写一这篇文章 ，揭露一下。供好学的人一同学习之。 关于QR Code Specification，可参看这个PDF：http://raidenii.net/files/datasheets/misc/qr_code.pdf 基础知识首先，我们先说一下二维码一共有40个尺寸。官方叫版本Version。Version 1是21 x 21的矩阵，Version 2是 25 x 25的矩阵，Version 3是29的尺寸，每增加一个version，就会增加4的尺寸，公式是：(V-1)4 + 21（V是版本号） 最高Version 40，(40-1)4+21 = 177，所以最高是177 x 177 的正方形。 下面我们看看一个二维码的样例： 定位图案 Position Detection Pattern是定位图案，用于标记二维码的矩形大小。这三个定位图案有白边叫Separators for Postion Detection Patterns。之所以三个而不是四个意思就是三个就可以标识一个矩形了。 Timing Patterns也是用于定位的。原因是二维码有40种尺寸，尺寸过大了后需要有根标准线，不然扫描的时候可能会扫歪了。 Alignment Patterns 只有Version 2以上（包括Version2）的二维码需要这个东东，同样是为了定位用的。 功能性数据 Format Information 存在于所有的尺寸中，用于存放一些格式化数据的。 Version Information 在 &gt;= Version 7以上，需要预留两块3 x 6的区域存放一些版本信息。 数据码和纠错码 除了上述的那些地方，剩下的地方存放 Data Code 数据码 和 Error Correction Code 纠错码。 数据编码我们先来说说数据编码。QR码支持如下的编码： Numeric mode数字编码，从0到9。如果需要编码的数字的个数不是3的倍数，那么，最后剩下的1或2位数会被转成4或7bits，则其它的每3位数字会被编成 10，12，14bits，编成多长还要看二维码的尺寸（下面有一个表Table 3说明了这点） Alphanumeric mode字符编码。包括 0-9，大写的A到Z（没有小写），以及符号$ % * + – . / : 包括空格。这些字符会映射成一个字符索引表。如下所示：（其中的SP是空格，Char是字符，Value是其索引值） 编码的过程是把字符两两分组，然后转成下表的45进制，然后转成11bits的二进制，如果最后有一个落单的，那就转成6bits的二进制。而编码模式和字符的个数需要根据不同的Version尺寸编成9, 11或13个二进制（如下表中Table 3） Byte mode, 字节编码，可以是0-255的ISO-8859-1字符。有些二维码的扫描器可以自动检测是否是UTF-8的编码。 Kanji mode这是日文编码，也是双字节编码。同样，也可以用于中文编码。日文和汉字的编码会减去一个值。如：在0X8140 to 0X9FFC中的字符会减去8140，在0XE040到0XEBBF中的字符要减去0XC140，然后把结果前两个16进制位拿出来乘以0XC0，然后再加上后两个16进制位，最后转成13bit的编码。如下图示例： Extended Channel Interpretation (ECI) mode主要用于特殊的字符集。并不是所有的扫描器都支持这种编码。 Structured Append mode用于混合编码，也就是说，这个二维码中包含了多种编码格式。 FNC1 mode这种编码方式主要是给一些特殊的工业或行业用的。比如GS1条形码之类的。 简单起见，后面三种不会在本文 中讨论。 下面两张表中， Table 2 是各个编码格式的“编号”，这个东西要写在Format Information中。注：中文是1101 Table 3 表示了，不同版本（尺寸）的二维码，对于，数字，字符，字节和Kanji模式下，对于单个编码的2进制的位数。（在二维码的规格说明书中，有各种各样的编码规范表，后面还会提到） 下面我们看几个示例， 示例一：数字编码在Version 1的尺寸下，纠错级别为H的情况下，编码： 01234567 1. 把上述数字分成三组: 012 345 67 2. 把他们转成二进制: 012 转成 0000001100； 345 转成 0101011001； 67 转成 1000011。 3. 把这三个二进制串起来: 0000001100 0101011001 1000011 4. 把数字的个数转成二进制 (version 1-H是10 bits ):8个数字的二进制是 0000001000 5. 把数字编码的标志0001和第4步的编码加到前面: 0001 0000001000 0000001100 0101011001 1000011 示例二：字符编码在Version 1的尺寸下，纠错级别为H的情况下，编码: AC-42 1. 从字符索引表中找到 AC-42 这五个字条的索引 (10,12,41,4,2) 2. 两两分组: (10,12) (41,4) (2) 3.把每一组转成11bits的二进制: (10,12) 1045+12 等于 462 转成 00111001110(41,4) 4145+4 等于 1849 转成 11100111001(2) 等于 2 转成 000010 4. 把这些二进制连接起来：00111001110 11100111001 000010 5. 把字符的个数转成二进制 (Version 1-H为9 bits ):5个字符，5转成 000000101 6. 在头上加上编码标识 0010 和第5步的个数编码: 0010 000000101 00111001110 11100111001 000010 结束符和补齐符假如我们有个HELLO WORLD的字符串要编码，根据上面的示例二，我们可以得到下面的编码， 编码字符数HELLO WORLD的编码001000000101101100001011 01111000110 10001011100 10110111000 10011010100 001101 我们还要加上结束符： 编码字符数HELLO WORLD的编码结束001000000101101100001011 01111000110 10001011100 10110111000 10011010100 0011010000 按8bits重排如果所有的编码加起来不是8个倍数我们还要在后面加上足够的0，比如上面一共有78个bits，所以，我们还要加上2个0，然后按8个bits分好组： 00100000 01011011 00001011 01111000 11010001 01110010 11011100 01001101 01000011 01000000 补齐码（Padding Bytes）最后，如果如果还没有达到我们最大的bits数的限制，我们还要加一些补齐码（Padding Bytes），Padding Bytes就是重复下面的两个bytes：11101100 00010001 （这两个二进制转成十进制是236和17，我也不知道为什么，只知道Spec上是这么写的）关于每一个Version的每一种纠错级别的最大Bits限制，可以参看QR Code Spec的第28页到32页的Table-7一表。 假设我们需要编码的是Version 1的Q纠错级，那么，其最大需要104个bits，而我们上面只有80个bits，所以，还需要补24个bits，也就是需要3个Padding Bytes，我们就添加三个，于是得到下面的编码： 00100000 01011011 00001011 01111000 11010001 01110010 11011100 01001101 01000011 0100000011101100 00010001 11101100 上面的编码就是数据码了，叫Data Codewords，每一个8bits叫一个codeword，我们还要对这些数据码加上纠错信息。 纠错码上面我们说到了一些纠错级别，Error Correction Code Level，二维码中有四种级别的纠错，这就是为什么二维码有残缺还能扫出来，也就是为什么有人在二维码的中心位置加入图标。 错误修正容量L水平7%的字码可被修正M水平15%的字码可被修正Q水平25%的字码可被修正H水平30%的字码可被修正 那么，QR是怎么对数据码加上纠错码的？首先，我们需要对数据码进行分组，也就是分成不同的Block，然后对各个Block进行纠错编码，对于如何分组，我们可以查看QR Code Spec的第33页到44页的Table-13到Table-22的定义表。注意最后两列： Number of Error Code Correction Blocks：需要分多少个块。 Error Correction Code Per Blocks：每一个块中的code个数，所谓的code的个数，也就是有多少个8bits的字节。 举个例子：上述的Version 5 + Q纠错级：需要4个Blocks（2个Blocks为一组，共两组），头一组的两个Blocks中各15个bits数据 + 各 9个bits的纠错码（注：表中的codewords就是一个8bits的byte）（再注：最后一例中的（c, k, r ）的公式为：c = k + 2 * r，因为后脚注解释了：纠错码的容量小于纠错码的一半） 下图给一个5-Q的示例（因为二进制写起来会让表格太大，所以，我都用了十进制，我们可以看到每一块的纠错码有18个codewords，也就是18个8bits的二进制数） 组块数据对每个块的纠错码1167 85 70 134 87 38 85 194 119 50 6 18 6 103 38213 199 11 45 115 247 241 223 229 248 154 117 154 111 86 161 111 392246 246 66 7 118 134 242 7 38 86 22 198 199 146 687 204 96 60 202 182 124 157 200 134 27 129 209 17 163 163 120 13321182 230 247 119 50 7 118 134 87 38 82 6 134 151 50 7148 116 177 212 76 133 75 242 238 76 195 230 189 10 108 240 192 141270 247 118 86 194 6 151 50 16 236 17 236 17 236 17 236235 159 5 173 24 147 59 33 106 40 255 172 82 2 131 32 178 236 注：二维码的纠错码主要是通过Reed-Solomon error correction（里德-所罗门纠错算法）来实现的。对于这个算法，对于我来说是相当的复杂，里面有很多的数学计算，比如：多项式除法，把1-255的数映射成2的n次方（0&lt;=n&lt;=255）的伽罗瓦域Galois Field之类的神一样的东西，以及基于这些基础的纠错数学公式，因为我的数据基础差，对于我来说太过复杂，所以我一时半会儿还有点没搞明白，还在学习中，所以，我在这里就不展开说这些东西了。还请大家见谅了。（当然，如果有朋友很明白，也繁请教教我） 最终编码穿插放置如果你以为我们可以开始画图，你就错了。二维码的混乱技术还没有玩完，它还要把数据码和纠错码的各个codewords交替放在一起。如何交替呢，规则如下： 对于数据码：把每个块的第一个codewords先拿出来按顺度排列好，然后再取第一块的第二个，如此类推。如：上述示例中的Data Codewords如下： 块 167857013487388519411950618610338&nbsp;块 224624666711813424273886221981991466&nbsp;块 31822302471195071181348738826134151507块 4702471188619461515016236172361723617236 我们先取第一列的：67， 246， 182， 70 然后再取第二列的：67， 246， 182， 70， 85，246，230 ，247 如此类推：67， 246， 182， 70， 85，246，230 ，247 ……… ……… ，38，6，50，17，7，236 对于纠错码，也是一样： 块 121319911451152472412232292481541171541118616111139块 28720496602021821241572001342712920917163163120133块 314811617721276133752422387619523018910108240192141块 423515951732414759331064025517282213132178236 和数据码取的一样，得到：213，87，148，235，199，204，116，159，…… ……39，133，141，236 然后，再把这两组放在一起（纠错码放在数据码之后）得到： 67, 246, 182, 70, 85, 246, 230, 247, 70, 66, 247, 118, 134, 7, 119, 86, 87, 118, 50, 194, 38, 134, 7, 6, 85, 242, 118, 151, 194, 7, 134, 50, 119, 38, 87, 16, 50, 86, 38, 236, 6, 22, 82, 17, 18, 198, 6, 236, 6, 199, 134, 17, 103, 146, 151, 236, 38, 6, 50, 17, 7, 236, 213, 87, 148, 235, 199, 204, 116, 159, 11, 96, 177, 5, 45, 60, 212, 173, 115, 202, 76, 24, 247, 182, 133, 147, 241, 124, 75, 59, 223, 157, 242, 33, 229, 200, 238, 106, 248, 134, 76, 40, 154, 27, 195, 255, 117, 129, 230, 172, 154, 209, 189, 82, 111, 17, 10, 2, 86, 163, 108, 131, 161, 163, 240, 32, 111, 120, 192, 178, 39, 133, 141, 236 这就是我们的数据区。 Remainder Bits最后再加上ReminderBits，对于某些Version的QR，上面的还不够长度，还要加上Remainder Bits，比如：上述的5Q版的二维码，还要加上7个bits，Remainder Bits加零就好了。关于哪些Version需要多少个Remainder bit，可以参看QR Code Spec的第15页的Table-1的定义表。 画二维码图Position Detection Pattern首先，先把Position Detection图案画在三个角上。（无论Version如何，这个图案的尺寸就是这么大） Alignment Pattern然后，再把Alignment图案画上（无论Version如何，这个图案的尺寸就是这么大） 关于Alignment的位置，可以查看QR Code Spec的第81页的Table-E.1的定义表（下表是不完全表格） 下图是根据上述表格中的Version8的一个例子（6，24，42） Timing Pattern接下来是Timing Pattern的线（这个不用多说了） Format Information再接下来是Formation Information，下图中的蓝色部分。 Format Information是一个15个bits的信息，每一个bit的位置如下图所示：（注意图中的Dark Module，那是永远出现的） 这15个bits中包括： 5个数据bits：其中，2个bits用于表示使用什么样的Error Correction Level， 3个bits表示使用什么样的Mask 10个纠错bits。主要通过BCH Code来计算 然后15个bits还要与101010000010010做XOR操作。这样就保证不会因为我们选用了00的纠错级别和000的Mask，从而造成全部为白色，这会增加我们的扫描器的图像识别的困难。 下面是一个示例： 关于Error Correction Level如下表所示： 关于Mask图案如后面的Table 23所示。 Version Information再接下来是Version Information（版本7以后需要这个编码），下图中的蓝色部分。 Version Information一共是18个bits，其中包括6个bits的版本号以及12个bits的纠错码，下面是一个示例： 而其填充位置如下： 数据和数据纠错码然后是填接我们的最终编码，最终编码的填充方式如下：从左下角开始沿着红线填我们的各个bits，1是黑色，0是白色。如果遇到了上面的非数据区，则绕开或跳过。 掩码图案这样下来，我们的图就填好了，但是，也许那些点并不均衡，如果出现大面积的空白或黑块，会告诉我们扫描识别的困难。所以，我们还要做Masking操作（靠，还嫌不复杂）QR的Spec中说了，QR有8个Mask你可以使用，如下所示：其中，各个mask的公式在各个图下面。所谓mask，说白了，就是和上面生成的图做XOR操作。Mask只会和数据区进行XOR，不会影响功能区。（注：选择一个合适的Mask也是有算法的） 其Mask的标识码如下所示：（其中的i,j分别对应于上图的x,y） 下面是Mask后的一些样子，我们可以看到被某些Mask XOR了的数据变得比较零散了。 Mask过后的二维码就成最终的图了。&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>数据库知识</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计原则-迪米特法则]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91java-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99-e8-bf-aa-e7-b1-b3-e7-89-b9-e6-b3-95-e5-88-99.html</url>
    <content type="text"><![CDATA[定义：一个对象应该对其他对象保持最少的了解。 问题由来：类与类之间的关系越密切，耦合度越大，当一个类发生改变时，对另一个类的影响也越大。 解决方案：尽量降低类与类之间的耦合。 自从我们接触编程开始，就知道了软件编程的总的原则：低耦合，高内聚。无论是面向过程编程还是面向对象编程，只有使各个模块之间的耦合尽量的低，才能提高代码的复用率。低耦合的优点不言而喻，但是怎么样编程才能做到低耦合呢？那正是迪米特法则要去完成的。 迪米特法则又叫最少知道原则，最早是在1987年由美国Northeastern University的Ian Holland提出。通俗的来讲，就是一个类对自己依赖的类知道的越少越好。也就是说，对于被依赖的类来说，无论逻辑多么复杂，都尽量地的将逻辑封装在类的内部，对外除了提供的public方法，不对外泄漏任何信息。迪米特法则还有一个更简单的定义：只与直接的朋友通信。首先来解释一下什么是直接的朋友：每个对象都会与其他对象有耦合关系，只要两个对象之间有耦合关系，我们就说这两个对象之间是朋友关系。耦合的方式很多，依赖、关联、组合、聚合等。其中，我们称出现成员变量、方法参数、方法返回值中的类为直接的朋友，而出现在局部变量中的类则不是直接的朋友。也就是说，陌生的类最好不要作为局部变量的形式出现在类的内部。 举一个例子：有一个集团公司，下属单位有分公司和直属部门，现在要求打印出所有下属单位的员工ID。先来看一下违反迪米特法则的设计。 //总公司员工 class Employee{ private String id; public void setId(String id){ this.id = id; } public String getId(){ return id; } } //分公司员工 class SubEmployee{ private String id; public void setId(String id){ this.id = id; } public String getId(){ return id; } } class SubCompanyManager{ public List&lt;SubEmployee&gt; getAllEmployee(){ List&lt;SubEmployee&gt; list = new ArrayList&lt;SubEmployee&gt;(); for(int i=0; i&lt;100; i++){ SubEmployee emp = new SubEmployee(); //为分公司人员按顺序分配一个ID emp.setId(“分公司“+i); list.add(emp); } return list; } } class CompanyManager{ public List&lt;Employee&gt; getAllEmployee(){ List&lt;Employee&gt; list = new ArrayList&lt;Employee&gt;(); for(int i=0; i&lt;30; i++){ Employee emp = new Employee(); //为总公司人员按顺序分配一个ID emp.setId(“总公司“+i); list.add(emp); } return list; } public void printAllEmployee(SubCompanyManager sub){ List&lt;SubEmployee&gt; list1 = sub.getAllEmployee(); for(SubEmployee e:list1){ System.out.println(e.getId()); } List&lt;Employee&gt; list2 = this.getAllEmployee(); for(Employee e:list2){ System.out.println(e.getId()); } } } public class Client{ public static void main(String[] args){ CompanyManager e = new CompanyManager(); e.printAllEmployee(new SubCompanyManager()); } } 现在这个设计的主要问题出在CompanyManager中，根据迪米特法则，只与直接的朋友发生通信，而SubEmployee类并不是CompanyManager类的直接朋友（以局部变量出现的耦合不属于直接朋友），从逻辑上讲总公司只与他的分公司耦合就行了，与分公司的员工并没有任何联系，这样设计显然是增加了不必要的耦合。按照迪米特法则，应该避免类中出现这样非直接朋友关系的耦合。修改后的代码如下: [java] view plain copy class SubCompanyManager{ public List&lt;SubEmployee&gt; getAllEmployee(){ List&lt;SubEmployee&gt; list = new ArrayList&lt;SubEmployee&gt;(); for(int i=0; i&lt;100; i++){ SubEmployee emp = new SubEmployee(); //为分公司人员按顺序分配一个ID emp.setId(“分公司“+i); list.add(emp); } return list; } public void printEmployee(){ List&lt;SubEmployee&gt; list = this.getAllEmployee(); for(SubEmployee e:list){ System.out.println(e.getId()); } } } class CompanyManager{ public List&lt;Employee&gt; getAllEmployee(){ List&lt;Employee&gt; list = new ArrayList&lt;Employee&gt;(); for(int i=0; i&lt;30; i++){ Employee emp = new Employee(); //为总公司人员按顺序分配一个ID emp.setId(“总公司“+i); list.add(emp); } return list; } public void printAllEmployee(SubCompanyManager sub){ sub.printEmployee(); List&lt;Employee&gt; list2 = this.getAllEmployee(); for(Employee e:list2){ System.out.println(e.getId()); } } } 修改后，为分公司增加了打印人员ID的方法，总公司直接调用来打印，从而避免了与分公司的员工发生耦合。 迪米特法则的初衷是降低类之间的耦合，由于每个类都减少了不必要的依赖，因此的确可以降低耦合关系。但是凡事都有度，虽然可以避免与非直接的类通信，但是要通信，必然会通过一个”中介”来发生联系，例如本例中，总公司就是通过分公司这个”中介”来与分公司的员工发生联系的。过分的使用迪米特原则，会产生大量这样的中介和传递类，导致系统复杂度变大。所以在采用迪米特法则时要反复权衡，既做到结构清晰，又要高内聚低耦合。 原文作者：卡奴达摩 原文地址：http://blog.csdn.net/zhengzhb/article/details/7296930]]></content>
      <categories>
        <category>JAVA设计模式</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计原则-接口隔离原则]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91java-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99-e6-8e-a5-e5-8f-a3-e9-9a-94-e7-a6-bb-e5-8e-9f-e5-88-99.html</url>
    <content type="text"><![CDATA[总结一句话：接口的设计尽量单一化 定义：客户端不应该依赖它不需要的接口；一个类对另一个类的依赖应该建立在最小的接口上。 问题由来：类A通过接口I依赖类B，类C通过接口I依赖类D，如果接口I对于类A和类B来说不是最小接口，则类B和类D必须去实现他们不需要的方法。 解决方案：将臃肿的接口I拆分为独立的几个接口，类A和类C分别与他们需要的接口建立依赖关系。也就是采用接口隔离原则。 举例来说明接口隔离原则： （图1 未遵循接口隔离原则的设计） 这个图的意思是：类A依赖接口I中的方法1、方法2、方法3，类B是对类A依赖的实现。类C依赖接口I中的方法1、方法4、方法5，类D是对类C依赖的实现。对于类B和类D来说，虽然他们都存在着用不到的方法（也就是图中红色字体标记的方法），但由于实现了接口I，所以也必须要实现这些用不到的方法。对类图不熟悉的可以参照程序代码来理解，代码如下： [java] view plain copy interface I { public void method1(); public void method2(); public void method3(); public void method4(); public void method5(); } class A{ public void depend1(I i){ i.method1(); } public void depend2(I i){ i.method2(); } public void depend3(I i){ i.method3(); } } class B implements I{ public void method1() { System.out.println(“类B实现接口I的方法1”); } public void method2() { System.out.println(“类B实现接口I的方法2”); } public void method3() { System.out.println(“类B实现接口I的方法3”); } //对于类B来说，method4和method5不是必需的，但是由于接口A中有这两个方法， //所以在实现过程中即使这两个方法的方法体为空，也要将这两个没有作用的方法进行实现。 public void method4() {} public void method5() {} } class C{ public void depend1(I i){ i.method1(); } public void depend2(I i){ i.method4(); } public void depend3(I i){ i.method5(); } } class D implements I{ public void method1() { System.out.println(“类D实现接口I的方法1”); } //对于类D来说，method2和method3不是必需的，但是由于接口A中有这两个方法， //所以在实现过程中即使这两个方法的方法体为空，也要将这两个没有作用的方法进行实现。 public void method2() {} public void method3() {} public void method4() { System.out.println(“类D实现接口I的方法4”); } public void method5() { System.out.println(“类D实现接口I的方法5”); } } public class Client{ public static void main(String[] args){ A a = new A(); a.depend1(new B()); a.depend2(new B()); a.depend3(new B()); C c = new C(); c.depend1(new D()); c.depend2(new D()); c.depend3(new D()); } } 可以看到，如果接口过于臃肿，只要接口中出现的方法，不管对依赖于它的类有没有用处，实现类中都必须去实现这些方法，这显然不是好的设计。如果将这个设计修改为符合接口隔离原则，就必须对接口I进行拆分。在这里我们将原有的接口I拆分为三个接口，拆分后的设计如图2所示： （图2 遵循接口隔离原则的设计） 照例贴出程序的代码，供不熟悉类图的朋友参考： [java] view plain copy interface I1 { public void method1(); } interface I2 { public void method2(); public void method3(); } interface I3 { public void method4(); public void method5(); } class A{ public void depend1(I1 i){ i.method1(); } public void depend2(I2 i){ i.method2(); } public void depend3(I2 i){ i.method3(); } } class B implements I1, I2{ public void method1() { System.out.println(“类B实现接口I1的方法1”); } public void method2() { System.out.println(“类B实现接口I2的方法2”); } public void method3() { System.out.println(“类B实现接口I2的方法3”); } } class C{ public void depend1(I1 i){ i.method1(); } public void depend2(I3 i){ i.method4(); } public void depend3(I3 i){ i.method5(); } } class D implements I1, I3{ public void method1() { System.out.println(“类D实现接口I1的方法1”); } public void method4() { System.out.println(“类D实现接口I3的方法4”); } public void method5() { System.out.println(“类D实现接口I3的方法5”); } } 接口隔离原则的含义是：建立单一接口，不要建立庞大臃肿的接口，尽量细化接口，接口中的方法尽量少。也就是说，我们要为各个类建立专用的接口，而不要试图去建立一个很庞大的接口供所有依赖它的类去调用。本文例子中，将一个庞大的接口变更为3个专用的接口所采用的就是接口隔离原则。在程序设计中，依赖几个专用的接口要比依赖一个综合的接口更灵活。接口是设计时对外部设定的”契约”，通过分散定义多个接口，可以预防外来变更的扩散，提高系统的灵活性和可维护性。 说到这里，很多人会觉的接口隔离原则跟之前的单一职责原则很相似，其实不然。其一，单一职责原则原注重的是职责；而接口隔离原则注重对接口依赖的隔离。其二，单一职责原则主要是约束类，其次才是接口和方法，它针对的是程序中的实现和细节；而接口隔离原则主要约束接口接口，主要针对抽象，针对程序整体框架的构建。 采用接口隔离原则对接口进行约束时，要注意以下几点： 接口尽量小，但是要有限度。对接口进行细化可以提高程序设计灵活性是不挣的事实，但是如果过小，则会造成接口数量过多，使设计复杂化。所以一定要适度。 为依赖接口的类定制服务，只暴露给调用的类它需要的方法，它不需要的方法则隐藏起来。只有专注地为一个模块提供定制服务，才能建立最小的依赖关系。 提高内聚，减少对外交互。使接口用最少的方法去完成最多的事情。 运用接口隔离原则，一定要适度，接口设计的过大或过小都不好。设计接口的时候，只有多花些时间去思考和筹划，才能准确地实践这一原则。 原文作者：卡奴达摩 原文地址：http://blog.csdn.net/zhengzhb/article/details/7296921]]></content>
      <categories>
        <category>JAVA设计模式</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计原则-单一职责原则]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91java-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99-e5-8d-95-e4-b8-80-e8-81-8c-e8-b4-a3-e5-8e-9f-e5-88-99.html</url>
    <content type="text"><![CDATA[定义：不要存在多于一个导致类变更的原因。通俗的说，即一个类只负责一项职责。 问题由来：类T负责两个不同的职责：职责P1，职责P2。当由于职责P1需求发生改变而需要修改类T时，有可能会导致原本运行正常的职责P2功能发生故障。 解决方案：遵循单一职责原则。分别建立两个类T1、T2，使T1完成职责P1功能，T2完成职责P2功能。这样，当修改类T1时，不会使职责P2发生故障风险；同理，当修改T2时，也不会使职责P1发生故障风险。 说到单一职责原则，很多人都会不屑一顾。因为它太简单了。稍有经验的程序员即使从来没有读过设计模式、从来没有听说过单一职责原则，在设计软件时也会自觉的遵守这一重要原则，因为这是常识。在软件编程中，谁也不希望因为修改了一个功能导致其他的功能发生故障。而避免出现这一问题的方法便是遵循单一职责原则。虽然单一职责原则如此简单，并且被认为是常识，但是即便是经验丰富的程序员写出的程序，也会有违背这一原则的代码存在。为什么会出现这种现象呢？因为有职责扩散。所谓职责扩散，就是因为某种原因，职责P被分化为粒度更细的职责P1和P2。 比如：类T只负责一个职责P，这样设计是符合单一职责原则的。后来由于某种原因，也许是需求变更了，也许是程序的设计者境界提高了，需要将职责P细分为粒度更细的职责P1，P2，这时如果要使程序遵循单一职责原则，需要将类T也分解为两个类T1和T2，分别负责P1、P2两个职责。但是在程序已经写好的情况下，这样做简直太费时间了。所以，简单的修改类T，用它来负责两个职责是一个比较不错的选择，虽然这样做有悖于单一职责原则。（这样做的风险在于职责扩散的不确定性，因为我们不会想到这个职责P，在未来可能会扩散为P1，P2，P3，P4……Pn。所以记住，在职责扩散到我们无法控制的程度之前，立刻对代码进行重构。） 举例说明，用一个类描述动物呼吸这个场景： class Animal{ public void breathe(String animal){ System.out.println(animal+“呼吸空气“); } } public class Client{ public static void main(String[] args){ Animal animal = new Animal(); animal.breathe(“牛“); animal.breathe(“羊“); animal.breathe(“猪“); } } 运行结果： 牛呼吸空气羊呼吸空气猪呼吸空气 程序上线后，发现问题了，并不是所有的动物都呼吸空气的，比如鱼就是呼吸水的。修改时如果遵循单一职责原则，需要将Animal类细分为陆生动物类Terrestrial，水生动物Aquatic，代码如下： class Terrestrial{ public void breathe(String animal){ System.out.println(animal+“呼吸空气“); } } class Aquatic{ public void breathe(String animal){ System.out.println(animal+“呼吸水“); } } public class Client{ public static void main(String[] args){ Terrestrial terrestrial = new Terrestrial(); terrestrial.breathe(“牛“); terrestrial.breathe(“羊“); terrestrial.breathe(“猪“); Aquatic aquatic = new Aquatic(); aquatic.breathe(“鱼“); } } 运行结果： 牛呼吸空气羊呼吸空气猪呼吸空气鱼呼吸水 我们会发现如果这样修改花销是很大的，除了将原来的类分解之外，还需要修改客户端。而直接修改类Animal来达成目的虽然违背了单一职责原则，但花销却小的多，代码如下： [java] view plain copy class Animal{ public void breathe(String animal){ if(“鱼“.equals(animal)){ System.out.println(animal+“呼吸水“); }else{ System.out.println(animal+“呼吸空气“); } } } public class Client{ public static void main(String[] args){ Animal animal = new Animal(); animal.breathe(“牛“); animal.breathe(“羊“); animal.breathe(“猪“); animal.breathe(“鱼“); } } 可以看到，这种修改方式要简单的多。但是却存在着隐患：有一天需要将鱼分为呼吸淡水的鱼和呼吸海水的鱼，则又需要修改Animal类的breathe方法，而对原有代码的修改会对调用“猪“”牛“”羊“等相关功能带来风险，也许某一天你会发现程序运行的结果变为“牛呼吸水“了。这种修改方式直接在代码级别上违背了单一职责原则，虽然修改起来最简单，但隐患却是最大的。还有一种修改方式： [java] view plain copy class Animal{ public void breathe(String animal){ System.out.println(animal+“呼吸空气“); } public void breathe2(String animal){ System.out.println(animal+“呼吸水“); } } public class Client{ public static void main(String[] args){ Animal animal = new Animal(); animal.breathe(“牛“); animal.breathe(“羊“); animal.breathe(“猪“); animal.breathe2(“鱼“); } } 可以看到，这种修改方式没有改动原来的方法，而是在类中新加了一个方法，这样虽然也违背了单一职责原则，但在方法级别上却是符合单一职责原则的，因为它并没有动原来方法的代码。这三种方式各有优缺点，那么在实际编程中，采用哪一中呢？其实这真的比较难说，需要根据实际情况来确定。我的原则是：只有逻辑足够简单，才可以在代码级别上违反单一职责原则；只有类中方法数量足够少，才可以在方法级别上违反单一职责原则； 例如本文所举的这个例子，它太简单了，它只有一个方法，所以，无论是在代码级别上违反单一职责原则，还是在方法级别上违反，都不会造成太大的影响。实际应用中的类都要复杂的多，一旦发生职责扩散而需要修改类时，除非这个类本身非常简单，否则还是遵循单一职责原则的好。 遵循单一职责原的优点有： 可以降低类的复杂度，一个类只负责一项职责，其逻辑肯定要比负责多项职责简单的多； 提高类的可读性，提高系统的可维护性； 变更引起的风险降低，变更是必然的，如果单一职责原则遵守的好，当修改一个功能时，可以显著降低对其他功能的影响。 需要说明的一点是单一职责原则不只是面向对象编程思想所特有的，只要是模块化的程序设计，都适用单一职责原则。 &nbsp; 原文作者：卡奴达摩 原文地址：http://blog.csdn.net/zhengzhb/article/details/7278174]]></content>
      <categories>
        <category>JAVA设计模式</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计原则-里氏替换原则]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91java-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99-e9-87-8c-e6-b0-8f-e6-9b-bf-e6-8d-a2-e5-8e-9f-e5-88-99.html</url>
    <content type="text"><![CDATA[一句话总结：子类可以扩展父类的功能，但不能改变父类原有的功能 原文作者:卡奴达摩 原文链接:http://blog.csdn.net/zhengzhb/article/details/7281833 肯定有不少人跟我刚看到这项原则的时候一样，对这个原则的名字充满疑惑。其实原因就是这项原则最早是在1988年，由麻省理工学院的一位姓里的女士（Barbara Liskov）提出来的。 定义1：如果对每一个类型为 T1的对象 o1，都有类型为 T2 的对象o2，使得以 T1定义的所有程序 P 在所有的对象 o1 都代换成 o2 时，程序 P 的行为没有发生变化，那么类型 T2 是类型 T1 的子类型。 定义2：所有引用基类的地方必须能透明地使用其子类的对象。 问题由来：有一功能P1，由类A完成。现需要将功能P1进行扩展，扩展后的功能为P，其中P由原有功能P1与新功能P2组成。新功能P由类A的子类B来完成，则子类B在完成新功能P2的同时，有可能会导致原有功能P1发生故障。 解决方案：当使用继承时，遵循里氏替换原则。类B继承类A时，除添加新的方法完成新增功能P2外，尽量不要重写父类A的方法，也尽量不要重载父类A的方法。 继承包含这样一层含义：父类中凡是已经实现好的方法（相对于抽象方法而言），实际上是在设定一系列的规范和契约，虽然它不强制要求所有的子类必须遵从这些契约，但是如果子类对这些非抽象方法任意修改，就会对整个继承体系造成破坏。而里氏替换原则就是表达了这一层含义。 继承作为面向对象三大特性之一，在给程序设计带来巨大便利的同时，也带来了弊端。比如使用继承会给程序带来侵入性，程序的可移植性降低，增加了对象间的耦合性，如果一个类被其他的类所继承，则当这个类需要修改时，必须考虑到所有的子类，并且父类修改后，所有涉及到子类的功能都有可能会产生故障。 举例说明继承的风险，我们需要完成一个两数相减的功能，由类A来负责。 class A{ public int func1(int a, int b){ return a-b; } } public class Client{ public static void main(String[] args){ A a = new A(); System.out.println(“100-50=”+a.func1(100, 50)); System.out.println(“100-80=”+a.func1(100, 80)); } } 运行结果： 100-50=50100-80=20 后来，我们需要增加一个新的功能：完成两数相加，然后再与100求和，由类B来负责。即类B需要完成两个功能：两数相减。两数相加，然后再加100。 由于类A已经实现了第一个功能，所以类B继承类A后，只需要再完成第二个功能就可以了，代码如下： class B extends A{ public int func1(int a, int b){ return a+b; } public int func2(int a, int b){ return func1(a,b)+100; } } public class Client{ public static void main(String[] args){ B b = new B(); System.out.println(“100-50=”+b.func1(100, 50)); System.out.println(“100-80=”+b.func1(100, 80)); System.out.println(“100+20+100=”+b.func2(100, 20)); } } 类B完成后，运行结果： 100-50=150100-80=180100+20+100=220 我们发现原本运行正常的相减功能发生了错误。原因就是类B在给方法起名时无意中重写了父类的方法，造成所有运行相减功能的代码全部调用了类B重写后的方法，造成原本运行正常的功能出现了错误。在本例中，引用基类A完成的功能，换成子类B之后，发生了异常。在实际编程中，我们常常会通过重写父类的方法来完成新的功能，这样写起来虽然简单，但是整个继承体系的可复用性会比较差，特别是运用多态比较频繁时，程序运行出错的几率非常大。如果非要重写父类的方法，比较通用的做法是：原来的父类和子类都继承一个更通俗的基类，原有的继承关系去掉，采用依赖、聚合，组合等关系代替。 里氏替换原则通俗的来讲就是：子类可以扩展父类的功能，但不能改变父类原有的功能。它包含以下4层含义： 子类可以实现父类的抽象方法，但不能覆盖父类的非抽象方法。 子类中可以增加自己特有的方法。 当子类的方法重载父类的方法时，方法的前置条件（即方法的形参）要比父类方法的输入参数更宽松。 当子类的方法实现父类的抽象方法时，方法的后置条件（即方法的返回值）要比父类更严格。 看上去很不可思议，因为我们会发现在自己编程中常常会违反里氏替换原则，程序照样跑的好好的。所以大家都会产生这样的疑问，假如我非要不遵循里氏替换原则会有什么后果？ 后果就是：你写的代码出问题的几率将会大大增加。]]></content>
      <categories>
        <category>JAVA设计模式</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】Java设计原则-依赖倒置原则（面向接口编程）]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91java-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99-e4-be-9d-e8-b5-96-e5-80-92-e7-bd-ae-e5-8e-9f-e5-88-99-ef-bc-88-e9-9d-a2-e5-90-91-e6-8e-a5-e5-8f-a3-2.html</url>
    <content type="text"><![CDATA[原文作者：卡奴达摩 原文地址：http://blog.csdn.net/zhengzhb/article/details/7289269 定义：高层模块不应该依赖低层模块，二者都应该依赖其抽象；抽象不应该依赖细节；细节应该依赖抽象。 问题由来：类A直接依赖类B，假如要将类A改为依赖类C，则必须通过修改类A的代码来达成。这种场景下，类A一般是高层模块，负责复杂的业务逻辑；类B和类C是低层模块，负责基本的原子操作；假如修改类A，会给程序带来不必要的风险。 解决方案：将类A修改为依赖接口I，类B和类C各自实现接口I，类A通过接口I间接与类B或者类C发生联系，则会大大降低修改类A的几率。 依赖倒置原则基于这样一个事实：相对于细节的多变性，抽象的东西要稳定的多。以抽象为基础搭建起来的架构比以细节为基础搭建起来的架构要稳定的多。在java中，抽象指的是接口或者抽象类，细节就是具体的实现类，使用接口或者抽象类的目的是制定好规范和契约，而不去涉及任何具体的操作，把展现细节的任务交给他们的实现类去完成。 依赖倒置原则的核心思想是面向接口编程，我们依旧用一个例子来说明面向接口编程比相对于面向实现编程好在什么地方。场景是这样的，母亲给孩子讲故事，只要给她一本书，她就可以照着书给孩子讲故事了。代码如下： class Book{ public String getContent(){ return “很久很久以前有一个阿拉伯的故事……”; } } class Mother{ public void narrate(Book book){ System.out.println(“妈妈开始讲故事“); System.out.println(book.getContent()); } } public class Client{ public static void main(String[] args){ Mother mother = new Mother(); mother.narrate(new Book()); } } 运行结果： 妈妈开始讲故事 很久很久以前有一个阿拉伯的故事…… 运行良好，假如有一天，需求变成这样：不是给书而是给一份报纸，让这位母亲讲一下报纸上的故事，报纸的代码如下： [java] view plain copy class Newspaper{ public String getContent(){ return “林书豪38+7领导尼克斯击败湖人……”; } } 这位母亲却办不到，因为她居然不会读报纸上的故事，这太荒唐了，只是将书换成报纸，居然必须要修改Mother才能读。假如以后需求换成杂志呢？换成网页呢？还要不断地修改Mother，这显然不是好的设计。原因就是Mother与Book之间的耦合性太高了，必须降低他们之间的耦合度才行。 我们引入一个抽象的接口IReader。读物，只要是带字的都属于读物： interface IReader{ public String getContent(); } Mother类与接口IReader发生依赖关系，而Book和Newspaper都属于读物的范畴，他们各自都去实现IReader接口，这样就符合依赖倒置原则了，代码修改为： class Newspaper implements IReader { public String getContent(){ return “林书豪17+9助尼克斯击败老鹰……”; } } class Book implements IReader{ public String getContent(){ return “很久很久以前有一个阿拉伯的故事……”; } } class Mother{ public void narrate(IReader reader){ System.out.println(“妈妈开始讲故事“); System.out.println(reader.getContent()); } } public class Client{ public static void main(String[] args){ Mother mother = new Mother(); mother.narrate(new Book()); mother.narrate(new Newspaper()); } } 运行结果： 妈妈开始讲故事很久很久以前有一个阿拉伯的故事……妈妈开始讲故事林书豪17+9助尼克斯击败老鹰…… 这样修改后，无论以后怎样扩展Client类，都不需要再修改Mother类了。这只是一个简单的例子，实际情况中，代表高层模块的Mother类将负责完成主要的业务逻辑，一旦需要对它进行修改，引入错误的风险极大。所以遵循依赖倒置原则可以降低类之间的耦合性，提高系统的稳定性，降低修改程序造成的风险。 采用依赖倒置原则给多人并行开发带来了极大的便利，比如上例中，原本Mother类与Book类直接耦合时，Mother类必须等Book类编码完成后才可以进行编码，因为Mother类依赖于Book类。修改后的程序则可以同时开工，互不影响，因为Mother与Book类一点关系也没有。参与协作开发的人越多、项目越庞大，采用依赖导致原则的意义就越重大。现在很流行的TDD开发模式就是依赖倒置原则最成功的应用。 传递依赖关系有三种方式，以上的例子中使用的方法是接口传递，另外还有两种传递方式：构造方法传递和setter方法传递，相信用过Spring框架的，对依赖的传递方式一定不会陌生。在实际编程中，我们一般需要做到如下3点： 低层模块尽量都要有抽象类或接口，或者两者都有。 变量的声明类型尽量是抽象类或接口。 使用继承时遵循里氏替换原则。 依赖倒置原则的核心就是要我们面向接口编程，理解了面向接口编程，也就理解了依赖倒置。]]></content>
      <categories>
        <category>JAVA设计模式</category>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】Mongodb常用查询命令总结]]></title>
    <url>%2Faaf5ef736546f8609aab82ef94134980.html</url>
    <content type="text"><![CDATA[设计的集合的结构如下,下面将结合此集合结构和关系型数据库Oracle，总结Mongodb常用的查询命令1.查询所有表中所有数据&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;span style=&quot;color: rgb(0, 128, 128);&quot;&gt;Mongodb&lt;/span&gt;查询： &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;;&lt;/span&gt;Oracle 查询： db.lognLogBean.find();2.查询指定的列&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Oracle &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; l&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;userName &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; lognLogBean l&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询： &lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;({},{&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;userId&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;color: rgb(25, 95, 145);&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;userName&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;color: rgb(25, 95, 145);&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;});&lt;/span&gt;备注：find中含有两个对象{}，第一个对象表示查询条件，第二个对象表示显示过滤条件3.查询指定的条目数，如查询100到300之前的数据&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;span style=&quot;color: rgb(0, 128, 128);&quot;&gt;Oracle &lt;/span&gt;查询：&lt;/span&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; t&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.*,&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; ROWNUM num &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; lognLogBean t &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; num &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;color: rgb(25, 95, 145);&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; num &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;color: rgb(25, 95, 145);&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;color: rgb(25, 95, 145);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：db.lognLogBean.find().limit(200,100);&lt;/span&gt; &lt;/span&gt;备注：limit中两个参数，第一个表示查询的条目数，第二个表示从哪一条开始查询4.等于与不等于查询,1.查询用户ID为25002325的数据，2.查询用户ID不为25002325的数据&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; userId = &#39;25002325&#39;;&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;({&#39;userId&#39;:&#39;25002325&#39;})&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px; line-height: 14.615385055541992px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;code class=&quot;language-sql&quot; style=&quot;font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word;&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; userId != &#39;25002325&#39;;&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;lognLogBean &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; userId &amp;lt;&amp;gt; &#39;25002325&#39;;&lt;/span&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;({&#39;userId&#39;:{&#39;$ne&#39;:&#39;25002325&#39;}})&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;;&lt;/span&gt;5.含有and或者or的复合查询&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;select lognLogBean where userId = ‘25002325’ and unitId = ‘702DSGXT’;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;&lt;font color=&quot;#000000&quot;&gt;userId&lt;/font&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;25002325&#39;,&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&#39;&lt;font color=&quot;#000000&quot;&gt;unitId&lt;/font&gt;&#39;:&#39;&lt;font color=&quot;#dd1144&quot;&gt;702DGSXT&lt;/font&gt;&#39;});&lt;/span&gt;&amp;nbsp;`Oracle 查询：select lognLogBean where userId = ‘25002325’ or and unitId = ‘702DSGXT’;&lt;/div&gt;&lt;div class=&quot;L4&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find(‘$or’[{‘userId‘:‘25002325’},{‘unitId‘:’702DGSXT‘}]);&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;6.含有大于等于小于的范围查询，($lt, $lte, $gt, $gte)如 1.查询jobLevel大于2小于4的用户信息, 2.查询&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5;&quot;&gt;jobLevel大于等于2小于等于4的用户信息&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询：select lognLogBean where jobLevel&nbsp;&gt;&nbsp;2 and jobLevel&nbsp;&lt;&nbsp;4;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘jobLevel‘:{‘$gt’:’2’,’$lt’:’4’}});&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询：select lognLogBean where jobLevel&nbsp;&gt;=&nbsp;2 and jobLevel&nbsp;&lt; =4;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘jobLevel‘:{‘$gte’:’2’,’$lte’:’4’}});&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;&lt;/code&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;7.查询null或者&#39;&#39;,查询remark为空的用户&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select from lognLogBean where remark is null;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find(‘$or’[{‘remark’:null},{‘remark’:‘’}]);&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;8.查询字段是否存在$exists，查询字段的类型$type &lt;/div&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘remark’:{$exists:true}}); //存在&lt;span style=&quot;color: rgb(221, 17, 68);&quot;&gt;remark就返回&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘remark’:{$type:2}}); //如果remark是字符串就返回&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;数据类型 Double &nbsp;String &nbsp;Object &nbsp;Array &nbsp;&nbsp;Binary data &nbsp;Object id &nbsp;Boolean &nbsp;Date &nbsp;Null &nbsp;Regular expression &nbsp;JavaScript code &nbsp;Symbol &nbsp;JavaScript code with scope &nbsp;32-bit integer &nbsp;Timestamp &nbsp;64-bit integer &nbsp;Min key &nbsp;Max key类型值 &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp; 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp; &nbsp; &nbsp; &nbsp;10 &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;13 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255 &nbsp; &nbsp; &nbsp; &nbsp;127&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5;&quot;&gt;9.模糊查询，1.查询用户名以‘王‘开始的用户，2.查询用户名中不以&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5;&quot;&gt;‘王‘开始的用户，3,查询用户名中含有‘管理员’的用户，&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5; background-color: rgb(247, 247, 249);&quot;&gt;4,查询&lt;/span&gt;&lt;span style=&quot;background-color: rgb(247, 247, 249); font-size: small;&quot;&gt;unitId&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5; background-color: rgb(247, 247, 249);&quot;&gt;中含有‘&lt;/span&gt;&lt;span style=&quot;background-color: rgb(247, 247, 249); color: rgb(147, 161, 161); font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; font-size: 13.076923370361328px; line-height: 17.992788314819336px; white-space: pre;&quot;&gt;SXT&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5; background-color: rgb(247, 247, 249);&quot;&gt;’的用户，部分匹&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5; background-color: rgb(247, 247, 249);&quot;&gt;配&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;1.&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Arial; font-size: 13.84615421295166px; line-height: 16.153846740722656px; white-space: normal;&quot;&gt;查询用户名以‘王‘开始的用户&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select from lognLogBean where userName like ‘王%’&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;db.lognLogBean.find({&quot;&lt;span style=&quot;color: rgb(221, 17, 68);&quot;&gt;userName&lt;/span&gt;&quot;:/^王/});&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt; &lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Arial; font-size: 13.84615421295166px; line-height: 16.153846740722656px; white-space: normal;&quot;&gt;2.查询用户名中不以&lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Arial; font-size: 10.5pt; line-height: 1.5; white-space: normal;&quot;&gt;‘王‘开始的用户&lt;/span&gt; &lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: &lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; lognLogBean &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; userName not like &lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;王%&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;db.lognLogBean.find({&quot;userName&quot;:{&quot;$not&quot;:/^王/}},{&quot;userName&quot;:1});&lt;/font&gt; &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&lt;font color=&quot;#000000&quot;&gt; &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;span style=&quot;font-family: Arial; font-size: 13.84615421295166px; line-height: 16.153846740722656px; white-space: normal;&quot;&gt;3,查询用户名中含有‘管理员’的用户&lt;/span&gt; &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询：&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; lognLogBean &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;color: rgb(30, 52, 123);&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt; userName not like &lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;%管理员%&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘userName’:{‘$regex’:‘管理员’}})&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘userName’:/管理员/})&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;white-space: normal; line-height: 16.153846740722656px; font-size: 13.84615421295166px; font-family: Arial; color: rgb(0, 0, 0);&quot;&gt;4,查询&lt;span style=&quot;font-size: small;&quot;&gt;unitId&lt;/span&gt;中含有‘&lt;span style=&quot;color: rgb(147, 161, 161); font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; font-size: 13.076923370361328px; line-height: 17.992788314819336px; white-space: pre;&quot;&gt;SXT&lt;/span&gt;’的用户，部分匹配&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;查询：&lt;/span&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;&#39;&lt;span style=&quot;font-family: Arial; font-size: small; line-height: 16.153846740722656px; white-space: normal;&quot;&gt;unitId&lt;/span&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;:&lt;/span&gt;/&lt;font color=&quot;#93a1a1&quot;&gt;&lt;span style=&quot;line-height: 17.980770111083984px;&quot;&gt;sxt&lt;/span&gt;&lt;/font&gt;/i&lt;span class=&quot;pun&quot; style=&quot;color: rgb(0, 0, 0); font-size: 13.076923370361328px; line-height: 17.992788314819336px;&quot;&gt;}) //后面的/i表示不区分大小写&lt;/span&gt;&lt;font color=&quot;#000000&quot; face=&quot;Arial&quot; size=&quot;2&quot;&gt;&lt;span style=&quot;line-height: 16.153846740722656px; white-space: normal;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;10.使用唯一distinct&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select distinct(userName) from lognLogBean where userName like ‘王%’&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.distinct(‘userName’);&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;11.常用函数count,mod 例子：1查找用户名中为&#39;杨波&#39;的总条目数，2.查出登录月份为偶数的用户&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select count(userName) from lognLogBean where userName =‘杨波‘&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;db.lognLogBean.count({&#39;userName&#39;:&#39;杨波&#39;});&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt; &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;margin-top: 0px; margin-bottom: 0px; padding-left: 0px; line-height: 14.615385055541992px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select from lognLogBean where mod(month,2)=0;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;db.lognLogBean.find({&#39;&lt;span style=&quot;color: rgb(190, 190, 197);&quot;&gt;month&lt;/span&gt;&#39;:{$mod:[2,0]}}); //待验证？ &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;Mongodb查询：db.lognLogBean.find(&#39;this.&lt;span style=&quot;color: rgb(190, 190, 197);&quot;&gt;month%2==0&#39;&lt;/span&gt;); &lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;12.使用in,not in 进行查询 &amp;nbsp;1.查询用户名中含有‘杨波’或者‘李燕’的用户，2.查询用户名中不含有‘杨波’或者&#39;李燕&#39;的用户&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select from lognLogBean where userName in (‘杨波’,‘李燕’);&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘userName’:{‘$in’:[‘杨波’,‘李燕’]}});&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;14.元操作符$not取反，如&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5;&quot;&gt;查询&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; line-height: 1.5;&quot;&gt;用户名中不含有‘杨波’&lt;/span&gt; &lt;/div&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Oracle 查询: select * from lognLogBean where userName != ‘杨波’;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘userName’:{$not:{‘$eq’:‘杨波’}}});&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询：db.lognLogBean.find({‘userName’:{‘$ne’:‘杨波’}});&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;15.数组查询 Mongodb特有&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;为了进行下面的实验：数据中remark中的数据如下&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#48484c&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02a999e52a7a0287e930d&quot;), &quot;remark&quot; : [ 2, 4, 8, 9 ] } { &quot;_id&quot; : ObjectId(&quot;54d02aa19e52a7a0287e930e&quot;), &quot;remark&quot; : [ 6, 1, 2, 3 ] } &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#48484c&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02aab9e52a7a0287e930f&quot;), &quot;remark&quot; : [ 4, 1, 0 ] }&lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;{ “_id” : ObjectId(“54ce3aed9e1e4c69aa9a744c”), “remark” : [ “test1”, “test2” ] }{ “_id” : ObjectId(“54ce3bb49e1e4c69aa9a744d”), “remark” : [ “test1”, “test4” ] }{ “_id” : ObjectId(“54cf148284b1157a30998c8d”), “remark” : [ “test1”, “test2”, “test3”, “test4” ] }{ “_id” : ObjectId(“54cf14a084b1157a30998c8e”), “remark” : [ “test5”, “test2”, “test3”, “test1” ] }&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;//查询remark字段中含有test1的用户，部分匹配即可查出,注意此处与顺序无关，只要字段数组中含有含有’test1’就会被检索出来&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;db.lognLogBean.find({‘remark’:‘test1’}); &lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询结果：&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;color: rgb(72, 72, 76);&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54ce3aed9e1e4c69aa9a744c&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test2&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54ce3bb49e1e4c69aa9a744d&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test4&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54cf148284b1157a30998c8d&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test4&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54cf14a084b1157a30998c8e&quot;), &quot;remark&quot; : [ &quot;test5&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test1&quot; ] }&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;//查询remark字段中含有test1和test2的用户，需要完全匹配时用$all关键字，此处依然显示了顺序无关性，只要数组中同时含有’test1’,’test2’就会被检索出来&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;db.lognLogBean.find({‘remark‘:{‘$all’:[‘test1’,’test2’]}});&nbsp;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询结果： &lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54ce3aed9e1e4c69aa9a744c&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test2&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54cf148284b1157a30998c8d&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test4&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54cf14a084b1157a30998c8e&quot;), &quot;remark&quot; : [ &quot;test5&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test1&quot; ] }&lt;/font&gt; &lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;//查询remark字段中数组个数为2的用户，此时需要用到$size关键字,注意$size不能和大于($gt)小于($lt)一起用&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;db.lognLogBean.find({‘remark‘:{‘$size’:2}});&nbsp;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;Mongodb查询结果：&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54ce3aed9e1e4c69aa9a744c&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test2&quot; ] } { &quot;_id&quot; : ObjectId(&quot;54ce3bb49e1e4c69aa9a744d&quot;), &quot;remark&quot; : [ &quot;test1&quot;, &quot;test4&quot; ] }&lt;/font&gt; &lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;//运用字段中数组下标进行查询，如：查询remark字段中第二个地算为&#39;test4&#39;的用户，语句如下&lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(72, 72, 76);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;remark.1&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(221, 17, 68);&quot;&gt;&#39;test4&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}); &lt;/span&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;//通过slice获取数组中的部分数据&lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;({},{&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&#39;remark&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;:&lt;font color=&quot;#dd1144&quot;&gt;{$slice:2}&lt;/font&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;}); //显示remark数组中前两个，考虑null与&quot;&quot;的情况&lt;/span&gt;&lt;font color=&quot;#93a1a1&quot;&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({},{&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;remark&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;font color=&quot;#dd1144&quot;&gt;{$slice:-2}&lt;/font&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}); //显示&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;remark数组中后两个，&lt;/span&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;考虑null与&quot;&quot;的情况&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({},{&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;remark&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;font color=&quot;#dd1144&quot;&gt;{$slice:[1,2]}&lt;/font&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}); //参数的含义 &lt;/span&gt;&lt;/span&gt;&lt;font color=&quot;#93a1a1&quot;&gt;[skip, limit] ，从哪开始截取，截取的个数&lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;//&lt;/font&gt;&lt;span style=&quot;background-color: rgb(245, 246, 247); color: rgb(34, 34, 34); line-height: 24px;&quot;&gt;$elemMatch查询出,只有数组的元素至少有一个满足匹配的条件即被检索出来&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span style=&quot;background-color: rgb(245, 246, 247); line-height: 24px;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;lognLogBean&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;({&#39;&lt;span style=&quot;color: rgb(221, 17, 68);&quot;&gt;remark&lt;/span&gt;&#39;:{&#39;&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;color: rgb(34, 34, 34); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;$&lt;span style=&quot;line-height: 23.990385055541992px; background-color: rgb(245, 246, 247);&quot;&gt;elemMatch&#39;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161); line-height: 17.992788314819336px; background-color: rgb(247, 247, 249);&quot;&gt;&lt;font color=&quot;#222222&quot;&gt;:{&lt;/font&gt;&lt;span class=&quot;nx&quot; style=&quot;color: rgb(34, 34, 34); line-height: 24px; box-sizing: border-box;&quot;&gt;$gt&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color: rgb(102, 102, 102); line-height: 24px; box-sizing: border-box;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;background-color: rgb(245, 246, 247); line-height: 24px; color: rgb(34, 34, 34);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;background-color: rgb(245, 246, 247); line-height: 24px;&quot;&gt;&lt;font color=&quot;#208050&quot;&gt;1&lt;/font&gt;&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;color: rgb(34, 34, 34); line-height: 24px; box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: rgb(34, 34, 34); background-color: rgb(245, 246, 247); line-height: 24px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot; style=&quot;color: rgb(34, 34, 34); line-height: 24px; box-sizing: border-box;&quot;&gt;$lt&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color: rgb(102, 102, 102); line-height: 24px; box-sizing: border-box;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: rgb(34, 34, 34); background-color: rgb(245, 246, 247); line-height: 24px;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;background-color: rgb(245, 246, 247); line-height: 24px;&quot;&gt;&lt;font color=&quot;#208050&quot;&gt;3&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;}}}&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;);&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;查询结果：&lt;/span&gt; &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02a999e52a7a0287e930d&quot;), &quot;remark&quot; : [ 2, 4, 8, 9 ] } { &quot;_id&quot; : ObjectId(&quot;54d02aa19e52a7a0287e930e&quot;), &quot;remark&quot; : [ 6, 1, 2, 3 ] }&lt;font size=&quot;2&quot;&gt; &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;//数组中存在以下情况，则被检索出来 一个元素大于5，另一个元素小于9 或者存在一个元素同时满足这两个条件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;font color=&quot;#222222&quot;&gt;&lt;span style=&quot;line-height: 17.980770111083984px;&quot;&gt;db.lognLogBean.find({&#39;remark&#39;:{$gt: 5, $lt: 9}});&lt;/span&gt;&lt;/font&gt; &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161);&quot;&gt;&lt;font color=&quot;#222222&quot;&gt;&lt;span style=&quot;line-height: 17.980770111083984px;&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;color: teal; line-height: 17.992788314819336px;&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;color: rgb(147, 161, 161); line-height: 17.992788314819336px;&quot;&gt;查询结果：&lt;/span&gt; &lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;L2&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02a999e52a7a0287e930d&quot;), &quot;remark&quot; : [ 2, 4, 8, 9 ] } { &quot;_id&quot; : ObjectId(&quot;54d02aa19e52a7a0287e930e&quot;), &quot;remark&quot; : [ 6, 1, 2, 3 ] } &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;16.字段中JSON查询，Mongodb特有&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-family: Arial;&quot;&gt;&lt;div&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot; style=&quot;font-size: 13px; font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; word-wrap: break-word; background-color: rgb(247, 247, 249); padding: 10px; border: 1px solid rgb(225, 225, 232); tab-size: 4; box-shadow: rgb(251, 251, 252) 40px 0px 0px inset, rgb(236, 236, 240) 41px 0px 0px inset;&quot;&gt;&lt;div class=&quot;linenums&quot; style=&quot;color: rgb(30, 52, 123); margin-top: 0px; margin-bottom: 0px; padding-left: 0px;&quot;&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;为了进行下面的实验：数据中remark中的数据如下&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#48484c&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02a999e52a7a0287e930d&quot;), &quot;remark&quot; : [ 2, 4, 8, 9 ] } { &quot;_id&quot; : ObjectId(&quot;54d02aa19e52a7a0287e930e&quot;), &quot;remark&quot; : [ 6, 1, 2, 3 ] } &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L1&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#48484c&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d02aab9e52a7a0287e930f&quot;), &quot;remark&quot; : [ 4, 1, 0 ] }&lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;{ “_id” : ObjectId(“54cf472365668d263ae538ca”), “remark” : { “name” : “lisi”, “age” : 13, “test” : { “ww” : “ww”, “mm” : “mm” } } }&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;{ “_id” : ObjectId(“54cf473a65668d263ae538cb”), “remark” : { “name” : “zhaojie”, “age” : 21, “test” : { “bb” : “bb”, “dd” : “dd” } } }&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt;{ &quot;_id&quot; : ObjectId(&quot;54d06dadd19ef99ec18ac8ba&quot;), &quot;remark&quot; : { &quot;name&quot; : &quot;zhaojie&quot;, &quot;age&quot; : 23, &quot;test&quot; : [ { &quot;cc&quot; : 12 }, { &quot;ff&quot; : &quot;ff&quot; } ] } }&lt;/font&gt; &lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;&lt;font color=&quot;#93a1a1&quot;&gt; &lt;/font&gt;&lt;/div&gt;&lt;div class=&quot;L0&quot; style=&quot;color: rgb(190, 190, 197); line-height: 18px; padding-left: 0px; list-style-type: none;&quot;&gt;//查询`remark中name为’lisi’的用户信息db.lognLogBean.find({‘remark.name’: ‘lisi’});Mongodb查询结果：{ “_id” : ObjectId(“54cf472365668d263ae538ca”), “remark” : { “name” : “lisi”, “age” : 13, “test” : { “ww” : “ww”, “mm” : “mm” } } }//查询remark中test的bb为’bb’的用户信息db.lognLogBean.find({‘remark.test.bb’: ‘bb’});Mongodb查询结果：{ “_id” : ObjectId(“54cf473a65668d263ae538cb”), “remark” : { “name” : “zhaojie”, “age” : 21, “test” : { “bb” : “bb”, “dd” : “dd” } } }//json不支持部分查询db.lognLogBean.find({“remark” :{ “name” : “zhaojie”, “age” : 21, “test” : { “bb” : “bb”, “dd” : “dd” }}}); //返回正确结果db.lognLogBean.find({“remark” :{ “name” : “zhaojie”, “age” : 21}}); //无结果返回//通过内嵌数组的序号查询db.lognLogBean.find({“remark.test.0.cc” :12});Mongodb查询结果：{ “_id” : ObjectId(“54d06dadd19ef99ec18ac8ba”), “remark” : { “name” : “zhaojie”, “age” : 23, “test” : [ { “cc” : 12 }, { “ff” : “ff” } ] } }至此：Mongodb的大体已经总结完全，如需更多，请参考Mongodb官网文档 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Single Sign On】Domino平台应用与构异系统实现单点登录]]></title>
    <url>%2F1d59179ae8a72ce763744f4f829fdea8.html</url>
    <content type="text"><![CDATA[本部分的描述仅适用于单一的Domino平台应用与构异系统实现单点登录。 * 1.1 Domino LTPA Cookie **生成原理** 在与 Domino 做 SSO 的时候，会使用 LTPA Token的认证方式，本文描述它的生成原理，通过它我们可以自己编码生成身份认证的 cookie，实现 SSO。 首先，这个 cookie 由以下部分组成： ·LTPA token 版本（4字节） ·创建时间（8字节） ·过期时间（8字节） ·用户名（可变长度） ·Domino LTPA 密钥（20字节） 接下来分别说明各部分的具体内容： ·LTPA token 版本目前 Domino 只有一种值：0x0001 ·创建时间为以十六进制方式表示的Unix time，例如:2009-04-09 13:52:42 (GMT +8) =1239256362 = 49DD8D2A。 ·过期时间=创建时间 + SSO 配置文档的过期时间（LTPA_TokenExpiration域） ·用户名为 Names 中用户文档的FullName域值；如：Squall Zhong/Digiwin ·Domino LTPA 密钥通过 Base64编码后，保存在 SSO 配置文档的LTPA_DominoSecret域中 当然不能将密钥直接发送给浏览器，所以将上述部分合并起来（如上图），计算 SHA-1 校验和。 然后用 SHA-1 校验和替换掉 Domino LTPA 密钥，最后再将内容通过 Base64 编码，形成最终的 cookie 发送给浏览器（如上图）。这样如果 cookie 中的任何内容被修改，校验和就不对了，达到了防篡改的效果。所以最终LTPACookie所得到的值为以下公式组成： SHA-1=LTPA**版本号+创建时间+过期时间+用户名+Domino LTPA 密钥** LTPA Cookie= Base64(LTPA**版本号+创建时间+过期时间+用户名+SHA-1)** * 1.2 **异构系统所需信息** ·Domino 所使用的DNS域，如：vgolive.com ·过期时间(分钟)，如：30 ·Domino LTPA 密钥 ·Domino验证字名称，如：/O=VGOLive Technology 注：用户名可以通过Domino验证字进行拼接，如异构系统中用户名为SquallZhong，相应在Domino中的DN就是CN=SquallZhong/O=VGOLiveTechnology。此类情况仅限于Domino中的CN与异构系统中的用户名一致。如果不一致，需要异构系统做用户对应 * 1.3 **实现** Base64解码/编码所需Jar包：apache-commons-codec-1.3.jar**以上** SHA-1的校验使用java.security.MessageDigest类 转换字符集使用：Cp850 * 1.3.1 **解析** show source &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;01&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;import &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;org.apache.commons.codec.binary.Base64; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;02…... &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;03&lt;/span&gt;final &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String CHARSET = &lt;/span&gt;“Cp850”&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;04&lt;/span&gt;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] dominoSecret = Base64.decodeBase64(ltpaDominoSecret.getBytes()); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;05&lt;/span&gt;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] ltpa = Base64.decodeBase64(ltpaToken.getBytes()); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;06ByteArrayInputStream stream = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ByteArrayInputStream(ltpa); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;07&lt;/span&gt;int &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;usernameLength = ltpa.length – &lt;/span&gt;40&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt; color:#666666&quot;&gt;; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;08&lt;/span&gt;byte &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;header[] = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[&lt;/span&gt;4&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;09&lt;/span&gt;byte &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;creation[] = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[&lt;/span&gt;8&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;10&lt;/span&gt;byte &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;expires[] = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[&lt;/span&gt;8&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;11&lt;/span&gt;byte &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;username[] = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[usernameLength]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;12&lt;/span&gt;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] sha = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[&lt;/span&gt;20&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;13// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt; color:#666666&quot;&gt;读取&lt;span lang=&quot;EN-US&quot;&gt;LTPAToken&lt;/span&gt;版本号 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;14stream.read(header, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, &lt;/span&gt;4&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;15&lt;/span&gt;if &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(header[&lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;] != &lt;/span&gt;0 &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;|| header[&lt;/span&gt;1&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;] != &lt;/span&gt;1 &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;|| header[&lt;/span&gt;2&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;] != &lt;/span&gt;2&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;|| header[&lt;/span&gt;3&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;] != &lt;/span&gt;3&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;) &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;16&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;IllegalArgumentException(&lt;/span&gt;“InvalidltpaToken format”&lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;17&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;读取开始时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;18&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;stream.read(creation, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, &lt;/span&gt;8&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;19&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;读取到期时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;20&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;stream.read(expires, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, &lt;/span&gt;8&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;21&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;读取&lt;span lang=&quot;EN-US&quot;&gt;Domino&lt;/span&gt;用户&lt;span lang=&quot;EN-US&quot;&gt;DN &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;22&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;stream.read(username, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, usernameLength); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;23&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;读取&lt;span lang=&quot;EN-US&quot;&gt;SHA&lt;/span&gt;校验和 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;24&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;stream.read(sha, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, &lt;/span&gt;20&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;25&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;转换用户名 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;26&lt;/span&gt;&nbsp;&nbsp; char &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;characters[] = &lt;/span&gt;new char&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[usernameLength]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;27&lt;/span&gt;&nbsp;&nbsp; try &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;{ &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;28&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;InputStreamReader isr = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;InputStreamReader( &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;29&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ByteArrayInputStream(username), &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;30&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;CHARSET); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;31&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;isr.read(characters); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;32&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt;catch &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(Exception e) { &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;33&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;34&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;获得&lt;span lang=&quot;EN-US&quot;&gt;Domino&lt;/span&gt;用户&lt;span lang=&quot;EN-US&quot;&gt;DN &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;35&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String dn = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String(characters); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;36&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;获得创建时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;37&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Date creationDate = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Date( &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;38&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Long.parseLong(&lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String(creation), &lt;/span&gt;16&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;) * &lt;/span&gt;1000&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;39&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;获得到期时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;40&lt;/span&gt;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Date expiresDate = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Date( &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;41&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;Long.parseLong(&lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String(expires), &lt;/span&gt;16&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;) * &lt;/span&gt;1000&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;42…... &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;43// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt; color:#666666&quot;&gt;创建&lt;span lang=&quot;EN-US&quot;&gt;LTPA Token &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;44&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ByteArrayOutputStream ostream = &lt;/span&gt;new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ByteArrayOutputStream(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;45&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;try &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;{ &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;46&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// LTPA Token&lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;版本号 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;47&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.write(header); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;48&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;创建时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;49&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.write(creation); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;50&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;过期时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;51&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.write(expires); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;52&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// Domino&lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;用户&lt;span lang=&quot;EN-US&quot;&gt;DN&lt;/span&gt;，如&lt;span lang=&quot;EN-US&quot;&gt;CN=SquallZhong/O=DigiWin &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;53&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.write(username); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;54&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// Domino LTPA &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;密钥 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;55&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.write(dominoSecret); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;56&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ostream.close(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;57&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt;catch &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(IOException e) { &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;58&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;RuntimeException(e); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;59&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;60&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;进行&lt;span lang=&quot;EN-US&quot;&gt; SHA-1 &lt;/span&gt;校验和 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;61&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;MessageDigest md; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;62&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;try &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;{ &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;63&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;md = MessageDigest.getInstance(&lt;/span&gt;“SHA-1”&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;64&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;md.reset(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;65&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt;catch &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(NoSuchAlgorithmException e) { &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;66&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;RuntimeException(e); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;67&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;68&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] digest = md.digest(ostream.toByteArray()); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;69&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;完成&lt;span lang=&quot;EN-US&quot;&gt; SHA-1 &lt;/span&gt;校验和，&lt;span lang=&quot;EN-US&quot;&gt;digest&lt;/span&gt;长度为&lt;span lang=&quot;EN-US&quot;&gt;20 &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;70&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;boolean &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;valid = MessageDigest.isEqual(digest, sha);&lt;/span&gt; * 1.3.2 **生成** show source &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;01&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;/** &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;02&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;为指定用户创建有效的&lt;span lang=&quot;EN-US&quot;&gt;LTPA Token.&lt;/span&gt;创建时间为&lt;span lang=&quot;EN-US&quot;&gt;&amp;lt;tt&amp;gt;now&amp;lt;/tt&amp;gt;. &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;03&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;04&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @param username &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;05&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;用户名，注：使用用户全称，如：&lt;span lang=&quot;EN-US&quot;&gt;CN=SquallZhong/O=VGOLive Technology &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;06&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @param creationTime &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;07&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;创建时间 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;08&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @param durationMinutes &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;09&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;到期时间，单位：分钟 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;10@param ltpaSecretStr &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;11&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Domino Ltpa &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;加密字符串 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;12&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @return - &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;返回已&lt;span lang=&quot;EN-US&quot;&gt;Base64&lt;/span&gt;编码的&lt;span lang=&quot;EN-US&quot;&gt;Ltpa Cookie. &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;13&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @throws NoSuchAlgorithmException &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;14&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;* @throws Base64DecodeException &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;15&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;*/&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;16&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;public static &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String createLtpaToken(String username, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;17&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;GregorianCalendar creationTime, &lt;/span&gt;int &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;durationMinutes, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;18&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String ltpaSecretStr) &lt;/span&gt;throws &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;NoSuchAlgorithmException { &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;19&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// Base64&lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;解码&lt;span lang=&quot;EN-US&quot;&gt;ltpaSecretStr &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;20&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] ltpaSecret = Base64.decodeBase64(ltpaSecretStr.getBytes()); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;21&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;用户名字节数组 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;22&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] usernameArray = username.getBytes(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;23&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] workingBuffer = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[preUserDataLength &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;24&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ usernameArray.length + ltpaSecret.length]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;25&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;26&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;设置&lt;span lang=&quot;EN-US&quot;&gt;ltpaToken&lt;/span&gt;版本至&lt;span lang=&quot;EN-US&quot;&gt;workingBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;27&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(ltpaTokenVersion, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt; color:#666666&quot;&gt;, workingBuffer, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;28&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;ltpaTokenVersion.length); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;29&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;获得过期时间，过期时间&lt;span lang=&quot;EN-US&quot;&gt;=&lt;/span&gt;当前时间&lt;span lang=&quot;EN-US&quot;&gt;+&lt;/span&gt;到期时间&lt;span lang=&quot;EN-US&quot;&gt;(&lt;/span&gt;分钟&lt;span lang=&quot;EN-US&quot;&gt;) &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;30&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;GregorianCalendar expirationDate = (GregorianCalendar) creationTime &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;31&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;.clone(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;32&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;expirationDate.add(Calendar.MINUTE, durationMinutes); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;33&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;34&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;转换创建时间至&lt;span lang=&quot;EN-US&quot;&gt;16&lt;/span&gt;进制字符串 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;35&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String hex = dateStringFiller &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;36&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ Integer.toHexString( &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;37&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(&lt;/span&gt;int&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;) (creationTime.getTimeInMillis() / &lt;/span&gt;1000&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;)) &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;38&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;.toUpperCase(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;39&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;设置创建时间至&lt;span lang=&quot;EN-US&quot;&gt;workingBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;40&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(hex.getBytes(), hex.getBytes().length &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;41&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;- dateStringLength, workingBuffer, creationDatePosition, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;42&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;dateStringLength); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;43&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;44&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;转换过期时间至&lt;span lang=&quot;EN-US&quot;&gt;16&lt;/span&gt;进制字符串 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;45&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;hex = dateStringFiller &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;46&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ Integer.toHexString( &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;47&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;(&lt;/span&gt;int&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;) (expirationDate.getTimeInMillis() / &lt;/span&gt;1000&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;)) &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;48&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;.toUpperCase(); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;49&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;设置过期时间至&lt;span lang=&quot;EN-US&quot;&gt;workingBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;50&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(hex.getBytes(), hex.getBytes().length &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;51&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;- dateStringLength, workingBuffer, expirationDatePosition, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;52&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;dateStringLength); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;53&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;54&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;设置用户全称至&lt;span lang=&quot;EN-US&quot;&gt;workingBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;55&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(usernameArray, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt; color:#666666&quot;&gt;, workingBuffer, preUserDataLength, &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;56&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;usernameArray.length); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;57&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;58&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;设置已&lt;span lang=&quot;EN-US&quot;&gt;Base64&lt;/span&gt;解码&lt;span lang=&quot;EN-US&quot;&gt;ltpaSecret&lt;/span&gt;至&lt;span lang=&quot;EN-US&quot;&gt;workingBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;59&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(ltpaSecret, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, workingBuffer, preUserDataLength &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;60&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ usernameArray.length, ltpaSecret.length); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;61&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;创建&lt;span lang=&quot;EN-US&quot;&gt;Hash&lt;/span&gt;字符串 &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;62&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] hash = createHash(workingBuffer); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;63&amp;nbsp;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;64&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// ltpaToken&lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;版本&lt;span lang=&quot;EN-US&quot;&gt;+&lt;/span&gt;开始时间&lt;span lang=&quot;EN-US&quot;&gt;(16&lt;/span&gt;进制&lt;span lang=&quot;EN-US&quot;&gt;)+&lt;/span&gt;到期时间&lt;span lang=&quot;EN-US&quot;&gt;(16&lt;/span&gt;进制&lt;span lang=&quot;EN-US&quot;&gt;)+&lt;/span&gt;用户全名&lt;span lang=&quot;EN-US&quot;&gt;+SHA-1(ltpaToken&lt;/span&gt;版本&lt;span lang=&quot;EN-US&quot;&gt;+&lt;/span&gt;开始时间&lt;span lang=&quot;EN-US&quot;&gt;(16&lt;/span&gt;进制&lt;span lang=&quot;EN-US&quot;&gt;)+&lt;/span&gt;到期时间&lt;span lang=&quot;EN-US&quot;&gt;(16&lt;/span&gt;进制&lt;span lang=&quot;EN-US&quot;&gt;)+&lt;/span&gt;用户全名&lt;span lang=&quot;EN-US&quot;&gt;) &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;65&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[] outputBuffer = &lt;/span&gt;new byte&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;[preUserDataLength + usernameArray.length &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;66&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ hashLength]; &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;67&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(workingBuffer, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt; color:#666666&quot;&gt;, outputBuffer, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, preUserDataLength &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;68&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ usernameArray.length); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;69&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;System.arraycopy(hash, &lt;/span&gt;0&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;, outputBuffer, preUserDataLength &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;70&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;+ usernameArray.length, hashLength); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;71&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;// &lt;/span&gt;``&lt;span style=&quot;font-size:12.0pt;color:#666666&quot;&gt;返回已&lt;span lang=&quot;EN-US&quot;&gt;Base64&lt;/span&gt;编码的&lt;span lang=&quot;EN-US&quot;&gt;outputBuffer &lt;/span&gt;&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;72&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new &lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;String(Base64.encodeBase64(outputBuffer)); &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;73&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span lang=&quot;EN-US&quot; style=&quot;font-size:12.0pt;color:#666666&quot;&gt;} &lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt;74…...&lt;/span&gt; &lt;span lang=&quot;EN-US&quot; style=&quot;font-size: 12.0pt;color:#666666&quot;&gt; &lt;/span&gt; 本文与同事在2013年设计一级部署系统架构时所定，同事曾经发表于百度文库]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【密码知识】An introduction to Digital Signatures(数字证书的介绍)]]></title>
    <url>%2Fe2c6f029977a8f38d983f0f2fdaa1d69.html</url>
    <content type="text"><![CDATA[What is a Digital Signature?Written by David Youd ,Expanded by LI RuJiaFor respecting authentic author, I give all the original text, For reading easily, I expanded it &nbsp;and &nbsp;translated it into Chinese&nbsp; Bob(Bob’s public key)(Bob’s private key)Bob has been given two keys. One of Bob’s keys is called a Public Key, the other is called a Private Key.Bob’s Co-workers:Anyone can get Bob’s Public Key, but Bob keeps his Private Key to himselfPatDougSusanBob’s Public key is available to anyone who needs it, but he keeps his Private Key to himself. Keys are used to encrypt information. Encrypting information means “scrambling it up”, so that only a person with the appropriate key can make it readable again. Either one of Bob’s two keys can encrypt data, and the other key can decrypt that data.Susan (shown below) can encrypt a message using Bob’s Public Key. Bob uses his Private Key to decrypt the message. Any of Bob’s coworkers might have access to the message Susan encrypted, but without Bob’s Private Key, the data is worthless.“Hey Bob, how about lunch at Taco Bell. I hear they have free refills!”HNFmsEm6Un BejhhyCGKOK JUxhiygSBCEiC 0QYIh/Hn3xgiK BcyLK1UcYiY lxx2lCFHDC/AHNFmsEm6Un BejhhyCGKOK JUxhiygSBCEiC 0QYIh/Hn3xgiK BcyLK1UcYiY lxx2lCFHDC/A“Hey Bob, how about lunch at Taco Bell. I hear they have free refills!”With his private key and the right software, Bob can put digital signatures on documents and other data. A digital signature is a “stamp” Bob places on the data which is unique to Bob, and is very difficult to forge. In addition, the signature assures that any changes made to the data that has been signed can not go undetected.To sign a document, Bob’s software will crunch down the data into just a few lines by a process called “hashing”. These few lines are called a message digest. (It is not possible to change a message digest back into the original data from which it was created.)Bob’s software then encrypts the message digest with his private key. The result is the digital signature.Finally, Bob’s software appends the digital signature to document. All of the data that was hashed has been signed.Bob now passes the document on to Pat.First, Pat’s software decrypts the signature (using Bob’s public key) changing it back into a message digest. If this worked, then it proves that Bob signed the document, because only Bob has his private key. Pat’s software then hashes the document data into a message digest. If the message digest is the same as the message digest created when the signature was decrypted, then Pat knows that the signed data has not been changed.Plot complication…Doug (our disgruntled employee) wishes to deceive Pat. Doug makes sure that Pat receives a signed message and a public key that appears to belong to Bob. Unbeknownst to Pat, Doug deceitfully sent a key pair he created using Bob’s name. Short of receiving Bob’s public key from him in person, how can Pat be sure that Bob’s public key is authentic?It just so happens that Susan works at the company’s certificate authority center. Susan can create a digital certificate for Bob simply by signing Bob’s public key as well as some information about Bob.Bob Info:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Department&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cubical NumberCertificate Info:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expiration Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial NumberBob’s Public Key:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Now Bob’s co-workers can check Bob’s trusted certificate to make sure that his public key truly belongs to him. In fact, no one at Bob’s company accepts a signature for which there does not exist a certificate generated by Susan. This gives Susan the power to revoke signatures if private keys are compromised, or no longer needed. There are even more widely accepted certificate authorities that certify Susan.Let’s say that Bob sends a signed document to Pat. To verify the signature on the document, Pat’s software first uses Susan’s (the certificate authority’s) public key to check the signature on Bob’s certificate. Successful de-encryption of the certificate proves that Susan created it. After the certificate is de-encrypted, Pat’s software can check if Bob is in good standing with the certificate authority and that all of the certificate information concerning Bob’s identity has not been altered.Pat’s software then takes Bob’s public key from the certificate and uses it to check Bob’s signature. If Bob’s public key de-encrypts the signature successfully, then Pat is assured that the signature was created using Bob’s private key, for Susan has certified the matching public key. And of course, if the signature is valid, then we know that Doug didn’t try to change the signed content.Although these steps may sound complicated, they are all handled behind the scenes by Pat’s user-friendly software. To verify a signature, Pat need only click on it. 原文地址：http://www.youdzone.com/signature.html主要内容有：对称密钥系统，非对称密钥系统，数字信封，确保信息完整性hash散列，数字签名，数字证书等1，对称密钥系统加密和解密用同一个密钥，密钥长度较短，传输熟读较快，常常用于在建立连接后的内容加密&nbsp; &nbsp; &nbsp; 如下图所示;典型的算法，DES（核心思想是替换加密和转换加密），三重DES—————————————————————————————2，非对称密钥系统，也称为公钥加密,它使用一对密钥，包括一个公钥（ Public Key ）和一个私钥（ Private Key ）。&nbsp; &nbsp; &nbsp;主要作用是认证，典型有算法RSA，背包算法，如下图所示—————————————————————————————两者常常一起使，下面是应用的案例用发送者公开密钥进行加密，接收者用私钥进行解密，问题是这个私钥怎么传输？&nbsp;&nbsp;接收者用私钥进行加密，所有人都知道的公钥，安全问题？&nbsp;这个图片解决以上两个问题，首先用发送者的私钥进行加密，这时所有人的公钥都可以解开，然后在用接收者的公钥进行加密，确保了只有接收者可以解开&nbsp;公钥算法相对兑成算法速度较慢，无法用于加密和解密大量数据，在实际应用中常常是两者同时使用—————————————————————————————下面来介绍可以几个相关概念：数字信封：（digitalenvelope）,用公钥建立和发送一个对称密钥个给接收人，然后用这个密钥进行信息的加密和解密&nbsp;通俗点将就是：通过非对称加密，获取对称加密的密钥，如下图所示：&nbsp;&nbsp;下面来思考一个问题，当我们可以确保信息不会外泄时，我们怎么样保证所发信息的完整性？&nbsp;散列值（也成哈希值），当不用个输入时，可以确保有不同的输出，通过输出值可以保证输入的唯一性散列是一个单向的函数，即使信息有细微的变化，所输出的散列值也不同确保信息完整的有效加密方法就是通过散列值，这点已经广泛应用，比如我们平时用的迅雷，电驴，甚至有时候在下载大型软件时，旁边会附有他的散列值原理如下&nbsp;1.将信息和信息的散列值一同发给收件人2.收件人收到信息，通过相同的散列算法，计算出另一个散列值3将两个散列值进行比较，如果相同，则说明在传输过程中未出现丢失，信息是完整的&nbsp;—————————————————————————————&nbsp;到目前为止，我们已经解决了两个问题，即传输中信息泄露（安全性）和接收后保证信息的完整性，当我们接收到一个数据后又是怎样确定是发送者发送的呢？下面我们来讨论这个问题&nbsp;现在最关心的是发送者的身份？现实生活中我们可以使用笔迹鉴定，按手印等，如甲在写完文章后，既按了一个手印，当乙（甚至是所有人）看到这个手印后，既可以确定是甲按的，这个手印具有唯一性，在网络传输中我们可以将内容和这个手印一起传给接收者，当接收者看到这手印后，即认定他就是甲，这个手印就是就是下面要讲的数据签名—————————————————————————————数据签名：基本原理1.对发送者者内容进行散列&nbsp;获取发送内容的哈希值，确保完整性—————————————————————————————2，对这个散列值进行加密（用发送者的私钥）记住一个原则，私钥加密，公钥解密不安全，但是可以用于身份验证&nbsp;—————————————————————————————3.将数字签名（用发送者私钥加密的发送内容的哈希值），附加在发送的内容中生成一个明文A，一起进行发送&nbsp;—————————————————————————————&nbsp;4.对明文A，用接收者的公钥进行加密生成密文B，进行发送&nbsp;5.接受者在收到密文B后，用自己的私钥进行解密，还原成明文Ａ6.接受者从还原的明文A中，抽取中签名，然后对签名用发送者的公钥进行解密得到一个散列值Ｆ，如果能得到说明，信息就是发送者发来的，因为发送者的私钥只有发送者的公钥能解开，至此验证了身份，对接收的明文A中内容进行哈希散列，获取哈希D ,如果D和F一致，说明发送的是完整，—————————————————————————————下面我们来讨论一个更深层次的问题：在确定了发送方的身份后，我们怎么确定接收方的身份，你必须知道某人的公钥才向他发送信息，公钥来自何处，如何确定公钥持有者的身份？带着这个问题，我们来探究下一个话题：数字证书数字证书有认证中心发行，用来正式公钥和私钥持有人真实身份，个人可以像CA（认证中心）申请数字证书，这个过程称为公钥认证，证书中心用自己 的私钥对申请人公钥和一些基本信息进行加密，寄给申请方，当有人像申请人发送信息时，他们首先要求接收人，寄过来签名证书，然后发送人使用CA公钥给证书解密，发送人对接收人的身份得意确认，这样最后只需要与认证方打交道即可 &nbsp;例子自己看看吧，我就不分析了本文曾经出现我之前的博客中：&nbsp;&lt;http://lirujia00.iteye.com/blog/1731309&gt;&nbsp; 来自为知笔记(Wiz) ### 附件列表 [)TEBIW9)KSQX$BN9U{Z@~D.png [PQS0SN48J2L0TMVE8U2~]W.png* FQZ6~5JBDXSZ)@EU0AO(}1Q.png &nbsp;]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】memcached全面剖析--5. memcached的应用和兼容程序]]></title>
    <url>%2F445d8f034e6cdb3945d279103076df2b.html</url>
    <content type="text"><![CDATA[# 发表日：2008/7/30 作者：长野雅广(Masahiro Nagano) 原文链接：http://gihyo.jp/dev/feature/01/memcached/0005 前几次的文章在这里： 第1次： 第2次：http://tech.idv2.com/2008/07/11/memcached-002/ 第3次：http://tech.idv2.com/2008/07/16/memcached-003/ 第4次：http://tech.idv2.com/2008/07/24/memcached-004/ 我是Mixi的长野。memcached的连载终于要结束了。 到上次为止， 我们介绍了与memcached直接相关的话题，本次介绍一些mixi的案例和 实际应用上的话题，并介绍一些与memcached兼容的程序。 mixi案例研究mixi在提供服务的初期阶段就使用了memcached。&nbsp;随着网站访问量的急剧增加，单纯为数据库添加slave已无法满足需要，因此引入了memcached。 此外，我们也从增加可扩展性的方面进行了验证，证明了memcached的速度和稳定性都能满足需要。 现在，memcached已成为mixi服务中非常重要的组成部分。 图1 现在的系统组件 服务器配置和数量mixi使用了许许多多服务器，如数据库服务器、应用服务器、图片服务器、&nbsp;反向代理服务器等。单单memcached就有将近200台服务器在运行。 memcached服务器的典型配置如下： CPU：Intel Pentium 4 2.8GHz 内存：4GB 硬盘：146GB SCSI 操作系统：Linux（x86_64） 这些服务器以前曾用于数据库服务器等。随着CPU性能提升、内存价格下降， 我们积极地将数据库服务器、应用服务器等换成了性能更强大、内存更多的服务器。 这样，可以抑制mixi整体使用的服务器数量的急剧增加，降低管理成本。 由于memcached服务器几乎不占用CPU，就将换下来的服务器用作memcached服务器了。 memcached进程每台memcached服务器仅启动一个memcached进程。分配给memcached的内存为3GB， 启动参数如下： /usr/bin/memcached -p 11211 -u nobody -m 3000 -c 30720 `&lt;/pre&gt; 由于使用了x86_64的操作系统，因此能分配2GB以上的内存。32位操作系统中， 每个进程最多只能使用2GB内存。也曾经考虑过启动多个分配2GB以下内存的进程， 但这样一台服务器上的TCP连接数就会成倍增加，管理上也变得复杂， 所以mixi就统一使用了64位操作系统。 另外，虽然服务器的内存为4GB，却仅分配了3GB，是因为内存分配量超过这个值， 就有可能导致内存交换(swap)。连载的[第2次](http://tech.idv2.com/2008/07/11/memcached-002/)中 前坂讲解过了memcached的内存存储“slab allocator”，当时说过，memcached启动时 指定的内存分配量是memcached用于保存数据的量，没有包括“slab allocator”本身占用的内存、 以及为了保存数据而设置的管理空间。因此，memcached进程的实际内存分配量要比 指定的容量要大，这一点应当注意。 mixi保存在memcached中的数据大部分都比较小。这样，进程的大小要比&amp;nbsp; 指定的容量大很多。因此，我们反复改变内存分配量进行验证， 确认了3GB的大小不会引发swap，这就是现在应用的数值。 ## memcached使用方法和客户端 现在，mixi的服务将200台左右的memcached服务器作为一个pool使用。 每台服务器的容量为3GB，那么全体就有了将近600GB的巨大的内存数据库。 客户端程序库使用了本连载中多次提到车的Cache::Memcached::Fast， 与服务器进行交互。当然，缓存的分布式算法使用的是&amp;nbsp;[第4次](http://tech.idv2.com/2008/07/24/memcached-004/)介绍过的 Consistent Hashing算法。 Cache::Memcached::Fast - search.cpan.org 应用层上memcached的使用方法由开发应用程序的工程师自行决定并实现。 但是，为了防止车轮再造、防止Cache::Memcached::Fast上的教训再次发生， 我们提供了Cache::Memcached::Fast的wrap模块并使用。 通过Cache::Memcached::Fast维持连接Cache::Memcached的情况下，与memcached的连接（文件句柄）保存在Cache::Memcached包内的类变量中。&nbsp;在mod_perl和FastCGI等环境下，包内的变量不会像CGI那样随时重新启动， 而是在进程中一直保持。其结果就是不会断开与memcached的连接， 减少了TCP连接建立时的开销，同时也能防止短时间内反复进行TCP连接、断开 而导致的TCP端口资源枯竭。 但是，Cache::Memcached::Fast没有这个功能，所以需要在模块之外 将Cache::Memcached::Fast对象保持在类变量中，以保证持久连接。 `package Gihyo::Memcached; use strict; use warnings; use Cache::Memcached::Fast; my @server_list = qw/192.168.1.1:11211 192.168.1.1:11211/; my $fast; ## 用于保持对象sub new {my $self = bless {}, shift; if ( !$fast ) { $fast = Cache::Memcached::Fast-&gt;new({ servers =&gt; \@server_list }); } $self-&gt;{_fast} = $fast; return $self; } sub get {my $self = shift; $self-&gt;{_fast}-&gt;get(@_); } ` 上面的例子中，Cache::Memcached::Fast对象保存到类变量$fast中。 公共数据的处理和rehash诸如mixi的主页上的新闻这样的所有用户共享的缓存数据、设置信息等数据， 会占用许多页，访问次数也非常多。在这种条件下，访问很容易集中到某台memcached服务器上。 访问集中本身并不是问题，但是一旦访问集中的那台服务器发生故障导致memcached无法连接， 就会产生巨大的问题。 连载的第4次&nbsp;中提到，Cache::Memcached拥有rehash功能，即在无法连接保存数据的服务器的情况下， 会再次计算hash值，连接其他的服务器。 但是，Cache::Memcached::Fast没有这个功能。不过，它能够在连接服务器失败时， 短时间内不再连接该服务器的功能。 `my $fast = Cache::Memcached::Fast-&gt;new({ max_failures =&gt; 3, failure_timeout =&gt; 1 }); ` 在failure_timeout秒内发生max_failures以上次连接失败，就不再连接该memcached服务器。 我们的设置是1秒钟3次以上。 此外，mixi还为所有用户共享的缓存数据的键名设置命名规则， 符合命名规则的数据会自动保存到多台memcached服务器中， 取得时从中仅选取一台服务器。创建该函数库后，就可以使memcached服务器故障 不再产生其他影响。 memcached应用经验到此为止介绍了memcached内部构造和函数库，接下来介绍一些其他的应用经验。 通过daemontools启动通常情况下memcached运行得相当稳定，但mixi现在使用的最新版1.2.5 曾经发生过几次memcached进程死掉的情况。架构上保证了即使有几台memcached故障 也不会影响服务，不过对于memcached进程死掉的服务器，只要重新启动memcached， 就可以正常运行，所以采用了监视memcached进程并自动启动的方法。 于是使用了daemontools。 daemontools是qmail的作者DJB开发的UNIX服务管理工具集，&nbsp;其中名为supervise的程序可用于服务启动、停止的服务重启等。 daemontools 这里不介绍daemontools的安装了。mixi使用了以下的run脚本来启动memcached。 `#!/bin/sh if [ -f /etc/sysconfig/memcached ];then . /etc/sysconfig/memcached fiexec 2&gt;&amp;1exec /usr/bin/memcached -p $PORT -u $USER -m $CACHESIZE -c $MAXCONN $OPTIONS` 监视mixi使用了名为“nagios”的开源监视软件来监视memcached。 Nagios: Home 在nagios中可以简单地开发插件，可以详细地监视memcached的get、add等动作。 不过mixi仅通过stats命令来确认memcached的运行状态。`define command {command_name check_memcachedcommand_line $USER1$/check_tcp -H $HOSTADDRESS$ -p 11211 -t 5 -E -s ‘stats\r\nquit\r\n’ -e ‘uptime’ -M crit} 此外，mixi将stats目录的结果通过rrdtool转化成图形，进行性能监视， 并将每天的内存使用量做成报表，通过邮件与开发者共享。 memcached的性能连载中已介绍过，memcached的性能十分优秀。我们来看看mixi的实际案例。 这里介绍的图表是服务所使用的访问最为集中的memcached服务器。 图2 请求数 图3 流量 图4 TCP连接数 从上至下依次为请求数、流量和TCP连接数。请求数最大为15000qps， 流量达到400Mbps，这时的连接数已超过了10000个。 该服务器没有特别的硬件，就是开头介绍的普通的memcached服务器。 此时的CPU利用率为： 图5 CPU利用率 可见，仍然有idle的部分。因此，memcached的性能非常高， 可以作为Web应用程序开发者放心地保存临时数据或缓存数据的地方。 兼容应用程序memcached的实现和协议都十分简单，因此有很多与memcached兼容的实现。&nbsp;一些功能强大的扩展可以将memcached的内存数据写到磁盘上，实现数据的持久性和冗余。 连载第3次&nbsp;介绍过，以后的memcached的存储层将变成可扩展的（pluggable），逐渐支持这些功能。 这里介绍几个与memcached兼容的应用程序。 repcached: 为memcached提供复制(replication)功能的patch。 Flared: 存储到QDBM。同时实现了异步复制和fail over等功能。 memcachedb: 存储到BerkleyDB。还实现了message queue。 Tokyo Tyrant: 将数据存储到Tokyo Cabinet。不仅与memcached协议兼容，还能通过HTTP进行访问。 Tokyo Tyrant案例mixi使用了上述兼容应用程序中的Tokyo Tyrant。Tokyo Tyrant是平林开发的&nbsp;Tokyo Cabinet DBM的网络接口。它有自己的协议，但也拥有memcached兼容协议，&nbsp;也可以通过HTTP进行数据交换。Tokyo Cabinet虽然是一种将数据写到磁盘的实现，但速度相当快。 mixi并没有将Tokyo Tyrant作为缓存服务器，而是将它作为保存键值对组合的DBMS来使用。&nbsp;主要作为存储用户上次访问时间的数据库来使用。它与几乎所有的mixi服务都有关， 每次用户访问页面时都要更新数据，因此负荷相当高。MySQL的处理十分笨重， 单独使用memcached保存数据又有可能会丢失数据，所以引入了Tokyo Tyrant。 但无需重新开发客户端，只需原封不动地使用Cache::Memcached::Fast即可， 这也是优点之一。关于Tokyo Tyrant的详细信息，请参考本公司的开发blog。 mixi Engineers’ Blog - Tokyo Tyrantによる耐高負荷DBの構築 mixi Engineers’ Blog - Tokyo (Cabinet|Tyrant)の新機能 总结到本次为止，“memcached全面剖析”系列就结束了。我们介绍了memcached的基础、内部结构、 分散算法和应用等内容。读完后如果您能对memcached产生兴趣，就是我们的荣幸。 关于mixi的系统、应用方面的信息，请参考本公司的开发blog。 感谢您的阅读。 来源：&nbsp;&lt;http://blog.charlee.li/memcached-005/&gt;&nbsp;来自为知笔记(Wiz)]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Linux】linux查看端口占用情况]]></title>
    <url>%2Flinuxport.html</url>
    <content type="text"><![CDATA[netstat -nupl 查看UDP// n表示用数字形式显示端口号，u，表示UDP协议类型，p是程序PID，l表示处于监听状态的； netstat -tupl 查看TCPt，表示TCP协议类型 lsof -i:8088查看此端口是否开放，如果没有开放不返回任何动，如果开放正常返回 netstat –apn使用netstat -apn查看所有的进程和端口使用情况。发现下面的进程列表，其中最后一栏是PID/Program name发现8080端口被PID为1288的进程占用。进一步使用命令：ps -ef | grep pid 查看就可以明确知道8080端口是被哪个程序占用了！然后判断是否使用KILL命令干掉！ 声明本文90%为翻译组合,10%为原创 引用https://zhidao.baidu.com/question/82236788.html]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】数据库常见架构分析]]></title>
    <url>%2Fe6-95-b0-e6-8d-ae-e5-ba-93-e5-b8-b8-e8-a7-81-e6-9e-b6-e6-9e-84-e5-88-86-e6-9e-90.html</url>
    <content type="text"><![CDATA[##数据库常见架构分析 1.基本概念1.1 单库单张表支撑所有业务，一旦异常，后果严重。 1.2&nbsp;分片分片解决的是“数据量太大”的问题，也就是通常说的“水平切分”。一旦引入分片，势必有“数据路由”的概念，哪个数据访问哪个库。针对个别的数据库，也支持表级的分片，如mongodb路由规则通常有3种方法：（1）范围：range优点：简单，容易扩展缺点：各库压力不均（新号段更活跃）（2）哈希：hash优点：简单，数据均衡，负载均匀缺点：迁移麻烦（2库扩3库数据要迁移）（3）路由服务：router-config-server优点：灵活性强，业务与路由算法解耦缺点：每次访问数据库前多一次查询 1.3 分组分组解决“可用性”问题，分组通常通过主从复制的方式实现。互联网公司数据库实际软件架构是：又分片，又分组（如下图） 2、数据库架构设计需要考虑的方向2.1数据的可用性解决可用性问题的思路是=&gt;冗余如何保证站点的可用性？复制站点，冗余站点如何保证服务的可用性？复制服务，冗余服务如何保证数据的可用性？复制数据，冗余数据数据的冗余，会带来一个副作用=&gt;引发一致性问题（先不说一致性问题，先说可用性）如何保证数据库“读”高可用？冗余读库写入单台机器中，另外两台根据日志去同步主数据库，读写有延时，可能不一致写仍然是单点，不能保证写高可用，如何保证数据库“写”高可用？冗余写库采用双主互备的方式，可以冗余写库带来的副作用？双写同步，数据可能冲突（例如“自增id”同步冲突）,如何解决同步冲突，有两种常见解决方案：（1）两个写库使用不同的初始值，相同的步长来增加id：1写库的id为0,2,4,6…；2写库的id为1,3,5,7…（2）不使用数据的id，业务层自己生成唯一的id，保证数据不冲突双主当主从用仍是双主，但只有一个主提供服务（读+写），另一个主是“shadow-master”，只用来保证高可用，平时不提供服务。master挂了，shadow-master顶上（vip漂移，对业务层透明，不需要人工介入）这种方式的好处：1）读写没有延时2）读写高可用不足：1）不能通过加从库的方式扩展读性能2）资源利用率为50%，一台冗余主没有提供服务那如何提高读性能呢？进入第二个话题，如何提供读性能。 2.2数据库的拓展性提高读性能的方式大致有三种第一种是建立索引。这种方式不展开，要提到的一点是，不同的库可以建立不同的索引。写库不建立索引；线上读库建立线上访问索引，例如uid；线下读库建立线下访问索引，例如time；第二种扩充读性能的方式是，增加从库，这种方法大家用的比较多，但是，存在两个缺点：（1）从库越多，同步越慢（2）同步越慢，数据不一致窗口越大（不一致后面说，还是先说读性能的提高）第三种 服务+数据库+缓存一套业务层不直接面向db和cache，服务层屏蔽了底层db、cache的复杂性。为什么要引入服务层，今天不展开，58采用了“服务+数据库+缓存一套”的方式提供数据访问，用cache提高读性能。不管采用主从的方式扩展读性能，还是缓存的方式扩展读性能，数据都要复制多份（主+从，db+cache），一定会引发一致性问题。 2.3数据库的一致性主从数据库的一致性，通常有两种解决方案：（1）中间件如果某一个key有写操作，在不一致时间窗口内，中间件会将这个key的读操作也路由到主库上。常见的组件有 Atlas，cobar，TDDL（2）强制读主第二类不一致，是db与缓存间的不一致常见的缓存架构如上，此时写操作的顺序是：（1）淘汰cache（2）写数据库读操作的顺序是：（1）读cache，如果cache hit则返回（2）如果cache miss，则读从库（3）读从库后，将数据放回cache在一些异常时序情况下，有可能从【从库读到旧数据（同步还没有完成），旧数据入cache后】，数据会长期不一致。解决办法是“缓存双淘汰”，写操作时序升级为：（1）淘汰cache（2）写数据库（3）在经验“主从同步延时窗口时间”后，再次发起一个异步淘汰cache的请求这样，即使有脏数据如cache，一个小的时间窗口之后，脏数据还是会被淘汰。带来的代价是，多引入一次读miss（成本可以忽略）。建议为所有cache中的item设置一个超时时间。 2.4数据库的拓展性如何秒级扩容？首先，我们不做2库变3库的扩容，我们做2库变4库（库加倍）的扩容（未来4-&gt;8-&gt;16）服务+数据库是一套（省去了缓存）数据库采用“双主”的模式。扩容步骤：第一步，将一个主库提升第二步，修改配置，2库变4库（原来MOD2，现在配置修改后MOD4）扩容完成原MOD2为偶的部分，现在会MOD4余0或者2原MOD2为奇的部分，现在会MOD4余1或者3数据不需要迁移，同时，双主互相同步，一遍是余0，一边余2，两边数据同步也不会冲突，秒级完成扩容！最后，要做一些收尾工作：（1）将旧的双主同步解除（2）增加新的双主（双主是保证可用性的，shadow-master平时不提供服务）（3）删除多余的数据（余0的主，可以将余2的数据删除掉）这样，秒级别内，我们就完成了2库变4库的扩展。 最后感谢58同城架构师 沈剑 的分享！ &nbsp; 来自为知笔记(Wiz) ### 附件列表 b4b787a3-4d55-4db4-9d90-aba34f1aaa93.png a13eb93f-e69c-4f1c-9ada-ce5d1c63ae2b.png &nbsp;]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>数据库知识</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】通俗理论解释常用部署方案]]></title>
    <url>%2Fe5-8d-95-e6-9c-ba-e9-83-a8-e7-bd-b2-ef-bc-88stand-alone-ef-bc-89-ef-bc-9a-e5-8f-aa-e6-9c-89-e4-b8-80-e4-b8-aa-e9-a5-ae-e6-b0-b4-e6-9c-ba-e6-8f-90-e4-be-9b-e6-9c-8d-e5-8a-a1.html</url>
    <content type="text"><![CDATA[图中用饮水机的例子解释了常用的部署方案 单机部署（stand-alone）：只有一个饮水机提供服务，服务只部署一份 集群部署（cluster）：有多个饮水机同时提供服务，服务冗余部署，每个冗余的服务都对外提供服务，一个服务挂掉时依然可用 热备部署（hot-swap）：只有一个桶提供服务，另一个桶stand-by，在水用完时自动热替换，服务冗余部署，只有一个主服务对外提供服务，影子服务在主服务挂掉时顶上 磁盘阵列RAID（Redundant Arrays of independent Disks） RAID0：存储性能高的磁盘阵列，又称striping，它的原理是，将连续的数据分散到不同的磁盘上存储，这些不同的磁盘能同时并行存取数据（速度块） RAID1：安全性高的磁盘阵列，又称mirror，它的原理是，将数据完全复制到另一个磁盘上，磁盘空间利用率只有50%（冗余，数据安全） RAID0+1：RAID0和RAID1的综合方案，这也是国企用的比较多的存储方案（速度快，安全性又高，但是很贵） RAID5：RAID0和RAID1的折衷方案，读取速度比较快（不如RAID0，因为多存储了校验位），安全性也很高（可以利用校验位恢复数据），空间利用率也不错（不完全复制，只冗余校验位），这也是互联网公司用的比较多的存储方案 &nbsp;来自为知笔记(Wiz) ### 附件列表 9fcf96b1-fc49-42c9-aeff-c6447db54d72.gif e118ad4b-8b98-45f8-a2c5-171d6ff384b4.jpg 34faebdd-1028-409a-a6bd-50259eb827fc.gif bc05bfee-9daf-44b0-8bfc-a0c4171ba201.gif &nbsp;]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>数据库知识</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【论文】Synchronous Non-blocking Server Based on Nodejs]]></title>
    <url>%2Fsynchronous-non-blocking-server-based-on-nodejs.html</url>
    <content type="text"><![CDATA[The old blocking multi-threaded server architecture always encounter the limitations of performance when faced of these problems such as large data, long connection, high concurrent requests, Nodejs change the maximum number of connections to the flow of a single system to solve the bottleneck.This article aims to explore the difference between asynchronous non-blocking server and blocking multi-threaded server from work and running performance.then explains the superiority of Nodejs in processing large data, long connection, high concurrent requests.This article was pulished at 《Computer Science and Application》 two years ago when I was in wuhan university，you can read it by opening this site http://image.hanspub.org:8080/Html/11970.html]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】低版本Mongodb集群加密-用户认证]]></title>
    <url>%2Fmongo-e9-9b-86-e7-be-a4-e5-8a-a0-e5-af-86-e4-b8-8e-e7-a8-8b-e5-ba-8f-e5-8f-98-e6-9b-b4.html</url>
    <content type="text"><![CDATA[1 数据库调整本文适用于对Mongo有一定了解到操作人员 以下操作基于以下条件 操作系统：Red Hat 6.4 Mongo版本：2.6.3 已经完成集群分片，已经存在数据库pmr 因为Mongo升级的原因，以下方法仅适用于2.6.3 以前的版本 1.1 创建用户本次一共预留4个用户 用户名 密码 备注 admin 123root 超级管理员 admin_read 123root_read 只读超级管理员 pmr_admin 123root_pmr pmr库管理员 pmr_admin_read 123root_pmr_read pmr库可读管理员 在无命令的情况下进行登录,（蓝色字体表示需敲入的语句，黑色字体表示执行成功的控制台输出的部分） [root@master ~]# mongo 192.168.0.178:20000/admin MongoDB shell version: 2.6.1 connecting to: 192.168.0.178:20000/admin mongos&gt;db.addUser(‘admin’,’123root’) #添加超级管理员用户 mongos&gt;db.addUser(‘admin_read’,123root_read’，true) #添加超级管理员可读用 mongos&gt;use pmr mongos&gt; db.addUser(‘pmr_admin’,’123root_pmr’) #添加pmr库管理员 mongos&gt; db.addUser(‘pmr_admin_read ‘,’123root_pmr_read ‘) #添加pmr可读管理员用户 命令执行成功标志：出现 Successfully added user: { } 在执行过程中会出现WARNING，提示方法已经过期，不影响最终结果 1.2 关闭服务器的mongod,mongos和config服务执行ps –ef|grep mongo 查出所有mongo正在运行的进程 执行 kill -2 进程ID 杀掉所有进程 1.3 停生成密钥文件keyfile切换到root的跟目录下执行以下命令 openssl rand -base64 753 &gt;keyfile chmod 600 keyfile #重点 必须 cat keyfile #查看 4a7w479ouV6fY5CASqxeWzzPhPLzZgYnHKWOFSIxjMABjaWK7up6Keb2+ZKz1C2Rtfl7ukCBelW2xOL0h3gOSAdIhUi0j8IMBYZV/kbUSSf0987xIur3lHZqUINPVVyl ib+XPrg3SO4IG25tCQbEf/twvS1CxiDmi/GtQZfqOjUX7MEJK3ynFBsB/9wU1nf1 6rLhBPIdmSnpNf5s9yGohx2wn6dQcJ8o0wn75oOBysX2mPkLI0tEu4//7x1PgY9Q Ws4XdXs1MFqUYXkh8K6RFd/TKB2zs5fonzqiXrgwpaW1KUFZB1lAfQwWePmxsWul HqR96/yTGPxQKOVpm1Zdj2LGa616X3Www16Td4c2UVoM7mPi+Js8R2Flc6oV9H+ 1.4 将keyfile分发到各个库中#将生成的keyfile 拷贝到mongod/mongos/config 进程对应的文件夹（依据自己的库而定） [root@master ~]# cp keyfile /data/mongodb/config/data/ [root@master ~]# cp keyfile /data/mongodb/mongos/ [root@master ~]# cp keyfile /data/mongodb/shard1/data/ [root@master ~]# cp keyfile /data/mongodb/shard2/data/ [root@master ~]# cp keyfile /data/mongodb/shard3/data/ 依次将keyfile拷贝到另外两台机器上的数据文件 全部执行完之后，依次变更权限，下面为其中一个例子 执行 chmod 600 /data/mongodb/mongos/keyfile 1.5 变更脚本文件原脚本 ${MONGODB}/bin/mongod -fork -shardsvr -replSet shard1 -port 10001 -dbpath ${MONGO_DATA}/shard1 -logpath ${MONGO_LOG}/shard1/shard1.log 变更后的脚本，在最后添加上权限 ${MONGODB}/bin/mongod -fork -shardsvr -replSet shard1 -port 10001 -dbpath ${MONGO_DATA}/shard1 -logpath ${MONGO_LOG}/shard1/shard1.log –keyFile /data/mongodb/shard1/data/keyfile 请依次变更所有服务的脚本（3台shard,config,mongo） 1.6 启动脚本进入脚本目录下，依次执行所有shard和config脚本后，然后在执行mongo服务，顺序很重要 1.7 确认权限是否添加成功验证超级管理员, 账户认证前状态 [Mongo@master ~]# mongo 10.142.51.43:30000 MongoDB shell version: 2.6.1 connecting to: localhost: 10.142.51.43:30000/test Error while trying to show server startup warnings: not authorized on admin to execute command { getLog: “startupWarnings” } mongos&gt; show collections; 2014-08-03T12:02:48.535+0800 error: { “$err” : “not authorized for query on test.system.namespaces”, “code” : 13 } at src/mongo/shell/query.js:131 mongos&gt; use pmr switched to db pmr mongos&gt; show collections; 2014-08-03T12:03:10.923+0800 error: { “$err” : “not authorized for query on uba.system.namespaces”, “code” : 13 } at src/mongo/shell/query.js:131 验证超级管理员, 账户认证后状态 #admin库认证 [Mongo @master ~]# mongo 10.142.51.43:30000/admin -u admin -p 123root MongoDB shell version: 2.6.1 connecting to: localhost:20000/admin mongos&gt; show collections; system.indexes system.users system.version #pmr库认证 读写权限用户 [Mongo@master ~]# mongo 10.142.51.44:30000/pmr -u pmr_admin -p 123root_pmr MongoDB shell version: 2.6.1 connecting to: 10.142.51.44:30000/pmr Error while trying to show server startup warnings: not authorized on admin to execute command { getLog: “startupWarnings” } mongos&gt; show collections; system.indexes table1 mongos&gt; db.table1.count() 0 mongos&gt; for (var i = 1; i &lt;= 1000; i++)db.table1.save({id:i,name:”username”+i,age:i}); WriteResult({ “nInserted” : 1 }) mongos&gt; db.table1.count() 1000 mongos&gt; db.table1.findOne() { “_id” : ObjectId(“53ddb52a65bb900f61e458a1”), “id” : 1, “name” : “username1”, “age” : 1 } #pmr库 只读权限用户 [Mongo@master ~]# mongo localhost:20000/pmr -u pmr_read -p 123root_pmr_read MongoDB shell version: 2.6.1 connecting to: localhost:20000/pmr Error while trying to show server startup warnings: not authorized on admin to execute command { getLog: “startupWarnings” } mongos&gt; db.auth(‘sa_read’,’123root_pmr_read’) 1 mongos&gt; for (var i = 1; i &lt;= 1000; i++)db.table1.save({id:i,name:”username”+i,age:i}); WriteResult({ “writeError” : { “code” : 13, &quot;errmsg&quot; : &quot;not authorized on uba to execute command { insert: \&quot;table1\&quot;, documents: [ { id: 1000.0, name: \&quot;username1000\&quot;, age: 1000.0, _id: ObjectId(&apos;53ddb5d62390d9a487087c87&apos;) } ], ordered: true }&quot; } }) mongos&gt; db.table1.findOne() { “_id” : ObjectId(“53ddb52a65bb900f61e458a1”), “id” : 1, “name” : “username1”, “age” : 1 } mongos&gt; db.table1.count() 1000 也可用工具MongoVUE执行验证，这里不再描述]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】集群分片环境mongodb的版本升级]]></title>
    <url>%2F13398c19511b11a7b9ecdfcfc5c5295d.html</url>
    <content type="text"><![CDATA[背景说明 生产环境数据量的剧增，鉴于2.6版本优化了存储引擎，提高了写入的速度，特提出了升级Mongo的需求目前环境中最大的一个集合分为6个片，且每片均有主节点，副节点和仲裁节点，本次升级为不停服务升级，升级的版本有2.4.10升级至2.6.2版本，特别需要提醒的是升级前请做好备份，升级一旦失败无法回退。 &lt;span style=”font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: &lt;br /&gt;major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; &lt;br /&gt;mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;”&gt;升级的注意事项 #### 1.升级过程中不允许有以下操作 &lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;enableSharding&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt; sh.shardCollection() sh.addShard() &lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;createCollection&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dropDatabase&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt;any operation that creates a database&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt;any other operation that modifies the cluster metadata in any way&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;See&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Sharding&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Reference&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a complete list of sharding commands&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Note&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; however&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; that not all commands on the &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Sharding&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Reference&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; page modifies the cluster meta&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;2,有升级后无法降级 &lt;span style=”font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: &lt;br /&gt;major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; &lt;br /&gt;mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;”&gt;升级的步骤 1. 安装，解压到/home/Mongo下，关于Mongo集群环境的搭建详见《【Mongodb】MongoDB分片备份策略与配置迁移示例》 2. 建脚本库存放于文件夹script中，脚本库中权限与内容如下 1. &lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwxrwxrwx &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;179&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; startconfig&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;2.3. &lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwxrwxrwx &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;191&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; startmongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;4.5. &lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwxrwxrwx &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;169&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; startshard1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;6.7. &lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwxrwxrwx &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;169&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; startshard2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;8.9. &lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwxrwxrwx &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongodb&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;169&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; startshard3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt; 文件中的内容（此处可以选择配置环境变量）1. **&lt;span class=&quot;pln&quot;&gt;startconfig&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;**2.3. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configsvr &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fork &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dbpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;config &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;upgrade&lt;/span&gt;4.5. **&lt;span class=&quot;pln&quot;&gt;startmongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;**6.7. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongos &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fork &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configdb &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;192.168.199.133:20000,192.168.199.134:20000,192.168.199.135:20000&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;8.9. **&lt;span class=&quot;pln&quot;&gt;startshard1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;**10.11. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fork &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shardsvr &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;replSet shard1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;10001&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dbpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;12.13. **&lt;span class=&quot;pln&quot;&gt;startshard2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;**14.15. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fork &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shardsvr &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;replSet shard2 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;10002&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dbpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard2 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;16.17. **&lt;span class=&quot;pln&quot;&gt;startshard3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;**18.19. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fork &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shardsvr &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;replSet shard3 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;10003&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dbpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard3 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shard3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;3.停止均衡器（Disable the Balancer）.连接到mongos,执行脚本1. &lt;span class=&quot;pun&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mongos &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;port &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30000&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//30000为路由器端口&lt;/span&gt;2.3. &lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;stopBalancer&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;检查是否已经完全停止1. &lt;span class=&quot;pln&quot;&gt;use config&lt;/span&gt;2.3. &lt;span class=&quot;kwd&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sh&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;isBalancerRunning&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; print&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;waiting...&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; sleep&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;6. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt; 4.升级分片元数据（配置服务器） 进入mongod节点,运行升级脚本1. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mongo&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongodb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x86_64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3.0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongos &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configdb &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;192.168.199.133:20000,192.168.199.134:20000,192.168.199.135:20000&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;logpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dblog&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;updatemongos&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;—&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;upgrade&lt;/span&gt;查看updatemongos中日志信息，如果输出以下语句，则表示配置服务器升级成功upgrade of configserver to v5 successfulConfig database is atversion v5依次停止旧的配置服务器启动新的配置服务器，备注：升级过程中保至少一台配置服务器正常运转5.升级分片服务（主从节点升级）停止10001的备份服务，启动新服务停止10001的仲裁服务，启动新服务切换10001的主节点到备份服务连接至主节点 使用切换命令1. &lt;span class=&quot;pln&quot;&gt;rs&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;stepDown&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;查看是否切换成功1. &lt;span class=&quot;pln&quot;&gt;rs&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;依次处理10002节点与10003节点WARNING：Do not upgrade mongod instances until after you have upgraded allmongos instances.6.重启主服务，启动Balancer关闭原来的服务，使用新的脚本启动下面的脚本启动Balancer1. &lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;setBalancerState&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;7.检查服务是否正常运转查看版本信息1. &lt;span class=&quot;pln&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;runCommand&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;buildInfo&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;})&lt;/span&gt; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Oracle】利用数据泵迁移数据库，以迁移用户schema为例]]></title>
    <url>%2Ffb09177eaf1586b386fa86c99ee81433.html</url>
    <content type="text"><![CDATA[Oracle数据泵是Oracle提供的更新、更灵活的数据导入、导出工具，数据泵可以用来导出表，表空间，用户Schema等 但也有限制，只能在服务器端进行。一、准备工作1.目标数据库已经安装，源数据库能正常运行，Linux安装Oracle的细节详见《【Oracle】linux下安装Oracle11g数据库》2.查看目标数据库的版本与源数据库的版本，当目标数据的版本高于源数据库的版本时，导出需指定版本号目标数据库的版本信息1. &lt;span class=&quot;pln&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;gt&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; select &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; from v$version&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;2.3. BANNER4. --------------------------------------------------------------------------------5. &lt;span class=&quot;typ&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11g&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Enterprise&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Edition&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt;PL&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;SQL &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt;CORE &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt;TNS &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt;NLSRTL &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;源数据库的版本信息1. &lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11g&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Enterprise&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Edition&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;64bit&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;2. &lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; PL&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;SQL &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;3. &lt;span class=&quot;lit&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;CORE 11.2.0.1.0 Production&quot;&lt;/span&gt;4. &lt;span class=&quot;lit&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; TNS &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bit &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Windows&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;5. &lt;span class=&quot;lit&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; NLSRTL &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;数据库版本一致，可以直接导出，导入二、用数据泵导出数据库1建立保存数据文件的地址 用root新建文件夹，并给oracle用户赋权，备注一，Linux赋权知识详见《【Linux】linux下权限知识整理》 （一般在Linux安装Oracle时必须提前建立Oracle用户）1. [root@localhost data]# mkdir /data/oracle/2. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; chown &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;R oracle&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dba &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;2.登录Oracle，采用主机认证方式1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;oracle@localhost &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;$ sqlplus &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;/as sysdba&#39;&lt;/span&gt;2.3. &lt;span class=&quot;pln&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Plus&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; on &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Wed&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mar&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;08&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2015&lt;/span&gt;4. &lt;span class=&quot;typ&quot;&gt;Copyright&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1982&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2009&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;All&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; rights reserved&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;5. &lt;span class=&quot;typ&quot;&gt;Connected&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; to&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;6. &lt;span class=&quot;typ&quot;&gt;Oracle&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11g&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Enterprise&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Edition&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11.2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Production&lt;/span&gt;7. &lt;span class=&quot;typ&quot;&gt;With&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Partitioning&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; OLAP&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mining&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; and &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Real&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Application&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Testing&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; options&lt;/span&gt;8.9. &lt;span class=&quot;pln&quot;&gt;SQL&amp;gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;3.在数据库服务器上创建DIRECTORY1. &lt;span class=&quot;pln&quot;&gt;create directory dir_dp as &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;/data/oracle&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;4.查询已经创建的目录以及权限1. &lt;span class=&quot;pln&quot;&gt;SELECT PRIVILEGE&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; DIRECTORY_NAME&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; DIRECTORY_PATH &lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt; FROM USER_TAB_PRIVS T&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ALL_DIRECTORIES D &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; WHERE T&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;TABLE_NAME&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(+)&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; D&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;DIRECTORY_NAME &lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; ORDER BY &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;5.按照Schema开始导出，命令如下1. &lt;span class=&quot;pln&quot;&gt;expdp xtbg/xtbg dumpfile =2015-03-05EXP.DMP directory = dir_dp schemas=xtbg LOGFILE=xtbg_expdp.log &lt;/span&gt;二、将*.DMP导入到目标数据库1.建立DIRECTORY步奏同上2.创建表空间1. --2. &lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; XTBG &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Tablespace&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;3. --4. CREATE TABLESPACE XTBG DATAFILE5. &lt;span class=&quot;str&quot;&gt;&#39;/home/oracle/app/oradata/orcl/XTBG_01.DBF&#39;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; SIZE &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;138048K&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; AUTOEXTEND ON NEXT &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;10M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; MAXSIZE &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000M&lt;/span&gt;6. LOGGING7. ONLINE8. EXTENT MANAGEMENT LOCAL AUTOALLOCATE9. &lt;span class=&quot;pln&quot;&gt;BLOCKSIZE &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8K&lt;/span&gt;10. SEGMENT SPACE MANAGEMENT AUTO11. &lt;span class=&quot;pln&quot;&gt;FLASHBACK ON&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;3.创建用户1. &lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; XTBG &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;3. &lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;CREATE USER XTBG&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; IDENTIFIED BY xtbg&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; DEFAULT TABLESPACE XTBG&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; TEMPORARY TABLESPACE TEMP&lt;/span&gt;4.对用户进行赋权1. &lt;span class=&quot;pln&quot;&gt;grant dba&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;connect to xtbg&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;grant read&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;write on directory dir_dp to xtbg&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;5.开始导入1. &lt;span class=&quot;pln&quot;&gt;impdp xtbg&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;xtbg directory&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dir_dp dumpfile&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2015&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span style=&quot;color: #195f91;&quot;&gt;03&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-05&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;EXP&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;DMP schemas&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;xtbg&lt;/span&gt; 版权声明：自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）引用列表：Oracle官网文档 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】Mongodb的联合索引与内嵌索引]]></title>
    <url>%2Fe3-80-90mongodb-e3-80-91mongodb-e7-9a-84-e8-81-94-e5-90-88-e7-b4-a2-e5-bc-95-e4-b8-8e-e5-86-85-e5-b5-8c-e7-b4-a2-e5-bc-95.html</url>
    <content type="text"><![CDATA[【Mongodb】Mongodb的联合索引与内嵌索引 导读： 索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可快速访问数据库表中的特定信息。索引有诸多优点如，通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性； 可以大大加快数据的检索速度，当然使用索引时也存在一些不可避免的问题，本文不在此权衡，下面着重介绍以实验的形式两种常用的常见的索引。 实验条件： 集合中的数据量约500万条集合存储结构 { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “_id” : ObjectId(“54f12a2e46595fd917542d92”), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “code” : “test0”, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “age” : 28, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “dog” : { “name”:”d0”} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}Mongodb的版本为32位linux版必备知识：查询索引 db.users.getIndex();增加索引 db.users.ensureIndex({});删除索引 db.users.dropIndex({});使用索引 db.users.find({}).expalin(); explain会返回查询使用的索引情况，耗时和扫描文档数的统计信息。“cursor”:”BasicCursor”表示没有使用索引。“nscanned”:1 表示查询了多少个文档。“n”:1 表示返回的文档数量。“millis”:0 表示整个查询的耗时。实验论证：1.在联合索引的情况下，查询条件与索引部分相同时索引能否生效2.嵌入文档的索引在查询时能否起到辅助作用 实验步骤一： 1.验证当前集合中的数据量2.不使用索引直接查询，此时的执行计划全表扫描，耗时9223毫秒3.建立联合索引4.查询条件与索引完全相同时进行查询，此时的执行计划开始使用B树索引，此时查询耗时仅为1毫秒5.查询条件与索引部分相同时进行查询，此时的执行计划只要查询中含有任一与索引相同的条件时，联合索引在查询时都会生效实验结论一：在联合索引的情况下，查询条件与索引部分相同时，索引会生效 实验步骤二： 1.不使用索引直接查询，此时的执行计划全表扫描，耗时39062毫秒2.建立内嵌索引3.查询条件与内嵌索引相同时进行查询，此时的执行计划使用B树索引，查询时间为0毫秒实验结论二：嵌入文档的索引在查询时能起到辅助作用 _ 版权声明：自由转载-非商用-衍生-保持署名（创意共享3.0许可证）引用列表：http://www.cnblogs.com/stephen-liu74/archive/2012/08/01/2561557.htmlhttp://docs.mongodb.org/manual/core/query-optimization/_]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【编程语言】避免创建不必要的对象]]></title>
    <url>%2Fe3-80-90-e7-bc-96-e7-a8-8b-e8-af-ad-e8-a8-80-e3-80-91-e9-81-bf-e5-85-8d-e5-88-9b-e5-bb-ba-e4-b8-8d-e5-bf-85-e8-a6-81-e7-9a-84-e5-af-b9-e8-b1-a1.html</url>
    <content type="text"><![CDATA[编程时重用最好能重用对象，而不是每次需要的时候都去创建一个同样功能的新对象，如果对象是不可变的，则它可以始终被重用除了重用那些不可变的对象外，也可以重用那些已知的不会被修改的可变对象，下面举一个常见的例子说明减少创建对象对代码优化的重要性模型说明：其中涉及了可变的Date对象，它的值一旦计算出来就不在改变，下面建立一个模型：其中一个人，并有IsPost90s方法，判断此人是否为90后模型代码：代码片段一：1. &lt;span &gt;/**&lt;/span&gt;2. &lt;span &gt; * 需求：判断此人是否属于属于90后，即出生年在1990年至1999年之间&lt;/span&gt;3. &lt;span &gt; * @author RUJIA_LI&lt;/span&gt;4. &lt;span &gt; *&lt;/span&gt;5. &lt;span &gt; */&lt;/span&gt;6. &lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;class&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Person1&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;{&lt;/span&gt;7. &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;String&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;;&lt;/span&gt;8. &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;;&lt;/span&gt;9. &lt;span &gt; &lt;/span&gt;&lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Person1&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;String&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; birthDate &lt;/span&gt;&lt;span &gt;)&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;{&lt;/span&gt;10. &lt;span &gt; &lt;/span&gt;&lt;span &gt;this&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;name &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;;&lt;/span&gt;11. &lt;span &gt; &lt;/span&gt;&lt;span &gt;this&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;birthDate &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;;&lt;/span&gt;12. &lt;span &gt; &lt;/span&gt;&lt;span &gt;}&lt;/span&gt;13. &lt;span &gt; &lt;/span&gt;&lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;boolean&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;IsPost90s&lt;/span&gt;&lt;span &gt;(){&lt;/span&gt;14. &lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt; cal &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getInstance&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;TimeZone&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTimeZone&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;&quot;GMT&quot;&lt;/span&gt;&lt;span &gt;));&lt;/span&gt;15. &lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;set&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;1990&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;JANUARY&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;1&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;);&lt;/span&gt;16. &lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; startdate &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTime&lt;/span&gt;&lt;span &gt;();&lt;/span&gt;17. &lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;set&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;1999&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;JANUARY&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;1&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;);&lt;/span&gt;18. &lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; enddate &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTime&lt;/span&gt;&lt;span &gt;();&lt;/span&gt;19. &lt;span &gt; &lt;/span&gt;&lt;span &gt;return&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;compareTo&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;startdate&lt;/span&gt;&lt;span &gt;)&amp;gt;=&lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span &gt;birthDate&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;compareTo&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;enddate&lt;/span&gt;&lt;span &gt;)&amp;lt;&lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;;&lt;/span&gt;20. &lt;span &gt; &lt;/span&gt;&lt;span &gt;}&lt;/span&gt; 21. &lt;span &gt;}&lt;/span&gt;IsPost90s()方法每次被调用的时候，都会新建一个Calendar对象，一个TimeZone对象和两个Date对象，这是非常没有意义的下面的版本用了静态初始化器，代码片段二： &lt;span &gt;/**&lt;/span&gt; &lt;span &gt; * 需求：判断此人是否属于属于90后，即出生年在1990年至1999年之间&lt;/span&gt; &lt;span &gt; * @author RUJIA_LI&lt;/span&gt; &lt;span &gt; *&lt;/span&gt; &lt;span &gt; */&lt;/span&gt; &lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;class&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Person2&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;{&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;String&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;static&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;final&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; START_TIME&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;private&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;static&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;final&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; END_TIME&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Person2&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;String&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Date&lt;/span&gt;&lt;span &gt; birthDate &lt;/span&gt;&lt;span &gt;)&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;{&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;this&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;name &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; name&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;this&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;birthDate &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;}&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;static&lt;/span&gt;&lt;span &gt;{&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt; cal &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getInstance&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;TimeZone&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTimeZone&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;&quot;GMT&quot;&lt;/span&gt;&lt;span &gt;));&lt;/span&gt; &lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;set&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;1990&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;JANUARY&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;1&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;);&lt;/span&gt; &lt;span &gt; START_TIME&lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTime&lt;/span&gt;&lt;span &gt;();&lt;/span&gt; &lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;set&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;1999&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;Calendar&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;JANUARY&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;1&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;,&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;);&lt;/span&gt; &lt;span &gt; END_TIME &lt;/span&gt;&lt;span &gt;=&lt;/span&gt;&lt;span &gt; cal&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;getTime&lt;/span&gt;&lt;span &gt;();&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;}&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;public&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;boolean&lt;/span&gt;&lt;span &gt; &lt;/span&gt;&lt;span &gt;IsPost90s&lt;/span&gt;&lt;span &gt;(){&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;return&lt;/span&gt;&lt;span &gt; birthDate&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;compareTo&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;START_TIME&lt;/span&gt;&lt;span &gt;)&amp;gt;=&lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span &gt;birthDate&lt;/span&gt;&lt;span &gt;.&lt;/span&gt;&lt;span &gt;compareTo&lt;/span&gt;&lt;span &gt;(&lt;/span&gt;&lt;span &gt;END_TIME&lt;/span&gt;&lt;span &gt;)&amp;lt;&lt;/span&gt;&lt;span &gt;0&lt;/span&gt;&lt;span &gt;;&lt;/span&gt; &lt;span &gt; &lt;/span&gt;&lt;span &gt;}&lt;/span&gt; &lt;span &gt;}&lt;/span&gt;测试结构：Person1和Person2中的IsPost90s方法分别被调用5000万次执行时间对比： 第一种方式耗时152161毫秒&nbsp;&nbsp; 第二种方式耗时28761毫秒&nbsp;&nbsp;堆栈利用情况：第一种方式堆栈使用情况 第一种方式堆栈使用情况改进后的Person2类在仅在初始化创建Calendar、TimeZone和Date对象一次，而不是每次调用IsPost90s的时候创建这些实例，把START_TIME和END_TIME从局部变量变为final静态域，当做常量处理，从上面的执行时间可以看出减少对象的创建可以大幅度提高性能，从堆栈的使用情况可知，频繁的创建的对象加速的虚拟机的GC速度&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】高性能网站的十大原则，系统拆分]]></title>
    <url>%2F837335d0d798fb1f51576f90057bd463.html</url>
    <content type="text"><![CDATA[导读：技术的进步源于需求的推动，在原始时代，单兵作战的服务器节点很容易满足零星的访问和简单的业务,随着系统业务复杂度增加，访问流量的不断增加，单兵作战的服务器很难招架住千万人的“同时蹂躏”，在此种情形下有以下方案可供选择，A选择性能更加优良的服务器（几乎不可行），B垂直拆分系统，将不同的模块（业务）分散到不同的机器上。C水平拓展，将系统整体分担到不同的机器上，D.同时运用垂直拆分与水平拓展，用某社交网站的架构图展示如下：&nbsp;&nbsp;本文旨在到讨论垂直拆分系统，所涉及的问题的如下1.为什么需要系统拆分？2.系统拆分的一般原则3.系统拆分所面临的额外的问题&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;3.1系统拆分后的数据同步问题&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;3.2查分后系统之间的通信问题，接口标准化&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;3.3系统拆分后单点的问题4.浅谈数据库拆分的策略&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4.1关系型数据库的拆分&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4.2非关系型数据库的拆分1.为什么需要系统拆分？&nbsp; 性能考虑 ：一个大的系统，往往其中的某个部分，承担了很大的并发压力，或者逻辑运算特别复杂，因此成为系统的性能瓶颈&nbsp;，这时就可以考虑将这部分独立出来，从而实现单独部署，再通过负载均衡等手段，来解决性能的问题&nbsp;&nbsp; 逻辑清晰&nbsp;：根据业务上、流程上的不同环节，将整个系统拆分为不同的子系统，在逻辑上会更加清晰，从而更容易在架构上说清楚，或者进一步做优化&nbsp;&nbsp; 分而治之 ：减少系统之间的耦合，一个模块出问题，不影响其他模块的运行，同时在开发时可以减少代码冲突&nbsp; 流量限定：将大流量的业务单独剥离出来，提升系统的可控制性&nbsp; 便于管理：随着业务的发展，模块之间的耦合性越来越强 ；开发人员越来越多，相互之间代码版本也难以管理2.系统拆分的一般原则&nbsp; &nbsp;按照业务应用拆分：一般的企业内部都是按照业务增长方式比较多，所以随着业务的增加，将系统进行拆分的是比较多的，也就是将一个较大的系统拆分为多个小的系统&nbsp; &nbsp;按照系统瓶颈拆分：当系统做庞大后，不不同的功能点会遇到不同的瓶颈，如安全瓶颈，性能瓶颈等，通过拆分可以解决此类问题&nbsp; &nbsp;单节点机器的限制：单个节点机器的CPU处理能力，硬盘存储有限，例如：当单节点上的硬盘容量不足时必须进行转移处理，如采用部分转移，拆分则是一个良策3.系统拆分面临的额外的问题&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.1系统拆分后的数据同步问题&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;业务拆分后最好能同时进行数据拆分，减少数据之间的耦合，降低数据层面出问题的可能，一旦数据被拆分，则会面临数据之间的同步的问题，如在京东上下单后，一部分数据流入支付入口，另一部分数据流入&nbsp; &nbsp;物流入口，处理数据同步问题从根本上讲有两种解决方案，一种是时钟同步，另一种是条件触发,条件触发可以从数据库层面考虑（触发器，数据库链路），也可以从应用的角度上去做，如下图所示&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.2查分后系统之间的通信问题，接口标准化&nbsp;&nbsp;&nbsp;当系统被拆分后，面临的另一个问题就是以前是属于一个工程内部的系统，相互之间的调用就可以直接调用到，现在很麻烦，要两边来做接口，接口还得联调，尤其是两个厂商之间来联调尤其繁琐，无规矩不成方圆，&nbsp; &nbsp;接口之间尽量标准化，这样在后期的维护可以减少不必要的麻烦，服务器之前常用的通信方式，有以下几种webservice，java RMI ,或者直接使用socket,下面将一一分解&nbsp; &nbsp;有关通信就说到早期的socket，这个socket虽然是最古老的技术，不过它也算是目前所有网络技术衍生的基石，网络的交互的不断优化过程就是socket特征不断变化的过程。说到socket就是编写程序比较麻烦，&nbsp; &nbsp; 双方调用和接受都需要编写 &nbsp; 单独程序去通信，要求传输的内容都可以被序列化，写的一方有点类似于写文件，读的一方有点类似读文件，不过它也是使用IO本身的一种方法去通信；很多程序员初手在调用完了也会搞忘把socket关掉。&nbsp; &nbsp; 面对java想要把底层封装的，而且尽量减少程序员的错误，所以RMI诞生了，远程方法调用诞生了，RMI是jvm自己封装的一种远程方法调用的协议，中间通过对象序列化来完成，调用方需要有远程的接口，由于RMI本身调用过程中配置 比较麻烦，但是又有了这种技术，于是EJB诞生了，EJB在RMI的基础上衍生出标准化的分布式编程模型，不过它都是基于RMI来编写的，主要目的是将业务和VIEW分解开，不过它是物理上将其分开了，在部署和调试程序上相对比较困难，最头痛的就是RMI里头在调用完后会自己做一个System.gc()方法，将会导致Full GC，于此同时衍生出不同厂商不同系统的通信方法也是沿用EJB，是的各个工程里头都有和自己不想管的系统的代码和jar包，Perm区域增加的开销暂时忽略掉，不过系统的移植性和产品化就出现了很多困难（如果在另一个地方要发布同样的系统，但是这个系统中有很多外部调用需要，要么最后工程鱼龙混杂，要么要把这些东西分解出来是很困难的事情，甚至于会报一些诡异的错误）&nbsp; &nbsp; 后来基于RPC的webservice出来了，它跨语言，因为它传递过程中你可以认为它不是传递对象（后来EJB也把它融进去了），不过我们很多时候还是喜欢用spring来集成它，高版本的webservice可以通过注解完成大部分的工作，不过tomcat发布这个玩意一直不是很好用；另外Spring里头也提供了对于RMI本身的封装的支持，以及spring hessian也是非常不错的交互框架，而且spring是轻量级的，越来越多的人开始选择spring了，因为EJB很多功能它都有，没有的大部分东西也不想要，用了EJB还有各种各样的问题。&nbsp; &nbsp; 最最简单的交互方法，HttpClient，这种是apache组织提供的一种非常轻量级的交互方法，其实也是基于socket写的，因为浏览器本身和服务器交互也是一种socket，只是建立了协议包头和一些短连接机制；所以HttpClient就是使用socket模拟的一个浏览器客户端发起的一次提交操作，可以发起Get和POST的请求，也可以控制参数的传递的字符集等等，传递和结果信息由双方决定；服务方只需要通过正常的response输出数据即可，只是这个时候不是输出一个页面，而是输出一些客户端可以被解释的数据，如json结构或xml结构的字符串信息。&nbsp; &nbsp; 总之，系统一旦拆分，通信是避免不了，从这里也可以看出，并不是系统想怎么拆分就怎么拆分的，要尽量减少相互之间的通信，就需要了解系统，做到系统的低耦合、高内聚，减少外部依赖，不然系统大部分时间就在通信了，没有做其他的事情，不过也不排除有这种情况，那就是有些系统是专门用来做通信的，这种系统可以例外，它处理的核心就是通信处理，做中间转换。其余的业务系统尽量做到减少通信的模块数量。&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3.3系统拆分后单点的问题&nbsp; &nbsp; &nbsp;关于系统拆分后的单点问题，下面的文章会详细讲解4.浅谈数据库拆分的策略&nbsp; &nbsp; &nbsp; 首先，前端有压力，数据库自然也有，而且数据库压力肯定比前端压力会更多（当然前端可以采用很多缓存技术来环节数据库的压力），数据库的复杂性比前端要更多，因为它是数据的核心，需要对数据库的安全、一致性等做保障，鉴于以上原因，需要对需要对数据库进行拆分，下面对数据库拆分进行简单的介绍&nbsp; &nbsp; &nbsp;&nbsp;4.1关系型数据库的拆分&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4.1.1数据跟随业务拆分，每个服务单独使用一个数据库Schema(垂直拆分）&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4.1.2简单的表分区，提高数据库查询的性能&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4.1.2如果数据量很大，数据库扛不住，还可能需要做缓存&amp;数据库的水平拆分（相同的数据库分解到多个物理库中）&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;传统应用中的range分区，如果用在分布式上，就是放在多个主机上的多个库上的多个表，这种用于自动增长列或时间上比较多，需要提前预知数据增长量，假设数据平稳增长&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A中存储3个月的数据就达到上限，第四个月时开始添加B，以后几个月的几个月的数据全部落到B中，这种方式比较容易理解，&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;但是存在一个比较严重的问题，&nbsp;这种拆分Insert操作始终落在最后一台机器的最后一个表的最后一个block上，如果每秒有几千个insert和update、delete这样做肯定是不行的，热块将严重影响数据库的性能&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;为了解决热块的问题，开始对数据库进行负载均衡，负载均衡最常用的策略就是hash算法，hash算法最简单的就是求模，如将一个表拆分为100个表，那么按照绝大部分情况按照某个编号去求模得到的是0-99之间的数据，这一百个表编号为0-99，分别对应存储即可，无论是自动增长还是非自动增长也不太可能落在同一个表上面去；而对于某些热点用户，如果按照用户拆分，这些热点用户的访问就会被反复访问到同一个表，比如类似微博这种东西，也许某个热门人物的他的好友个数就会非常多，可能会导致某个表非常大，所以为了缓解这种问题，我们会再做二次hash；而对于一些非数字类的数据，我们一般会采取对其前几个字符的ascii或者hash值等取出来做操作，具体看实际情况而定；&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;4.2非关系型数据库的拆分&nbsp; &nbsp; &nbsp; &nbsp;非关系型的数据库的拆分以mongodb为代表，详细请参考 &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; 版权声明：文章中的观点或直接饮用，均会在下面列出http://www.verydemo.com/demo_c161_i59302.htmlhttp://www.iteye.com/topic/1128856http://www.iteye.com/problems/99893 http://blog.csdn.net/tujiyue/article/details/7222309&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Oracle】查询锁表的用户并处理]]></title>
    <url>%2F99cbe0dfe754af1522fea6f3a61ada14.html</url>
    <content type="text"><![CDATA[–锁表查询1. &lt;span class=&quot;pln&quot;&gt;SQLSELECT object_name&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; machine&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; s&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; s&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;serial&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;# &lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;FROM gv$locked_object l&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; dba_objects o&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; gv$session s &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;WHERE l&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;object_id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt; =&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; o&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;object_id &lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;AND l&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;session_id &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; s&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;找到被锁定的表，解锁–释放SESSION SQL:1. &lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;alter system kill session &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;sid, serial#&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;ALTER system kill session &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;23, 1647&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】Mongodb查询优化一合理利用片键]]></title>
    <url>%2F2f00dfaf87bbfa2a5ee961ec223db126.html</url>
    <content type="text"><![CDATA[指标项 具体说明 当前数据量 单个集合100G 优化结果 目前查询平均相应时间小于20s 最优查询方式 切换到需要查询的单位，选择时间间隔，输入其他查询条件 必要说明 1.查询时间间隔越小，速度越快，2.查询同一家单位首次查询速度最慢，查询次数越多，速度越快&nbsp; &nbsp; &nbsp;&nbsp;3.数据库多线程每个15秒批量插入一次，在数据库插入的同一时间点去查询，速度会较慢 优化过程 1.去除所有模糊查询【全表扫描】；2.优化查询json串，【去除KEY中双引号，速度有明显提升，原因不明】，3.利用联合索引中单位ID字段并与其他字段组合【B树扫描】，4.利用索引总按照时间倒序的规律【B树扫描】 1.查询最优图示：2.生产环境10点左右查询，时间显示3.查询JSON字符串优化前后对比图4.生产环境优化前后，平均时间对比 来自为知笔记(Wiz) ### 附件列表 [C_K4U64E1]H{HO`{(W(W{A.jpg [C_K4U64E1]H{HO`{(W(W{A_2.jpg 0N9$D3%1Y~KVJ2R$GDG@)ZU.png 111.bmp 3.bmp [FH@05QHD)9OIT_9CGCFO[9.jpg](https://rjgeek.github.io/images/2015/12/wpid-12b45b80b162bb572027a83698960c26_FH@05QHD9OIT_9CGCFO9.jpg) * [FH@05QHD)9OIT_9CGCFO9_2.jpg* P`~D22H4YKSC$8Y00TLWV{U.png &nbsp;]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Oracle】【Sql】视图的建立与dml]]></title>
    <url>%2F5907e39990a954e2e85959b50b1bca17.html</url>
    <content type="text"><![CDATA[1.测试表表结构如下 2.表中数据如下3.开始实验视图使用中的一些注意事项&nbsp;&nbsp;实验一：&nbsp;&nbsp;结论：建立视图添加with cheak option 的约束后，对视图进行dml操作时，会在where后面的条件记性校验实验二：结论：基表中含有非空列，所建的视图不包含此非空列，无法对此视图进行插入操作实验三：结论：建立视图时，不能出现含有分组函数总结以上：Rules for Performing DML Operations on a ViewYou cannot add data through a view if the view includes:Group functionsA GROUP BY clauseThe DISTINCT keywordThe pseudo column ROWNUM keywordColumns defined by expressionsNOT NULL columns in the base tables that are not selected by the view(以上内容出自官网文档)&nbsp;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Linux】手动释放linux内存]]></title>
    <url>%2Fbd77c13f2f0aa9c920b09fa28203a6c9.html</url>
    <content type="text"><![CDATA[1.查看当前系统内存使用情况2.手动执行sync命令sync 命令运行 sync 子例程。如果必须停止系统，则运行sync 命令以确保文件系统的完整性。sync 命令将所有未写的系统缓冲区写到磁盘中，包含已修改的 i-node、已延迟的块 I/O 和读写映射文件3.修改/proc/sys/vm/drop_caches/proc是一个虚拟文件系统，我们可以通过对它的读写操作做为与kernel实体间进行通信的一种手段。也就是说可以通过修改/proc中的文件，来对当前kernel的行为做出调整。那么我们可以通过调整/proc/sys/vm/drop_caches来释放内存。操作如下：4.再次去查看内存占用情况，cached明显减少，释放成功 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Linux】linux下权限知识整理]]></title>
    <url>%2Ffdb751020f885c25b4a7cf224541d33c.html</url>
    <content type="text"><![CDATA[导读：&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;权限查看&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;权限更改命令 chmod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;权限更改命令 chown1.权限查看查看左1的权限d&nbsp;rwxr-xr-x &nbsp; &nbsp;d开头表示文件夹- &nbsp;rwxr-xr-x &nbsp; &nbsp; -开头表示普通文件绿色表示当前用户的权限，如上，当前用户的权限为可读，可写，可执行蓝色表示与当前用户同组的用户 &nbsp; 如上同组用户的权限为 可读，可执行黄色表示其他用户，如上，其他用户的权限为，可读，可执行2.chmod使用说明 &nbsp;&nbsp;参数&nbsp;:&nbsp;mode&nbsp;:&nbsp;权限设定字串，格式如下&nbsp;:&nbsp;[ugoa…][[+-=][rwxX]…][,…]，其中&nbsp;u&nbsp;表示该档案的拥有者，g&nbsp;表示与该档案的拥有者属于同一个群体(group)者，o&nbsp;表示其他以外的人，a&nbsp;表示这三者皆是。&nbsp;+&nbsp;表示增加权限、-&nbsp;表示取消权限、=&nbsp;表示唯一设定权限。&nbsp;r&nbsp;表示可读取，w&nbsp;表示可写入，x&nbsp;表示可执行，X&nbsp;表示只有当该档案是个子目录或者该档案已经被设定过为可执行。&nbsp;-c&nbsp;:&nbsp;若该档案权限确实已经更改，才显示其更改动作&nbsp;-f&nbsp;:&nbsp;若该档案权限无法被更改也不要显示错误讯息&nbsp;-v&nbsp;:&nbsp;显示权限变更的详细资料&nbsp;-R&nbsp;:&nbsp;对目前目录下的所有档案与子目录进行相同的权限变更(即以递回的方式逐个变更)&nbsp;–help&nbsp;:&nbsp;显示辅助说明&nbsp;–version&nbsp;:&nbsp;显示版本&nbsp;0 —&nbsp;1 –x&nbsp;2 -w-&nbsp;3 -wx&nbsp;4 r–&nbsp;5 r-x&nbsp;6 rw-&nbsp;7 rwx例子：使file1有对于所有用户有效1. &lt;span class=&quot;pln&quot;&gt;chmod ugo &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; r file1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh &lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;chmod a&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;r file1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;444&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; file1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sh //&lt;/span&gt;语法为：chmod&nbsp;abc&nbsp;file&nbsp;,其中a,b,c各为一个数字，分别表示User、Group、及Other的权限。&nbsp;关于数据的含义请看上面说明将档案&nbsp;file1.sh 与&nbsp;file2.sh 设为该档案拥有者，与其所属同一个群体者可写入，但其他以外的人则不可写入&nbsp;:&nbsp;1. &lt;span class=&quot;pln&quot;&gt;chmod ug&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;w file1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;txt file2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;txt &lt;/span&gt;将目前目录下所有用户都可写1. &lt;span class=&quot;pln&quot;&gt;chmod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;R a&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;w &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;chmod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;R &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;444&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;其他例子：1. &lt;span class=&quot;pln&quot;&gt;$ chmod u&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;给&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;的属主增加执行权限&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;$ chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;751&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;给&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;的属主分配读、写、执行(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)的权限，给&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;的所在组分配读、执行(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)的权限，给其他用户分配执行(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)的权限&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;$ chmod u&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rwx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;rx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;x file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;上例的另一种形式&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;$ chmod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;r file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;为所有用户分配读权限&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;$ chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;444&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;同上例&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt;$ chmod a&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;wx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;r file &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;同上例&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt;$ chmod &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;R u&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;r directory &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;递归地给&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;目录下所有文件和子目录的属主分配读的权限&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt;$ chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4755&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;[&lt;span class=&quot;pun&quot;&gt;设置用&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，给属主分配读、写和执行权限，给组和其他用户分配读、执行的权限。&lt;/span&gt;](http://en.wikipedia.org/wiki/Sticky_bit)3&nbsp;权限更改命令 chownchown [-cfhvR] [–help] [–version] user[:group] file…&nbsp;user : 新的档案拥有者的使用者 ID group : 新的档案拥有者的使用者群体(group) -c : 若该档案拥有者确实已经更改，才显示其更改动作 -f : 若该档案拥有者无法被更改也不要显示错误讯息 -h : 只对于连结(link)进行变更，而非该 link 真正指向的档案 -v : 显示拥有者变更的详细资料 -R : 对目前目录下的所有档案与子目录进行相同的拥有者变更(即以递回的方式逐个变更) –help : 显示辅助说明 –version : 显示版本1. &lt;span class=&quot;pln&quot;&gt;chown mail&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mail log2012&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Linux】linux常用缩写含义]]></title>
    <url>%2F2e1c3eb3f9248952b33b5780b356d5c3.html</url>
    <content type="text"><![CDATA[Basicd = directory$-$ = regular filel = symbolic links = Unix domain socketp = named pipec = character device fileb = block device filer = read permissionw = write permissionx = execute permission$-$ = no permission Which user?u user/ownerg groupo othera all What to do?$+$ add this permission$-$ remove this permission$=$ set exactly this permission Which permissions?r readw writex execute4 = read (r)2 = write (w)1 = execute (x)0 = no permission (-) Which number?0 —1 –x2 -w-3 -wx4 r–5 r-x6 rw-7 rwx Referencehttp://www.cnblogs.com/computer/archive/2010/07/20/1781091.html]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Linux】给虚拟机上的LINUX拓展存储]]></title>
    <url>%2Fc309d07117e8340a6343271615731936.html</url>
    <content type="text"><![CDATA[导读：A.给虚拟机添加硬盘 &nbsp;B.拓展虚拟机的存储容量1 &lt;span style=”font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-font-kerning:0pt”&gt;关闭虚拟机，添加磁盘。 1**、选择“VM”—-“setting”并打开，将光标定位在hard Disk这一选项，然后点击下方的Add按钮** 2**、点击next，执行下一个步骤** &nbsp; 3**、根据提示，创建一个虚拟的磁盘，并点击下一步** &nbsp;**** &nbsp; &nbsp;4**、按照默认的，选择SCSI格式的磁盘即可，点击next执行下一步** &nbsp; &nbsp;名称默认。 5**、按照默认的点击下一步即可完成虚拟磁盘的添加** &nbsp; &nbsp;我添加了三块盘。 2 &lt;span style=”font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-font-kerning:0pt”&gt;格式化磁盘。 1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; **fdisk **&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;**-**&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;**l** //查看&lt;/span&gt;2.3. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;19.3&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;19327352832&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;4.5. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;6.7. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;8.9. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt;10.11. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;104391&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;12.13. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda2 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;18763920&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8e&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; LVM&lt;/span&gt;14.15. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;16.17. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;18.19. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;20.21. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb doesn&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;t contain a valid partition table&lt;/span&gt;22.23. &lt;span class=&quot;str&quot;&gt;Disk /dev/sdc: 21.4 GB, 21474836480 bytes&lt;/span&gt;24.25. &lt;span class=&quot;str&quot;&gt;255 heads, 63 sectors/track, 2610 cylinders&lt;/span&gt;26.27. &lt;span class=&quot;str&quot;&gt;Units = cylinders of 16065 * 512 = 8225280 bytes&lt;/span&gt;28.29. &lt;span class=&quot;str&quot;&gt;Disk /dev/sdc doesn&#39;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;t contain a valid partition table&lt;/span&gt;30.31. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdd&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;32.33. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;34.35. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;36.37. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdd doesn&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;t contain a valid partition table&lt;/span&gt;开始格式化1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; fdisk &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb&lt;/span&gt;2.3. &lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; contains neither a valid DOS partition table&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; nor &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Sun&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; SGI or OSF disklabel&lt;/span&gt;4.5. &lt;span class=&quot;typ&quot;&gt;Building&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a new DOS disklabel&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Changes&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; will remain &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; memory only&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;6.7. &lt;span class=&quot;kwd&quot;&gt;until&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; you decide to write them&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; that&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; of course&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the previous&lt;/span&gt;8.9. &lt;span class=&quot;pln&quot;&gt;content won&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;t be recoverable.&lt;/span&gt;10.11. &lt;span class=&quot;str&quot;&gt;The number of cylinders for this disk is set to 2610.&lt;/span&gt;12.13. &lt;span class=&quot;str&quot;&gt;There is nothing wrong with that, but this is larger than 1024,&lt;/span&gt;14.15. &lt;span class=&quot;str&quot;&gt;and could in certain setups cause problems with:&lt;/span&gt;16.17. &lt;span class=&quot;str&quot;&gt;1) software that runs at boot time (e.g., old versions of LILO)&lt;/span&gt;18.19. &lt;span class=&quot;str&quot;&gt;2) booting and partitioning software from other OSs&lt;/span&gt;20.21. &lt;span class=&quot;str&quot;&gt; (e.g., DOS FDISK, OS/2 FDISK)&lt;/span&gt;22.23. &lt;span class=&quot;str&quot;&gt;Warning: invalid flag 0x0000 of partition table 4 will be corrected by w(rite)&lt;/span&gt;24.25.26. &lt;span class=&quot;str&quot;&gt;Command (m for help):&lt;/span&gt;27.28. &lt;span class=&quot;str&quot;&gt;Command (m for help): m&lt;/span&gt;29.30. &lt;span class=&quot;str&quot;&gt;Command action&lt;/span&gt;31.32. &lt;span class=&quot;str&quot;&gt; a toggle a bootable flag&lt;/span&gt;33.34. &lt;span class=&quot;str&quot;&gt; b edit bsd disklabel&lt;/span&gt;35.36. &lt;span class=&quot;str&quot;&gt; c toggle the dos compatibility flag&lt;/span&gt;37.38. &lt;span class=&quot;str&quot;&gt; d delete a partition&lt;/span&gt;39.40. &lt;span class=&quot;str&quot;&gt; l list known partition types&lt;/span&gt;41.42. &lt;span class=&quot;str&quot;&gt; m print this menu&lt;/span&gt;43.44. &lt;span class=&quot;str&quot;&gt; n add a new partition&lt;/span&gt;45.46. &lt;span class=&quot;str&quot;&gt; o create a new empty DOS partition table&lt;/span&gt;47.48. &lt;span class=&quot;str&quot;&gt; p print the partition table&lt;/span&gt;49.50. &lt;span class=&quot;str&quot;&gt; q quit without saving changes&lt;/span&gt;51.52. &lt;span class=&quot;str&quot;&gt; s create a new empty Sun disklabel&lt;/span&gt;53.54. &lt;span class=&quot;str&quot;&gt; t change a partition&#39;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;s system id&lt;/span&gt;55.56. &lt;span class=&quot;pln&quot;&gt; u change display&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;entry units&lt;/span&gt;57.58. &lt;span class=&quot;pln&quot;&gt; v verify the partition table&lt;/span&gt;59.60. &lt;span class=&quot;pln&quot;&gt; w write table to disk and exit&lt;/span&gt;61.62. &lt;span class=&quot;pln&quot;&gt; x extra functionality &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;experts only&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;63.64. &lt;span class=&quot;typ&quot;&gt;Command&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;m &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; help&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; **n**&lt;/span&gt;65.66. &lt;span class=&quot;typ&quot;&gt;Command&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; action&lt;/span&gt;67.68. &lt;span class=&quot;pln&quot;&gt; e extended&lt;/span&gt;69.70. &lt;span class=&quot;pln&quot;&gt; p primary partition &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)** **&lt;/span&gt;p71.72.73. &lt;span class=&quot;typ&quot;&gt;Partition&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; number &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;**1**&lt;/span&gt;74.75. &lt;span class=&quot;typ&quot;&gt;First&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinder &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; default &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;76.77. &lt;span class=&quot;typ&quot;&gt;Using&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; default value &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;78.79. &lt;span class=&quot;typ&quot;&gt;Last&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinder or &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;size or &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sizeM or &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sizeK &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; default &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;80.81. &lt;span class=&quot;typ&quot;&gt;Using&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; default value &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;82.83. &lt;span class=&quot;typ&quot;&gt;Command&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;m &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; help&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;** w**&lt;/span&gt;84.85. &lt;span class=&quot;typ&quot;&gt;The&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; partition table has been altered&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;!&lt;/span&gt;86.87. &lt;span class=&quot;typ&quot;&gt;Calling&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ioctl&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; to re&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;read partition table&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;88.89. &lt;span class=&quot;typ&quot;&gt;Syncing&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; disks&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; fdisk &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;l //再次查看&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;19.3&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;19327352832&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt; &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;104391&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt; &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda2 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;18763920&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8e&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; LVM&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt; &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20964793&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt; &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdc doesn&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;t contain a valid partition table&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;Disk /dev/sdd: 21.4 GB, 21474836480 bytes&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;255 heads, 63 sectors/track, 2610 cylinders&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;Units = cylinders of 16065 * 512 = 8225280 bytes&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;Disk /dev/sdd doesn&#39;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;t contain a valid partition table&lt;/span&gt; 3 &lt;span style=”font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-font-kerning:0pt”&gt;挂载磁盘。 1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mkfs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;t ext3 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb1&lt;/span&gt;2.3. &lt;span class=&quot;pln&quot;&gt;mke2fs &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.39&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;May&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2006&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;4.5. &lt;span class=&quot;typ&quot;&gt;Filesystem&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; label&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;6.7. &lt;span class=&quot;pln&quot;&gt;OS type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;8.9. &lt;span class=&quot;typ&quot;&gt;Block&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; size&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;10.11. &lt;span class=&quot;typ&quot;&gt;Fragment&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; size&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;12.13. &lt;span class=&quot;lit&quot;&gt;2621440&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; inodes&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;5241198&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; blocks&lt;/span&gt;14.15. &lt;span class=&quot;lit&quot;&gt;262059&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; blocks &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;5.00&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; reserved &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the super user&lt;/span&gt;16.17. &lt;span class=&quot;typ&quot;&gt;First&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; data block&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;18.19. &lt;span class=&quot;typ&quot;&gt;Maximum&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; filesystem blocks&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;20.21. &lt;span class=&quot;lit&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; block groups&lt;/span&gt;22.23. &lt;span class=&quot;lit&quot;&gt;32768&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; blocks per group&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;32768&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; fragments per group&lt;/span&gt;24.25. &lt;span class=&quot;lit&quot;&gt;16384&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; inodes per group&lt;/span&gt;26.27. &lt;span class=&quot;typ&quot;&gt;Superblock&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; backups stored on blocks&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;28.29. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;32768&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;98304&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;163840&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;229376&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;294912&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;819200&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;884736&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1605632&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2654208&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;30.31. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4096000&lt;/span&gt;32.33. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;34.35. &lt;span class=&quot;typ&quot;&gt;Writing&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; inode tables&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;36.37. &lt;span class=&quot;typ&quot;&gt;Creating&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; journal &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;32768&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; blocks&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;done&lt;/span&gt;38.39. &lt;span class=&quot;typ&quot;&gt;Writing&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; superblocks and filesystem accounting information&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;done&lt;/span&gt;40.41. &lt;span class=&quot;typ&quot;&gt;This&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; filesystem will be automatically checked every &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mounts or&lt;/span&gt;42.43. &lt;span class=&quot;lit&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; days&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; whichever comes first&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Use&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; tune2fs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;c or &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;i to override&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;修改配置文件，启动自动挂载1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; vi &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;etc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;fsta&lt;/span&gt;2.3. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;VolGroup00&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;LogVol00&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ext3 defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;4.5. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disk2 ext3 defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;6.7. &lt;span class=&quot;pln&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;boot &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;boot ext3 defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;8.9. &lt;span class=&quot;pln&quot;&gt;tmpfs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shm tmpfs defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;10.11. &lt;span class=&quot;pln&quot;&gt;devpts &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;pts devpts gid&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;620&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;12.13. &lt;span class=&quot;pln&quot;&gt;sysfs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sys sysfs defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;14.15. &lt;span class=&quot;pln&quot;&gt;proc &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;proc proc defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;16.17. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;VolGroup00&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;LogVol01&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; swap swap defaults &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;18.19. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cd &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;20.21. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mkdir &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disk2&lt;/span&gt;22.23. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mount /dev/sdb1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disk2 //将 &lt;/span&gt;/dev/sdb1挂载在disk2下 24.25. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; df &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;h //查看磁盘占用情况&lt;/span&gt;26.27. &lt;span class=&quot;typ&quot;&gt;Filesystem&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Used&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Avail&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Use&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Mounted&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; on&lt;/span&gt;28.29. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mapper&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;VolGroup00&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;LogVol00&lt;/span&gt;30.31. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;17G&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;11G&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;5.5G&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;66&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;32.33. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;99M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;12M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;82M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;boot&lt;/span&gt;34.35. &lt;span class=&quot;pln&quot;&gt;tmpfs &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;506M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;506M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;shm&lt;/span&gt;36.37. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20G&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;173M&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;19G&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disk2&lt;/span&gt; &lt;span style=”font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri”&gt;如何扩虚拟机大小： 先power off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@gc1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; fdisk &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;l&lt;/span&gt;2.3.4. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;32.2&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;32212254720&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;5.6. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;3916&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;7.8. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;9.10.11. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt;12.13. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda1 &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;104391&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;14.15. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sda2 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;18763920&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8e&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; LVM&lt;/span&gt;16.17. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;18.19. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;20.21. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;22.23. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;24.25. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;26.27. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt;28.29. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdb1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20964793&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;30.31. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;32.33. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;34.35. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;36.37. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;38.39. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;40.41. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt;42.43. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdc1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20964793&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt;44.45. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;46.47. &lt;span class=&quot;typ&quot;&gt;Disk&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdd&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21.4&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; GB&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;21474836480&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;48.49. &lt;span class=&quot;lit&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; heads&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; sectors&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders&lt;/span&gt;50.51. &lt;span class=&quot;typ&quot;&gt;Units&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; cylinders of &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16065&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;8225280&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;52.53. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;54.55. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Boot&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Blocks&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;System&lt;/span&gt;56.57. &lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sdd1 &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2610&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20964793&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Linux&lt;/span&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Weblogic】32位redhat6系统安装weblogic]]></title>
    <url>%2F59711ebb77f1c5fa569d58136b9752f9.html</url>
    <content type="text"><![CDATA[1.创建weblogic用户 用root用户登入服务器，进行如下操作：#groupadd-g 600 weblogic （创建weblogic组并设置组id为600）#useradd-u 600 -g 600 weblogic （创建用户id为600的weblogic用户,并将用户添加到id为600的组中）#passwd weblogic（设置weblogic密码）2.配置weblogic用户下的jdk#su- weblogic （切换到weblogic用户）$vi~/.bash_profile （编辑用户环境变量文件）按i键，进入编辑模式，在最后面加入 JDK环境变量 按ESC键，退出编辑模式，输入命令:wq保存退出。检查配置是否生效。$source~/.bash_profile$java-version如果看到JVM版本及相关信息，即环境变量配置生效3.安装前的准备工作（上传与权限变更）使用weblogic用户将weblogic11g安装包wls11gR11036_generic.jar上传至应用服务器/u01/app目录下，如下图所示使用chmod命令修改weblogic安装包可执行权限,如下图：4.执行weblogic安装程序使用可视化工具(例如：Xmanager、VNC)连接到服务器，打开命令操作界面，用weblogic用户执行如下命令进行weblogic安装。（注意：如果执行命令无法进入图形界面，请先使用root用户，执行xhost+命令，然后重开命令窗口，执行weblogic安装命令）$java -jar /u01/app/wls11gR11036_generic.jar 安装界面，点击next，执行下一步l 选择程序安装目录(可以自定义安装目录，这里我们自定义安装到/u01/weblogic目录下)，点击next，执行下一步l 不设置邮箱信息，点击next，弹出确认框后点击yesl 弹出确认框后点击yesl 取消选择框，点击continue，执行下一步l 默认安装即可，点击next，执行下一步l 选择jdk，默认为环境变量配置的JDK，点击next，执行下一步l 选择程序安装目录，默认即可，点击next，执行下一步l 安装信息确认界面，点击next，执行安装l 安装进度显示界面，安装完成后点击done，完成安装5.创建weblogic域&nbsp;1) **启动安装命令Linux系统：用weblogic用户执行 /u01/weblogic/Oracle/Middleware/wlserver_10.3/common/bin下的config.sh$cd /u01/weblogic/Oracle/Middleware/wlserver_10.3/common/bin$./config.sh接受默认设置，点击“Next”接受默认设置，点击“Next” 修改路径和域名点击NEXT 2) 设置console**登入的用户名及密码注意：如果此处不能填用户名和密码，把语言切换成英文后，重新创建域，如下图所示： 密码：weblogic1，点击“Next”3) **选择安装模式及**JDK此处我们选择生产模式及JDK1.6.0_45进行部署。4) **选择服务配置设置选择“Administration Server”，点击“Next”。 5) 设置console**信息Listenaddress:localhost （填写locahost或者服务器IP）Listen port:7001 (控制台的监听端口，默认7001，也可自行设置)点击“Next”，继续。点击“Create”，进行域创建。点击“Done”完成域创建。6.配置weblogic的密码服务a.创建boot.properties文件为使各weblogic服务启动时不必每次都输入控制台的用户名和密码，故须设置weblogic的boot文件，让服务启动时自动填充用户名、密码。具体操作如下：使用weblogic账户登录服务器，进入weblogic域创建boot.properties文件$cd /u01/weblogic/Oracle/Middleware/user_projects/domains/base_domain$vi boot.properties按i键进入编辑模式，输入用户名和密码例如：username=weblogicpassword=weblogic1按ESC退出编辑模式，输入:wq进行保存。b.修改weblogic11g 域下的/bin/setDomainEnv.sh文件### 由于weblogic 11g默认的boot文件路径是在各应用服务的文件夹下的security目录下，为使同一个weblogic域下各个应用服务共用同一个boot文件而不必为每个应用服务创建一个boot文件，故须修改setDomainEnv.sh文件，设置默认的boot文件读取路径。$cd /u01/weblogic/Oracle/Middleware/user_projects/domains/base_domain/bin$vi setDomainEnv.sh将下列值JAVA_OPTIONS=”${JAVA_OPTIONS}”export JAVA_OPTIONS# SET THE CLASSPATH修改为JAVA_OPTIONS=”${JAVA_OPTIONS}-Dweblogic.system.BootIdentityFile=${DOMAIN_HOME}/boot.properties”export JAVA_OPTIONS# SET THE CLASSPATH7.安装成功的验证（启动weblogic控制台）使用weblogic用户登录服务器，进入weblogic安装域下的bin目录$cd /u01/weblogic/Oracle/Middleware/user_projects/domains/base_domain/bin用nohup在后台启动，并制定输出日志路径$nohup ./startWebLogic.sh &gt; startWebLogic.log &amp; tail –f/app/logs/startWebLogic.log查看输出日志，如果看到Running Mode则证明控制台启动成功。 &nbsp;来自为知笔记(Wiz)]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Weblogic</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Memcache】32位redhat6系统安装memcache]]></title>
    <url>%2F7770dc7201024befdd6b5698df1d8280.html</url>
    <content type="text"><![CDATA[一：准备工作 检查服务器上是否已安装libevent的rpm包，具体操作如下： # rpm –qlibevent 若没有，请在linux软件安装包中找到libevent-.rpm，上传至服务器，然后用命令rpm –u libevent-.rpm安装 二：软件安装 使用root用户将memcached-1.4.5.tar.gz上传至服务器上的/usr/local目录下，用root用户登录服务器进行如下安装操作： # cd/usr/local # tar zxvf memcached-1.4.5.tar.gz # cdmemcached-1.4.5 # ./configure # make # makeinstall 查看memcached是否安装成功 # ls -al/usr/local/bin/mem* 成功如下图 三：编写memcache系统服务 # cd/etc/rc.d/init.d # vi memcached 按i键，进入编辑模式，输入如下信息(不包含中文注释)，其中MEMCACHED、MEMCACHED_PID、MEMCACHED_IP、MEMCACHED_USER、MEMCACHED_PORT、 MEMCACHED_MEMORY请按实际情况配置： 1.2. &lt;span class=&quot;pln&quot;&gt;#!/bin/sh &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;# &lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;# memcached: MemCached Daemon &lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;# &lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt;# chkconfig: - 90 25 &lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt;# description: MemCached Daemon &lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt;# &lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt;# Source function library.&lt;/span&gt;10. &lt;span class=&quot;pln&quot;&gt;. /etc/rc.d/init.d/functions&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt;. /etc/sysconfig/network&lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt;RETVAL=0 &lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt;#memcached安装目录下的memcached脚本路径&lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt;#MEMCACHED=/root/memcached/bin/memcached&lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt;MEMCACHED=/usr/local/memcached-1.4.21 &lt;/span&gt;16. &lt;span class=&quot;pln&quot;&gt;#memcached_pid存放路径，可自行定义，但须确保存在该目录&lt;/span&gt;17. &lt;span class=&quot;pln&quot;&gt;MEMCACHED_PID=/root/logs/memcached.pid&lt;/span&gt;18. &lt;span class=&quot;pln&quot;&gt;#启动memcached的服务器IP&lt;/span&gt;19. &lt;span class=&quot;pln&quot;&gt;MEMCACHED_IP=10.1.195.88&lt;/span&gt;20. &lt;span class=&quot;pln&quot;&gt;#启动memcached的用户&lt;/span&gt;21. &lt;span class=&quot;pln&quot;&gt;MEMCACHED_USER=root&lt;/span&gt;22. &lt;span class=&quot;pln&quot;&gt;#启动memcached的端口&lt;/span&gt;23. &lt;span class=&quot;pln&quot;&gt;MEMCACHED_PORT=11211&lt;/span&gt;24. &lt;span class=&quot;pln&quot;&gt;#启动内存 单位(M)&lt;/span&gt;25. &lt;span class=&quot;pln&quot;&gt;MEMCACHED_MEMORY=8192m&lt;/span&gt;26.27. &lt;span class=&quot;pln&quot;&gt;start()&lt;/span&gt;28. &lt;span class=&quot;pln&quot;&gt;{&lt;/span&gt;29. &lt;span class=&quot;pln&quot;&gt; if [ -e $MEMCACHED_PID];then&lt;/span&gt;30. &lt;span class=&quot;pln&quot;&gt; echo &quot;memcached already running....&quot;&lt;/span&gt;31. &lt;span class=&quot;pln&quot;&gt; exit 0&lt;/span&gt;32. &lt;span class=&quot;pln&quot;&gt; fi&lt;/span&gt;33. &lt;span class=&quot;pln&quot;&gt; echo -n $&quot;Starting memcached: &quot;&lt;/span&gt;34. &lt;span class=&quot;pln&quot;&gt; daemon $MEMCACHED -u $MEMCACHED_USER -d -m $MEMCACHED_MEMORY -l $MEMCACHED_IP -p $MEMCACHED_PORT&lt;/span&gt;35. &lt;span class=&quot;pln&quot;&gt; RETVAL=$?&lt;/span&gt;36. &lt;span class=&quot;pln&quot;&gt; echo&lt;/span&gt;37. &lt;span class=&quot;pln&quot;&gt; [ $RETVAL = 0 ] &amp;amp;&amp;amp; touch $MEMCACHED_PID&lt;/span&gt;38. &lt;span class=&quot;pln&quot;&gt; return $RETVAL&lt;/span&gt;39. &lt;span class=&quot;pln&quot;&gt;}&lt;/span&gt;40. &lt;span class=&quot;pln&quot;&gt;stop()&lt;/span&gt;41. &lt;span class=&quot;pln&quot;&gt;{&lt;/span&gt;42. &lt;span class=&quot;pln&quot;&gt; echo -n $&quot;Shutting down memcached: &quot;&lt;/span&gt;43. &lt;span class=&quot;pln&quot;&gt; killproc memcached&lt;/span&gt;44. &lt;span class=&quot;pln&quot;&gt; RETVAL=$?&lt;/span&gt;45. &lt;span class=&quot;pln&quot;&gt; echo&lt;/span&gt;46. &lt;span class=&quot;pln&quot;&gt; [ $RETVAL = 0 ] &amp;amp;&amp;amp; rm -f $MEMCACHED_PID&lt;/span&gt;47. &lt;span class=&quot;pln&quot;&gt;}&lt;/span&gt;48. &lt;span class=&quot;pln&quot;&gt;#[ -f $MEMCACHED] || exit 0&lt;/span&gt;49. &lt;span class=&quot;pln&quot;&gt;# See how we were called.&lt;/span&gt;50. &lt;span class=&quot;pln&quot;&gt;case &quot;$1&quot; in&lt;/span&gt;51. &lt;span class=&quot;pln&quot;&gt;start)&lt;/span&gt;52. &lt;span class=&quot;pln&quot;&gt; start&lt;/span&gt;53. &lt;span class=&quot;pln&quot;&gt; ;;&lt;/span&gt;54. &lt;span class=&quot;pln&quot;&gt;stop)&lt;/span&gt;55. &lt;span class=&quot;pln&quot;&gt; stop&lt;/span&gt;56. &lt;span class=&quot;pln&quot;&gt; ;;&lt;/span&gt;57. &lt;span class=&quot;pln&quot;&gt;restart)&lt;/span&gt;58. &lt;span class=&quot;pln&quot;&gt; stop&lt;/span&gt;59. &lt;span class=&quot;pln&quot;&gt; sleep 3&lt;/span&gt;60. &lt;span class=&quot;pln&quot;&gt; start&lt;/span&gt;61. &lt;span class=&quot;pln&quot;&gt; ;;&lt;/span&gt;62. &lt;span class=&quot;pln&quot;&gt;*)&lt;/span&gt;63. &lt;span class=&quot;pln&quot;&gt; echo $&quot;Usage: $0 {start|stop|restart}&quot;&lt;/span&gt;64. &lt;span class=&quot;pln&quot;&gt; exit 1&lt;/span&gt;65. &lt;span class=&quot;pln&quot;&gt;esac&lt;/span&gt;66. &lt;span class=&quot;pln&quot;&gt;exit $RETVAL&lt;/span&gt;按ESC键，退出编辑模式，输入命令:wq保存退出。四：启动memcache服务使用命令service memcached start启动memcached服务，出现如下信息即启动成功：Service&nbsp; memcached：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [OK]在本地机器telnet memcached服务器的11211端口，能够连接上即表示服务正常启动。五：常见问题记录1.&nbsp;libevent没有安装下载libevent安装包，编译安装&nbsp; &nbsp; &nbsp; &nbsp;./configure –prefix=/usr&nbsp; &nbsp; &nbsp; &nbsp;make&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;make install 来自为知笔记(Wiz) ### 附件列表 libevent-2.0.21-stable.tar.gz memcached-1.4.21.tar.gz &nbsp;]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Memcache</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Nginx】32位redhat6系统安装nginx]]></title>
    <url>%2Fa9f0ca6e8ec035725bb7b69972e4f315.html</url>
    <content type="text"><![CDATA[1.安装前的准备 需求 备注 操作系统 Red Hat Linux Server 6（32位） Nginx安装包 nginx-1.4.7.tar.gz（linux下的压缩包格式） Nginx插件包 nginx_upstream_check_module-master.zipnginx-sticky-module-1.1.tar.gz 传输工具 Xftp 编辑工具 Xshell、Xmanager 服务器 192.168.20.102(仿F5分发的Nginx服务器)，192.168.20.103（Nginx静态文件服务器），192.168.20.124（Nginx反向代理服务器） Nginx安装包存放路径 /u01 Nginx安装路径 /usr/local/nginx 2.开始安装&nbsp;a.上传nginx程序布署包至/u01目录下&nbsp;&nbsp;&nbsp;&nbsp;b.将压缩包进行解压1. &lt;span class=&quot;pln&quot;&gt;tar &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;–&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;xvzf nginx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.4&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;7.tar&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;gz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;、&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;tar &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;–&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;xvzf nginx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sticky&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;tar&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;gz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;、&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;unzip nginx_upsatream_check_module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;zip &lt;/span&gt;c.跳转到解压后的文件夹中，执行如下命令1. &lt;span class=&quot;pln&quot;&gt; cd &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;u01&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.4&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configure &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;usr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;http_stub_status_module &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;http_ssl_module &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;u01&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sticky&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;u01&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx_upstream_check_module&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;master&lt;/span&gt;3. make4. make install命令解释：./configure是执行configure这个配置文件，后面是为这个文件配置的参数。prefix=/usr/local/nginx：是安装路径with-http_stub_status_modulewith-http_ssl_module这个是为nginx添加两个模块add-module=../nginx-sticky-module-1.1add-module=../nginx_upstream_check_module-masterd.在安装时遇到的问题以及解决安装时会遇到缺少包，需要用yum进行安装，关于yum的配置详见另一篇文章，以下是我遇到缺少的包1. &lt;span class=&quot;pun&quot;&gt;问题&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;：&lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; error&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the HTTP rewrite module requires the PCRE library&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;3.4. &lt;span class=&quot;pun&quot;&gt;安装&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;pcre&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;devel&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;解决问题&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;yum &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;y install pcre&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;devel&lt;/span&gt;6.7.8. &lt;span class=&quot;pun&quot;&gt;问题&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;：&lt;/span&gt;9. &lt;span class=&quot;pun&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; error&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the HTTP gzip module requires the zlib library&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;10. &lt;span class=&quot;typ&quot;&gt;You&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; can either disable the module by using &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;–&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;without&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;http_gzip_module&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; or install the zlib library into the system&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; or build the zlib &lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt;library&lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt;statically from the source with nginx by using &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;–&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;zlib&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; option&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;14.15. &lt;span class=&quot;pun&quot;&gt;则需要安装“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;zlib&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;devel&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”即可。&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;SSH&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;执行以下命令：&lt;/span&gt;16.17. &lt;span class=&quot;pln&quot;&gt;yum install &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;y zlib&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;devel&lt;/span&gt;3.将Nginx服务设为系统服务 &nbsp; &nbsp;a.新建nginx文件，并将她拷入/etc/init.d/中执行如下命令1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; vim &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;etc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx&lt;/span&gt;2. 按i键，进入编辑模式，输入如下信息(不包含中文注释)，其中nginxd、nginx_config、nginx_pid请按实际情况配置：3. #nx Startup script for the Nginx HTTP Server# this script create it by jackbillow at 2007.10.15.# it is v.0.0.2 version.# if you find any errors on this scripts,please contact jackbillow.# and send mail to jackbillow at gmail dot com.## chkconfig: - 85 15# description: Nginx is a high-performance web and proxy server.# It has a lot of features, but it’s not for everyone.# processname: nginx# pidfile: /var/run/nginx.pid# config: /usr/local/nginx/conf/nginx.conf#nginx 脚本路径nginxd=/usr/local/nginx/sbin/nginx#nginx 脚本nginx.conf配置nginx_config=/usr/local/nginx/conf/nginx.conf#nginx.pidnginx_pid=/usr/local/nginx/logs/nginx.pidRETVAL=0prog=”nginx”# Source function library.. /etc/rc.d/init.d/functions# Source networking configuration.. /etc/sysconfig/network# Check that networking is up.[ ${NETWORKING} = “no” ] &amp;&amp; exit 0[ -x $nginxd ] || exit 0# Start nginx daemons functions.start() {if [ -e $nginx_pid ];then echo “nginx already running….” exit 1fi echo -n $”Starting $prog: “ daemon $nginxd -c ${nginx_config} RETVAL=$? echo [ $RETVAL = 0 ] &amp;&amp; touch $nginx_pid return $RETVAL}# Stop nginx daemons functions.stop() { echo -n $”Stopping $prog: “ killproc $nginxd RETVAL=$? echo [ $RETVAL = 0 ] &amp;&amp; rm -f $nginx_pid}# reload nginx service functions.reload() { echo -n $”Reloading $prog: ““nginx” 81L, 1855C按ESC键，退出编辑模式，输入命令:wq保存退出。b.执行以下代码，将配置文件加入启动项，并解决权限问题1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;755&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;etc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nginx&lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; chkconfig &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;add nginx&lt;/span&gt;4.启动nginx服务使用命令service nginx start启动nginx服务，出现如下信息即启动成功：Service&nbsp; nginx：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [OK]在ie浏览器中访问http://192.168.20.102(其中192.168.20.102为nginx服务器IP)，出现如下图所示，则nginx安装完成&nbsp; &nbsp; &nbsp; &nbsp;使用命令 service nginx stop 关闭nginx关闭服务4.Nginx插件包说明安装nginx主要有两个插件，他们的作用如下 &nbsp;nginx_upstream_checkmodule-master.zip &nbsp;&nbsp;nginx-sticky-module-1.1.tar.gz下载地址分别为：https://github.com/yaoweibin/nginx_upstream_check_module/archive/master.zip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;_https://code.google.com/p/nginx-sticky-module/wiki/Documentation&nbsp;nginx_upstream_checkmodule-master &nbsp;主要用来检测后端服务器状态&nbsp;nginx-sticky-module 主要是更好负载均衡关于这两个插件，后续会详细介绍&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;_ 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Mongodb】MongoDB分片备份策略示例与配置迁移示例]]></title>
    <url>%2Fe5-9b-bd-e7-bd-91-e5-8d-8f-e5-90-8c-e5-8a-9e-e5-85-ac-e4-b8-80-e7-ba-a7-e9-83-a8-e7-bd-b2-e4-b8-admongodb-e9-85-8d-e7-bd-ae-e6-93-8d-e4-bd-9c-e5-ae-9e-e4-be-8b.html</url>
    <content type="text"><![CDATA[以下内容针对Linux系统配置MongoDB集群过程，具体的Windows平台自行进行修改： 部署模式：1、Replica Set + Sharding ### 1.1.1准备工作正式安装MongoDB集群前需分别在三台服务器上做如下准备工作：1. 创建安装Mongodb所需用户：Mongo，组：Mongodb2. 创建程序数据存储目录:/data/db/shard1、/data/db/shard2、/data/db/shard3、/data/db/config3. 创建日志存储目录：/data/dblog/shard1、/data/dblog/shard2、/data/dblog/shard3、/data/dblog/mongos、/data/dblog/config4. Mongo用户对数据及日志存储目录拥有读写权限5. 上传Mongodb程序mongodb-linux-x86_64-2.4.3.tgz到/home/mongo/目录下，并解压。### 1.1.2创建 shard服务1) 分别在三台服务器上配置环境变量，具体操作如下：[root@mongodb ~] su – mongo[mongo@mongodb ~] vi .bash_profile然后在打开的环境变量文档的export PATH后添加如下变量信息：export MONGODB=/home/mongo/mongodbexport MONGO_DATA=/data/dbexport MONGO_LOG=/data/dblog其中MONGODB为程序包路径，MONGO_DATA为数据存放路径，MONGO_LOG为日志存放路径2) 创建mongodb的启动脚本，具体操作如下：[mongo@mongodb ~] cd /home/mongo[mongo@mongodb ~] mkdir script[mongo@mongodb ~] cd script[mongo@mongodb script] vi startshard1.sh然后在打开的文档中输入如下信息：${MONGODB}/bin/mongod -fork -shardsvr -replSet shard1 -port 10001-dbpath ${MONGO_DATA}/shard1 -logpath ${MONGO_LOG}/shard1/shard1.log保存后为刚创建的startshard1.sh增加执行权限[mongo@mongodb script] chmod 755 startshard1.sh重复上述步骤在当前服务器上创建startshard2.sh和startshard3.sh,其中shard2的端口为10002,shard3的端口为10003,并在其余两台服务器上创建startshard1.sh、startshard2.sh和startshard3.sh.3) 启动每台服务器上的三个shard服务[mongo@mongodb ~] cd /home/mongo/script[mongo@mongodb script] ./startshard1.sh[mongo@mongodb script] ./startshard2.sh[mongo@mongodb script] ./startshard3.sh### 1.1.3 初始化replica set1) 连接mongodb 10001端口初始化replica set，具体操作如下：[mongo@mongodb ~] cd ${MONGODB}bin[mongo@mongodb ~] ./mongo –port 10001MongoDB shell version: 2.4.3connecting to: 127.0.0.1:10001/test&gt;config={_id:’shard1’,members:[{_id: 0, host: ‘IP1:10001’,priority:2},{_id: 1, host: ‘IP2:10001’ ,priority:1},{_id: 2, host: ‘IP3:10001’, “arbiterOnly”: true }]}&gt;rs.initiate(config)&gt;rs.status()其中IP1,IP2,IP3为三台服务器的IP。2) 连接mongodb 10002端口初始化replica set，具体操作如下：[mongo@mongodb ~] cd ${MONGODB}bin[mongo@mongodb ~] ./mongo –port 10002MongoDB shell version: 2.4.3connecting to: 127.0.0.1:10002/test&gt;config={_id:’shard2’,members:[{_id: 0, host: ‘IP1:10002’,arbiterOnly:true},{_id: 1, host: ‘IP2:10002’,priority:2},{_id: 2, host: ‘IP3:10002’,priority:1 }]}&gt;rs.initiate(config)&gt;rs.status()其中IP1,IP2,IP3为三台服务器的IP。3) 连接mongodb 10003端口初始化replica set，具体操作如下：[mongo@mongodb ~] cd ${MONGODB}bin[mongo@mongodb ~] ./mongo –port 100033MongoDB shell version: 2.4.3connecting to: 127.0.0.1:100033/test&gt;config={_id:’shard3’,members:[{_id: 0, host: ‘IP1:10003’ ,priority:1},{_id: 1, host: ‘IP2:10003’,arbiterOnly:true},{_id: 2, host: ‘IP3:10003’,priority:2 }]}&gt;rs.initiate(config)&gt;rs.status()其中IP1,IP2,IP3为三台服务器的IP。4) 验证replica set信息此时分别连接10001、10002和10003端口，用执行rs.status()命令会看到如下图所示的信息： &lt;span style=”font-family: ‘Arial’,’sans-serif’; mso-fareast-font-family: &lt;br /&gt;Arial;” lang=”X-NONE”&gt;1.1.4 创建config servers服务 1) 创建config启动脚本，具体操作如下： [mongo@mongodb ~] cd /home/mongo [mongo@mongodb ~] cd script [mongo@mongodb script] vi startconfig.sh 然后在打开的文档中输入如下信息： ${MONGODB}/bin/mongod -configsvr -port 20000 -fork -dbpath${MONGO_DATA}/dbcfg -logpath ${MONGO_LOG}/dbcfg/dbcfg.log 保存后为刚创建的startconfig.sh增加执行权限 [mongo@mongodb script] chmod 755 startconfig.sh 重复上述步骤在其余两台服务器上创建startconfig.sh。 2) 启动三台服务器上的config服务 [mongo@mongodb ~] cd /home/mongo/script [mongo@mongodb script] ./startconfig.sh &lt;span style=”font-family: ‘Arial’,’sans-serif’; mso-fareast-font-family: &lt;br /&gt;Arial;” lang=”X-NONE”&gt;1.1.5 创建服务 1) 创建mongos启动脚本，具体操作如下： [mongo@mongodb ~] cd /home/mongo [mongo@mongodb ~] cd script [mongo@mongodb script] vi startmongos.sh 然后在打开的文档中输入如下信息： ${MONGODB}/bin/mongos -fork -port 30000 -configdb “IP1:20000,IP2:20000,IP3:20000” -logpath${MONGO_LOG}/mongos/mongos.log 其中IP1,IP2,IP3分别为三台服务器的IP 保存后为刚创建的startconfig.sh增加执行权限 [mongo@mongodb script] chmod 755 startmongos.sh 重复上述步骤在其余两台服务器上创建startmongos.sh。 2) 启动三台服务器上的mongos服务 [mongo@mongodb ~] cd /home/mongo/script [mongo@mongodb script] ./startmongos.sh &lt;span style=”font-family: ‘Arial’,’sans-serif’; mso-fareast-font-family: &lt;br /&gt;Arial;” lang=”X-NONE”&gt;1.1.6配置Sharding 在其中一台服务器上，连接mongod服务，即路由节点30000端口，具体操作如下： [mongo@mongodb ~] cd ${MONGODB}bin [mongo@mongodb ~] ./mongo –port 30000 MongoDB shell version: 2.4.3 connecting to: 127.0.0.1:30000/test 在这里需要 切换到 admin 库 &gt; use admin &gt;db.runCommand({addshard:’shard1/10.1.195.47:10001,10.1.195.57:10001,10.1.195.67:10001’}) { “shardAdded” : “shard1”, “ok” : 1 } &gt;db.runCommand({addshard:”shard2/10.1.195.47:10002,10.1.195.57:10002,10.1.195.67:10002”}) { “shardAdded” : “shard2”, “ok” : 1 } &gt;db.runCommand({addshard:”shard3/10.1.195.47:10003,10.1.195.57:10003,10.1.195.67:10003”}) { “shardAdded” : “shard3”, “ok” : 1 } &gt;db.runCommand({enablesharding:”(dbname)”}) &lt;span style=”font-family: ‘Arial’,’sans-serif’; mso-fareast-font-family: &lt;br /&gt;Arial; mso-fareast-language: ZH-CN;” lang=”X-NONE”&gt;1.1.7 配置Collection分片 为充分体现mongodb分布式的优点，需对mongodb的collection进行分片。collection分片使得数据被分散存储在不同服务器上，减少每个服务器上的数据量，即使要进行大量数据的写入、读取操作，处理起来也会很容易的。 在其中一台服务器上，连接mongod服务，即路由节点30000端口，具体操作如下： [mongo@mongodb ~] cd ${MONGODB}bin [mongo@mongodb ~] ./mongo –port 30000 MongoDB shell version: 2.4.3 connecting to: 127.0.0.1:30000/test &gt;db.runCommand({“enablesharding”:”sgccoa”}) {“OK”:”1”} &gt;db.runCommand({“shardcollection”:”sgccoa.XXX”,”key”:{“XXX”:”1”}}) {“collectionsharded”:”sgccoa.XXX”,”OK”:”1”} 由于协同办公一级部署系统关于mongodb如何分片，研发暂未给出明确答复，故以上分片操作中XXX为不确定信息，可暂不进行分片操作。 1.2如何验证MongoDB集群安装部署成功 对于安装完成后的MongoDB，我们如何查看对应的状态呢，下面是具体的查询操作，以下的查询均基于生产环境实际操作截图：–查看副本集的配置1、shard1的副本集情况2、shard2的副本集情况3、shard3的副本集情况–查看分片的配置1.3 操作当某57磁盘空间沾满而47空间空闲时，将57中的副本集迁移到47中的操作过程： 1、首先连接到三个副本集上面，查看一下分布在57服务器上面的副本状态： 在57服务器上面部署的副本集情况为： shard1: 57:10001 为secondary 副本节点 数据来自与primary节点，所以该节点可以删除 shard2: 57:10002 为primary 主节点，主要数据的存储目录，不建议删除 shard3: 57:10003 为arbiter 仲裁节点，数据量不大，不考虑迁移 故对shard1 在57上面的分布进行迁移 操作步骤：1、查看shard1副本集的primary节点，10.142.51.47:10001 通过mongo -host 10.1.195.47 -port 10001 登录到shard1的主节点进行操作： &gt;rs.remove(“10.1.195.57:10001”)–删除指定发副本集 &gt;rs.status()可以查看删除后的节点情况2、由于我们的副本将迁移到47上面，所以在47上面在开启一个mongod服务，作为节点，启动脚本如下：${MONGODB}/bin/mongod -fork -shardsvr -replSet shard1 -port 10004 -dbpath ${MONGO_DATA}/shard4 -logpath ${MONGO_LOG}/shard4/shard4.log如以上启动脚本所示： 我们删除的副本集的名称（shard1）和我们即将创建的mongod的名称必须一致，否则在添加的时候会出现问题，提示集合名称不匹配。前提：需要再对应的47服务器上面创建对应的目录结构。当新的副本集mongod创建完成后， &gt;rs.add(“10.1.195.47:10004”) –方式一&gt;rs.add({_id:2,host:’10.1.195.47:10004’,priority:2})–方式二 利用配置形式创建可以指定优先级在添加成功后，我们再次查看配置&gt;rs.conf()&gt;rs.status()3、在以上的操作结束后，mongo会进行数据的备份过程，如果数据量大的话会比较耗时，如果数据量较大，建议将新建mongod的目录清空，让mongo进行整改数据库的备份，忽略掉匹配备份，比较省时。4、在以上创建完副本集后，再去查看分片的配置，发现分片的配置已经自动更新为 新增的mongod了。来自为知笔记(Wiz)]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
      <tags>
        <tag>Mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Jdk】32位redhat6系统安装jdk]]></title>
    <url>%2Fc7e17ddcdd976d3300d357de40f10873.html</url>
    <content type="text"><![CDATA[1.所需环境准备 需求备注操作系统Red Hat Linux Server 6（32位）&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JDK安装包&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jdk-6u20-linux-i586.bin2.开始安装a.使用root用户将jdk1.6安装包上传至linux服务器上的/app/install目录下，并使用root用户登录上述服务器进行如下安装操作b.修改jdk的权限，执行以下命令1. &lt;span class=&quot;pln&quot;&gt;chmod &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;755&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; jdk&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;6u20&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;i586&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;c.准备工作完成后开始安装.执行1. &lt;span class=&quot;pun&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;jdk&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;6u20&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;i586&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bin&lt;/span&gt;d.&nbsp; &nbsp;界面首先提示&nbsp;1. &lt;span class=&quot;typ&quot;&gt;Sun&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Microsystems&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Inc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Binary&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Code&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;License&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Agreement&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; the JAVA SE DEVELOPMENT KIT &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;JDK&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; VERSION &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;pun&quot;&gt;……&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;4. &lt;span class=&quot;pun&quot;&gt;会提示“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;More&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”，按空格键翻页&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;e.输入“&nbsp;yes&nbsp;”确认同意；&nbsp;1. &lt;span class=&quot;typ&quot;&gt;Do&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; you agree to the above license terms&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;yes or no&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;yes &lt;/span&gt;3. &lt;span class=&quot;pun&quot;&gt;安装程序自动解压缩安装，直至提示安装成功&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;按回车键（&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Enter&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;）完成安装；&lt;/span&gt;3.配置环境变量#vi ~/.bash_profile按i键，进入编辑模式，在最后面加入 JDK环境变量（JAVA_HOME的地址按实际jdk配置）&nbsp;按ESC键，退出编辑模式，输入命令:wq保存退出。# . /etc/profile注意: . 和 /etc/profile 有空格.4.检验JDK是否安装成功&nbsp; &nbsp; &nbsp;重新启动系统或者注销当前用户&nbsp;打开客户端执行javac1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Desktop&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; javac&lt;/span&gt;2. &lt;span class=&quot;typ&quot;&gt;Usage&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; javac &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;source files&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;where possible options include&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;g &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Generate&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; all debugging info&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;none &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Generate&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; no debugging info&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;vars&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Generate&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; only some debugging info&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;nowarn &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Generate&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; no warnings&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;verbose &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; messages about what the compiler is doing&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;deprecation &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; source locations where deprecated &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;APIs&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; are used&lt;/span&gt;10. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;classpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to find user class files and annotation processors&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;cp &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to find user class files and annotation processors&lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;sourcepath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to find input source files&lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bootclasspath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Override&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; location of bootstrap class files&lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;extdirs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Override&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; location of installed extensions&lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;endorseddirs &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Override&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; location of endorsed standards path&lt;/span&gt;16. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;only&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Control&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; whether annotation processing and&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;or compilation is &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;17. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;processor &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;class1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;[,&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;class2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;,&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;class3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;...]&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Names&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; of the annotation processors to run&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; bypasses default discovery process&lt;/span&gt;18. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;processorpath &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to find annotation processors&lt;/span&gt;19. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;d &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to place generated class files&lt;/span&gt;20. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;s &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; where to place generated source files&lt;/span&gt;21. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;implicit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; whether or not to generate class files &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; implicitly referenced files &lt;/span&gt;22. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;encoding &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Specify&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; character encoding used by source files&lt;/span&gt;23. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;source &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Provide&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; source compatibility with specified release&lt;/span&gt;24. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;target &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Generate&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; class files &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; specific VM version&lt;/span&gt;25. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;version &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; information&lt;/span&gt;26. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;help &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Print&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a synopsis of standard options&lt;/span&gt;27. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Akey&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;[=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Options&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; to pass to annotation processors&lt;/span&gt;28. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;X &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Print&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a synopsis of nonstandard options&lt;/span&gt;29. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Pass&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; directly to the runtime system&lt;/span&gt; 执行 java -version，如果看到JVM版本及相关信息，即安装成功 1. &lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;root@localhost &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Desktop&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;]#&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; java &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;version&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;java version &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;1.6.0_20&quot;&lt;/span&gt;3. &lt;span class=&quot;typ&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;TM&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; SE &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Environment&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;build &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1.6&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0_20&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;b02&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;4. &lt;span class=&quot;typ&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;HotSpot&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;TM&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; VM &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;build &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16.3&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;b01&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mixed mode&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;5.常见问题分析&nbsp; 1.解决在root中配置JDK其他用户不生效，当时设置时用的命令是1. &lt;span class=&quot;pln&quot;&gt;vi &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;~/.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;bash_profile&lt;/span&gt;原因分析，~/此时是指当前目录,此句话的意思是配置了root用户的环境变量文件，对于其他文件会因为权限问题导致问题解决环境变量配置到全局变量中1. &lt;span class=&quot;pln&quot;&gt;vi &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;etc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;profile&lt;/span&gt;profile是系统文件,对系统下全体用户起作用&nbsp;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Jdk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Yum】32位redhat6系统安装yum]]></title>
    <url>%2Ff3a2ec311e9deddee0b29a1bc9636c25.html</url>
    <content type="text"><![CDATA[## 32位redhat6系统安装yum由于&nbsp;redhat的yum在线更新是收费的，如果没有注册的话不能使用，如果要使用，需将redhat的yum卸载后，重启安装，再配置其他源，以下为详细过程：&nbsp;### 一，安装国内在线yum源(网易163提供的)http://mirrors.163.com/centos/ 1.删除redhat原有的yum&nbsp;rpm -aq|grep yum|xargs rpm -e –nodeps 2.下载yum安装文件 (需要有连接上web)wget http://mirrors.163.com/centos/6/os/i386/Packages/yum-3.2.29-40.el6.centos.noarch.rpmwget http://mirrors.163.com/centos/6/os/i386/Packages/yum-metadata-parser-1.1.2-16.el6.i686.rpmwget http://mirrors.163.com/centos/6/os/i386/Packages/yum-plugin-fastestmirror-1.1.30-14.el6.noarch.rpmwget http://mirrors.163.com/centos/6/os/i386/Packages/python-iniparse-0.3.1-2.1.el6.noarch.rpm 3.进行安装yum&nbsp;rpm -ivh python-iniparse-0.3.1-2.1.el6.noarch.rpm&nbsp;rpm -ivh yum-metadata-parser-1.1.2-16.1.el6.i686.rpm&nbsp;rpm -ivh yum-3.2.29-40.el6.centos.noarch.rpm yum-plugin-fastestmirror-1.1.30-14.el6.noarch.rpm&nbsp;&nbsp;注意最后两个包必需同时安装，否则会相互依赖 4.编辑repo仓库服务器配置文件在配置文件中配置如下：/etc/yum.repos.d/rhel-source.repo [base]name=CentOS-$releasever&nbsp;-&nbsp;Basebaseurl=http://mirrors.163.com/centos/6/os/$basearch/gpgcheck=1gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-6#released&nbsp;updates[updates]name=CentOS-$releasever&nbsp;-&nbsp;Updatesbaseurl=http://mirrors.163.com/centos/6/updates/$basearch/gpgcheck=1gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-6#packages&nbsp;used/produced&nbsp;in&nbsp;the&nbsp;build&nbsp;but&nbsp;not&nbsp;released#[addons]#name=CentOS-$releasever&nbsp;-&nbsp;Addons#baseurl=http://mirrors.163.com/centos/$releasever/addons/$basearch/#gpgcheck=1#gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-6#additional&nbsp;packages&nbsp;that&nbsp;may&nbsp;be&nbsp;useful[extras]name=CentOS-$releasever&nbsp;-&nbsp;Extrasbaseurl=http://mirrors.163.com/centos/6/extras/$basearch/gpgcheck=1gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-6#additional&nbsp;packages&nbsp;that&nbsp;extend&nbsp;functionality&nbsp;of&nbsp;existing&nbsp;packages[centosplus]name=CentOS-$releasever&nbsp;-&nbsp;Plusbaseurl=http://mirrors.163.com/centos/6/centosplus/$basearch/gpgcheck=1gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-6 5.清除yum缓存yum clean all 6.构建数据源基本资料yum repolist all (如果这时运行正常，且enabld字段为1,那么表示yum源配置成功了) 7.尝试安装yum install vim 二 配置命令解释注:当第一次使用yum或yum资源库有更新时,yum会自动下载所有所需的headers放置于/var/cache/yum目录下,所需时间可能较长.系统更新(更新所有可以升级的rpm包,包括kernel)#yum -y update每天定期执行系统更新#chkconfig yum on#service yum start*rpm包的更新，检查可更新的rpm包#yum check-update更新所有的rpm包#yum update更新指定的rpm包,如更新kernel和kernel source#yum update kernel kernel-source大规模的版本升级,与yum update不同的是,连旧的淘汰的包也升级#yum upgrade*rpm包的安装和删除安装rpm包,如xmms-mp3#yum install xmms-mp3删除rpm包,包括与该包有倚赖性的包#yum remove licq注:同时会提示删除licq-gnome,licq-qt,licq-text*yum暂存(/var/cache/yum/)的相关参数清除暂存中rpm包文件#yum clean packages清除暂存中rpm头文件#yum clean headers清除暂存中旧的rpm头文件#yum clean oldheaders清除暂存中旧的rpm头文件和包文件#yum clean 或#yum clean all注:相当于yum clean packages + yum clean oldheaders*rpm包列表列出资源库中所有可以安装或更新的rpm包#yum list列出资源库中特定的可以安装或更新以及已经安装的rpm包#yum list mozilla#yum list mozilla注:可以在rpm包名中使用匹配符,如列出所有以mozilla开头的rpm包列出资源库中所有可以更新的rpm包#yum list updates列出已经安装的所有的rpm包#yum list installed列出已经安装的但是不包含在资源库中的rpm包#yum list extras注:通过其它网站下载安装的rpm包 rpm包信息显示(info参数同list)列出资源库中所有可以安装或更新的rpm包的信息#yum info列出资源库中特定的可以安装或更新以及已经安装的rpm包的信息#yum info mozilla#yum info mozilla注:可以在rpm包名中使用匹配符,如列出所有以mozilla开头的rpm包的信息列出资源库中所有可以更新的rpm包的信息#yum info updates列出已经安装的所有的rpm包的信息#yum info installed列出已经安装的但是不包含在资源库中的rpm包的信息#yum info extras注:通过其它网站下载安装的rpm包的信息**搜索rpm包搜索匹配特定字符的rpm包#yum search mozilla注:在rpm包名,包描述等中搜索 搜索有包含特定文件名的rpm包#yum provides realplay&nbsp;### 三 常见问题解决 1、如果网速慢的话可以通过增加yum的超时时间，这样就不会总是因为超时而退出。#vi /etc/yum.conf#加上这么一句timeout=120&nbsp; 2、yum Existing lock错误的解决办法*如果系统启动的时候， yum出现Existing lock /var/run/yum.pid: another copy is running as pid 3380. Aborting.可以用下面的办法解决：方法一etc/init.d/yum-updatesd stop方法二#rm -f /var/run/yum.pid主要原因就是yum在自动更新，只要关掉它就可以了。&nbsp; 先安装fastestmirror，让系统yum的时候自动选择最快的镜像：#yum install yum-fastestmirror -y接下来说说RPMForge。RPMForge是一个安全、稳定并且更新及时的软件仓库，通过安装RPMForge可以是CentOS在进行yum update的时候多一个选择，有时候甚至是唯一的选择，比如想要升级rsync到3.0.x版本，如果懒得自己编译安装，就得依靠RPMForge了。1、先安装priority这个yum的插件，这个插件用来设定安装软件时候软件仓库的优先级，一般是默认先从官方base或者镜像安装，然后从社区用户contribute的软件中安装，再从第三方软件仓库中安装。#yum install yum-priorities2、手动编辑 /etc/yum.repos.d/ 目录中后缀为.repos的文件来设置软件仓库的优先级priority=N(N是整数，范围从1-99，数字越小代表优先级越高)官方推荐配置是[base], [addons], [updates], [extras]&nbsp;这几部分 priority=1[centosplus],[contrib] 这几部分priority=2Third Party Repos such as rpmforge … priority=N&nbsp; (where N is &gt; 10 and based on your preference)3、现在开始安装rpmforge的软件仓库先下载rpmforge的安装包&nbsp; &nbsp; &nbsp; i386&nbsp;&nbsp;wget&nbsp;http://apt.sw.be/redhat/el5/en/i386/RPMS.dag/rpmforge-release-0.3.6-1.el5.rf.i386.rpm&nbsp; &nbsp; &nbsp; x86_64&nbsp;wget&nbsp;_http://apt.sw.be/redhat/el5/en/x86_64/RPMS.dag/rpmforge-release-0.3.6-1.el5.rf.x8664.rpm安装&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rpm -i rpmforge-release-0.3.6-1.el5.rf.*.rpm更改 /etc/yum.repos.d/rpmforge.repo 配置文件，添加priority=1（或者2.3.4….）来源：&nbsp;&lt;http://www.cnblogs.com/shuaixf/archive/2011/11/30/2268496.html&gt;来源：&nbsp;&lt;http://www.cnblogs.com/mailingfeng/archive/2012/09/01/2666745.html&gt; &nbsp;&nbsp; 来自为知笔记(Wiz) ### 附件列表* redhat6_yum安装包.rar &nbsp;]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Yum</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【Linux】虚拟机下linux网络设置]]></title>
    <url>%2Fccd2152002b3c50692e2566884595817.html</url>
    <content type="text"><![CDATA[本次配置通过特定虚拟网络连接外网，能达到当主机WINS能上网时，虚拟机就能上网 步骤如下：1.安装完虚拟后会出现VMware Network Adapter VMnet8,设置网络属性如下 2.在虚拟机安装完REDHAT，启动前设置3.在REDHAT设置网络4.重启网络，用root用户在控制台中执行以下命令service network restart5.关闭防火墙，用root用户在控制台中执行以下命令chkconfig iptables off 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】跨域解决方案汇总]]></title>
    <url>%2Fc36a998751bfa6c62be8eccad11fc6b2.html</url>
    <content type="text"><![CDATA[系统首页架构经典系列—跨域解决方案汇总1.什么是跨域？&nbsp; &nbsp; &nbsp; —1.1 同源策略&nbsp; &nbsp; &nbsp; —1.2&nbsp;同源策略规则2.解决跨域之间的数据交互&nbsp; &nbsp; &nbsp; —2.1&nbsp;document.domain+iframe&nbsp; &nbsp; &nbsp; —2.2&nbsp;动态脚本注入&nbsp; &nbsp; &nbsp; —2.3&nbsp;跨域代理&nbsp; &nbsp; &nbsp;&nbsp;—2.4 JSONP的形式&nbsp; &nbsp; &nbsp; —2.5 使用HTML5 postMessage3.在首页展现架构中实际应用&nbsp; &nbsp; &nbsp;—3.1 运用嵌套iframe&nbsp; &nbsp; &nbsp;—3.2 运用JSONP&nbsp;&nbsp; 1.什么是跨域？跨域，简单地理解就是因为JavaScript同源策略的限制，a.com 域名下的js无法操作b.com或是c.a.com域名下的对象&nbsp;所谓同源是指，域名，协议，端口相同。当一个浏览器的两个tab页中分别打开来 百度和谷歌的页面当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，即检查是否同源，只有和百度同源的脚本才会被执行。&nbsp; &nbsp; &nbsp;以下是维基百科上的解释 1.1同源策略In&nbsp;computing, the&nbsp;same-origin policy&nbsp;is an important concept in the&nbsp;web application&nbsp;security model. The policy permits scripts running on pages originating from the same site&nbsp;– a combination of&nbsp;scheme,&nbsp;hostname, and&nbsp;port number “Port (computer networking)”)[1]&nbsp;– to access each other’s&nbsp;DOM&nbsp;with no specific restrictions, but prevents access to&nbsp;DOM&nbsp;on different sites.[1]&nbsp;The same-origin policy also applies to&nbsp;XMLHttpRequest&nbsp;and to&nbsp;WebSocket. 1.2 同源策略规则To illustrate, the following table gives an overview of typical outcomes for checks against the URL “http://www.example.com/dir/page.html“.Compared URLOutcomeReasonhttp://www.example.com/dir/page2.htmlSuccessSame protocol and hosthttp://www.example.com/dir2/other.htmlSuccessSame protocol and hosthttp://username:password@www.example.com/dir2/other.htmlSuccessSame protocol and hosthttp://www.example.com:**81**/dir/other.htmlFailureSame protocol and host but different port 端口不同https://www.example.com/dir/other.htmlFailureDifferent protocol 协议不同http://**en.example.com**/dir/other.htmlFailureDifferent host 仅主域名相同http://**example.com**/dir/other.htmlFailureDifferent host (exact match required)http://**v2.www.example.com**/dir/other.htmlFailureDifferent host (exact match required)http://www.example.com:**80**/dir/other.htmlDependsPort explicit. Depends on implementation in browser.## 2.解决跨域之间的数据交互以下总结了5种解决跨域之间数据交互的策略，document.domain+iframe、动态脚本注入、跨域代理、JSONP的形式、使用HTML5 postMessage其中JSONP的是原理和动态脚本注入的原理一致 2.1 document.domain+iframe对于主域相同而子域不同的例子，可以通过设置document.domain的办法来解决。举www.a.test.com/a.html和www.b.test.com/b.html为例，只需在a.html中添加一个b.html的iframe， 并且设置两个页面的document.domain都为’a.com’（只能为主域名），两个页面之间即可互相访问了，代码如下：a.htm可以选择动态生成iframe，也可以选择在a.html用iframe直接引用b页面I.采用动态创建iframe的形式 a.htm的js中填写1. &lt;span class=&quot;pln&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;a.com&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;2. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ifr &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;iframe&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;src &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Arial; line-height: 16.799999237060547px; text-indent: 28px; white-space: normal;&quot;&gt;www.b.test.com/b.html&lt;/span&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;display &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;none&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt;ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onload &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(){&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; doc &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;contentDocument &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ifr&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;contentWindow&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;// 在这里操纵b.html&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; alert&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;innerHTML&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;10. &lt;span class=&quot;pun&quot;&gt;};&lt;/span&gt;II采用直接引用iframe的形式 a.htm的内容1. &lt;span class=&quot;dec&quot;&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;&lt;/span&gt;2. &lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;3. &lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;4. &lt;span class=&quot;tag&quot;&gt;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&lt;/span&gt;5. &lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;test.com&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;7. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;8. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;9. &lt;span class=&quot;tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;10. &lt;span class=&quot;tag&quot;&gt;&amp;lt;iframe src =&quot;www.b.test.com/b.html&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;solrIframe&quot; style =&quot;display:none&quot; &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;11. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;12. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt; http://www.c.a.com/b.html 1. &lt;span class=&quot;dec&quot;&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;&lt;/span&gt;2. &lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;3. &lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;4. &lt;span class=&quot;tag&quot;&gt;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&lt;/span&gt;5. &lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;a.com&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;7. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;8. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;9. &lt;span class=&quot;tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;10. &lt;span class=&quot;tag&quot;&gt;&amp;lt;h1&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;Hello World&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;11. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;12. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt; 如果b.html要访问a.html，可在子窗口（iframe）中通过window.parent来访问父窗口的window对象，然后就可以为所欲为了（window对象都有了，还有啥不行的），同理子窗口也可以和子窗口之间通信。 我们可以通过b.html的XMLHttpRequest来获取数据，再传给a.html，从而解决跨子域获取数据的问题。 问题：1、安全性，当一个站点（b.a.com）被攻击后，另一个站点（c.a.com）会引起安全漏洞。2、如果一个页面中引入多个iframe，要想能够操作所有iframe，必须都得设置相同domain。 2.2 动态脚本注入浏览器默认禁止了跨域访问，但并不禁止在页面中引用其他域的JS文件，并可以自由执行引入的JS文件中的function（包括操作cookie、Dom等等）。根据这一点，可以方便地通过创建script节点的方法来实现完全 跨域的通信。具体的做法可以参考YUI的Get Utility 这种技术克服了XMLHttpRequest的最大限制，也就是跨域请求数据。直接用JavaScript创建一个新的脚本标签，然后设置它的src属性为不同域的URL。 www.a.com/a.html中的script 1. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; dynScript &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;script&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;dynScript&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;src &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;http://www.b.com/b.js&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;dynScript&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;head&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;dynScript&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;b.js可以选择调用去www.b.com服务器中调用请求并将返回的数据放入dynCallback中，而dynCallback实质处理函数则写在a.html的页面中,然后www.a.com/a.html获取了域名www.b.com上的数据a.html中回调函数如下：1. &lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; dynCallback&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//处理www.b.com返回的数据 &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; alert&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;4. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&nbsp; 2.3、跨域代理一种简单的办法，就是把跨域的工作交给服务器，从后台获取其他站点的数据再返回给前台，也就是跨域代理（Cross Domain Proxy）。这段英文比较简单，就不再翻译，请读者自行理解吧 All modern web browsers impose a security restriction on network connections, which includes calls to XMLHttpRequest. This restriction prevents a script or application from making a connection to any web server other than the one the web page originally came from (Internet Explorer will allow cross-domain requests if the option has been enabled in the preferences). If both your web application and the XML data that application uses come directly from the same server, then you do not run into this restriction. If, however, you serve your web application from one web server and you make web service data requests to another server – for example, to the Yahoo! Web Services – then the browser prevents the connection from being opened at all. Bummer. There are a number of solutions to this problem but the most commonly-used one is to install a proxy on your web server. Instead of making your XMLHttpRequest calls directly to the web service, you make your calls to your web server proxy. The proxy then passes the call onto the web service and in return passes the data back to your client application. Because the connection is made to your server, and the data comes back from your server, the browser has nothing to complain about. For security reasons it’s a good idea for any proxy you install on your web server should be limited in use. An open proxy that passes on connections to any web site URL is open to abuse. Although it is difficult to limit the connections to your proxy from only your application, you can prevent the proxy from making connections to servers other than those you specify. Hard code the URL to connect to in the proxy itself or provide limited options. This makes the proxy less open and less useful to users other than your client application. 这种方法似乎蛮简单的，改动也不太大。不过就是http请求多了些，响应慢了些，服务器的负载重了些 2.4 JSONP的形式JSONP的底层原理实际就是动态创建脚本，利用script标签绕过同源策略，获得一个类似这样的数据，jsonpcallback是页面存在的回调方法，参数就是想得到的json。 按照动态创建脚本的方式，又要插入script标签，又要定义一个回调，略显麻烦，利用jQuery可以直接得到想要的json数据，同样是上面的jsonp： 1. &lt;span class=&quot;pln&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;#getJsonpByJquery&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;click&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt; $&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ajax&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; url&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;http://localhost:2701/home/somejsonp&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; dataType&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;jsonp&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; jsonp&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;callback&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; success&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; console&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;})&lt;/span&gt;10. &lt;span class=&quot;pun&quot;&gt;})&lt;/span&gt; 2.5 使用HTML5 postMessage​HTML5提供了跨文档消息机制（Cross Document Messaging），它提供了跨越frame、tabs或windows通信的能力。要接收消息的页面需要添加相应的事件监听器，在消息到来时你可以检测其来源来并判断是否处理。浏览器的支持情况：检测浏览器支持：if (typeof window.postMessage === “undefined”) {// postMessage not supported in this browser}发送消息：发送消息给另一个页面：window.postMessage(“Hello, world”, “portal.example.com”);发送消息给iframe：document.getElementsByTagName(“iframe”)[0].contentWindow.postMessage(“Hello, world”,“chat.example.net”);监听消息，首先设置白名单，对接受到的消息进行过滤，只处理信任页面发送的消息。1. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; originWhiteList &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;[“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;portal&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;games&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”];&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; checkWhiteList&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;originWhiteList&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;origin &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; originWhiteList&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;9. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;10. &lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; messageHandler&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;checkWhiteList&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt; processMessage&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;// ignore messages from unrecognized origins &lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;16. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;17. &lt;span class=&quot;pln&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(“&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;”,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; messageHandler&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;## 3 在首页展现架构中实际应用在网站的首页设计中既用到了来自SOLR的数据下图的【会议预告】，又用到了来自流程引擎的数据【待办工作】，因此首页在展现数据时用到了如下策略&nbsp; 3.1运用嵌套iframe &nbsp; 遇到问题：home在去调用SOLR页面时，SOLR页面页面并没有完全加载，造成调用失败， 应对策略：在SOLR页面添加标志位，待确认加载完全后，home再去调用，代码如下； home页面中代码如下：1. &lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;4. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; isChildLoaded&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//标志位，判断嵌套的solr页面是否完全加载&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;displayXmlToPage&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;6. &lt;span class=&quot;com&quot;&gt;//在home页面上展现SOLR返回的数据&lt;/span&gt;7. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;8. &lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;isChildLoaded&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; getSolrXml&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//执行iframe的上的函数&lt;/span&gt;10. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; setTimeOut&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getSolrXml&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;12. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;13. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;14. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;15. &lt;span class=&quot;tag&quot;&gt;&amp;lt;body&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;16. &lt;span class=&quot;tag&quot;&gt;&amp;lt;iframe&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;${solrSearchURL}/searcher/solr.jsp &quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;solrIframe&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&amp;lt;/iframe&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;17. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;18. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;solr页面如下：1. &lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;4. &lt;span class=&quot;com&quot;&gt;//获取Solr服务器上的数据&lt;/span&gt;5. &lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getSolrXml&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; url&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;http://search.sgcc.com.cn:8088/searcher/SearcherSelectServlet/select&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; jQuery&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ajax&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;post&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; url&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; url&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;10. &lt;span class=&quot;pln&quot;&gt; data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; encodeURIComponent&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;queryService&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; async&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt; cache&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt; timeout&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt; success&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt; parent&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;displayXmlToPage&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//回调主页面的函数，在home页面上进行展现 &lt;/span&gt;16. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;17. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;18. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;19. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;20. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;21. &lt;span class=&quot;tag&quot;&gt;&amp;lt;body&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;onload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;parent&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;isChildLoaded &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;测试solr&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;22. &lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;### 3.2 运用JSONP1.jsonp的后台action中处理方式：public void jsonpMethod (){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PrintWriter out=null;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jsonmap = new HashMap();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jsonmap.put(“successed”, true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String callBack = “”+ callback +”(“+ JSONUtil.serialize(jsonmap) +”)”;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.setCharacterEncoding(“utf-8”);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.setContentType(“text/javascript;charset=utf-8”);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.setHeader(“Cache-Control”, “no-cache”);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out = response.getWriter();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.write(callBack);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (Exception e) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throwException(e);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;备注：callback 属于前台传来的参数jsonp的前台调用形式var url=http://log.coa.sgcc.com.cn:8006/coa-webapp/json/jsonpMethod .actionjQuery.ajax({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type : “get”,&nbsp; //获取形式&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; url : url,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //请求url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataType : “jsonp”,&nbsp;&nbsp;&nbsp;&nbsp; //标明是jsonp的形式&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jsonpCallback:”callback”,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; async : false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cache : false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data: {querycond:querycond},&nbsp; //条件&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; success : function(json) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(json.list[0].unitName)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;})&nbsp;引用附录来源：&nbsp;&lt;http://en.wikipedia.org/wiki/Same-origin_policy&gt;来源：&nbsp;&lt;https://developer.yahoo.com/javascript/howto-proxy.html&gt;来源：&nbsp;&lt;http://www.2cto.com/kf/201111/110813.html&gt;来源：&lt;http://www.grati.org/?p=429&gt;来源：&nbsp;&lt;http://www.cnblogs.com/lijiaxuan/&gt;来源：&nbsp;&lt;http://www.cnblogs.com/yuzhongwusan/archive/2012/12/11/2812849.html&gt; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[系统首页架构经典系列—二级缓存的应用与设计中的28法则]]></title>
    <url>%2F31d2d2ea1404210e91c97ebf8b50eabb.html</url>
    <content type="text"><![CDATA[导读缓存设计，常见的一级缓存应用计算机的二级缓存设计无处不在的28法则系统架构二级缓存的应用系统架构28原则的体现优点与依然存在的问题常见的一级缓存应用广义上的缓存技术，下面以memcached为例子，访问应用程序时，如果没有缓存技术应用服务直接读取数据库，第二次继续读取数据库读取数据库速度则成了系统的瓶颈，为了解决这个瓶颈可以在在应用程序与数据之间加个缓存，当应用程序读取缓存的速度远高于读数据库时这个缓存会显得更有意义，第一次应用程序会读取数据库，同时填充缓存，以后则可以直接读取缓存，当未命中时再去数据库中获取计算机的二级缓存设计没有CPU缓存前&nbsp;我们可以形象地把CPU的运算单元想象成是一间坐落在城市中心的工厂，把内存看成是工厂设置在郊区的一间面积很大的仓库A。&nbsp;工厂生产所需要的原材料每次都要花时间去远处的仓库A调运，而且到达仓库后，还要等待仓库准备好材料，中间浪费了不少时间。这就是CPU频率未变的情况下，CPU与内存的数据交换不同步的现象。&nbsp;而突然有一天，由于资金短缺，仓库A从近郊区“搬到”了远郊区，这样原料和成品在工厂与仓库A之间的运输所花费的时间就更长了，工厂生产所需的原料供应不足，经常处于空运转的状态下。这就是说当CPU频率增加后，CPU与内存交换数据等待需时间会变得更长。&nbsp; 增加L1Cache&nbsp;要解决CPU与内存交换数据不同步这个系统瓶颈问题，其中一个办法是在靠近工厂的市区设置一个小型的仓库B（L1Cache）。&nbsp;平时把生产最迫切需要、用得最多的原材料（指令和数据）从仓库A（内存）调配到仓库B（L1Cache），这样工厂生产所需要的原材料就可以很快地调配过来，减少空运转的时间。当所需的原材料在仓库B中找不到（缓存未命中）时，仍然要到仓库A（内存）里调配，虽然无可避免地使工厂又进入空运转，或部分空运转（CPU等待若干个时钟周期），但这样毕竟使等待时间大大降低了。&nbsp;小知识：缓存有一个“预读”功能，也就是可以通过一定的算法，猜测接下来所要的数据，并预先取入缓存。&nbsp;再添L2Cache&nbsp;随着CPU的频率提高，与内存之间交换数据不同步的现象更明显了，可以理解为仓库A（内存）搬离郊区，迁到更远的地方了。解决这一问题的一个更好的办法就是在城市的边缘再设立一个比仓库B大，的仓库C也就是我们说的二级缓存。&nbsp;它的作用是把郊区之外的仓库A（内存）中最迫切用的材料（指令）运到仓库C，而工厂如果在仓库B中找不到所需的材料，就可以到仓库C中找，而不必老远跑到仓库A那里找，节省了不少时间。&nbsp;通常情况下，L2包括L1所有的数据，另外还有一些附加的数据。换言之，L1与L2、L2与内存之间是子母关系，所以CPU缓存的出现更有效地解决了CPU空等待所造成的资源浪费问题。&nbsp;CPU缓存越大越好?&nbsp;当然，CPU缓存并不是越大越好，因为缓存采用的是速度快、价格昂贵的静态RAM（SRAM），由于每个SRAM内存单元都是由4~6个晶体管构成，增加缓存会带来CPU集成晶体管个数大增，发热量也随之增大，给设计制造带来很大的难度。 &nbsp;所以就算缓存容量做得很大，但如设计不合理会造成缓存的延时，CPU的性能也未必得到提高。 &nbsp;无处不在的28法则自从19世纪末帕累托提出“28法则”后，其重要的实用价值得到充分体现。无论是经济社会活动，还是人们日常生活，无不呈现出“28法则”现象。20%的品牌占有80%的市场份额；20%的产品和20%的顾客，承担了企业约80%的营业额;&nbsp;20%拥有80%的财富 80%拥有20%的财富；等等；28法则在系统中的应用，80%的用户只使用了系统20%的功能，80%的用户会集中时间段登录，在架构中体现为，如何提高80%用户的性能，系统如何迅速满足80%用户的用户体验。系统架构二级缓存的应用首页中 来源：&nbsp;&lt;http://baike.baidu.com/view/1749226.htm?fr=aladdin&gt;来源：&nbsp;&lt;http://wenda.tianya.cn/question/7d4424fa8994afba&gt;来源：&nbsp;&lt;http://kb.cnblogs.com/page/42731/&gt;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【系统架构】用JS记录整网页的加载时长]]></title>
    <url>%2Fe3-80-90-e7-b3-bb-e7-bb-9f-e6-9e-b6-e6-9e-84-e3-80-91-e7-94-a8js-e8-ae-b0-e5-bd-95-e6-95-b4-e7-bd-91-e9-a1-b5-e7-9a-84-e5-8a-a0-e8-bd-bd-e6-97-b6-e9-95-bf.html</url>
    <content type="text"><![CDATA[&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 用JS记录整网页的加载时长 &nbsp; &nbsp; &nbsp; &nbsp;导读： &nbsp; &nbsp; &nbsp; &nbsp;随着浏览器的发展的发展，现行的浏览器的插件已经提供了查看时间轨迹的工具，如IE的内置调试工具,火狐的firedug,httpWatch等，为单次调制提供了很大极大便利&nbsp; &nbsp; &nbsp; &nbsp;但是如果对于获取多个用户的页面打开统计时长，仍然比较棘手，常用的方式是在服务端进行时间的处理，但是这样会忽略网络请求和网络发送的时长，为了解决这些问题&nbsp; &nbsp; &nbsp; &nbsp;可以考虑在浏览中运用JS来记录整个页面的所有加载全部时长。 &nbsp; &nbsp;1.几种常见触发函数的理解 2.如何判断页面是刷新还是关闭？ 3.深入思考页面的开始渲染时间 4.前后页面的通讯方式&nbsp; &nbsp; &nbsp; &nbsp; 5.获取计算页面加载完成的时间&nbsp; &nbsp; &nbsp; &nbsp; 6.本次计算加载时长最终采用方案&nbsp; &nbsp; &nbsp; &nbsp; 7.与真实时间的差异性对比 1.几种常见触发函数的理解1. &lt;span class=&quot;pln&quot;&gt;unload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;都是在刷新或关闭时调用，可以在&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;脚本中通过&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;来指定或者在&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;里指定。&lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;区别在于&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;在&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;之前执行，它还可以阻止&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;的执行。&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;typ&quot;&gt;Onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;也是在页面刷新或关闭时调用，&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;是正要去服务器读取新的页面时调用，此时还没开始读取；&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;则已经从服务器上读到了需要加载的新的页面，在即将替换掉当前页面时调用。&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;是无法阻止页面的更新和关闭的。而&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Onbeforeunload&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;可以做到。&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;5. &lt;span class=&quot;pun&quot;&gt;页面加载时只执行&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onload &lt;/span&gt;6. &lt;span class=&quot;pun&quot;&gt;页面关闭时先执行&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，最后&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onunload &lt;/span&gt;7. &lt;span class=&quot;pun&quot;&gt;页面刷新时先执行&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，然后&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，最后&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&gt; &gt; &nbsp; &nbsp; &nbsp;&nbsp;2.如何判断页面是刷新还是关闭？&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;1. &lt;span class=&quot;pln&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;2. &lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;clientX&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;clientWidth &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; event&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;clientY &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; event&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;altKey&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;你关闭了浏览器&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;4. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;你正在刷新页面&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;6. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;7. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&nbsp; &nbsp; &nbsp;&nbsp; 3.深入思考页面的开始渲染时间1. &lt;span class=&quot;typ&quot;&gt;Onunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;都是在刷新或关闭时调用，可以在中第一句话开始，获取当前时间作为开始时间，这样得到的时间实际上忽略了去服务器请求的时间与部分页面渲染的时间&lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;按照&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;中说法，对于首次请求的时间应该有服务器开始处理的时间（忽略了请求时间）对于刷新页面的开始时间应该是上一个页面的关闭后开始去服务器请求的时间，也就是&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Onbeforeunload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;调用时间&lt;/span&gt; 4.前后页面的通讯方式1. &lt;span class=&quot;pun&quot;&gt;如果放在同一页面中设置全局变量，刷新时无法计算，所以页面刷新的介质一般是&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;cookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;，需要注意的是及时对&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;cookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;进行清理&lt;/span&gt; 5.获取计算页面加载完成的时间 1. &lt;span class=&quot;pun&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, SimSun, &#39;Segoe UI&#39;, Tahoma, Helvetica, sans-serif, &#39;Microsoft YaHei&#39;, Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif; line-height: 16.799999237060547px; white-space: normal;&quot;&gt;a.常用方式，页面加载完成时会调用onload函数，获取onload中时间即为结束时间，问题：若是主框架中还有异步请求服务器的请求，并不能准确方式判断异步请求的结束时间，若解决这个问题则可以采用以下方式&lt;/span&gt; &lt;/span&gt;2. &lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;3. &lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;4. &lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;5. &lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; load&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;6. &lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;7. //在此处获取时间8. &lt;span class=&quot;pln&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;Page is loaded&quot;&lt;/span&gt;9. &lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;10. &lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;11. &lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;12. &lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body onload&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;load()&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;13. &lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;14. &lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;1. &lt;span class=&quot;com&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, SimSun, &#39;Segoe UI&#39;, Tahoma, Helvetica, sans-serif, &#39;Microsoft YaHei&#39;, Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif; line-height: 16.799999237060547px; white-space: normal;&quot;&gt;b.基于检查的计算时间方式，确定页面全部加载完成标志元素，比如页面的某个元素加载成功,每隔一段时间去检查页面上是否已经含有此元素，若含有则停止检查，执行操作&lt;/span&gt; &lt;/span&gt;2. &lt;span class=&quot;com&quot;&gt;/*********记录日志开始************/&lt;/span&gt;3. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ssoTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;enterHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//获取SSO的跳转成功的时间&lt;/span&gt;4. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; freTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; parent&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;freTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//获取main页面刚进入的时间&lt;/span&gt;5. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mlen &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;6. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mindex &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;7. &lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(){&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; mlen &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; jQuery&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;.mfi_dotline&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; mindex&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;++;&lt;/span&gt;10. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mlen&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;mindex &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; window&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;clearInterval&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//停止循环&lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; curTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;();&lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt; alert&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;refresh&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;true&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;refresh&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;true&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;16. &lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;curTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;freTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;17. &lt;span class=&quot;pln&quot;&gt; log_visit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&amp;lt;s:property value=&quot;serverip&quot;/&amp;gt;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;系统首页&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;后续刷新&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;18. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;19. &lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;curTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ssoTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//第一次进入&lt;/span&gt;20. &lt;span class=&quot;pln&quot;&gt; setCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;refresh&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;21. &lt;span class=&quot;pln&quot;&gt; log_visit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&amp;lt;s:property value=&quot;serverip&quot;/&amp;gt;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;系统首页&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;首次进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;22. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;23. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;24. &lt;span class=&quot;pun&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;25. 1. &lt;span class=&quot;kwd&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, SimSun, &#39;Segoe UI&#39;, Tahoma, Helvetica, sans-serif, &#39;Microsoft YaHei&#39;, Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif; line-height: 16.799999237060547px; white-space: normal;&quot;&gt;c.基于事件的计算时间方式，在业务处理的代码中添加事件，当满足某种条件则执行操作，这种做法的缺点是与业务代码耦合度过高，【注意清理&lt;span style=&quot;color: rgb(221, 17, 68); font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; line-height: 18px; white-space: pre;&quot;&gt;refresh&lt;/span&gt;】&lt;/span&gt; &lt;/span&gt;2. &lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;portIndex&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;portTotalNum&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){ //当满足某种条件时&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; portIndex &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;999&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;; &lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; var ssoTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;enterHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//获取SSO的跳转成功的时间&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; var freTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;freshToHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; var curTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;();&lt;/span&gt;7. &lt;span class=&quot;pln&quot;&gt; var loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;8. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;refresh&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;true&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;curTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;freTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;10. &lt;span class=&quot;pln&quot;&gt; log_visit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;serverip&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;系统首页&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;后续刷新&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;11. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;12. &lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;curTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ssoTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//第一次进入&lt;/span&gt;13. &lt;span class=&quot;pln&quot;&gt; setCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;refresh&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;14. &lt;span class=&quot;pln&quot;&gt; log_visit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;serverip&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;系统首页&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;首次进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;15. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;16. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt; &nbsp;&nbsp;6.本次计算加载时长最终采用方案 其中主框架为同步加载，在副框架均为异步加载，首页的整个加载顺序：先加载主框架，然后加载副1，然后加载副2，最后副2中豆腐块 首次进入的时间：SSO跳转进入的时间 a.&nbsp;SSO登录跳转成功后&nbsp;准备转向首页的代码，核心代码如下&lt;span class=&quot;pln&quot;&gt;&amp;nbsp;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&gt; &lt;span class=&quot;pln&quot;&gt; &amp;nbsp;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;setCookie(‘enterHomeTime’,new Date().getTime()); &lt;span class=&quot;pln&quot;&gt; &amp;nbsp;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;window.location.href=“&lt;s:property value=’dispatchUrl.homeUrl’/&gt;”; &lt;span class=&quot;pln&quot;&gt;&lt;span style=&quot;font-family: Consolas; color: rgb(30, 52, 123); font-size: 13px; line-height: 1.5;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt; 后续刷新时间采用函数Onbeforeunload，此函数在页面刷新或关闭时调用，是正要去服务器读取新的页面时调用，此时还没开始读取，刷新的时候直接覆盖SSO写过来的时间 &lt;span class=&quot;pln&quot;&gt;&amp;nbsp;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;head&gt; &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; writestarttime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//当刷新的时候去执行&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; freshToHomeTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; delCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;enterHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; setCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;enterHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;freshToHomeTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body loadWebUI&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;SplitBar&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; scroll&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;no&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; onbeforeunload &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;writestarttime()&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;结束时间为，基于事件的记录方式，在页面上所有的豆腐块加载完后进行记录，精确到最后一个加载才开始记录cent.jsp中&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(portIndex==portTotalNum){1. &lt;span class=&quot;pln&quot;&gt; portIndex &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;999&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ssoTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getCookie&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;enterHomeTime&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; curTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;();&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; loadTime &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;curTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;ssoTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt; log_visit&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;serverip&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;系统首页&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;首次进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#39;进入&#39;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt; console&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;进入首页持续时间&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;loadTime&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;7. &lt;span class=&quot;pun&quot;&gt;&lt;font face=&quot;Consolas&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;font face=&quot;Consolas&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/font&gt;}&lt;/span&gt;&nbsp;7.与真实时间的差异性对比 所处环 境 &nbsp; &nbsp; 日志记录时间 实际时间 脚本下载时间 网页渲染时间 误差 准确性 &nbsp;&nbsp;动态页面 13.016s 11.54s 11.54s 3.99s +1.476 88% 10.879s 11.87s 11.87s 3.77s -0.991 92% 12.835s 13.04s 13.04s 4.27s -0.161 98% 12.516s 11.67 11.67s 3.65s +0.846 93% 12.888s 12.36 12.36s 3.97s +1.528 95% &nbsp;&nbsp;静态页面 4.757s 4.64s 4.64s 3.39s +0.117 97% 7.358s 7.54s 7.54s 3.64s -0.182 97% 4.164s 3.65s 3.65s 2.83s +0.154 87% 4.768s 4.32s 4.32s 3.71s +0.448 90% 2.464s 3.03s 3.03s 2.99s -0.566 81% &nbsp;备注：a测试环境为北京PC机访问福州的数据库和缓存。浏览器为IE9b.在页面加载的过程中,实际是一边下载一边渲染，渲染时间远小于下载时间，所以取下载时间作为实际时间c.特殊说明：由于存在工作台的自刷新的情况，若记录的时间有超过5分钟的情况，请自行舍弃结论：按照此思路设计的日志时间准确性平均在90%以上，符合设计要求&nbsp;&nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>系统架构</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Linux】Linux下安装Oracle11g服务器]]></title>
    <url>%2F188e1d0b466344e2ecad5c1e1e53a293.html</url>
    <content type="text"><![CDATA[安装环境 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Linux服务器：SuSe10 sp2 64位 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Oracle服务器：Oracle11gR2 64位 系统要求 Linux安装Oracle系统要求 &nbsp; 系统要求说明内存必须高于1G的物理内存交换空间一般为内存的2倍，例如：1G的内存可以设置swap 分区为3G大小硬盘5G以上 &nbsp; &nbsp;2.修改操作系统核心参数 在Root用户下执行以下步骤： 1**）修改用户的SHELL的限制，修改/etc/security/limits.conf文件 &nbsp;设置Oracle用户的资源占用情况** 输入命令：vi&nbsp;/etc/security/limits.conf**，按i键进入编辑模式，将下列内容加入该文件。oracle &nbsp;&nbsp;soft &nbsp;&nbsp;&nbsp;nproc &nbsp;&nbsp;&nbsp;2047oracle &nbsp;&nbsp;hard &nbsp;&nbsp;&nbsp;nproc &nbsp;&nbsp;&nbsp;16384oracle &nbsp;&nbsp;soft &nbsp;&nbsp;&nbsp;nofile &nbsp;&nbsp;&nbsp;&nbsp;1024oracle &nbsp;&nbsp;hard &nbsp;&nbsp;&nbsp;nofile &nbsp;&nbsp;&nbsp;655361. &lt;span class=&quot;pln&quot;&gt;Oracle soft nproc 2047&lt;/span&gt;2. &lt;span class=&quot;pln&quot;&gt;oracle hard nproc 16384&lt;/span&gt;3. &lt;span class=&quot;pln&quot;&gt;oracle最多允许开启2047个进程，软限制和硬限制都是起限制作用。不过策略稍有不同&lt;/span&gt;4. &lt;span class=&quot;pln&quot;&gt;oracle soft nofile 1024 &lt;/span&gt;5. &lt;span class=&quot;pln&quot;&gt;oracle hard nofile 65536&lt;/span&gt;6. &lt;span class=&quot;pln&quot;&gt;这两句就是限制epg用户最多允许打开10000个文件。&lt;/span&gt;7.8. &lt;span class=&quot;pln&quot;&gt;硬限制就是“绝对不能超过”&lt;/span&gt;9. &lt;span class=&quot;pln&quot;&gt;软限制是可以超过的，但必须小于等于硬限制值。&lt;/span&gt; 编辑完成后按Esc键，输入“:wq”存盘退出&nbsp;2）修改/etc/pam.d/login 文件，输入命令：vi &nbsp;/etc/pam.d/login，按i键进入编辑模式，将下列内容加入该文件。session &nbsp;&nbsp;required &nbsp;&nbsp;&nbsp;/lib/security/pam_limits.so&nbsp;session &nbsp;&nbsp;required &nbsp;&nbsp;&nbsp;pam_limits.so 编辑完成后按Esc键，输入“:wq”存盘退出 &nbsp; 3）修改linux**内核，修改/etc/sysctl.conf文件，输入命令:&nbsp;vi &nbsp;/etc/sysctl.conf&nbsp;，按i键进入编辑模式，将下列内容加入该文件# 整个系统同时可以开启的文件数fs.file-max = 6815744 &nbsp; &nbsp;&nbsp;# 同时可以拥有的的异步IO请求数目fs.aio-max-nr = 1048576&nbsp;#一个共享内存段所能容纳的内存数量kernel.shmall = 2097152&nbsp;#一个共享内存段所能容纳的内存数量kernel.shmmax = 2147483648#整个系统最多可有几个共享内存段&nbsp;kernel.shmmni = 4096&nbsp;#对信号量的设置kernel.sem = 250 32000 100 128&nbsp;#程序可自由使用端口范围net.ipv4.ip_local_port_range = 9000 65500&nbsp;#接收TCP封包的预设缓存空间net.core.rmem_default = 4194304&nbsp;#接收TCP封包的最大缓存空间net.core.rmem_max = 4194304&nbsp;#发送TCP封包的预设缓存空间net.core.wmem_default = 262144&nbsp;#发送TCP封包的最大缓存空间net.core.wmem_max = 1048576编辑完成后按**Esc键，输入“:wq”**存盘退出&nbsp;4**）要使 /etc/sysctl.conf 更改立即生效，执行以下命令。 输入：sysctl &nbsp;-p&nbsp;显示如下： linux:~ # sysctl -p net.ipv4.icmp_echo_ignore_broadcasts = 1 net.ipv4.conf.all.rp_filter = 1 fs.file-max = 6815744 fs.aio-max-nr = 1048576 kernel.shmall = 2097152 kernel.shmmax = 2147483648 kernel.shmmni = 4096 kernel.sem = 250 32000 100 128 net.ipv4.ip_local_port_range = 9000 65500 net.core.rmem_default = 4194304 net.core.rmem_max = 4194304 net.core.wmem_default = 262144 net.core.wmem_max = 1048576&nbsp;5）编辑 /etc/profile ，输入命令：vi&nbsp; /etc/profile，按i键进入编辑模式，将下列内容加入该文件。if [ $USER = “oracle” ]; then&nbsp;if [ $SHELL = “/bin/ksh” ]; then&nbsp;&nbsp; ulimit -p 16384&nbsp;&nbsp; ulimit -n 65536&nbsp;else&nbsp;&nbsp; ulimit -u 16384 -n 65536&nbsp;fifi 编辑完成后按Esc键，输入“:wq”存盘退出 &nbsp; 6**）创建相关用户和组，作为软件安装和支持组的拥有者。创建用户，输入命令：groupadd &nbsp;oinstall&nbsp;groupadd &nbsp;dba创建Oracle用户和密码,输入命令：useradd -g oinstall -g dba -m oraclepasswd &nbsp;oracle然后会让你输入密码，密码任意输入2次，但必须保持一致，回车确认&nbsp;7**）创建数据库软件目录和数据文件存放目录，目录的位置，根据自己的情况来定，注意磁盘空间即可，这里我把其放到oracle用户下,例如： 输入命令： mkdir /home/oracle/app mkdir /home/oracle/app/oracle mkdir /home/oracle/app/oradata mkdir /home/oracle/app/oracle/**product&nbsp;8)**更改目录属主为Oracle用户所有，输入命令：&nbsp; chown -R oracle:oinstall /home/oracle/app &nbsp; 9)**配置oracle用户的环境变量，首先，切换到新创建的oracle用户下,输入：su – oracle&nbsp;&nbsp;，然后直接在输入 ：&nbsp;vi .bash_profile按i编辑 .bash_profile,进入编辑模式，增加以下内容：umask 022export ORACLE_BASE=/home/oracle/appexport ORACLE_HOME=$ORACLE_BASE/oracle/product/11.2.0/dbhome_1export ORACLE_SID=orclexport PATH=$PATH:$HOME/bin:$ORACLE_HOME/binexport LD_LIBRARY_PATH=$ORACLE_HOME/lib:/usr/lib编辑完成后按**Esc键，输入“:wq”**存盘退出## 安装过程1） 当上述系统要求操作全部完成后，注销系统，在图形界面以Oracle用户登陆。首先将下载的Oracle安装包复制到linux中，推荐用Xmanager 或其他ftp工具拷贝。&nbsp;&nbsp; 打开一个终端，运行unzip命令解压oracle安装文件，如：输入命令：unzip &nbsp;linux.x64_11gR2_database_1of2.zip&nbsp;unzip&nbsp; linux.x64_11gR2_database_2of2.zip&nbsp;解压完成后 cd 进入其解压后的目录database输入命令：cd &nbsp;database使用ls命令可以查看解压后database所包含的文件，如下图：2）&nbsp;执行安装，输入命令：./runInstaller&nbsp;&nbsp;&nbsp;&nbsp;装到这一步，可以看到，可以查看到有很多的rpm**包没有，我们可以从安装linux的光盘或ISO中查找所缺的包，使用ftp上传到linux中，然后使用rpm&nbsp; –ivh&nbsp; xxx.rpm&nbsp; –nodeps –force&nbsp;来进行安装（其中加上–nodeps – force&nbsp;代表强制安装，是在直接使用rpm –ivh&nbsp; xxx.rpm**安装不成功的情况下用的）安装过程略。方法一：将安装盘挂在到虚拟机上，去/media/RHEL_6.2 x86_64 Disc 1/Packages 中 执行 &nbsp;rpm&nbsp; –ivh&nbsp; xxx.rpm&nbsp; –nodeps –force&nbsp;进行安装， 方法二： 可以直接去网上下载 相关的xxx.rpm，然后进入目录，然后进行安装 &nbsp;&nbsp;&nbsp;**等到把包全部都安装好的情况下，再次在oracle图形界面中，执行安装过程2，下来在环境检查过程中，就通过了。** 安装完成后，系统会提示你需要用root权限执行2个shell脚本。按照其提示的路径，找到其所在的位置，如：我的就在/home/oracle/app/oracle/product/11.2.0/dbhome_1/root.sh 和 /home/oracle/app/oraInventory/orainstRoot.sh&nbsp; 新开启一个终端，输入命令： su – rootcd&nbsp; /home/oracle/app/oracle/product/11.2.0/dbhome_1sh&nbsp; root.shcd /home/oracle/app/oraInventorysh&nbsp; orainstRoot.sh 数据库建库1） 还是在oracle用户的图形界面oracle用户中，新开启一个终端，直接输入命令dbca会弹出如下界面。我们这里采用定制数据库。 输入统一密码（也可以分别设置其密码） 数据库存放位置，我这里采用默认 不指定快速恢复和归档 去掉不常用的模块 内存分配及指定字符集 经过漫长的等待，当看到此界面，说明oracle建库完成 可以用sqlplus来检验下，新开启一个命令窗口，输入sqlplus，然后输入用户名和密码，可以测试下，这里就不做过多的介绍了。 配置监听及本地网络服务1） 在oracle用户的图形界面oracle用户中，新开启一个终端，输入命令netca 会弹出如下界面。 2）创建监听服务（充当oracle服务器，让别的oracle客户端连接本oracle服务器） 3）配置本地网络服务名（充当oracle客户端，连接别的oracle服务器） 输入连接的oracle服务器的数据库的实例名 输入oracle服务器的ip地址 选中测试 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 点击change Login 输入所连接oracle服务器的其中某一个用户名和密码，点击OK 看到此界面说明测试成功（如果不成功，请查看网络是否畅通，所连接的oracle服务器是否启动，监听是否启动等原因) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 为你所设置的本地网络服务名起个名字 &nbsp;然后下一步，下一步即可 这样oracle服务器安装配置基本就完成了。 常见问题分析： 问题一： vi .bash_profile 修改保存后报错： “.bash_profile”&nbsp; “.bash_profile” E212: Can’t open file for writing Press ENTER or type command to continue 解决办法： 此问题是权限不够 chmod 755 .bash_profile，就可以了 问题二： 在执行检查的时候，会遇到check failed的情况，这是由于依赖包没有安装，可以根据check的情况，到网上下载相应的rpm包，使用：rpm -ivh ……rpm 安装 但是在oracle用户下无法执行rpm依赖包，因为权限不够 解决办法： su到root用户下执行 备注：如何在linux下查看rpm包是否安装完毕，可以执行命令：rpm -q gcc cpp compat-libstdc++ glibc-devel kernel-headers binutils 问题三： 在linux下安装rpm包时经常会遇到下面这个问题： 例如：&nbsp; [root@test Server]# rpm -ivh elfutils-libelf-devel-0.137-3.el5.i386.rpm&nbsp; warning: elfutils-libelf-devel-0.137-3.el5.i386.rpm: Header V3 DSA signature: NOKEY, key ID 37017186 error: Failed dependencies: elfutils-libelf-devel-static-i386 = 0.137-3.el5 is needed by elfutils-libelf-devel-0.137-3.el5.i386&nbsp; 解决办法： 遇到此问题时可以在安装rpm包命令的后面加两个参数：–nodeps –force 如 rpm -ivh elfutils-libelf-devel-0.137-3.el5.i386.rpm –nodeps –force –nodeps意思是解决依赖问题 –force意思是强制安装 问题四： 安装过程中，会出现下面这句话： Enter the full pathname of the local bin directory: [/usr/local/bin]:&nbsp; 解决办法：直接回车 问题五： 执行sqlplus时出错，错误信息如下： cannot restore segment prot after reloc: Permission denied 解决办法： 原因是selinux的问题，selinux的设置太过严格导致的。解决的办法是在root用户下 编辑/etc/selinux/config，找到这段： # This file controls the state of SELinux on the system. # SELINUX= can take one of these three values: # enforcing - SELinux security policy is enforced. # permissive - SELinux prints warnings instead of enforcing. # disabled - SELinux is fully disabled. SELINUX=enforcing&nbsp; 把 SELINUX=enforcing 注释掉：#SELINUX=enforcing ，然后新加一行为： SELINUX=disabled 保存，关闭。 …… 编辑/etc/sysconfig/selinux，找到: # This file controls the state of SELinux on the system. # SELINUX= can take one of these three values: # enforcing - SELinux security policy is enforced. # permissive - SELinux prints warnings instead of enforcing. # disabled - SELinux is fully disabled. SELINUX=enforcing&nbsp; 如果SELINUX已经是 SELINUX=disabled，那么就不用改了，否则就把SELINUX=enforcing 注释掉，新加一行： SELINUX=disabled 保存，退出。 重启电脑 问题六： 使用用户登录Oracle时报错： ERROR: ORA-01034: ORACLE not available ORA-27101: shared memory realm does not exist Linux Error: 2: No such file or directory 解决办法： 首先查看ORACLE_HOME 和ORACLE_SID是否正确，并且，ORACLE_HOME不能在尾部有斜杠“/” [oracle@localhost ~]$ echo $ORACLE_HOME /home/oracle/app/oracle/product/11.2.0/dbhome_1 [oracle@localhost ~]$ echo $ORACLE_SID orcl 上面内容为正确结果 接着执行下面的语句便可解决此问题。 [oracle@localhost ~]$ sqlplus /nolog SQL&gt; connect /as sysdba Connected to an idle instance. SQL&gt; startup ORACLE instance started 执行完后，exit退出Oracle，然后用sqlplus重新登录测试。 做到最后配置完监听后了 问题七 开始安装时候报如下错误 [oracle@localhost database]$ ./runInstallerStarting Oracle Universal Installer…Checking Temp space: must be greater than 80 MB.&nbsp; &nbsp;Actual 244 MB&nbsp; &nbsp; PassedChecking swap space: must be greater than 150 MB.&nbsp; &nbsp;Actual 2015 MB&nbsp; &nbsp; PassedChecking monitor: must be configured to display at least 256 colors&nbsp; &nbsp; &gt;&gt;&gt; Could not execute auto check for display colors using command /usr/bin/xdpyinfo. Check if the DISPLAY variable is set.&nbsp; &nbsp; Failed &lt;&lt;&lt;&lt;Some requirement checks failed. You must fulfill these requirements beforecontinuing with the installation,at which time they will be rechecked.Continue? (y/n) [n] y Rechecking installer requirements….Preparing to launch Oracle Universal Installer from /tmp/OraInstall2012-03-23_02-36-20AM. Please wait …[oracle@localhost database]$ No protocol specifiedException in thread “main” java.lang.InternalError: Can’t connect to X11 window server using ‘:0.0’ as the value of the DISPLAY variable.at sun.awt.X11GraphicsEnvironment.initDisplay(Native Method)at sun.awt.X11GraphicsEnvironment.access$000(X11GraphicsEnvironment.java:53)at sun.awt.X11GraphicsEnvironment$1.run(X11GraphicsEnvironment.java:142)at java.security.AccessController.doPrivileged(Native Method)at sun.awt.X11GraphicsEnvironment.&lt;clinit&gt;(X11GraphicsEnvironment.java:131)at java.lang.Class.forName0(Native Method)at java.lang.Class.forName(Class.java:164)at java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment(GraphicsEnvironment.java:68)at java.awt.Window.init(Window.java:270)at java.awt.Window.&lt;init&gt;(Window.java:318)at java.awt.Frame.&lt;init&gt;(Frame.java:419)at oracle.ewt.popup.PopupFrame.&lt;init&gt;(Unknown Source)at oracle.ewt.lwAWT.BufferedFrame.&lt;init&gt;(Unknown Source)at oracle.sysman.oio.oioc.OiocOneClickInstaller.&lt;init&gt;(OiocOneClickInstaller.java:328)at oracle.sysman.oio.oioc.OiocOneClickInstaller.&lt;clinit&gt;(OiocOneClickInstaller.java:168) 解决方案，重新启动redhat问题八系统无法正常安装pdksh-5.2.14网上32位地址&nbsp;[root@localhost oracle]#&nbsp;wget http://mirror.centos.org/centos/5/os/i386/CentOS/pdksh-5.2.14-37.el5_8.1.i386.rpm 网上64位地址&nbsp;[root@localhost oracle]#&nbsp;wget&nbsp;http://mirror.centos.org/centos/5/os/x86_64/CentOS/pdksh-5.2.14-37.el5_8.1.x86_64.rpm**&nbsp;下载后正常安装~**来源：&nbsp;&lt;http://www.cnblogs.com/zhangyongli2011/archive/2012/04/04/2431953.html&gt;&nbsp; 来自为知笔记(Wiz) ### 附件列表* pdksh-5.2.14.rar &nbsp;]]></content>
      <categories>
        <category>数据库知识</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[【Memcache】32位Linux下的Memcache安装]]></title>
    <url>%2Fb15a2d7569b341bd4cbf61a9cfe6824c.html</url>
    <content type="text"><![CDATA[由于memcached安装时，需要使用libevent类库，所以先安装libevent libevent下载网址:http://www.monkey.org/~provos/libevent/ 官方网站下载地址：http://libevent.org/ 本次安装用的是 libevent-2.0.21-stable.tar.gz 版本安装步骤如下: 1. 解压缩 tar xzfv libevent-2.0.21-stable.tar.gz 2. 进入到 libevent-2.0.21-stable目录 cd libevent-2.0.21-stable 3. 编译，安装 ./configure make make install 注：默认安装到/usr/local/lib/ 目录 接下来，安装memcached memcached下载网址:http://www.memcached.org/ 本手册中下载的是 memcached-1.4.20.tar.gz版本 安装步骤如下: 1. 解压缩 tar xzfv memcached-1.4.20.tar.gz 2. 进入到 memcached-1.4.20目录 cd memcached-1.2.6 3. 编译，安装 ./configure –prefix=/local/memcached make make install 安装完成后，会在 /local/memcached 出现 bin和share目录 进行 bin目录，启动 memcache 方法如下: ./memcached -d -u nobody -m 512 127.0.0.1 -p 11211 此时，会报一个异常 error while loading shared libraries: libevent-2.0.so.5: cannot open shared object file: No such file or directory 原因是找不到libevent-2.0.so.5类库，解决办法如下： 使用LD_DEBUG=help ./memcached -v来确定 加载的类库路径,方法如下: LD_DEBUG=libs ./memcached -v 2&gt;&amp;1 &gt; /dev/null | less 则系统会显示: linux:/local/memcached/bin # LD_DEBUG = libs ./memcached -v&nbsp; 2 &gt;&amp; 1&nbsp; &gt; /dev/null | less 20421 :&nbsp;&nbsp;&nbsp;&nbsp; find library = libevent-2.0.so.5 ;&nbsp; searching 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; search cache = /etc/ld.so.cache 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; search path = /lib/tls/i686/sse2:/lib/tls/i686:/lib/tls/sse2:/lib/tls:/lib/i686/sse2:/lib/i686:/lib/sse2:/lib:/usr/lib/tls/i686 /sse2:/usr/lib/tls/i686:/usr/lib/tls/sse2:/usr/lib/tls:/usr/lib/i686/sse2:/usr/lib/i686:/usr/lib/sse2:/usr/lib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (system search path) 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/i686/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/i686/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/tls/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/i686/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/i686/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /lib/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/i686/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/i686/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/tls/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/i686/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/i686/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/sse2/libevent-2.0.so.5 20421 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying file = /usr/lib/libevent-2.0.so.5 20421 : ./memcached: error while loading shared libraries: libevent-2.0.so.5 : cannot open shared object file: No such file or directory 我们看到，memcached会到很多地方去找，所以根据其它求，我们只需建一个软链接，指定到我们安装的类库上即可 方法如下： ln -s /usr/local/lib/libevent-2.0.so.5 &nbsp;/lib/libevent-2.0.so.5 现在可以正常启动memcached了 ./memcached -d -u nobody -m 512 127.0.0.1 -p 11211 到这里，看到memcached已经启动，说明安装成功。 测试：通过其他机器telnet 此机器的端口 &nbsp; &nbsp; ps:虚拟机上的端口是否已经打开 最后做启动文件，下次可以直接使用 1startmemcache.sh 内容为：local/memcached/bin/memcached -d -m 10 -u redhat -l 192.168.199.101 -p 11211 -c 256 -P /tmp/memcached.pid&nbsp; 2stopmemecache.sh 内容为：kill cat /tmp/memcached.pid memcache启动参数说明: -d选项是启动一个守护进程， -m是分配给Memcache使用的内存数量，单位是MB，我这里是10MB， -u是运行Memcache的用户，我这里是root， -l是监听的服务器IP地址，如果有多个地址的话，我这里指定了服务器的IP地址192.168.0.200， -p是设置Memcache监听的端口，我这里设置了12000，最好是1024以上的端口， -c选项是最大运行的并发连接数，默认是1024，我这里设置了256，按照你服务器的负载量来设定， -P是设置保存Memcache的pid文件，我这里是保存在 /tmp/memcached.pid &nbsp; 来自为知笔记(Wiz)]]></content>
      <categories>
        <category>应用服务器</category>
      </categories>
      <tags>
        <tag>Memcache</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[【数学工具】数学工具MathJax整理]]></title>
    <url>%2FmathJax.html</url>
    <content type="text"><![CDATA[什么是MathJaxMathJax is an open-source JavaScript display engine for LaTeX, MathML, and AsciiMath notation that works in all modern browsers. It was designed with the goal of consolidating the recent advances in web technologies into a single, definitive, math-on-the-web platform supporting the major browsers and operating systems, including those on mobile devices. It requires no setup on the part of the user (no plugins to download or software to install), so the page author can write web documents that include mathematics and be confident that users will be able to view it naturally and easily. One simply includes MathJax and some mathematics in a web page, and MathJax does the rest. 如何使用1.在你的html中引入1&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt; 2.使用\$**\$,其中**表示并不同的符号，如下图中的\hat{a}就表示$\hat{a}$ 总结本文总结了MathJax的常见用法。 声明本文95%为翻译组合,5%为原创 引用https://www.mathjax.org/http://blog.csdn.net/ws_20100/article/details/49159291]]></content>
      <categories>
        <category>数学工具</category>
      </categories>
      <tags>
        <tag>MathJax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Study identifies a new way to prevent a deadly fungal infection spreading to the brain]]></title>
    <url>%2Fnews_0.html</url>
    <content type="text"><![CDATA[NEWSResearch led by the University of Birmingham has discovered a way to stop a deadly fungus from ‘hijacking’ the body’s immune system and spreading to the brain. The team studied Cryptococcosis, a disease that infects humans and animals after breathing in airborne fungi. The disease can result in a lung infection that may subsequently spread to the brain by hitching a lift inside our own white blood cells. Professor Robin May, Director of the Institute of Microbiology &amp; Infection at the University of Birmingham, said: “When an infection starts, the first white blood cell to respond is called a macrophage. This identifies the invading bacteria or fungus, ‘eats it’, destroys it and then alerts the rest of the immune system. “However, in the case of some diseases like Cryptococcosis, the invading organism has evolved to be able to survive inside that white blood cell and then use them like a public transport system to help move around the body. “We know that many white blood cells overcome this by throwing those hijackers out, using a mechanism called ‘vomocytosis’. However, we don’t know how vomocytosis is controlled. “There are many diseases, not only Cryptococcosis, in which pathogens - bacteria, viruses, fungi or parasites that can cause disease - survive by deliberately hijacking the immune system in this way. “This research aimed to identify the mechanism that allows white blood cells to recognise and expel these hijackers. “If we can develop ways to manipulate this and encourage the white blood cells to recognise and expel organisms like this, we might be able to limit the spread of infection not only for Cryptococcosis but for other invasive pathogens that are a significant threat to human health world-wide.” The findings of the study, carried out in collaboration with the Universities of Sheffield, Dundee, and Manchester in the UK, as well as the University of Leuven in Belgium and Harvard Medical School in the US, were published today in Science Advances. They identified signals that white blood cells use to control their behaviour, then one by one disabled those signals - discovering that one particular molecule called ERK5 could be manipulated to encourage white blood cells either to throw out pathogens better or to keep them inside and try to kill them for longer. Professor May continues: “We found that by blocking ERK5 in zebrafish, we were able to increase vomocytosis rates in their white blood cells and so prevent a deadly fungal infection from spreading to the brain. “As a consequence of this research we have a greater understanding of a really subtle and new aspect of the human immune system. “Longer term, our hope is that we will be able to develop therapies that target this process, such as drugs that would be able to limit an infection and prevent it from spreading from the initial site of attack. “We would also now like to broaden this research to see how much this process may play a similar role in other major human diseases.” Hashf24ed3c811777c00b94d53b81c4d0413f94649f9227f4d864b3fb1e793a1d3e3]]></content>
      <categories>
        <category>算法整理</category>
      </categories>
      <tags>
        <tag>算法整理</tag>
        <tag>八数码问题</tag>
      </tags>
  </entry>
</search>
